import{r as o,A as le,j as e,c as pe,a as Xe,S as se,R as nt,u as G,M as me,W as ne,i as lt,f as ot}from"./index-WpmMFlvs.js";import{U as Ie}from"./UserAvatar-oaGqtEN3.js";import{t as it,E as ct}from"./EditProfileModal-yGIxivXk.js";import{S as ae,a as dt,G as xt,b as ut,c as tt,E as We,d as mt,e as pt,f as ht,g as gt,h as bt,D as ft,i as vt,O as yt}from"./OrdersList-DNioRiom.js";import wt from"./html2canvas.esm-QH1iLAAe.js";import"./imageCompressor-D5vYYzIg.js";const st=({activeDashboard:s,currentAdminView:a,isReportSubMenuOpen:i,isProfileSubMenuOpen:r,onNavChange:y,onReportSubNav:g,setIsReportSubMenuOpen:m,setIsProfileSubMenuOpen:b,setEditProfileModalOpen:l,isMobile:v=!1})=>{const{currentUser:h,logout:j,refreshData:L,isSidebarCollapsed:P,setIsSidebarCollapsed:A,setAppState:N,setIsChatOpen:I,unreadCount:w,language:M,setLanguage:u}=o.useContext(le),[n,p]=o.useState(!1),x=it[M],t=[{id:"overview",title:x.overview,icon:"üìä"},{id:"sales_team",title:x.sales_team_report,icon:"üë•"},{id:"sales_page",title:x.sales_page_report,icon:"üìÑ"},{id:"performance",title:x.performance,icon:"üìà"},{id:"profitability",title:x.profitability,icon:"üí∞"},{id:"forecasting",title:x.forecasting,icon:"üîÆ"},{id:"shipping",title:x.shipping_report,icon:"üöö"}],C=[{id:"dashboard",label:x.dashboard,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),component:"admin"},{id:"fulfillment",label:"Fulfillment",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",strokeWidth:2})}),component:"fulfillment"},{id:"orders",label:x.orders,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),component:"orders"},{id:"reports",label:x.reports,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),component:"reports"},{id:"settings",label:x.settings,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),component:"settings"}],d=(h==null?void 0:h.IsSystemAdmin)&&((h==null?void 0:h.Team)||"").split(",").map(S=>S.trim()).filter(Boolean).length>0,f=async()=>{p(!0);try{await L(),window.location.reload()}catch{p(!1)}},c=v?"w-full flex flex-col h-full bg-transparent":`fixed left-0 top-0 h-screen border-r border-white/5 z-50 transition-all duration-300 ease-in-out ${P?"w-20":"w-64"} bg-[#020617]/95 backdrop-blur-3xl flex flex-col shadow-2xl`;return e.jsxs("aside",{className:c,children:[!v&&e.jsxs("div",{className:"h-20 flex items-center gap-4 px-6 border-b border-white/5 overflow-hidden relative group shrink-0",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-600/20 flex-shrink-0 transition-all border border-white/10 z-10",children:e.jsx("img",{src:pe(Xe),alt:"Logo",className:"w-5 h-5 object-contain"})}),!P&&e.jsxs("div",{className:"flex flex-col z-10 animate-fade-in min-w-0",children:[e.jsx("h1",{className:"text-base font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em]",children:"Admin"})]})]}),!v&&e.jsx("button",{onClick:()=>A(!P),className:"absolute top-[4.5rem] -right-3 w-6 h-6 bg-[#0f172a] border border-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-white shadow-xl z-[60] transition-all hover:scale-110 hover:border-blue-500/50",children:e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 ${P?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:e.jsx("path",{d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-0 py-6 space-y-1",children:[v&&e.jsx("div",{className:"px-4 mb-6",children:e.jsxs("button",{onClick:()=>I(!0),className:"w-full flex items-center justify-between px-4 py-3.5 rounded-2xl bg-gradient-to-r from-blue-600/20 to-indigo-600/20 text-blue-300 border border-blue-500/30 active:scale-[0.98] transition-all shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative p-1.5 bg-blue-500/20 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),w>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-gray-900 animate-pulse"})]}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:x.chat_system})]}),w>0&&e.jsx("span",{className:"bg-red-500 text-white text-[9px] font-black px-2 py-0.5 rounded-full shadow-lg",children:w})]})}),C.map(S=>{const k=S.id==="reports",D=s===S.component&&(S.component!=="admin"||S.id===a),T=k&&i;return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>y(S.id),className:`
                                    w-full flex items-center justify-between px-6 py-4 transition-all duration-200 group relative
                                    ${D?"text-white bg-gradient-to-r from-blue-600/30 to-transparent border-l-4 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5 border-l-4 border-transparent"}
                                `,title:P&&!v?S.label:"",children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("span",{className:`transition-transform duration-300 ${D?"scale-110 text-blue-400":"group-hover:text-gray-200"}`,children:S.icon}),(v||!P)&&e.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${D?"text-white":""}`,children:S.label})]}),k&&(v||!P)&&e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 opacity-50 ${T?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-black/20 ${T&&(v||!P)?"max-h-[500px] opacity-100 py-2":"max-h-0 opacity-0"}`,children:t.map(z=>e.jsxs("button",{onClick:()=>g(z.id),className:"w-full flex items-center gap-3 px-6 pl-14 py-2.5 text-[10px] font-bold uppercase tracking-wider text-gray-500 hover:text-white hover:bg-white/5 transition-all relative group",children:[e.jsx("div",{className:"absolute left-10 w-1.5 h-1.5 rounded-full bg-gray-700 group-hover:bg-blue-500 transition-colors"}),e.jsx("span",{className:"truncate",children:z.title})]},z.id))})]},S.id)})]}),e.jsxs("div",{className:`p-4 shrink-0 ${v?"":"border-t border-white/5 bg-black/20"}`,children:[e.jsxs("button",{onClick:()=>b(!r),className:`
                        w-full flex items-center gap-3 p-2.5 rounded-2xl transition-all duration-300
                        ${r?"bg-gray-800":"hover:bg-white/5"}
                        ${!v&&P?"justify-center":""}
                    `,children:[e.jsx(Ie,{avatarUrl:h==null?void 0:h.ProfilePictureURL,name:(h==null?void 0:h.FullName)||"",size:"md",className:"ring-2 ring-white/5 shadow-md flex-shrink-0"}),(v||!P)&&e.jsxs("div",{className:"min-w-0 flex-grow text-left",children:[e.jsx("p",{className:"text-xs font-black text-white truncate leading-tight",children:h==null?void 0:h.FullName}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-widest mt-0.5 truncate",children:h==null?void 0:h.Role})]}),(v||!P)&&e.jsx("svg",{className:`w-3 h-3 text-gray-500 transition-transform duration-300 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]}),e.jsx("div",{className:`
                    overflow-hidden transition-all duration-300 ease-in-out
                    ${r&&(v||!P)?"max-h-[300px] mt-4 opacity-100":"max-h-0 opacity-0"}
                `,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-900 rounded-xl p-1 flex border border-white/5",children:[e.jsx("button",{onClick:()=>u("en"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${M==="en"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"ENG"}),e.jsx("button",{onClick:()=>u("km"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${M==="km"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"KH"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>l(!0),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-blue-600/20 hover:border-blue-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400 mb-1.5 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Profile"})]}),e.jsxs("button",{onClick:f,disabled:n,className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-emerald-600/20 hover:border-emerald-500/30 transition-all group",children:[n?e.jsx(se,{size:"sm"}):e.jsx("svg",{className:"w-4 h-4 text-emerald-400 mb-1.5 group-hover:rotate-180 transition-transform duration-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Sync"})]}),d&&e.jsxs("button",{onClick:()=>N("role_selection"),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-yellow-600/20 hover:border-yellow-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-400 mb-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Switch"})]}),e.jsxs("button",{onClick:j,className:`flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-red-600/20 hover:border-red-500/30 transition-all group ${d?"":"col-span-2"}`,children:[e.jsx("svg",{className:"w-4 h-4 text-red-400 mb-1.5 group-hover:translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Logout"})]})]})]})})]})]})},jt=({children:s,activeDashboard:a,currentAdminView:i,isSidebarCollapsed:r,onNavChange:y,onReportSubNav:g,isReportSubMenuOpen:m,setIsReportSubMenuOpen:b,isProfileSubMenuOpen:l,setIsProfileSubMenuOpen:v,setEditProfileModalOpen:h})=>e.jsxs("div",{className:"flex min-h-screen bg-gray-950",children:[e.jsx(st,{activeDashboard:a,currentAdminView:i,isReportSubMenuOpen:m,isProfileSubMenuOpen:l,onNavChange:y,onReportSubNav:g,setIsReportSubMenuOpen:b,setIsProfileSubMenuOpen:v,setEditProfileModalOpen:h}),e.jsxs("main",{className:`flex-1 transition-all duration-300 ease-in-out ${r?"pl-20":"pl-64"}`,children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-50 overflow-hidden",children:e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-600/5 rounded-full blur-[120px]"})}),e.jsx("div",{className:"p-4 md:p-6 lg:p-8 xl:p-10 2xl:p-12 max-w-[2400px] mx-auto min-h-screen relative z-10 transition-all duration-300",children:s})]})]}),at=({activeDashboard:s,currentAdminView:a,onNavChange:i,onReportSubNav:r,isReportSubMenuOpen:y,setIsReportSubMenuOpen:g,isProfileSubMenuOpen:m,setIsProfileSubMenuOpen:b,setEditProfileModalOpen:l})=>{const{isMobileMenuOpen:v,setIsMobileMenuOpen:h}=o.useContext(le);return v?e.jsxs("div",{className:"fixed inset-0 z-[100] flex overflow-hidden",children:[e.jsx("style",{children:`
                @keyframes slide-right {
                    from { transform: translateX(-100%); }
                    to { transform: translateX(0); }
                }
                .animate-slide-right {
                    animation: slide-right 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
                }
            `}),e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md transition-opacity duration-300",onClick:()=>h(!1)}),e.jsxs("div",{className:"relative w-[85%] max-w-[320px] h-full bg-[#020617] shadow-2xl animate-slide-right flex flex-col border-r border-white/10",children:[e.jsxs("div",{className:"flex-shrink-0 px-6 pt-12 pb-6 flex items-center justify-between bg-gradient-to-b from-[#0f172a] to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/40 border border-white/10 overflow-hidden p-1.5",children:e.jsx("img",{src:pe(Xe),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"Core Access"})]})]}),e.jsx("button",{onClick:()=>h(!1),className:"w-9 h-9 rounded-full bg-white/5 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 border border-white/5 transition-all active:scale-90",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 18L18 6M6 6l12 12",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex-grow overflow-hidden relative z-10",children:e.jsx(st,{isMobile:!0,activeDashboard:s,currentAdminView:a,isReportSubMenuOpen:y,isProfileSubMenuOpen:m,onNavChange:j=>{i(j),j!=="reports"&&h(!1)},onReportSubNav:j=>{r(j),h(!1)},setIsReportSubMenuOpen:g,setIsProfileSubMenuOpen:b,setEditProfileModalOpen:l})})]})]}):null},Nt=({children:s,activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:y,isReportSubMenuOpen:g,setIsReportSubMenuOpen:m,isProfileSubMenuOpen:b,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:v})=>e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-5%] left-[-10%] w-[60%] h-[40%] bg-blue-600/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-5%] right-[-5%] w-[60%] h-[40%] bg-indigo-600/10 rounded-full blur-[120px]"})]}),e.jsx(at,{activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:y,isReportSubMenuOpen:g,setIsReportSubMenuOpen:m,isProfileSubMenuOpen:b,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:v}),e.jsx("main",{className:"flex-1 pb-12 px-3 overflow-x-hidden relative z-10",children:e.jsx("div",{className:"max-w-xl mx-auto",children:s})}),e.jsx("div",{className:"h-1 w-24 bg-white/5 rounded-full mx-auto mb-4"})]}),kt=({children:s,activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:y,isReportSubMenuOpen:g,setIsReportSubMenuOpen:m,isProfileSubMenuOpen:b,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:v})=>{const{setIsMobileMenuOpen:h,currentUser:j}=nt.useContext(le);return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-5%] w-[50%] h-[50%] bg-blue-900/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-5%] w-[50%] h-[50%] bg-purple-900/10 rounded-full blur-[120px]"})]}),e.jsxs("header",{className:"sticky top-0 z-40 bg-[#0f172a]/80 backdrop-blur-xl border-b border-white/5 px-6 py-4 flex justify-between items-center shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h(!0),className:"p-2.5 rounded-xl bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white transition-all border border-white/5 active:scale-95",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/20 p-1.5 border border-white/10",children:e.jsx("img",{src:pe(Xe),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[10px] text-blue-400 font-bold uppercase tracking-[0.2em]",children:"Tablet Admin"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-sm font-bold text-white leading-tight",children:j==null?void 0:j.FullName}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono uppercase",children:j==null?void 0:j.Role})]}),e.jsx(Ie,{avatarUrl:j==null?void 0:j.ProfilePictureURL,name:(j==null?void 0:j.FullName)||"",size:"md",className:"ring-2 ring-white/10 shadow-md"})]})]}),e.jsx(at,{activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:y,isReportSubMenuOpen:g,setIsReportSubMenuOpen:m,isProfileSubMenuOpen:b,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:v}),e.jsx("main",{className:"flex-1 p-6 relative z-10 overflow-x-hidden",children:e.jsx("div",{className:"w-full mx-auto",children:s})})]})},St=({stats:s,onStatClick:a})=>{const i=o.useMemo(()=>s.reduce((r,y)=>({revenue:r.revenue+y.revenue,orders:r.orders+y.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"}),e.jsx("path",{d:"M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"})]}),"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî·ûè·û∂·ûò·ûÄ·üí·ûö·ûª·ûò"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"·ûÄ·üí·ûö·ûª·ûò"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"·ûÖ·üÜ·ûé·ûº·ûõ"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,y)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",y+1]}),e.jsx("span",{className:"group-hover:text-blue-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"·ûò·û∑·ûì·ûë·û∂·ûì·üã·ûò·û∂·ûì·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"·ûü·ûö·ûª·ûî·ûö·ûΩ·ûò"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:i.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",i.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},Ct="/Order_System/",Dt=[`${Ct}cambodia-provinces.geojson`,"https://raw.githubusercontent.com/seanghai/cambodia-geojson/master/cambodia-provinces.geojson","https://raw.githubusercontent.com/romnea/cambodia-geojson/master/provinces.geojson","https://raw.githubusercontent.com/kheang-hong/cambodia-geojson/master/provinces.geojson"],He=s=>{if(!s)return"";const a=String(s).toLowerCase().replace(/\s/g,"").replace(/province|city|krong|khan|·ûö·û∂·ûá·ûí·û∂·ûì·û∏|·ûÅ·üÅ·ûè·üí·ûè|·ûÅ·üÅ·ûè·üí·ûä|·ûÄ·üí·ûö·ûª·ûÑ/g,"").trim();return{·ûó·üí·ûì·üÜ·ûñ·üÅ·ûâ:"phnompenh",·ûÄ·ûé·üí·ûè·û∂·ûõ:"kandal",·ûÄ·ûé·üí·ûä·û∂·ûõ:"kandal",·ûÄ·üÜ·ûñ·ûÑ·üã·ûÖ·û∂·ûò:"kampongcham",·ûÄ·üÜ·ûñ·ûÑ·üã·ûÜ·üí·ûì·û∂·üÜ·ûÑ:"kampongchhnang",·ûÄ·üÜ·ûñ·ûÑ·üã·ûí·üÜ:"kampongthom",·ûÄ·üÜ·ûñ·ûÑ·üã·ûü·üí·ûñ·û∫:"kampongspeu",·ûÄ·üÜ·ûñ·ûè:"kampot",·ûÄ·üÇ·ûî:"kep",·ûÄ·üÑ·üá·ûÄ·ûª·ûÑ:"kohkong",·ûÄ·üí·ûö·ûÖ·üÅ·üá:"kratie",·ûè·û∂·ûÄ·üÇ·ûú:"takeo",·ûè·üí·ûî·ûº·ûÑ·ûÉ·üí·ûò·ûª·üÜ:"tbongkhmum",·ûî·ûì·üí·ûë·û∂·ûô·ûò·û∂·ûì·ûá·üê·ûô:"banteymeanchey",·ûî·û∂·ûè·üã·ûä·üÜ·ûî·ûÑ:"battambang",·ûî·üâ·üÉ·ûõ·û∑·ûì:"pailin",·ûñ·üÑ·ûí·û∑·üç·ûü·û∂·ûè·üã:"pursat",·ûñ·üí·ûö·üÉ·ûú·üÇ·ûÑ:"preyveng",·ûñ·üí·ûö·üá·ûú·û∑·û†·û∂·ûö:"preahvihear",·ûñ·üí·ûö·üá·ûü·û∏·û†·ûì·ûª:"preahsihanouk",·ûò·ûé·üí·ûå·ûõ·ûÇ·û∑·ûö·û∏:"mondulkiri",·ûö·ûè·ûì·ûÇ·û∑·ûö·û∏:"ratanakiri",·ûü·üÄ·ûò·ûö·û∂·ûî:"siemreap",·ûü·üí·ûë·ûπ·ûÑ·ûè·üí·ûö·üÇ·ûÑ:"stungtreng",·ûü·üí·ûú·û∂·ûô·ûö·üÄ·ûÑ:"svayrieng",·ûß·ûè·üí·ûè·ûö·ûò·û∂·ûì·ûá·üê·ûô:"oddarmeanchey"}[a]||a},Pt=()=>{const[s,a]=o.useState(null),[i,r]=o.useState(null),[y,g]=o.useState(!0);return o.useEffect(()=>{let m=!0;return(async()=>{for(const l of Dt)try{const v=await fetch(l);if(v.ok){const h=await v.json();if(h&&h.type==="FeatureCollection"&&Array.isArray(h.features)){m&&(a(h),g(!1));return}else console.warn(`Fetched data from ${l} is not valid GeoJSON`)}}catch(v){console.warn(`Failed to load ${l}`,v)}m&&(r("·ûò·û∑·ûì·û¢·û∂·ûÖ·ûë·û∂·ûâ·ûô·ûÄ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûï·üÇ·ûì·ûë·û∏·ûî·û∂·ûì·ûë·üÅ"),g(!1))})().catch(l=>{console.error("GeoJSON Fetch Fatal Error:",l),m&&(r("Error loading map data"),g(!1))}),()=>{m=!1}},[]),{geoJson:s,loading:y,error:i}},we={levels:["#2e1065","#581c87","#7e22ce","#a855f7","#d8b4fe","#facc15","#fde047"]},be=[0,500,2e3,5e3,1e4,25e3],Ue=["interpolate",["linear"],["get","revenue"],0,200,500,1500,5e3,8e3,1e4,2e4,5e4,45e3],Lt=["case",["!=",["get","revenue"],0],["step",["get","revenue"],we.levels[0],be[1],we.levels[1],be[2],we.levels[2],be[3],we.levels[3],be[4],we.levels[4],be[5],we.levels[5]],"rgba(46, 16, 101, 0.5)"],Mt=()=>e.jsxs("div",{className:"absolute bottom-6 left-6 bg-[#0f0518]/60 backdrop-blur-2xl p-5 rounded-[2rem] border border-purple-500/20 z-10 shadow-[0_0_50px_rgba(0,0,0,0.5)] pointer-events-none min-w-[200px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 border-b border-purple-500/10 pb-3",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-400 animate-pulse"}),e.jsx("h5",{className:"text-[11px] font-black text-purple-300 uppercase tracking-[0.2em]",children:"Data Metrics"})]}),e.jsx("div",{className:"space-y-2.5",children:be.map((s,a)=>{if(a===0)return null;const i=we.levels[a],r=be[a-1],y=a===be.length-1?`$${(s/1e3).toFixed(0)}k+`:`$${(r/1e3).toFixed(1)}k - $${(s/1e3).toFixed(1)}k`;return e.jsxs("div",{className:"flex items-center gap-4 group",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm shadow-[0_0_10px_rgba(255,255,255,0.05)] transition-transform duration-300 group-hover:scale-110",style:{backgroundColor:i,boxShadow:`0 0 15px ${i}33`}}),e.jsx("span",{className:"text-[10px] text-purple-400 font-bold font-mono tracking-tight",children:y})]},a)})}),e.jsxs("div",{className:"mt-5 pt-4 border-t border-purple-500/10 flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-2 rounded-full bg-gradient-to-t from-purple-900 via-purple-500 to-yellow-400 shadow-[0_0_15px_rgba(168,85,247,0.2)]"}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-[10px] text-purple-100 font-black uppercase tracking-wider",children:"3D Density"}),e.jsx("span",{className:"text-[9px] text-purple-500 font-medium",children:"Visual Projection"})]})]})]}),$t=s=>{const a=o.useRef(null),[i,r]=o.useState(!1),[y,g]=o.useState(null);return o.useEffect(()=>{let m=!0,b=null;return(async()=>{if(s.current&&!a.current)try{let v=0;for(;!window.maplibregl&&v<50;)await new Promise(j=>setTimeout(j,100)),v++;if(!m)return;const h=window.maplibregl;if(!h)throw new Error("MapLibre GL library not found.");b=new h.Map({container:s.current,style:{version:8,sources:{osm:{type:"raster",tiles:["https://a.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}@2x.png"],tileSize:256,attribution:"&copy; OpenStreetMap & CartoDB"}},layers:[{id:"background",type:"background",paint:{"background-color":"#020617"}},{id:"osm-layer",type:"raster",source:"osm",paint:{"raster-opacity":.3,"raster-saturation":-1,"raster-contrast":.1}}]},center:[104.916,12.5657],zoom:6.6,pitch:45,bearing:-10,minZoom:5,maxZoom:12}),b.addControl(new h.NavigationControl({showCompass:!0,visualizePitch:!0}),"top-right"),b.on("load",()=>{m&&(a.current=b,r(!0),console.log("Map Engine Ready in 3D Mode"))}),b.on("error",j=>{console.error("Map Internal Error:",j)})}catch(v){console.error("Map Engine Initialization Failed:",v),m&&g(v.message)}})().catch(v=>{console.error("Uncaught Map Engine Error:",v),m&&g("Failed to initialize map engine.")}),()=>{m=!1,b&&(b.remove(),a.current=null)}},[]),{map:a.current,isMapReady:i,mapError:y}},Tt=({data:s})=>{const a=o.useRef(null),i=o.useRef(null),r=o.useRef([]),y=o.useRef(null),g=o.useRef(null),[m,b]=o.useState("revenue"),l=o.useRef(!1),{geoJson:v,loading:h,error:j}=Pt(),{map:L,isMapReady:P,mapError:A}=$t(a),N=o.useMemo(()=>{const u={};return Array.isArray(s)&&s.forEach(n=>{if(!n||!n.name)return;const p=He(n.name);p&&(u[p]?(u[p].revenue+=Number(n.revenue)||0,u[p].orders+=Number(n.orders)||0,u[p].shippingCost=(u[p].shippingCost||0)+(Number(n.shippingCost)||0)):u[p]={...n,shippingCost:Number(n.shippingCost)||0})}),u},[s]),I=o.useMemo(()=>{const u=Object.values(N).sort((p,x)=>{const t=p[m]||0;return(x[m]||0)-t}),n={};return u.forEach((p,x)=>{const t=He(p.name);t&&(n[t]=x+1)}),n},[N,m]),w=()=>{switch(m){case"revenue":return"#fde047";case"orders":return"#d8b4fe";case"shipping":return"#34d399";default:return"#fde047"}},M=()=>{switch(m){case"revenue":return"#facc15";case"orders":return"#c084fc";case"shipping":return"#10b981";default:return"#facc15"}};return o.useEffect(()=>{if(!(!P||!L||!v)){try{const u=window.maplibregl,n=()=>{l.current=!0},p=()=>{l.current=!1};L.on("mousedown",n),L.on("touchstart",n),L.on("dragstart",n),L.on("mouseup",p),L.on("touchend",p),L.on("dragend",p),L.on("zoomstart",n),L.on("zoomend",p),g.current||L.flyTo({center:[104.916,12.7],zoom:7.6,pitch:62,bearing:-15,speed:.5,curve:1.5,essential:!0});const x=f=>{const c=f/3e3,S=Math.sin(c)*1.5,k=Math.cos(c)*1.5;if(L.setLight({anchor:"map",color:w(),intensity:.6+Math.sin(c*2)*.15,position:[S,k,90]}),!l.current){const D=f/15e3,T=-15+Math.sin(D)*3,z=62+Math.cos(D*.7)*2;L.jumpTo({bearing:T,pitch:z})}g.current=requestAnimationFrame(x)};g.current&&cancelAnimationFrame(g.current),g.current=requestAnimationFrame(x),L.setFog&&L.setFog({range:[1,12],color:"#0f0518","horizon-blend":.15,"high-color":m==="shipping"?"#064e3b":"#7e22ce","space-color":"#0f0518","star-intensity":.9});const t=v.features.map(f=>{const c=f.properties||{},S=[c.name_kh,c.Name_KH,c.name_en,c.Name_EN,c.name,c.shapeName];let k=0,D=0,T=0,z=c.name_en||c.shapeName||"Province",U=999;for(const O of S){if(!O)continue;const W=He(String(O));if(N[W]){k=N[W].revenue,D=N[W].orders,T=N[W].shippingCost||0,I[W]&&(U=I[W]),z=O;break}}let E=k;return m==="orders"&&(E=D*50),m==="shipping"&&(E=T*20),{...f,properties:{...c,revenue:E,realRevenue:k,orders:D,shippingCost:T,displayName:z,rank:U}}}),C={type:"FeatureCollection",features:t},d=L.getSource("cambodia-3d-source");d?d.setData(C):(L.addSource("cambodia-3d-source",{type:"geojson",data:C,generateId:!0}),L.addLayer({id:"province-hover-fill",type:"fill",source:"cambodia-3d-source",paint:{"fill-color":M(),"fill-opacity":["case",["boolean",["feature-state","hover"],!1],.5,0]}}),L.addLayer({id:"province-3d",type:"fill-extrusion",source:"cambodia-3d-source",paint:{"fill-extrusion-color":Lt,"fill-extrusion-height":Ue,"fill-extrusion-base":0,"fill-extrusion-opacity":.95,"fill-extrusion-vertical-gradient":!0}}),L.addLayer({id:"province-outlines",type:"line",source:"cambodia-3d-source",paint:{"line-color":w(),"line-width":1,"line-opacity":.4}}),L.addLayer({id:"province-floor-glow",type:"line",source:"cambodia-3d-source",paint:{"line-color":m==="shipping"?"#059669":"#a855f7","line-width":4,"line-opacity":.3,"line-blur":6}},"province-3d"),L.addLayer({id:"province-glass-shell",type:"fill-extrusion",source:"cambodia-3d-source",paint:{"fill-extrusion-color":"#ffffff","fill-extrusion-height":Ue,"fill-extrusion-base":Ue,"fill-extrusion-opacity":.1}}),L.addLayer({id:"province-highlight",type:"fill-extrusion",source:"cambodia-3d-source",paint:{"fill-extrusion-color":"#ffffff","fill-extrusion-height":["+",Ue,2e3],"fill-extrusion-opacity":["case",["boolean",["feature-state","hover"],!1],.9,0]}}),i.current=new u.Popup({closeButton:!1,closeOnClick:!1,className:"custom-map-popup",offset:80,maxWidth:"300px"}),L.on("mousemove","province-3d",f=>{if(f.features.length>0){L.getCanvas().style.cursor="pointer";const c=f.features[0];y.current!==null&&L.setFeatureState({source:"cambodia-3d-source",id:y.current},{hover:!1}),y.current=c.id,L.setFeatureState({source:"cambodia-3d-source",id:c.id},{hover:!0});const{displayName:S,realRevenue:k,orders:D,shippingCost:T}=c.properties;let z=`$${Number(k).toLocaleString()}`,U="REVENUE",E=`${D} UNITS`,O="ORDERS";m==="orders"?(z=`${D}`,U="ORDERS",E=`$${Number(k).toLocaleString()}`,O="REVENUE"):m==="shipping"&&(z=`$${Number(T).toLocaleString()}`,U="SHIPPING",E=`${D} UNITS`,O="ORDERS"),i.current.setLngLat(f.lngLat).setHTML(`
                                <div class="relative overflow-hidden bg-[#0f0518]/90 backdrop-blur-xl rounded-lg border border-purple-500/50 shadow-[0_0_30px_rgba(168,85,247,0.3)] min-w-[200px] group">
                                    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"></div>
                                    <div class="absolute top-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-purple-400 to-transparent"></div>
                                    
                                    <div class="p-4 relative z-10">
                                        <div class="flex items-center justify-between mb-3 pb-2 border-b border-purple-500/30">
                                            <h4 class="font-mono font-bold text-sm text-purple-100 tracking-widest uppercase">${S}</h4>
                                            <div class="w-2 h-2 rounded-full bg-yellow-400 shadow-[0_0_10px_#facc15] animate-pulse"></div>
                                        </div>
                                        
                                        <div class="space-y-3">
                                            <div class="flex justify-between items-end">
                                                <span class="text-purple-300 text-[10px] font-bold uppercase tracking-widest">${U}</span>
                                                <span class="font-mono font-black text-xl text-yellow-300 drop-shadow-[0_0_5px_rgba(253,224,71,0.5)]">${z}</span>
                                            </div>
                                            
                                            <div class="w-full h-1 bg-purple-900/50 rounded-full overflow-hidden">
                                                <div class="h-full bg-gradient-to-r from-purple-600 to-yellow-300 w-[60%] relative">
                                                    <div class="absolute right-0 top-0 bottom-0 w-1 bg-white shadow-[0_0_10px_white]"></div>
                                                </div>
                                            </div>

                                            <div class="flex justify-between items-center">
                                                <span class="text-purple-300 text-[10px] font-bold uppercase tracking-widest">${O}</span>
                                                <div class="flex items-center gap-1.5">
                                                    <span class="text-xs text-purple-200 font-mono">${E}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).addTo(L)}}),L.on("mouseleave","province-3d",()=>{L.getCanvas().style.cursor="",y.current!==null&&L.setFeatureState({source:"cambodia-3d-source",id:y.current},{hover:!1}),y.current=null,i.current.remove()})),L.getLayer("province-outlines")&&L.setPaintProperty("province-outlines","line-color",w()),L.getLayer("province-hover-fill")&&L.setPaintProperty("province-hover-fill","fill-color",M()),r.current.forEach(f=>f.remove()),r.current=[],t.forEach(f=>{const{rank:c,displayName:S,realRevenue:k,orders:D,shippingCost:T}=f.properties;if(c&&c<=3){const z=f.geometry.type==="Polygon"?f.geometry.coordinates[0]:f.geometry.coordinates.flat(1)[0];if(!z)return;const U=new u.LngLatBounds(z[0],z[0]);z.forEach(oe=>U.extend(oe));const E=U.getCenter(),O=document.createElement("div");O.className="province-rank-marker";let W=`$${(k/1e3).toFixed(1)}k`;m==="orders"&&(W=`${D} Orders`),m==="shipping"&&(W=`$${(T/1e3).toFixed(1)}k Ship`),O.innerHTML=`
                        <div class="flex flex-col items-center group cursor-pointer animate-float hover:z-50">
                            <div class="relative transition-transform duration-300 group-hover:scale-110">
                                <div class="absolute -inset-4 bg-purple-600/30 blur-xl rounded-full animate-pulse"></div>
                                <div class="relative bg-[#0f0518]/90 backdrop-blur-xl border border-purple-500/60 rounded-full px-4 py-2 shadow-[0_0_20px_rgba(168,85,247,0.4)] flex items-center gap-3">
                                    <div class="flex flex-col items-center justify-center w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-yellow-400 shadow-inner">
                                        <span class="font-black text-white text-xs leading-none">#${c}</span>
                                    </div>
                                    <div class="flex flex-col">
                                        <span class="text-[10px] text-purple-200 font-bold uppercase tracking-wider leading-tight">${S}</span>
                                        <span class="text-[9px] text-yellow-300 font-mono">${W}</span>
                                    </div>
                                </div>
                            </div>
                            
                            {/* THE POLE / BEAM */}
                            <div class="w-px h-16 bg-gradient-to-b from-purple-500 via-purple-500/50 to-transparent relative">
                                <div class="absolute inset-0 bg-purple-400 blur-[2px] opacity-50"></div>
                            </div>
                            
                            {/* BASE EFFECT ON GROUND */}
                            <div class="w-8 h-8 border border-purple-500/30 rounded-full flex items-center justify-center -mt-2 animate-[spin_8s_linear_infinite]">
                                <div class="w-6 h-6 border border-dashed border-purple-500/50 rounded-full"></div>
                                <div class="absolute w-2 h-2 bg-purple-500 blur-sm rounded-full animate-pulse"></div>
                            </div>
                        </div>
                    `;const q=new u.Marker({element:O,anchor:"bottom",offset:[0,-40]}).setLngLat(E).addTo(L);r.current.push(q)}})}catch(u){console.error("Layer Update Error:",u)}return()=>{g.current&&cancelAnimationFrame(g.current)}}},[P,v,N,I,m]),j||A?e.jsx("div",{className:"w-full h-[500px] flex items-center justify-center bg-gray-900/50 rounded-3xl border border-red-500/20 text-red-400",children:e.jsxs("p",{children:["Map Error: ",j||A]})}):e.jsxs("div",{className:"relative w-full h-[650px] xl:h-[750px] bg-[#0f0518] rounded-[2.5rem] border border-purple-500/20 shadow-[0_0_60px_rgba(88,28,135,0.4)] overflow-hidden group",children:[e.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-10 pointer-events-none",children:e.jsxs("div",{className:"flex items-center gap-4 bg-[#0f0518]/60 backdrop-blur-md px-6 py-2.5 rounded-full border border-purple-500/30 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-500 animate-pulse"}),e.jsx("span",{className:"text-[10px] text-purple-300 font-mono uppercase tracking-widest",children:"Live Geo-Data"})]}),e.jsx("div",{className:"w-px h-3 bg-white/10"}),e.jsxs("h2",{className:"text-sm font-bold text-white tracking-wide uppercase font-sans",children:["Cambodia ",e.jsx("span",{className:"text-yellow-400",children:"Nexus"})]})]})}),e.jsx("div",{className:"absolute bottom-8 right-8 flex flex-col gap-3 z-10",children:e.jsxs("div",{className:"flex flex-col bg-[#0f0518]/80 backdrop-blur-xl border border-purple-500/30 rounded-2xl p-1.5 shadow-2xl",children:[e.jsxs("button",{onClick:()=>b("revenue"),className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all duration-300 flex items-center justify-between gap-3 ${m==="revenue"?"bg-purple-600 text-white shadow-lg":"text-purple-400 hover:bg-purple-900/50"}`,children:[e.jsx("span",{children:"Revenue"}),m==="revenue"&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-400 animate-pulse"})]}),e.jsxs("button",{onClick:()=>b("orders"),className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all duration-300 flex items-center justify-between gap-3 ${m==="orders"?"bg-fuchsia-600 text-white shadow-lg":"text-purple-400 hover:bg-purple-900/50"}`,children:[e.jsx("span",{children:"Orders"}),m==="orders"&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"})]}),e.jsxs("button",{onClick:()=>b("shipping"),className:`px-4 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-all duration-300 flex items-center justify-between gap-3 ${m==="shipping"?"bg-emerald-600 text-white shadow-lg":"text-purple-400 hover:bg-purple-900/50"}`,children:[e.jsx("span",{children:"Shipping"}),m==="shipping"&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-300 animate-pulse"})]})]})}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden z-0 opacity-20",children:[e.jsx("div",{className:"w-full h-[1px] bg-gradient-to-r from-transparent via-purple-400 to-transparent absolute top-0 animate-scan blur-[1px]"}),e.jsx("div",{className:"w-full h-[100px] bg-gradient-to-b from-purple-400/5 to-transparent absolute top-0 animate-scan"})]}),e.jsx("div",{className:"absolute inset-0 pointer-events-none z-0 opacity-10",style:{backgroundImage:`
                    linear-gradient(to right, rgba(168, 85, 247, 0.3) 1px, transparent 1px),
                    linear-gradient(to bottom, rgba(168, 85, 247, 0.3) 1px, transparent 1px)
                `,backgroundSize:"40px 40px",maskImage:"radial-gradient(circle at center, black, transparent 80%)"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[...Array(20)].map((u,n)=>e.jsx("div",{className:"absolute w-0.5 h-0.5 bg-yellow-300 rounded-full animate-float-particle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*5}s`,animationDuration:`${10+Math.random()*10}s`,opacity:Math.random()*.5}},n))}),e.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-purple-900/10 blur-[120px] pointer-events-none rounded-full mix-blend-screen"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[600px] h-[600px] bg-indigo-900/10 blur-[120px] pointer-events-none rounded-full mix-blend-screen"}),e.jsx("div",{ref:a,className:"w-full h-full"}),(!P||h)&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[#0f0518] z-20",children:[e.jsxs("div",{className:"w-20 h-20 border-t-2 border-b-2 border-purple-500 rounded-full animate-spin flex items-center justify-center relative",children:[e.jsx("div",{className:"w-16 h-16 border-l-2 border-r-2 border-yellow-300 rounded-full animate-reverse-spin"}),e.jsx("div",{className:"absolute inset-0 bg-purple-500/10 blur-xl animate-pulse"})]}),e.jsx("p",{className:"mt-6 text-xs font-black text-purple-400 uppercase tracking-[0.3em] animate-pulse",children:"Initializing Neural Link..."})]}),e.jsx(Mt,{}),e.jsx("style",{children:`
                .maplibregl-popup {
                    z-index: 100;
                }
                .maplibregl-popup-content {
                    background: transparent !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    border: none !important;
                }
                .maplibregl-popup-tip { display: none !important; }
                .province-rank-marker { z-index: 5; }
                
                @keyframes float {
                    0%, 100% { transform: translateY(0); }
                    50% { transform: translateY(-8px); }
                }
                .animate-float {
                    animation: float 4s ease-in-out infinite;
                }
                
                @keyframes reverse-spin {
                    from { transform: rotate(360deg); }
                    to { transform: rotate(0deg); }
                }
                .animate-reverse-spin {
                    animation: reverse-spin 3s linear infinite;
                }

                @keyframes float-particle {
                    0% { transform: translateY(0) translateX(0); opacity: 0; }
                    10% { opacity: 0.5; }
                    90% { opacity: 0.5; }
                    100% { transform: translateY(-100px) translateX(20px); opacity: 0; }
                }
                .animate-float-particle {
                    animation: float-particle linear infinite;
                }
                
                @keyframes shimmer {
                    0% { transform: translateX(-100%); }
                    100% { transform: translateX(100%); }
                }
                .animate-shimmer {
                    animation: shimmer 3s infinite;
                }

                @keyframes scan {
                    0% { top: -10%; opacity: 0; }
                    10% { opacity: 1; }
                    90% { opacity: 1; }
                    100% { top: 110%; opacity: 0; }
                }
                .animate-scan {
                    animation: scan 8s linear infinite;
                }
            `})]})},Ot=({stats:s,onProvinceClick:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-black text-slate-100 flex items-center px-1 tracking-tight",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"·ûü·ûÑ·üí·ûÅ·üÅ·ûî·ûè·û∂·ûò·ûÅ·üÅ·ûè·üí·ûè/·ûö·û∂·ûá·ûí·û∂·ûì·û∏"]}),e.jsx("div",{className:"bg-slate-900/80 backdrop-blur-xl rounded-2xl border border-slate-700/50 overflow-hidden shadow-2xl h-[450px] lg:h-[550px] xl:h-[600px]",children:e.jsx("div",{className:"overflow-y-auto h-full custom-scrollbar",children:e.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[e.jsx("thead",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest bg-slate-950/80 border-b border-slate-700/50 sticky top-0 z-20 backdrop-blur-md",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-4",children:"·ûÅ·üÅ·ûè·üí·ûè/·ûö·û∂·ûá·ûí·û∂·ûì·û∏"}),e.jsx("th",{className:"px-5 py-4 text-right",children:"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[s.map((i,r)=>e.jsxs("tr",{className:"hover:bg-indigo-500/10 transition-colors cursor-pointer group",onClick:()=>a==null?void 0:a(i.name),children:[e.jsx("td",{className:"px-5 py-3.5 font-bold text-slate-200 group-hover:text-indigo-300 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-lg text-[10px] font-black flex items-center justify-center border shadow-sm
                                                ${r<3?"bg-gradient-to-br from-indigo-500 to-violet-600 border-indigo-400/50 text-white":"bg-slate-800 border-slate-700 text-slate-500"}`,children:r+1}),e.jsx("span",{className:"truncate max-w-[150px] font-medium tracking-wide",children:i.name})]})}),e.jsxs("td",{className:"px-5 py-3.5 text-right",children:[e.jsxs("span",{className:"text-cyan-400 font-black block group-hover:text-cyan-300 drop-shadow-sm text-base",children:["$",i.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsxs("span",{className:"text-[9px] text-slate-500 uppercase tracking-wider font-semibold group-hover:text-slate-400",children:[i.orders," orders"]})]})]},i.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-6 py-12 text-center text-slate-500 italic",children:"·ûò·û∑·ûì·ûë·û∂·ûì·üã·ûò·û∂·ûì·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô"})})]})]})})})]}),_t=({dateRange:s,onRangeChange:a,customStart:i,onCustomStartChange:r,customEnd:y,onCustomEndChange:g})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx("div",{className:"flex items-center gap-1 bg-gray-800/80 p-1 rounded-xl border border-gray-700 shadow-inner",children:["today","this_week","this_month","custom"].map(m=>e.jsx("button",{onClick:()=>a(m),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${s===m?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:m==="today"?"·ûê·üí·ûÑ·üÉ·ûì·üÅ·üá":m==="this_week"?"·ûü·ûî·üí·ûè·û∂·û†·üç·ûì·üÅ·üá":m==="this_month"?"·ûÅ·üÇ·ûì·üÅ·üá":"·ûÄ·üÜ·ûé·ûè·üã"},m))})}),s==="custom"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-gray-900/40 rounded-2xl border border-gray-800 animate-fade-in-down",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"·ûÖ·û∂·ûî·üã·ûñ·û∏"}),e.jsx("input",{type:"date",value:i,onChange:m=>r(m.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"·ûä·ûõ·üã"}),e.jsx("input",{type:"date",value:y,onChange:m=>g(m.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]})]})]}),At=({stats:s,onStatClick:a})=>{const i=o.useMemo(()=>s.reduce((r,y)=>({revenue:r.revenue+y.revenue,orders:r.orders+y.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-orange-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"·ûÉ·üí·ûõ·û∂·üÜ·ûÑ·ûî·ûâ·üí·ûÖ·üÅ·ûâ·ûë·üÜ·ûì·û∑·ûâ (Stock)"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"·ûà·üí·ûò·üÑ·üá·ûÉ·üí·ûõ·û∂·üÜ·ûÑ (Store)"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"·ûÖ·üÜ·ûì·ûΩ·ûì Orders"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"·ûÖ·üÜ·ûé·ûº·ûõ"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,y)=>e.jsxs("tr",{className:"hover:bg-orange-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",y+1]}),e.jsx("span",{className:"group-hover:text-orange-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"·ûò·û∑·ûì·ûë·û∂·ûì·üã·ûò·û∂·ûì·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"·ûü·ûö·ûª·ûî·ûö·ûΩ·ûò"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:i.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",i.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},It=({currentUser:s,parsedOrders:a,dateFilter:i,setDateFilter:r,teamRevenueStats:y,provinceStats:g,storeStats:m,onTeamClick:b,onProvinceClick:l,onStoreClick:v})=>{const h=P=>new Date(P.Timestamp),j=a.filter(P=>{if(!P.Timestamp)return!1;const A=h(P),N=new Date,I=new Date(N.getFullYear(),N.getMonth(),N.getDate());if(i.preset==="today")return A.toDateString()===N.toDateString();if(i.preset==="this_week"){const w=N.getDay(),M=new Date(I);M.setDate(I.getDate()-(w===0?6:w-1));const u=new Date(M);return u.setDate(M.getDate()+6),u.setHours(23,59,59),A>=M&&A<=u}else{if(i.preset==="this_month")return A.getMonth()===N.getMonth()&&A.getFullYear()===N.getFullYear();if(i.preset==="custom"){const w=i.start?new Date(i.start+"T00:00:00"):null,M=i.end?new Date(i.end+"T23:59:59"):null;return!(w&&A<w||M&&A>M)}}return!0}),L={revenue:j.reduce((P,A)=>P+(Number(A["Grand Total"])||0),0),orders:j.length,unpaid:j.filter(P=>P["Payment Status"]==="Unpaid").length};return e.jsxs("div",{className:"space-y-6 lg:space-y-8 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-800/10 p-5 rounded-[2rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl lg:text-2xl 2xl:text-3xl font-black text-white leading-tight",children:["·ûü·ûΩ·ûü·üí·ûè·û∏, ",s==null?void 0:s.FullName," üëã"]}),e.jsx("p",{className:"text-gray-500 text-xs lg:text-sm font-bold uppercase tracking-widest mt-1.5",children:new Date().toLocaleDateString("km-KH",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsx("div",{className:"w-full md:w-auto",children:e.jsx(_t,{dateRange:i.preset,onRangeChange:P=>r({...i,preset:P}),customStart:i.start,onCustomStartChange:P=>r({...i,start:P}),customEnd:i.end,onCustomEndChange:P=>r({...i,end:P})})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6",children:[e.jsx(ae,{label:"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî",value:`$${L.revenue.toLocaleString(void 0,{minimumFractionDigits:2})}`,icon:"üí∞",colorClass:"from-blue-600 to-blue-400"}),e.jsx(ae,{label:"·ûÖ·üÜ·ûì·ûΩ·ûì·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã",value:L.orders,icon:"üì¶",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(ae,{label:"·ûò·û∑·ûì·ûë·û∂·ûì·üã·ûë·ûº·ûë·û∂·ûè·üã",value:L.unpaid,icon:"‚è≥",colorClass:"from-orange-500 to-yellow-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-6 lg:gap-8",children:[e.jsx("div",{className:"xl:col-span-6",children:e.jsx(St,{stats:y,onStatClick:b})}),e.jsx("div",{className:"xl:col-span-6",children:e.jsx(At,{stats:m,onStatClick:v})}),e.jsx("div",{className:"xl:col-span-8",children:e.jsx(Tt,{data:g})}),e.jsx("div",{className:"xl:col-span-4",children:e.jsx(Ot,{stats:g,onProvinceClick:l})})]})]})},Ye=s=>{const a=s["Grand Total"]||0,i=s["Total Product Cost ($)"]||0,r=s["Internal Cost"]||0;return a-i-r},zt=s=>{try{if(!s)return new Date().toISOString().slice(0,7);const a=new Date(s);return isNaN(a.getTime())?new Date().toISOString().slice(0,7):a.toISOString().slice(0,7)}catch{return new Date().toISOString().slice(0,7)}},Ft=(s,a,i)=>o.useMemo(()=>{const r=Array.isArray(a)?a.filter(w=>w&&w.UserName):[],y=Array.isArray(s)?s.filter(w=>w&&w["Grand Total"]!==void 0):[],g=Array.isArray(i)?i:[],m=y.reduce((w,M)=>w+(M["Grand Total"]||0),0),b=y.reduce((w,M)=>w+Ye(M),0),l=y.length,v=new Date().toISOString().slice(0,7),h=r.map(w=>{const M=y.filter(d=>d.User===w.UserName),u=M.reduce((d,f)=>d+(f["Grand Total"]||0),0),n=M.reduce((d,f)=>d+Ye(f),0),p=M.length,x=g.find(d=>d.UserName===w.UserName&&d.Month===v),t=(x==null?void 0:x.TargetAmount)||0,C=t>0?u/t*100:0;return{userName:w.UserName,fullName:w.FullName,profilePictureURL:w.ProfilePictureURL,team:w.Team,revenue:u,profit:n,orderCount:p,target:t,achievement:C}}),L=Array.from(new Set(r.map(w=>w.Team).filter(Boolean))).map(w=>{const M=h.filter(C=>C.team===w),u=M.reduce((C,d)=>C+d.revenue,0),n=M.reduce((C,d)=>C+d.profit,0),p=M.reduce((C,d)=>C+d.orderCount,0),x=M.reduce((C,d)=>C+d.target,0),t=x>0?u/x*100:0;return{teamName:w,revenue:u,profit:n,orderCount:p,target:x,achievement:t}}),P=L.reduce((w,M)=>w+M.target,0),A=P>0?m/P*100:0,N={};y.forEach(w=>{const M=zt(w.Timestamp);N[M]||(N[M]={revenue:0,profit:0,orders:0}),N[M].revenue+=w["Grand Total"]||0,N[M].profit+=Ye(w),N[M].orders+=1});const I=Object.entries(N).sort(([w],[M])=>w.localeCompare(M)).map(([w,M])=>({label:w,value:M.revenue,...M}));return{summary:{totalRevenue:m,totalProfit:b,totalOrders:l,overallTarget:P,overallAchievement:A},byUser:h,byTeam:L,monthlyTrend:I,hasData:r.length>0}},[s,a,i]),Et=({value:s,label:a})=>{const i=Math.max(0,s),r=Math.min(i/100,1),y=80,g=14,m=y-g/2,l=2*Math.PI*m*.75,v=l*(1-r),j=i<50?"#ef4444":i<90?"#f59e0b":"#10b981";return e.jsx("div",{className:"relative flex items-center justify-center w-full max-w-[280px] mx-auto h-[220px]",children:e.jsxs("svg",{viewBox:"0 0 200 160",className:"w-full h-full transform transition-all duration-700",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gaugeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),e.jsx("stop",{offset:"50%",stopColor:"#f59e0b"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981"})]}),e.jsxs("filter",{id:"gaugeGlow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"4",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})]}),e.jsx("path",{d:`M 35 130 A ${m} ${m} 0 1 1 165 130`,fill:"none",stroke:"#1f2937",strokeWidth:g,strokeLinecap:"round",className:"opacity-40"}),e.jsx("path",{d:`M 35 130 A ${m} ${m} 0 1 1 165 130`,fill:"none",stroke:j,strokeWidth:g,strokeLinecap:"round",strokeDasharray:l,strokeDashoffset:v,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)",filter:i>0?"url(#gaugeGlow)":"none"}}),e.jsxs("g",{className:"text-center select-none",children:[e.jsx("text",{x:"100",y:"95",textAnchor:"middle",className:"text-5xl font-black fill-white tracking-tighter",children:`${Math.round(i)}%`}),a&&e.jsx("text",{x:"100",y:"122",textAnchor:"middle",className:"text-[8px] font-black uppercase tracking-[0.2em] fill-gray-500",children:a})]})]})})},rt=({data:s,title:a})=>{const[i,r]=o.useState(null);if(!s||s.length===0)return e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 min-h-[300px]",children:"No data available for chart."});const y=300,g=500,l={top:20,right:20,bottom:40,left:50},v=Math.max(...s.map(w=>w.value),0),h=v===0?0:(y-l.top-l.bottom)/v,j=(g-l.left-l.right)/(s.length-1||1),L=()=>{if(s.length<2)return"";let w=`M ${l.left},${y-l.bottom-s[0].value*h}`;return s.slice(1).forEach((M,u)=>{const n=l.left+(u+1)*j,p=y-l.bottom-M.value*h;w+=` L ${n},${p}`}),w},P=(w,M)=>{const u=w.currentTarget.getBoundingClientRect(),n=`${M.label}: $${M.value.toLocaleString(void 0,{maximumFractionDigits:2})}`;r({visible:!0,x:u.left+window.scrollX,y:u.top+window.scrollY,content:n})},A=()=>{r(null)},I=(w=>{if(w===0)return[0];const M=5,u=Math.ceil(w/M/10)*10;return u===0?[0,w]:Array.from({length:M+1},(n,p)=>p*u).filter(n=>n<=w*1.1)})(v);return e.jsxs("div",{className:"relative",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-white text-center",children:a}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("svg",{viewBox:`0 0 ${g} ${y}`,className:"min-w-[500px]",preserveAspectRatio:"xMinYMin meet",children:[e.jsx("g",{className:"y-axis",children:I.map(w=>e.jsxs("g",{transform:`translate(0, ${y-l.bottom-w*h})`,children:[e.jsx("line",{x1:l.left-5,y1:"0",x2:g-l.right,y2:"0",stroke:"#374151"}),e.jsx("text",{x:l.left-10,y:"3",textAnchor:"end",fill:"#9ca3af",fontSize:"12",children:w>=1e3?`${(w/1e3).toFixed(0)}k`:w})]},w))}),e.jsx("g",{className:"x-axis",children:s.map((w,M)=>e.jsx("text",{x:l.left+M*j,y:y-l.bottom+20,textAnchor:"middle",fill:"#9ca3af",fontSize:"12",children:w.label},M))}),e.jsx("path",{d:L(),fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),s.map((w,M)=>e.jsx("circle",{cx:l.left+M*j,cy:y-l.bottom-w.value*h,r:"4",fill:"#3b82f6",stroke:"#111827",strokeWidth:"2",onMouseOver:u=>P(u,w),onMouseOut:A,className:"cursor-pointer"},M))]})}),i&&e.jsx("div",{className:"fixed p-2 text-xs text-white bg-gray-900 border border-gray-600 rounded-md shadow-lg z-50",style:{left:i.x,top:i.y-35,pointerEvents:"none",transform:"translateX(-50%)"},children:i.content})]})},Rt=({summary:s,monthlyTrend:a})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 animate-fade-in",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ae,{label:"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî (Revenue)",value:`$${s.totalRevenue.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"})}),colorClass:"from-blue-600 to-blue-400"}),e.jsx(ae,{label:"·ûî·üí·ûö·û∂·ûÄ·üã·ûÖ·üÜ·ûé·üÅ·ûâ (Profit)",value:`$${s.totalProfit.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),colorClass:"from-emerald-600 to-green-400"}),e.jsx(ae,{label:"·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã·ûü·ûö·ûª·ûî (Orders)",value:s.totalOrders,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),colorClass:"from-purple-600 to-pink-400"}),e.jsx(ae,{label:"·ûÇ·üÑ·ûõ·ûä·üÖ·ûü·ûö·ûª·ûî (Overall Target)",value:s.overallTarget>0?`$${s.overallTarget.toLocaleString()}`:"N/A",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),colorClass:"from-orange-500 to-yellow-400"})]}),e.jsx("div",{className:"glass-card p-6 rounded-2xl shadow-xl border border-gray-700/50",children:e.jsx(rt,{data:a,title:"·ûì·û∑·ûì·üí·ûì·û∂·ûÄ·û∂·ûö·ûÖ·üÜ·ûé·ûº·ûõ (Revenue Trend)"})})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"glass-card p-8 rounded-2xl shadow-xl flex flex-col items-center justify-center h-full min-h-[400px]",children:[e.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em] mb-8",children:"·ûú·ûå·üí·ûç·ûì·ûó·û∂·ûñ·ûÇ·üÑ·ûõ·ûä·üÖ·ûö·ûΩ·ûò"}),e.jsx(Et,{value:s.overallAchievement,label:"Overall Achievement"}),e.jsx("div",{className:"mt-10 grid grid-cols-1 gap-4 w-full",children:e.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase mb-1",children:"·ûì·üÖ·ûÅ·üí·ûú·üá (To Target)"}),e.jsxs("p",{className:"text-2xl font-black text-white",children:["$",Math.max(0,s.overallTarget-s.totalRevenue).toLocaleString()]})]})})]})})]}),et=({rank:s})=>{const a={1:{emoji:"ü•á",bg:"bg-yellow-500/20",border:"border-yellow-500/50",text:"text-yellow-500",glow:"shadow-[0_0_15px_rgba(234,179,8,0.4)]"},2:{emoji:"ü•à",bg:"bg-gray-300/20",border:"border-gray-300/50",text:"text-gray-300",glow:"shadow-[0_0_15px_rgba(209,213,219,0.3)]"},3:{emoji:"ü•â",bg:"bg-orange-600/20",border:"border-orange-600/50",text:"text-orange-600",glow:"shadow-[0_0_15px_rgba(234,88,12,0.3)]"}}[s];return a?e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${a.bg} ${a.border} ${a.text} ${a.glow} border-2 animate-bounce-slow`,children:e.jsx("span",{className:"text-xl",children:a.emoji})}):e.jsxs("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-gray-800 border border-gray-700 text-gray-500 font-black text-sm italic",children:["#",s]})},Ut=({data:s,metric:a,onMetricChange:i,datePreset:r,previewImage:y})=>{const g=b=>b>=100?"text-emerald-400":b>=70?"text-yellow-400":"text-red-400",m=b=>b>=100?"bg-emerald-500":b>=70?"bg-yellow-500":"bg-red-500";return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white tracking-tight",children:"·ûè·û∂·ûö·û∂·ûÑ·ûÖ·üÜ·ûé·û∂·ûè·üã·ûê·üí·ûì·û∂·ûÄ·üã·û¢·üí·ûì·ûÄ·ûõ·ûÄ·üã·ûÜ·üí·ûì·ûæ·ûò"}),e.jsxs("p",{className:"text-gray-500 text-xs mt-1 uppercase tracking-wider font-bold",children:["·ûï·üí·û¢·üÇ·ûÄ·ûõ·ûæ: ",r.replace("_"," ")]})]}),e.jsx("div",{className:"flex bg-gray-900/50 p-1 rounded-xl border border-gray-800",children:["revenue","orderCount","achievement"].map(b=>e.jsx("button",{onClick:()=>i(b),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${a===b?"bg-gray-700 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:b==="revenue"?"·ûÖ·üÜ·ûé·ûº·ûõ":b==="orderCount"?"·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã":"% ·ûü·ûò·üí·ûö·üÅ·ûÖ"},b))})]}),e.jsxs("div",{className:"glass-card rounded-3xl shadow-2xl overflow-hidden border border-gray-700/50",children:[e.jsx("div",{className:"block md:hidden divide-y divide-gray-800",children:s.map((b,l)=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(et,{rank:l+1}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ie,{avatarUrl:b.profilePictureURL,name:b.fullName,size:"sm",className:"ring-2 ring-blue-500/20"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white leading-none",children:b.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1 font-bold",children:b.team})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-black text-blue-400",children:["$",b.revenue.toLocaleString()]}),e.jsxs("p",{className:`text-[10px] font-bold ${g(b.achievement)}`,children:[b.achievement.toFixed(1),"%"]})]})]},b.userName))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-800",children:[e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center w-24",children:"Rank"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"·û¢·üí·ûì·ûÄ·ûõ·ûÄ·üã"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center",children:"·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"·ûÄ·û∂·ûö·ûü·ûò·üí·ûö·üÅ·ûÖ·ûÇ·üÑ·ûõ·ûä·üÖ (%)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800/50",children:s.map((b,l)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-all group",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(et,{rank:l+1})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ie,{avatarUrl:b.profilePictureURL,name:b.fullName,size:"md",className:"border border-gray-700 shadow-md group-hover:scale-110 transition-transform",onClick:()=>y(pe(b.profilePictureURL))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white group-hover:text-blue-300 transition-colors",children:b.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black tracking-tighter",children:b.team})]})]})}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-blue-400 font-black text-lg",children:["$",b.revenue.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-center font-black text-gray-300",children:b.orderCount}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`text-xs font-black mb-1.5 ${g(b.achievement)}`,children:[b.achievement.toFixed(1),"%"]}),e.jsx("div",{className:"w-32 h-1.5 bg-gray-800 rounded-full overflow-hidden border border-gray-700 shadow-inner",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out progress-glow ${m(b.achievement)}`,style:{width:`${Math.min(b.achievement,100)}%`}})})]})})]},b.userName))})]})})]})]})},Bt=({data:s})=>{const a=r=>r>=100?"text-emerald-400":r>=70?"text-yellow-400":"text-red-400",i=r=>r>=100?"bg-emerald-500":r>=70?"bg-yellow-500":"bg-red-500";return e.jsx("div",{className:"animate-fade-in grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:s.map(r=>e.jsxs("div",{className:"glass-card p-6 rounded-3xl shadow-xl hover:border-blue-500/50 transition-all group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ie,{avatarUrl:r.profilePictureURL,name:r.fullName,size:"md",className:"ring-4 ring-blue-500/10 group-hover:ring-blue-500/20 transition-all"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black leading-none mb-1 group-hover:text-blue-300 transition-colors",children:r.fullName}),e.jsx("span",{className:"text-[9px] bg-blue-900/40 text-blue-300 px-2.5 py-0.5 rounded-full font-black uppercase tracking-wider border border-blue-500/20",children:r.team||"No Team"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest mb-1",children:"·ûÇ·üÑ·ûõ·ûä·üÖ·ûÅ·üÇ·ûì·üÅ·üá"}),e.jsxs("p",{className:"text-blue-400 font-black text-lg tracking-tight",children:["$",r.target.toLocaleString()]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"·ûú·ûå·üí·ûç·ûì·ûó·û∂·ûñ·ûü·ûò·üí·ûö·üÅ·ûÖ·ûî·û∂·ûì"}),e.jsxs("span",{className:`text-sm font-black ${a(r.achievement)}`,children:[r.achievement.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full h-3.5 bg-gray-900 rounded-full overflow-hidden border border-gray-800 shadow-inner p-0.5",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out shadow-[0_0_8px_rgba(0,0,0,0.5)] ${i(r.achievement)}`,style:{width:`${Math.min(r.achievement,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-800/50",children:[e.jsxs("div",{className:"bg-gray-900/30 p-3 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"·ûõ·ûÄ·üã·ûî·û∂·ûì"}),e.jsxs("p",{className:"text-white font-black",children:["$",r.revenue.toLocaleString()]})]}),e.jsxs("div",{className:`p-3 rounded-xl border ${r.achievement>=100?"bg-emerald-900/10 border-emerald-900/30":"bg-red-900/10 border-red-900/30"}`,children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"·ûì·üÖ·ûü·ûõ·üã"}),e.jsx("p",{className:`font-black ${r.achievement>=100?"text-emerald-400":"text-red-400"}`,children:r.achievement>=100?"SUCCESS üèÜ":`$${Math.max(0,r.target-r.revenue).toLocaleString()}`})]})]})]})]},r.userName))})},Wt=({orders:s,users:a,targets:i})=>{const{previewImage:r,setMobilePageTitle:y}=o.useContext(le),[g,m]=o.useState("overview"),[b,l]=o.useState({datePreset:"this_month",team:"",store:""}),[v,h]=o.useState("revenue");o.useEffect(()=>(y("PERFORMANCE"),()=>y(null)),[y]);const j=o.useMemo(()=>{const n=new Set;return s.forEach(p=>{p["Fulfillment Store"]&&n.add(p["Fulfillment Store"])}),Array.from(n).sort()},[s]),L=o.useMemo(()=>{const n=new Set;return s.forEach(p=>{p.Team&&n.add(p.Team)}),Array.from(n).sort()},[s]),P=o.useMemo(()=>{const n=new Date;let p=null,x=new Date;switch(b.datePreset){case"this_month":p=new Date(n.getFullYear(),n.getMonth(),1);break;case"last_month":p=new Date(n.getFullYear(),n.getMonth()-1,1),x=new Date(n.getFullYear(),n.getMonth(),0,23,59,59);break;case"quarter":const t=Math.floor(n.getMonth()/3);p=new Date(n.getFullYear(),t*3,1);break;case"year":p=new Date(n.getFullYear(),0,1);break;case"all":p=null,x=null;break}return s.filter(t=>{if(!t.Timestamp)return!1;const C=new Date(t.Timestamp),d=(!p||C>=p)&&(!x||C<=x),f=!b.team||t.Team===b.team,c=!b.store||t["Fulfillment Store"]===b.store;return d&&f&&c})},[s,b]),A=Ft(P,a,i),N=o.useMemo(()=>A?[...A.byUser].sort((n,p)=>p[v]-n[v]):[],[A,v]);if(!A.hasData&&a.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500 page-card",children:[e.jsx("svg",{className:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.jsx("p",{className:"text-lg font-bold",children:"·ûö·ûÄ·ûò·û∑·ûì·ûÉ·ûæ·ûâ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·û¢·üí·ûì·ûÄ·ûî·üí·ûö·ûæ·ûî·üí·ûö·û∂·ûü·üã"}),e.jsx("p",{className:"text-sm",children:"·ûü·ûº·ûò·ûî·üí·ûö·û∂·ûÄ·ûä·ûê·û∂·û¢·üí·ûì·ûÄ·ûî·û∂·ûì·ûî·ûÑ·üí·ûÄ·ûæ·ûè·ûÇ·ûé·ûì·û∏·û¢·üí·ûì·ûÄ·ûõ·ûÄ·üã·ûÄ·üí·ûì·ûª·ûÑ·ûî·üí·ûö·ûñ·üê·ûì·üí·ûí·üî"})]});const{summary:I,byUser:w,monthlyTrend:M}=A,u=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center bg-gray-800/20 border-2 border-dashed border-gray-700 rounded-3xl animate-fade-in",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"·ûò·û∑·ûì·ûë·û∂·ûì·üã·ûò·û∂·ûì·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûü·ûò·üí·ûö·û∂·ûî·üã·ûá·ûò·üí·ûö·ûæ·ûü·ûì·üÅ·üá"}),e.jsx("p",{className:"text-gray-400 max-w-xs mx-auto mb-6 text-sm",children:'·ûü·ûº·ûò·ûü·û∂·ûÄ·ûõ·üí·ûî·ûÑ·ûî·üí·ûè·ûº·ûö "·ûÄ·û∂·ûõ·ûî·ûö·û∑·ûÖ·üí·ûÜ·üÅ·ûë" ·û¨ "·ûÄ·üí·ûö·ûª·ûò/Store" ·ûä·ûæ·ûò·üí·ûî·û∏·ûò·ûæ·ûõ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûï·üí·ûü·üÅ·ûÑ·ûë·üÄ·ûè·üî'}),e.jsx("button",{onClick:()=>l({...b,datePreset:"all",team:"",store:""}),className:"btn btn-secondary text-xs",children:"·ûî·ûÑ·üí·û†·û∂·ûâ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûë·û∂·üÜ·ûÑ·û¢·ûü·üã (All Time)"})]});return e.jsxs("div",{className:"space-y-6 animate-fade-in px-2 sm:px-0 pb-12",children:[e.jsx("style",{children:`
                @keyframes bounce-slow { 0%, 100% { transform: translateY(-5%); } 50% { transform: translateY(0); } }
                .animate-bounce-slow { animation: bounce-slow 3s infinite ease-in-out; }
                .glass-card { background: rgba(31, 41, 55, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(75, 85, 99, 0.3); }
                .progress-glow { filter: drop-shadow(0 0 4px currentColor); }
            `}),e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsx("div",{className:"flex bg-gray-800/80 p-1.5 rounded-2xl border border-gray-700 backdrop-blur-md shadow-inner",children:["overview","leaderboard","targets"].map(n=>e.jsx("button",{onClick:()=>m(n),className:`px-5 py-2.5 text-xs font-black rounded-xl transition-all duration-300 ${g===n?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:n==="overview"?"·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûü·ûÑ·üí·ûÅ·üÅ·ûî":n==="leaderboard"?"·ûÖ·üÜ·ûé·û∂·ûè·üã·ûê·üí·ûì·û∂·ûÄ·üã":"·ûÇ·üÑ·ûõ·ûä·üÖ"},n))}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full lg:w-auto",children:[e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"·ûÄ·û∂·ûõ·ûî·ûö·û∑·ûÖ·üí·ûÜ·üÅ·ûë:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-blue-400 cursor-pointer w-full sm:w-auto",value:b.datePreset,onChange:n=>l({...b,datePreset:n.target.value}),children:[e.jsx("option",{value:"this_month",children:"·ûÅ·üÇ·ûì·üÅ·üá"}),e.jsx("option",{value:"last_month",children:"·ûÅ·üÇ·ûò·ûª·ûì"}),e.jsx("option",{value:"quarter",children:"·ûè·üí·ûö·û∏·ûò·û∂·ûü·ûì·üÅ·üá"}),e.jsx("option",{value:"year",children:"·ûÜ·üí·ûì·û∂·üÜ·ûì·üÅ·üá"}),e.jsx("option",{value:"all",children:"·ûë·û∂·üÜ·ûÑ·û¢·ûü·üã"})]})]}),e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"Store:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-emerald-400 cursor-pointer w-full sm:w-auto",value:b.store,onChange:n=>l({...b,store:n.target.value}),children:[e.jsx("option",{value:"",children:"All Stores"}),j.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"Team:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-purple-400 cursor-pointer w-full sm:w-auto",value:b.team,onChange:n=>l({...b,team:n.target.value}),children:[e.jsx("option",{value:"",children:"All Teams"}),L.map(n=>e.jsx("option",{value:n,children:n},n))]})]})]})]}),g==="overview"&&(I.totalRevenue===0?e.jsx(u,{}):e.jsx(Rt,{summary:I,monthlyTrend:M})),g==="leaderboard"&&e.jsx(Ut,{data:N,metric:v,onMetricChange:h,datePreset:b.datePreset,previewImage:r}),g==="targets"&&(w.length===0?e.jsx("div",{className:"col-span-full py-12 text-center text-gray-500",children:"·ûò·û∑·ûì·ûò·û∂·ûì·ûñ·üê·ûè·üå·ûò·û∂·ûì·ûÇ·üÑ·ûõ·ûä·üÖ·û¢·üí·ûì·ûÄ·ûõ·ûÄ·üã·ûü·ûò·üí·ûö·û∂·ûî·üã·ûá·ûò·üí·ûö·ûæ·ûü·ûì·üÅ·üá"}):e.jsx(Bt,{data:w}))]})},_e=({orders:s,reportType:a,dateFilter:i,startDate:r,endDate:y,onNavigate:g,contextFilters:m})=>{const{appData:b}=o.useContext(le),[l,v]=o.useState(""),[h,j]=o.useState(!1);if(a==="shipping")return e.jsx(dt,{orders:s,appData:b,dateFilter:i,startDate:r,endDate:y,onNavigate:g,contextFilters:m});const L=o.useMemo(()=>{const A=s.reduce((u,n)=>u+(Number(n["Grand Total"])||0),0),N=s.reduce((u,n)=>u+(Number(n["Total Product Cost ($)"])||0),0),I=s.reduce((u,n)=>u+(Number(n["Internal Cost"])||0),0),w=A-N-I,M=A>0?w/A*100:0;return{revenue:A,totalOrders:s.length,totalProfit:w,margin:M,shippingCost:I}},[s]),P=async()=>{j(!0);try{const N=await ut(L,{reportType:a});v(N)}catch{v("AI Analysis error.")}finally{j(!1)}};return e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ae,{label:"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî",value:`$${L.revenue.toLocaleString()}`,icon:"üí∞",colorClass:"from-blue-600 to-blue-400"}),e.jsx(ae,{label:"·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã",value:L.totalOrders,icon:"üì¶",colorClass:"from-indigo-600 to-indigo-400"}),e.jsx(ae,{label:"·ûî·üí·ûö·û∂·ûÄ·üã·ûÖ·üÜ·ûé·üÅ·ûâ",value:`$${L.totalProfit.toLocaleString()}`,icon:"üìà",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(ae,{label:"Margin (%)",value:`${L.margin.toFixed(1)}%`,icon:"‚öñÔ∏è",colorClass:"from-amber-500 to-orange-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-8 bg-gray-900/40 border-white/5 h-full min-h-[400px]",children:e.jsx(rt,{data:[],title:"·ûì·û∑·ûì·üí·ûì·û∂·ûÄ·û∂·ûö·ûÖ·üÜ·ûé·ûº·ûõ (Revenue Over Time)"})})}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"page-card !p-8 bg-gray-900/40 border-white/5 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h3",{className:"text-sm font-black text-white uppercase tracking-widest",children:"AI Insights"}),e.jsx(xt,{onClick:P,isLoading:h,children:"Analyze"})]}),e.jsx("div",{className:"flex-grow bg-black/40 rounded-3xl p-6 border border-white/5 overflow-y-auto",children:l?e.jsx("div",{className:"text-sm text-gray-300",children:l}):e.jsx("p",{className:"text-[10px] opacity-20 text-center uppercase font-black",children:"Ready for Analysis"})})]})})]})]})},Ce=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Vt=({orders:s,onBack:a})=>{const{appData:i}=o.useContext(le),[r,y]=o.useState(!0),[g,m]=o.useState(!1),[b,l]=o.useState(!0),[v,h]=o.useState("revenue"),[j,L]=o.useState({key:"revenue",direction:"desc"}),[P,A]=o.useState(!1),N=x=>{L(t=>({key:x,direction:t.key===x&&t.direction==="desc"?"asc":"desc"}))},I=o.useMemo(()=>{const x={};return s.forEach(t=>{var c,S,k;let C=t.Team||t.User&&((k=(S=(c=i.users)==null?void 0:c.find(D=>D.UserName===t.User))==null?void 0:S.Team)==null?void 0:k.split(",")[0].trim())||"Unassigned";x[C]||(x[C]={name:C,revenue:0,profit:0,orders:0,members:new Set},Ce.forEach(D=>{x[C][`rev_${D}`]=0,x[C][`prof_${D}`]=0}));const d=Number(t["Grand Total"])||0,f=(Number(t["Total Product Cost ($)"])||0)+(Number(t["Internal Cost"])||0);if(x[C].revenue+=d,x[C].profit+=d-f,x[C].orders+=1,t.User&&x[C].members.add(t.User),t.Timestamp){const D=new Date(t.Timestamp),T=Ce[D.getMonth()];x[C][`rev_${T}`]+=d,x[C][`prof_${T}`]+=d-f}}),Object.values(x).sort((t,C)=>{const d=j.direction==="asc"?1:-1,f=t[j.key],c=C[j.key];return typeof f=="string"?f.localeCompare(c)*d:(f-c)*d})},[s,j,i.users]),w=o.useMemo(()=>{const x={revenue:0,profit:0,orders:0};return Ce.forEach(t=>{x[`rev_${t}`]=0,x[`prof_${t}`]=0}),I.forEach(t=>{x.revenue+=t.revenue,x.profit+=t.profit,x.orders+=t.orders,Ce.forEach(C=>{x[`rev_${C}`]+=t[`rev_${C}`],x[`prof_${C}`]+=t[`prof_${C}`]})}),x},[I]),M=()=>{A(!0),setTimeout(()=>{try{const x=new We({orientation:"landscape"}),t=x.internal.pageSize.width;x.setFontSize(18),x.text("Sales Report by Team",t/2,15,{align:"center"}),x.save(`Team_Sales_Report_${Date.now()}.pdf`)}catch(x){console.error(x)}finally{A(!1)}},100)},u=o.useMemo(()=>I.slice(0,10).map(x=>({label:x.name,value:x.revenue})),[I]),n=(x,t)=>{const d=[{key:"index",label:"#"},{key:"teamName",label:"·ûà·üí·ûò·üÑ·üá·ûÄ·üí·ûö·ûª·ûò (Team)",sortable:!0,sortKey:"name"},{key:`total${x}`,label:`·ûü·ûö·ûª·ûî (${x})`,sortable:!0,sortKey:x.toLowerCase()},...Ce.map(f=>({key:`${t}_${f}`,label:f}))];return e.jsxs("div",{className:"hidden md:flex page-card flex-col mb-8 !p-6 border-gray-700/50 shadow-xl overflow-hidden bg-gray-900/40",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:`text-xl font-black flex items-center gap-2 ${x==="Revenue"?"text-blue-300":"text-green-400"}`,children:[e.jsx("span",{className:`w-2 h-6 rounded-full ${x==="Revenue"?"bg-blue-600":"bg-green-600"}`}),"·ûè·û∂·ûö·û∂·ûÑ",x==="Revenue"?"·ûÖ·üÜ·ûé·ûº·ûõ":"·ûî·üí·ûö·û∂·ûÄ·üã·ûÖ·üÜ·ûé·üÅ·ûâ","·ûè·û∂·ûò·ûÄ·üí·ûö·ûª·ûò"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x==="Revenue"&&e.jsxs("button",{onClick:M,disabled:P,className:"btn !py-1 !px-4 text-[10px] font-black bg-red-600/20 border border-red-500/30 text-red-400 hover:bg-red-600 hover:text-white transition-all flex items-center gap-2",children:[P?e.jsx(se,{size:"sm"}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"EXPORT PDF"]}),e.jsx("button",{onClick:()=>l(!b),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${b?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"COLOR"}),e.jsx("button",{onClick:()=>m(!g),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${g?"bg-blue-600 border-blue-500 text-white shadow-lg":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"FREEZE"}),e.jsx("button",{onClick:()=>y(!r),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${r?"bg-gray-700 border-gray-600 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"BORDER"})]})]}),e.jsx("div",{className:`overflow-x-auto custom-scrollbar pb-2 ${r?"border-2 border-white/10 rounded-2xl shadow-[0_0_30px_rgba(0,0,0,0.5)]":""}`,children:e.jsxs("table",{className:`report-table w-full border-separate border-spacing-0 text-sm ${r?"border-collapse":""}`,children:[e.jsx("thead",{className:"bg-[#0f172a] backdrop-blur-md",children:e.jsx("tr",{className:"border-b-2 border-white/20",children:d.map(f=>{let c="",S={};g&&(f.key==="index"?(c="sticky left-0 z-30 bg-[#0f172a]",S={width:"45px",minWidth:"45px"}):f.key==="teamName"?(c="sticky left-[45px] z-30 bg-[#0f172a] border-r border-white/10 shadow-md",S={width:"140px",minWidth:"140px"}):f.key.includes("total")&&(c="sticky left-[185px] z-30 bg-[#0f172a] border-r border-white/10 shadow-lg",S={width:"100px",minWidth:"100px"}));const k=f.key.includes("total")?x==="Revenue"?"bg-blue-900/80":"bg-green-900/80":"";return e.jsx("th",{onClick:()=>f.sortable&&N(f.sortKey),className:`px-4 py-5 whitespace-nowrap text-left font-black uppercase tracking-wider border-b-2 border-white/20 ${r?"border-x border-white/5":""} ${c} ${k} ${f.sortable?"cursor-pointer hover:bg-gray-700":""}`,style:S,children:e.jsxs("div",{className:"flex items-center gap-1",children:[f.label," ",f.sortable&&j.key===f.sortKey&&e.jsx("span",{children:j.direction==="asc"?"‚Üë":"‚Üì"})]})},f.key)})})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:I.map((f,c)=>{const S=Array.from(String(f.name)).reduce((T,z)=>T+z.charCodeAt(0),0)%5,D=b?["bg-blue-500/5","bg-purple-500/5","bg-emerald-500/5","bg-orange-500/5","bg-pink-500/5"][S]:"hover:bg-blue-500/5";return e.jsx("tr",{className:`${D} transition-colors group border-b border-white/5`,children:d.map(T=>{const z=`px-4 py-4 lg:py-5 whitespace-nowrap border-white/5 ${r?"border-x border-white/5":""}`;let U="",E={};if(g&&(T.key==="index"?(U="sticky left-0 z-10 bg-[#020617]",E={width:"45px",minWidth:"45px"}):T.key==="teamName"?(U="sticky left-[45px] z-10 bg-[#020617] border-r border-white/5 shadow-md",E={width:"140px",minWidth:"140px"}):T.key.includes("total")&&(U="sticky left-[185px] z-10 bg-[#020617] border-r border-white/5 shadow-lg",E={width:"100px",minWidth:"100px"})),T.key==="index")return e.jsx("td",{className:`${z} text-center font-bold text-gray-500 ${U}`,style:E,children:c+1},T.key);if(T.key==="teamName")return e.jsx("td",{className:`${z} font-black text-white ${U}`,style:E,children:f.name},T.key);if(T.key.includes("total"))return e.jsxs("td",{className:`${z} text-right font-black ${U} ${x==="Revenue"?"text-blue-200 bg-blue-600/10":"text-green-200 bg-green-600/10"}`,style:E,children:["$",(x==="Revenue"?f.revenue:f.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},T.key);if(T.key.startsWith(t)){const O=f[T.key]||0,W=x==="Profit"?O>0?"text-green-400":O<0?"text-red-400":"text-gray-500":O>0?"text-blue-300":"text-gray-500";return e.jsx("td",{className:`${z} text-right font-bold font-mono ${W}`,children:O!==0?`$${O.toLocaleString(void 0,{minimumFractionDigits:2})}`:"-"},T.key)}return e.jsx("td",{className:z,children:"-"},T.key)})},f.name)})}),e.jsx("tfoot",{className:"bg-[#0f172a] font-black border-t-2 border-white/20",children:e.jsx("tr",{className:"border-t-2 border-white/20",children:d.map((f,c)=>{const S=`px-4 py-5 whitespace-nowrap border-t-2 border-white/20 ${r?"border-x border-white/5":""}`;let k="",D={};return g&&(f.key==="index"?(k="sticky left-0 z-30 bg-[#0f172a]",D={width:"45px",minWidth:"45px"}):f.key==="teamName"?(k="sticky left-[45px] z-30 bg-[#0f172a] shadow-md",D={width:"140px",minWidth:"140px"}):f.key.includes("total")&&(k="sticky left-[185px] z-30 bg-[#0f172a] shadow-lg",D={width:"100px",minWidth:"100px"})),c===0?e.jsx("td",{className:`${S} uppercase tracking-widest text-white font-black ${k}`,style:D,colSpan:2,children:"·ûü·ûö·ûª·ûî·ûö·ûΩ·ûò (GRAND TOTAL)"},f.key):f.key==="teamName"?null:f.key.includes("total")?e.jsxs("td",{className:`${S} text-right ${k} ${x==="Revenue"?"text-blue-400 bg-blue-600/10":"text-green-400 bg-green-600/10"}`,style:D,children:["$",(x==="Revenue"?w.revenue:w.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},f.key):f.key.startsWith(t)?e.jsxs("td",{className:`${S} text-right text-gray-300 font-mono`,children:["$",w[f.key].toLocaleString(void 0,{minimumFractionDigits:2})]},f.key):e.jsx("td",{className:S},f.key)})})})]})})]})},p=()=>e.jsxs("div",{className:"md:hidden space-y-6 pb-12 px-1",children:[e.jsxs("div",{className:"flex bg-gray-900/60 p-1 rounded-2xl border border-white/10 shadow-inner",children:[e.jsx("button",{onClick:()=>h("revenue"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${v==="revenue"?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-gray-500"}`,children:"·ûÖ·üÜ·ûé·ûº·ûõ (Revenue)"}),e.jsx("button",{onClick:()=>h("profit"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${v==="profit"?"bg-emerald-600 text-white shadow-lg shadow-emerald-600/20":"text-gray-500"}`,children:"·ûÖ·üÜ·ûé·üÅ·ûâ (Profit)"})]}),e.jsx("div",{className:"space-y-4",children:I.map((x,t)=>{const C=v==="revenue"?x.revenue:x.profit,d=v==="revenue"?w.revenue:w.profit,f=C/(d||1)*100;return e.jsxs("div",{className:"bg-gray-800/40 border border-white/10 rounded-[2.5rem] p-6 shadow-xl space-y-5 animate-fade-in-up group relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start border-b border-white/5 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-10 h-10 bg-gray-950 rounded-2xl flex items-center justify-center border border-gray-700 text-gray-500 font-black text-xs shadow-inner",children:["#",t+1]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-black text-white uppercase tracking-tight",children:x.name}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest mt-0.5",children:[x.orders," Orders Total"]})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest ${v==="revenue"?"bg-blue-600/10 text-blue-400":"bg-emerald-600/10 text-emerald-400"}`,children:v==="revenue"?"Revenue Node":"Profit Node"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"·ûü·ûö·ûª·ûî·ûî·üí·ûö·ûÖ·û∂·üÜ·ûÅ·üÇ"}),e.jsxs("p",{className:`text-xl font-black ${v==="revenue"?"text-blue-400":"text-emerald-400"}`,children:["$",C.toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5 flex flex-col justify-center",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"·ûÖ·üÜ·ûé·üÇ·ûÄ·ûë·û∏·ûï·üí·ûü·û∂·ûö"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-white font-black text-sm",children:[f.toFixed(1),"%"]}),e.jsx("div",{className:"flex-grow h-1 bg-gray-900 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${v==="revenue"?"bg-blue-500":"bg-emerald-500"}`,style:{width:`${Math.min(100,f)}%`}})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"Monthly Breakdown (Recent 3)"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ce.slice(-3).map(c=>e.jsxs("div",{className:"bg-gray-900/50 p-2 rounded-xl border border-white/5 text-center",children:[e.jsx("p",{className:"text-[8px] text-gray-600 font-bold uppercase mb-0.5",children:c}),e.jsxs("p",{className:"text-[10px] text-gray-300 font-black",children:["$",(x[`${v==="revenue"?"rev":"prof"}_${c}`]||0).toLocaleString(void 0,{maximumFractionDigits:0})]})]},c))})]}),e.jsx("div",{className:`absolute -right-10 -bottom-10 w-32 h-32 rounded-full blur-[50px] opacity-10 transition-colors ${v==="revenue"?"bg-blue-600":"bg-emerald-600"}`})]},x.name)})})]});return e.jsxs("div",{className:"w-full space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(ae,{label:"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî (Revenue)",value:`$${w.revenue.toLocaleString()}`,icon:"üí∞",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(ae,{label:"·ûî·üí·ûö·û∂·ûÄ·üã·ûÖ·üÜ·ûé·üÅ·ûâ (Profit)",value:`$${w.profit.toLocaleString()}`,icon:"üìà",colorClass:"from-emerald-600 to-teal-500"}),e.jsx(ae,{label:"·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã·ûü·ûö·ûª·ûî (Orders)",value:w.orders,icon:"üì¶",colorClass:"from-purple-600 to-pink-500"})]}),e.jsxs("div",{className:"hidden md:block space-y-8",children:[n("Revenue","rev"),n("Profit","prof")]}),e.jsx(p,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pb-10",children:[e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(tt,{data:u,title:"·ûÖ·üÜ·ûé·ûº·ûõ·ûè·û∂·ûò·ûÄ·üí·ûö·ûª·ûò (Top Teams Revenue)"})}),e.jsxs("div",{className:"page-card !p-6 bg-gray-800/40 border-gray-700/50 flex flex-col justify-center",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-blue-500 rounded-full"})," ·ûü·üí·ûê·û∑·ûè·û∑·ûÄ·üí·ûö·ûª·ûò·ûõ·ûÄ·üã"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"·ûÖ·üÜ·ûì·ûΩ·ûì·ûÄ·üí·ûö·ûª·ûò·ûü·ûÄ·ûò·üí·ûò:"}),e.jsx("span",{className:"text-white font-black text-lg",children:I.length})]}),e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"·ûò·ûí·üí·ûô·ûò·ûó·û∂·ûÇ·ûÖ·üÜ·ûé·ûº·ûõ/·ûÄ·üí·ûö·ûª·ûò:"}),e.jsxs("span",{className:"text-blue-400 font-black text-lg",children:["$",(w.revenue/(I.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"·ûò·ûí·üí·ûô·ûò·ûó·û∂·ûÇ·ûÖ·üÜ·ûé·üÅ·ûâ/·ûÄ·üí·ûö·ûª·ûò:"}),e.jsxs("span",{className:"text-emerald-400 font-black text-lg",children:["$",(w.profit/(I.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},Ae=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Gt=({orders:s,onBack:a,onNavigate:i,contextFilters:r,dateFilter:y,startDate:g,endDate:m})=>{const{appData:b,previewImage:l}=o.useContext(le),[v,h]=o.useState(!0),[j,L]=o.useState(!1),[P,A]=o.useState({key:"teamName",direction:"asc"}),N=t=>{A(C=>({key:t,direction:C.key===t&&C.direction==="desc"?"asc":"desc"}))},I=()=>{const t={};return r&&(r.team&&(t.team=r.team),r.store&&(t.store=r.store),r.paymentStatus&&(t.paymentStatus=r.paymentStatus),r.user&&(t.user=r.user),r.fulfillmentStore&&(t.fulfillmentStore=r.fulfillmentStore),r.location&&(t.location=r.location),r.shippingService&&(t.shipping=r.shippingService),r.driver&&(t.driver=r.driver),r.bank&&(t.bank=r.bank),r.product&&(t.product=r.product),r.internalCost&&(t.internalCost=r.internalCost)),t},w=(t,C)=>{if(i){const d=I();t==="page"&&(d.page=C),t==="team"&&(d.team=C),d.datePreset=y,d.startDate=g,d.endDate=m,i(d)}},M=(t,C)=>{if(i){const d=I(),f=new Date().getFullYear(),c=y==="last_year"?f-1:f,S=new Date(c,C,1),k=new Date(c,C+1,0,23,59,59),D=T=>{const z=T.getFullYear(),U=String(T.getMonth()+1).padStart(2,"0"),E=String(T.getDate()).padStart(2,"0");return`${z}-${U}-${E}`};d.page=t,d.datePreset="custom",d.startDate=D(S),d.endDate=D(k),i(d)}},u=o.useMemo(()=>{const t={};b.pages&&b.pages.forEach(d=>{t[d.PageName]={pageName:d.PageName,teamName:d.Team||"Unassigned",logoUrl:d.PageLogoURL||"",revenue:0,profit:0,orderCount:0},Ae.forEach(f=>{t[d.PageName][`rev_${f}`]=0,t[d.PageName][`prof_${f}`]=0})}),s.forEach(d=>{var k;const f=d.Page||"Unknown";if(!t[f]){const D=(k=b.pages)==null?void 0:k.find(T=>T.PageName===f);t[f]={pageName:f,teamName:d.Team||"Unassigned",logoUrl:(D==null?void 0:D.PageLogoURL)||"",revenue:0,profit:0,orderCount:0},Ae.forEach(T=>{t[f][`rev_${T}`]=0,t[f][`prof_${T}`]=0})}const c=Number(d["Grand Total"])||0,S=(Number(d["Total Product Cost ($)"])||0)+(Number(d["Internal Cost"])||0);if(t[f].revenue+=c,t[f].profit+=c-S,t[f].orderCount+=1,d.Timestamp){const D=new Date(d.Timestamp),T=Ae[D.getMonth()];t[f][`rev_${T}`]+=c,t[f][`prof_${T}`]+=c-S}});let C=Object.values(t);return v||(C=C.filter(d=>d.revenue>0)),C.sort((d,f)=>{const c=P.direction==="asc"?1:-1,S=d[P.key],k=f[P.key];return typeof S=="string"?S.localeCompare(k)*c:(S-k)*c})},[s,P,b.pages,v]),n=o.useMemo(()=>{const t={revenue:0,profit:0,pagesCount:u.length};return Ae.forEach(C=>{t[`rev_${C}`]=0,t[`prof_${C}`]=0}),u.forEach(C=>{t.revenue+=C.revenue,t.profit+=C.profit,Ae.forEach(d=>{t[`rev_${d}`]+=C[`rev_${d}`],t[`prof_${d}`]+=C[`prof_${d}`]})}),t},[u]),p=()=>{L(!0),setTimeout(()=>{try{const t=new We({orientation:"landscape"}),C=t.internal.pageSize.width;t.setFontSize(18),t.text("Sales Report by Page",C/2,15,{align:"center"}),t.save(`Page_Sales_Report_${Date.now()}.pdf`)}catch(t){console.error(t),alert("Export failed")}finally{L(!1)}},100)},x=o.useMemo(()=>[...u].sort((t,C)=>C.revenue-t.revenue).slice(0,5).map(t=>({label:t.pageName,value:t.revenue,imageUrl:t.logoUrl})),[u]);return e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ae,{label:"·ûÖ·üÜ·ûé·ûº·ûõ·ûü·ûö·ûª·ûî (Total Rev)",value:`$${n.revenue.toLocaleString()}`,icon:"üí∞",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(ae,{label:"·ûî·üí·ûö·û∂·ûÄ·üã·ûÖ·üÜ·ûé·üÅ·ûâ (Total Profit)",value:`$${n.profit.toLocaleString()}`,icon:"üìà",colorClass:"from-emerald-600 to-green-500"})]}),e.jsx(mt,{data:u,grandTotals:n,sortConfig:P,onToggleSort:N,showAllPages:v,setShowAllPages:h,onExportPDF:p,isExporting:j,onPreviewImage:l,onNavigate:w,onMonthClick:M}),e.jsx(pt,{data:u,grandTotals:n,onPreviewImage:l,onNavigate:w,onMonthClick:M}),e.jsx(ht,{data:u,onPreviewImage:l,onNavigate:w,onMonthClick:M}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 pb-10",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(tt,{data:x,title:"Page ·ûä·üÇ·ûõ·ûò·û∂·ûì·ûÖ·üÜ·ûé·ûº·ûõ·ûÅ·üí·ûñ·ûü·üã·ûî·üÜ·ûï·ûª·ûè (Top 5 Pages Revenue)"})})}),e.jsxs("div",{className:"lg:col-span-4 flex flex-col justify-center page-card !p-5 bg-gray-800/30 border-gray-700/50",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-6",children:[e.jsx("span",{className:"w-1.5 h-4 bg-indigo-500 rounded-full"}),"·ûü·ûÑ·üí·ûÅ·üÅ·ûî"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"·ûÖ·üÜ·ûì·ûΩ·ûì Page ·ûü·ûÄ·ûò·üí·ûò:"}),e.jsx("span",{className:"text-white font-black text-sm",children:n.pagesCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"·ûò·ûí·üí·ûô·ûò·ûó·û∂·ûÇ/Page:"}),e.jsxs("span",{className:"text-blue-400 font-black text-sm",children:["$",(n.revenue/(n.pagesCount||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},Ht=[{label:"·ûë·û∂·üÜ·ûÑ·û¢·ûü·üã (All Time)",value:"all"},{label:"·ûê·üí·ûÑ·üÉ·ûì·üÅ·üá (Today)",value:"today"},{label:"·ûò·üí·ûü·û∑·ûõ·ûò·û∑·ûâ (Yesterday)",value:"yesterday"},{label:"·ûü·ûî·üí·ûè·û∂·û†·üç·ûì·üÅ·üá (This Week)",value:"this_week"},{label:"·ûü·ûî·üí·ûè·û∂·û†·üç·ûò·ûª·ûì (Last Week)",value:"last_week"},{label:"·ûÅ·üÇ·ûì·üÅ·üá (This Month)",value:"this_month"},{label:"·ûÅ·üÇ·ûò·ûª·ûì (Last Month)",value:"last_month"},{label:"·ûÜ·üí·ûì·û∂·üÜ·ûì·üÅ·üá (This Year)",value:"this_year"},{label:"·ûÜ·üí·ûì·û∂·üÜ·ûò·ûª·ûì (Last Year)",value:"last_year"},{label:"·ûÄ·üÜ·ûé·ûè·üã·ûÅ·üí·ûõ·ûΩ·ûì·ûØ·ûÑ (Custom)",value:"custom"}],Yt=({datePreset:s,setDatePreset:a,startDate:i,setStartDate:r,endDate:y,setEndDate:g,calculatedRange:m})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 p-5 rounded-[1.8rem] border border-white/5 shadow-inner",children:[e.jsx("label",{className:"text-[10px] font-black text-blue-500 mb-3 block uppercase tracking-[0.2em] ml-2",children:"Temporal Window"}),e.jsx("select",{value:s,onChange:b=>a(b.target.value),className:"form-select !bg-gray-900 border-gray-800 !py-3.5 !px-5 rounded-2xl font-bold text-gray-200 focus:border-blue-500/50",children:Ht.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))}),e.jsx("div",{className:"mt-3 bg-black/40 p-3 rounded-xl text-center text-[10px] font-mono text-gray-500 border border-white/5 uppercase tracking-widest",children:m})]}),s==="custom"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 animate-fade-in px-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"From"}),e.jsx("input",{type:"date",value:i,onChange:b=>r(b.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"To"}),e.jsx("input",{type:"date",value:y,onChange:b=>g(b.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]})]})]}),xe=({label:s,value:a,onChange:i,options:r,placeholder:y="All",variant:g="default",multiple:m=!1,searchable:b=!0})=>{const[l,v]=o.useState(!1),[h,j]=o.useState(""),L=o.useRef(null),P=o.useRef(null);o.useEffect(()=>{const t=C=>{L.current&&!L.current.contains(C.target)&&(v(!1),j(""))};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),o.useEffect(()=>{l&&b&&P.current&&setTimeout(()=>{var t;return(t=P.current)==null?void 0:t.focus()},100)},[l,b]);const A=a?a.split(","):[],N=t=>typeof t=="string"?t:t.label,I=t=>typeof t=="string"?t:t.value,w=o.useMemo(()=>{if(!h)return r;const t=h.toLowerCase();return r.filter(C=>{const d=N(C).toLowerCase(),f=I(C).toLowerCase();return d.includes(t)||f.includes(t)})},[r,h]),M=t=>{if(m){let C;A.includes(t)?C=A.filter(d=>d!==t):C=[...A,t],i(C.join(","))}else i(t),v(!1),j("")},u=t=>{t.stopPropagation(),i(""),m||v(!1)};let n=y;if(A.length>0)if(A.length===1){const t=r.find(C=>I(C)===A[0]);n=t?N(t):A[0]}else n=`${A.length} Selected`;let p="relative w-full cursor-pointer bg-gray-900 border border-gray-800 py-3.5 px-4 rounded-2xl font-bold transition-all focus:border-blue-500/50 flex justify-between items-center",x="text-gray-400";return g==="payment"?A.includes("Paid")?(p+=" border-emerald-500/30 shadow-[0_0_15px_rgba(16,185,129,0.1)]",x="text-emerald-400"):A.includes("Unpaid")&&(p+=" border-red-500/30 shadow-[0_0_15px_rgba(239,68,68,0.1)]",x="text-red-400"):A.length>0&&(x="text-white",p+=" border-blue-500/30"),e.jsxs("div",{className:"w-full",ref:L,children:[e.jsxs("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:[s," ",m&&e.jsx("span",{className:"text-[9px] text-blue-500 bg-blue-500/10 px-1.5 py-0.5 rounded ml-1",children:"MULTI"})]}),e.jsxs("div",{className:p,onClick:()=>v(!l),children:[e.jsx("span",{className:`truncate mr-2 text-sm ${x}`,children:n}),e.jsxs("div",{className:"flex items-center gap-2",children:[A.length>0&&e.jsx("button",{onClick:u,className:"p-1 hover:bg-gray-700 rounded-full text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${l?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),l&&e.jsxs("div",{className:"absolute top-full left-0 w-full mt-2 bg-[#1a2235] border border-white/10 rounded-2xl shadow-2xl z-50 overflow-hidden animate-fade-in-down max-h-72 flex flex-col",children:[b&&e.jsx("div",{className:"p-2 border-b border-white/5 sticky top-0 bg-[#1a2235] z-10",children:e.jsx("input",{ref:P,type:"text",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-sm text-white focus:border-blue-500 focus:outline-none placeholder-gray-600",placeholder:"Search...",value:h,onChange:t=>j(t.target.value),onClick:t=>t.stopPropagation()})}),e.jsx("div",{className:"overflow-y-auto custom-scrollbar flex-grow",children:w.length>0?w.map((t,C)=>{const d=I(t),f=N(t),c=A.includes(d);return e.jsxs("div",{onClick:S=>{S.stopPropagation(),M(d)},className:`
                                                px-4 py-3 flex items-center justify-between cursor-pointer border-b border-white/5 last:border-none transition-colors
                                                ${c?"bg-blue-600/10":"hover:bg-white/5"}
                                            `,children:[e.jsx("span",{className:`text-sm font-bold truncate ${c?"text-blue-400":"text-gray-300"}`,children:f}),c&&e.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),!c&&m&&e.jsx("div",{className:"w-5 h-5 rounded border-2 border-gray-600 flex-shrink-0 ml-2"})]},`${d}-${C}`)}):e.jsx("div",{className:"p-4 text-center text-xs text-gray-500 font-bold uppercase",children:"No Matches Found"})})]})]})]})},Je=({filters:s,setFilters:a,orders:i,usersList:r,appData:y,calculatedRange:g})=>{var v;const m=o.useMemo(()=>{const h=new Set,j=new Set,L=new Set,P=new Set,A=new Set,N=new Set,I=new Set,w=new Set,M=new Map;i.forEach(n=>{n.Page&&h.add(n.Page),n.Location&&j.add(n.Location),n["Internal Shipping Method"]&&L.add(n["Internal Shipping Method"]),n["Internal Shipping Details"]&&P.add(n["Internal Shipping Details"]),n["Fulfillment Store"]&&A.add(n["Fulfillment Store"]),n["Payment Info"]&&N.add(n["Payment Info"]),n["Internal Cost"]!==void 0&&I.add(String(n["Internal Cost"])),n.Team&&w.add(n.Team),n["Customer Name"]&&M.set(n["Customer Name"],n["Customer Phone"]||"")});const u=Array.from(M.entries()).sort((n,p)=>n[0].localeCompare(p[0])).map(([n,p])=>({label:`${n} ${p?`(${p})`:""}`,value:n}));return{pages:Array.from(h).sort(),locations:Array.from(j).sort(),shippingMethods:Array.from(L).sort(),drivers:Array.from(P).sort(),fulfillmentStores:Array.from(A).sort(),banks:Array.from(N).sort(),costs:Array.from(I).sort((n,p)=>Number(n)-Number(p)),teams:Array.from(w).sort(),customerOptions:u}},[i]),b=()=>{a({datePreset:"this_month",startDate:"",endDate:"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:"",customerName:""})},l=(h,j)=>{a({...s,[h]:j})};return e.jsxs("div",{className:"space-y-8",children:[e.jsx(Yt,{datePreset:s.datePreset,setDatePreset:h=>a({...s,datePreset:h}),startDate:s.startDate,setStartDate:h=>l("startDate",h),endDate:s.endDate,setEndDate:h=>l("endDate",h),calculatedRange:g}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-x-6 gap-y-6 px-1",children:[e.jsx(xe,{label:"Customer Name (·ûà·üí·ûò·üÑ·üá·û¢·ûè·û∑·ûê·û∑·ûá·ûì)",value:s.customerName,onChange:h=>l("customerName",h),options:m.customerOptions,placeholder:"Search by Name or Phone...",multiple:!0,searchable:!0}),e.jsx(xe,{label:"Payment Status",value:s.paymentStatus,onChange:h=>l("paymentStatus",h),options:[{label:"Paid (·ûö·ûΩ·ûÖ·ûö·û∂·ûõ·üã)",value:"Paid"},{label:"Unpaid (COD)",value:"Unpaid"}],placeholder:"All Statuses",variant:"payment",multiple:!0}),e.jsx(xe,{label:"Store (Brand/Sales)",value:s.store,onChange:h=>l("store",h),options:((v=y.stores)==null?void 0:v.map(h=>h.StoreName))||[],placeholder:"All Stores (Brands)",multiple:!0}),e.jsx(xe,{label:"Team Allocation",value:s.team,onChange:h=>l("team",h),options:m.teams,placeholder:"All Operational Teams",multiple:!0}),e.jsx(xe,{label:"Source Page",value:s.page,onChange:h=>l("page",h),options:m.pages,placeholder:"All Pages",multiple:!0}),e.jsx(xe,{label:"Fulfillment Store (Stock)",value:s.fulfillmentStore,onChange:h=>l("fulfillmentStore",h),options:m.fulfillmentStores,placeholder:"All Fulfillment Centers",multiple:!0}),e.jsx(xe,{label:"Geography (Location)",value:s.location,onChange:h=>l("location",h),options:m.locations,placeholder:"All Regions",multiple:!0}),e.jsx(xe,{label:"Logistics Method",value:s.shippingService,onChange:h=>l("shippingService",h),options:m.shippingMethods,placeholder:"All Shipping Methods",multiple:!0}),e.jsx(xe,{label:"Logistics Driver",value:s.driver,onChange:h=>l("driver",h),options:m.drivers,placeholder:"All Drivers / Details",multiple:!0}),e.jsx(xe,{label:"Merchant Node (User)",value:s.user,onChange:h=>l("user",h),options:r.map(h=>({label:h.FullName,value:h.UserName})),placeholder:"All Registered Users",multiple:!0}),e.jsx(xe,{label:"Exp. Cost (Internal)",value:s.internalCost,onChange:h=>l("internalCost",h),options:m.costs.map(h=>({label:`$${h}`,value:h})),placeholder:"All Costs",multiple:!0}),e.jsx(xe,{label:"·ûÇ·ûé·ûì·û∏·ûí·ûì·û∂·ûÇ·û∂·ûö (Bank)",value:s.bank,onChange:h=>l("bank",h),options:m.banks,placeholder:"All Bank Accounts",multiple:!0}),e.jsxs("div",{className:"sm:col-span-2 xl:col-span-3",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:"Asset Selection (Product)"}),e.jsx(gt,{products:y.products,selectedProductName:s.product,onSelect:h=>l("product",h),showTagEditor:!1})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:b,className:"w-full py-4 text-[11px] font-black text-gray-500 uppercase tracking-widest hover:text-white border border-dashed border-gray-800 rounded-2xl transition-all active:scale-95 hover:border-red-500/30 hover:bg-red-500/10",children:"Reset All Configurations"})})]})},Kt=({activeReport:s,onBack:a,onNavigate:i})=>{const{appData:r,refreshTimestamp:y,setMobilePageTitle:g}=o.useContext(le),[m,b]=o.useState(!0),[l,v]=o.useState([]),[h,j]=o.useState([]),[L,P]=o.useState(!1),A={overview:"OVERVIEW",sales_team:"SALES TEAM REPORT",sales_page:"SALES PAGE REPORT",performance:"PERFORMANCE",profitability:"PROFITABILITY",shipping:"SHIPPING COST",forecasting:"FORECASTING"};o.useEffect(()=>(g(A[s]),()=>g(null)),[s,g]);const[N,I]=G("dateFilter","this_month"),[w,M]=G("startDate",""),[u,n]=G("endDate",""),[p,x]=G("customerFilter",""),[t,C]=o.useState({datePreset:N||"this_month",startDate:w||"",endDate:u||"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:"",customerName:p||""});o.useEffect(()=>{t.datePreset!==N&&I(t.datePreset),t.startDate!==w&&M(t.startDate),t.endDate!==u&&n(t.endDate),t.customerName!==p&&x(t.customerName)},[t.datePreset,t.startDate,t.endDate,t.customerName,N,w,u,p,I,M,n,x]);const d=async()=>{b(!0);try{const[k,D]=await Promise.all([fetch(`${ne}/api/admin/all-orders`),fetch(`${ne}/api/users`)]),T=await k.json(),z=await D.json();if(T.status==="success"){const U=(T.data||[]).filter(E=>E!==null&&E["Order ID"]!=="Opening_Balance"&&E["Order ID"]!=="Opening Balance").map(E=>{let O=[];try{E["Products (JSON)"]&&(O=JSON.parse(E["Products (JSON)"]))}catch{}return{...E,Products:O}});v(U)}z.status==="success"&&j(z.data||[])}catch(k){console.error(k)}finally{b(!1)}};o.useEffect(()=>{d()},[y]);const f=o.useMemo(()=>{const k=new Date,D=new Date(k.getFullYear(),k.getMonth(),k.getDate());let T=null,z=new Date;switch(t.datePreset){case"today":T=D;break;case"yesterday":T=new Date(D),T.setDate(D.getDate()-1),z=new Date(D),z.setMilliseconds(-1);break;case"this_week":const E=k.getDay();T=new Date(D),T.setDate(D.getDate()-(E===0?6:E-1));break;case"last_week":T=new Date(D),T.setDate(D.getDate()-k.getDay()-6),z=new Date(T),z.setDate(T.getDate()+6),z.setHours(23,59,59);break;case"this_month":T=new Date(k.getFullYear(),k.getMonth(),1);break;case"last_month":T=new Date(k.getFullYear(),k.getMonth()-1,1),z=new Date(k.getFullYear(),k.getMonth(),0,23,59,59);break;case"this_year":T=new Date(k.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${t.startDate||"..."} to ${t.endDate||"..."}`}const U=E=>{const O=E.getFullYear(),W=String(E.getMonth()+1).padStart(2,"0"),q=String(E.getDate()).padStart(2,"0");return`${O}-${W}-${q}`};return T?`${U(T)} to ${U(z)}`:"All time data stream"},[t.datePreset,t.startDate,t.endDate]),c=o.useMemo(()=>l.filter(k=>{var T;if(t.datePreset!=="all"){const z=new Date(k.Timestamp),U=new Date,E=new Date(U.getFullYear(),U.getMonth(),U.getDate());let O=null,W=new Date;switch(t.datePreset){case"today":O=E;break;case"yesterday":O=new Date(E),O.setDate(E.getDate()-1),W=new Date(E),W.setMilliseconds(-1);break;case"this_week":const q=U.getDay();O=new Date(E),O.setDate(E.getDate()-(q===0?6:q-1));break;case"last_week":O=new Date(E),O.setDate(E.getDate()-U.getDay()-6),W=new Date(O),W.setDate(O.getDate()+6),W.setHours(23,59,59);break;case"this_month":O=new Date(U.getFullYear(),U.getMonth(),1);break;case"last_month":O=new Date(U.getFullYear(),U.getMonth()-1,1),W=new Date(U.getFullYear(),U.getMonth(),0,23,59,59);break;case"this_year":O=new Date(U.getFullYear(),0,1);break;case"custom":t.startDate&&(O=new Date(t.startDate+"T00:00:00")),t.endDate&&(W=new Date(t.endDate+"T23:59:59"));break}if(O&&z<O||W&&z>W)return!1}const D=(z,U)=>{if(!z)return!0;const E=z.split(",").map(W=>W.trim().toLowerCase()),O=(U||"").trim().toLowerCase();return E.includes(O)};if(!D(t.team,k.Team)||!D(t.user,k.User||"")||!D(t.paymentStatus,k["Payment Status"])||!D(t.shippingService,k["Internal Shipping Method"])||!D(t.driver,k["Internal Shipping Details"])||!D(t.bank,k["Payment Info"])||!D(t.fulfillmentStore,k["Fulfillment Store"])||!D(t.page,k.Page)||!D(t.location,k.Location)||!D(t.internalCost,String(k["Internal Cost"]))||t.product&&!k.Products.some(z=>z.name===t.product))return!1;if(t.store){const z=(T=r.pages)==null?void 0:T.find(O=>O.PageName===k.Page),U=z?z.DefaultStore:null,E=t.store.split(",");if(!U||!E.includes(U))return!1}return!!D(t.customerName,k["Customer Name"])}),[l,t,r.pages]);if(m)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-950",children:e.jsx(se,{size:"lg"})});const S=Object.values(t).filter(k=>k!==""&&k!=="this_month"&&k!=="all").length;return e.jsxs("div",{className:"animate-fade-in space-y-8 pb-20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-gray-800/20 p-6 rounded-[2.5rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden sm:block text-2xl font-black text-white uppercase tracking-tight italic",children:A[s]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("p",{className:"text-[10px] text-blue-400 font-black uppercase tracking-widest",children:[f," ",S>0&&` ‚Ä¢ ${S} Active Filters`]})]})]}),e.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:e.jsxs("button",{onClick:()=>P(!0),className:"relative flex-1 sm:flex-none btn btn-secondary !py-2.5 !px-6 rounded-2xl border border-gray-700 flex items-center justify-center gap-3 transition-all hover:bg-gray-700 active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter Engine",S>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-600 text-white text-[10px] font-black rounded-full flex items-center justify-center border-2 border-gray-900",children:S})]})})]}),e.jsxs("div",{className:"min-h-[500px]",children:[s==="overview"&&e.jsx(_e,{orders:c,reportType:"overview",allOrders:l,dateFilter:t.datePreset}),s==="sales_team"&&e.jsx(Vt,{orders:c,onBack:a}),s==="sales_page"&&e.jsx(Gt,{orders:c,onBack:a,onNavigate:i,contextFilters:t,dateFilter:t.datePreset,startDate:t.startDate,endDate:t.endDate}),s==="shipping"&&e.jsx(_e,{orders:c,reportType:"shipping",allOrders:l,dateFilter:t.datePreset,startDate:t.startDate,endDate:t.endDate,onNavigate:i,contextFilters:t}),s==="profitability"&&e.jsx(_e,{orders:c,reportType:"profitability",allOrders:l,dateFilter:t.datePreset}),s==="performance"&&e.jsx(_e,{orders:c,reportType:"performance",allOrders:l,dateFilter:t.datePreset}),s==="forecasting"&&e.jsx(_e,{orders:l,reportType:"forecasting",allOrders:l,dateFilter:t.datePreset})]}),e.jsx(me,{isOpen:L,onClose:()=>P(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>P(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"√ó"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(Je,{filters:t,setFilters:C,orders:l,usersList:h,appData:r,calculatedRange:f})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>P(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})]})},Jt=({storesHierarchy:s,selectedPageNames:a,teamsPerRow:i,columns:r,imageMap:y})=>{const g=a.size,b=o.useCallback(()=>g>60?.45:g>45?.6:g>30?.75:g>=20?.85:1,[g])(),l=v=>Math.round(v*b);return e.jsxs("div",{id:"png-export-layer",style:{display:"none",width:"2560px",minHeight:"1440px",height:"auto",position:"relative",backgroundColor:"#020617",fontFamily:"'Kantumruy Pro', sans-serif",WebkitFontSmoothing:"antialiased",paddingBottom:l(100)},className:"flex flex-col items-center",children:[e.jsx("style",{children:`
                #png-export-layer * {
                    box-sizing: border-box;
                    line-height: 1.6 !important;
                }
                .khmer-text {
                    font-family: 'Kantumruy Pro', sans-serif !important;
                    padding-bottom: 2px;
                }
                .item-container {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }
                .team-badge-gradient {
                    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
                    border: ${l(2)}px solid rgba(59, 130, 246, 0.5);
                }
            `}),e.jsx("div",{className:"absolute inset-0 opacity-[0.12] pointer-events-none",style:{backgroundImage:"radial-gradient(#3b82f6 1.2px, transparent 1.2px)",backgroundSize:"40px 40px",height:"100%"}}),e.jsx("div",{className:"w-full h-full flex flex-col p-[50px] relative z-10 justify-center",children:e.jsx("div",{className:"w-full",children:Object.entries(s).map(([v,h],j)=>Object.values(h).some(P=>P.some(A=>a.has(A.PageName)))?e.jsxs("div",{className:"w-full item-container flex flex-col mb-[70px] last:mb-0 items-center",children:[e.jsxs("div",{className:"flex items-center gap-[30px] mb-[60px] justify-center",children:[e.jsx("div",{style:{width:l(100),height:l(100),borderRadius:l(28),fontSize:l(50)},className:"bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center font-black shadow-[0_0_40px_rgba(59,130,246,0.3)] border border-white/20 flex-shrink-0",children:(j+1).toString().padStart(2,"0")}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("h2",{style:{fontSize:l(100)},className:"font-black text-white uppercase tracking-tighter leading-none khmer-text drop-shadow-2xl",children:v})})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${i}, minmax(0, 1fr))`,gap:l(60),width:"100%",maxWidth:"95%",direction:"ltr"},children:Object.entries(h).map(([P,A])=>{const N=A.filter(I=>a.has(I.PageName));return N.length===0?null:e.jsxs("div",{style:{borderRadius:l(45),padding:l(40),paddingTop:l(65)},className:"bg-gray-900/40 border border-white/10 shadow-2xl flex flex-col relative backdrop-blur-xl",children:[e.jsx("div",{style:{top:l(-42),left:"50%",transform:"translateX(-50%)",borderRadius:l(20),padding:`${l(14)}px ${l(50)}px`,fontSize:l(34),minWidth:l(220),display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 ${l(15)}px ${l(35)}px rgba(0,0,0,0.8), inset 0 0 ${l(10)}px rgba(59, 130, 246, 0.2)`},className:"absolute team-badge-gradient font-black uppercase tracking-widest text-blue-400 khmer-text whitespace-nowrap z-20",children:P}),e.jsx("div",{className:"space-y-[20px] flex-grow",children:N.map(I=>e.jsxs("div",{style:{borderRadius:l(28),padding:l(18)},className:"flex items-center gap-[20px] bg-black/40 border border-white/5 shadow-inner hover:border-blue-500/30 transition-all",children:[r.logoImage&&y[I.PageName]&&e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:y[I.PageName],style:{width:l(85),height:l(85),borderRadius:l(22)},className:"object-cover border-[3px] border-gray-700 shadow-lg",alt:""})}),e.jsxs("div",{className:"flex-grow min-w-0 text-left",style:{marginTop:l(-25)},children:[e.jsx("span",{style:{fontSize:l(36)},className:"font-black block text-white uppercase tracking-tight khmer-text leading-tight break-words",children:I.PageName}),r.telegramValue&&e.jsxs("div",{style:{marginTop:l(8)},className:"flex items-center gap-2",children:[e.jsx("svg",{style:{width:l(20),height:l(20)},className:"text-blue-500 opacity-80",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h-2v-6h2v6zm-1-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})}),e.jsxs("span",{style:{fontSize:l(24)},className:"text-blue-400/70 font-mono font-bold tracking-wider leading-none",children:["@",I.TelegramValue]})]})]})]},I.PageName))})]},P)})})})]},v):null)})})]})},qt=({isOpen:s,onClose:a,pages:i})=>{const[r,y]=o.useState(3),[g,m]=o.useState(!1),[b,l]=o.useState(0),[v,h]=o.useState(null),[j,L]=o.useState({pageName:!0,telegramValue:!0,logoImage:!0}),[P,A]=o.useState(new Set),[N,I]=o.useState({});o.useEffect(()=>{s&&i&&i.length>0&&P.size===0&&A(new Set(i.map(c=>c.PageName))),s||h(null)},[s,i]);const w=o.useMemo(()=>{const c={};return i&&i.forEach(S=>{const k=S.DefaultStore||"No Store",D=S.Team||"No Team";c[k]||(c[k]={}),c[k][D]||(c[k][D]=[]),c[k][D].push(S)}),c},[i]),M=c=>{L(S=>({...S,[c]:!S[c]}))},u=c=>{A(S=>{const k=new Set(S);return k.has(c)?k.delete(c):k.add(c),k})},n=c=>{const S=c.every(k=>P.has(k.PageName));A(k=>{const D=new Set(k);return c.forEach(T=>{S?D.delete(T.PageName):D.add(T.PageName)}),D})},p=c=>{const S=Object.values(c).flat(),k=S.every(D=>P.has(D.PageName));A(D=>{const T=new Set(D);return S.forEach(z=>{k?T.delete(z.PageName):T.add(z.PageName)}),T})},x=c=>{A(c?new Set(i.map(S=>S.PageName)):new Set)},t=async c=>{const S={...N};let k=0;for(const D of c){if(D.PageLogoURL&&!S[D.PageName])try{const T=await lt(D.PageLogoURL);T&&(S[D.PageName]=`data:image/png;base64,${T}`)}catch{console.warn(`Failed to load logo for ${D.PageName}`)}k++,l(Math.round(k/c.length*100))}return I(S),S},C=async()=>{if(P.size===0)return;m(!0),l(0);const c=document.getElementById("png-export-layer");if(!c){m(!1);return}const S=c.getAttribute("style")||"";try{const k=i.filter(O=>P.has(O.PageName));await t(k),await document.fonts.ready;const D=2560;c.style.display="flex",c.style.width=`${D}px`,c.style.height="auto",c.style.position="fixed",c.style.top="0",c.style.left="-10000px",c.style.zIndex="-100",await new Promise(O=>setTimeout(O,1e3));const T=c.scrollHeight,z=Math.max(1440,T),E=(await wt(c,{backgroundColor:"#020617",scale:1.5,useCORS:!0,logging:!1,width:D,height:z,windowWidth:D,windowHeight:z,allowTaint:!0,imageTimeout:15e3})).toDataURL("image/png",.9);h(E)}catch(k){console.error("Preview Generation Error:",k),alert("·ûÄ·û∂·ûö·ûî·ûÑ·üí·ûÄ·ûæ·ûè Preview ·ûî·ûö·û∂·ûá·üê·ûô·üî")}finally{c.setAttribute("style",S),m(!1)}},d=()=>{if(v)try{const c=new We({orientation:"landscape",unit:"mm",format:"a4"}),S=c.getImageProperties(v),k=c.internal.pageSize.getWidth(),D=S.height*k/S.width;c.deletePage(1),c.addPage([k,D]),c.addImage(v,"PNG",0,0,k,D),c.save(`Organization_Chart_${new Date().getTime()}.pdf`),a()}catch(c){console.error(c),alert("Export PDF Error")}},f=()=>{if(!v)return;const c=document.createElement("a");c.href=v,c.download=`Organization_Chart_${new Date().getTime()}.png`,document.body.appendChild(c),c.click(),document.body.removeChild(c)};return e.jsxs(me,{isOpen:s,onClose:a,maxWidth:"max-w-7xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-white/5 pb-6",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-3xl font-black text-white flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-600/20 rounded-2xl flex items-center justify-center border border-red-500/30",children:e.jsx("svg",{className:"w-7 h-7 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),"Premium HD Export"]})}),e.jsx("button",{onClick:a,className:"p-3 bg-gray-800 text-gray-400 hover:text-white rounded-2xl active:scale-95 transition-all",children:"√ó"})]}),v?e.jsxs("div",{className:"flex flex-col h-[70vh]",children:[e.jsx("div",{className:"flex-grow overflow-auto bg-gray-950/50 rounded-3xl border border-white/10 p-4 flex items-center justify-center relative",children:e.jsx("img",{src:v,className:"max-w-full h-auto shadow-2xl rounded-lg",alt:"Preview"})}),e.jsxs("div",{className:"mt-6 flex flex-wrap justify-between items-center border-t border-white/5 pt-6 gap-4",children:[e.jsxs("button",{onClick:()=>h(null),className:"px-8 py-4 text-sm font-black text-gray-400 hover:text-white uppercase flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})}),"Back to Settings"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:f,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16l4 4m0 0l4-4m-4 4V4"})}),"Download PNG"]}),e.jsxs("button",{onClick:d,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-emerald-600 text-white hover:bg-emerald-700 shadow-emerald-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download PDF"]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 h-[70vh]",children:[e.jsx("div",{className:"lg:col-span-3 space-y-8 overflow-y-auto pr-4 custom-scrollbar",children:e.jsxs("div",{className:"bg-black/40 p-6 rounded-[2.5rem] border border-white/5 space-y-8 shadow-inner",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Density Control"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-900/50 p-1.5 rounded-2xl border border-gray-800",children:[1,2,3,4,5,6].map(c=>e.jsx("button",{onClick:()=>y(c),className:`py-2.5 rounded-xl text-xs font-black transition-all ${r===c?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:c},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Display Fields"}),e.jsx("div",{className:"space-y-2",children:Object.keys(j).map(c=>e.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-2xl border border-gray-800 cursor-pointer hover:bg-blue-600/5 transition-colors group",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-gray-200 capitalize",children:c.replace(/([A-Z])/g," $1")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:j[c],onChange:()=>M(c),className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]},c))})]})]})}),e.jsxs("div",{className:"lg:col-span-9 flex flex-col bg-gray-950/40 rounded-[3rem] border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 bg-white/5 flex justify-between items-center backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsxs("p",{className:"text-xs font-black text-white uppercase tracking-widest",children:[P.size," Nodes Linked"]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("button",{onClick:()=>x(!0),className:"text-[10px] font-black text-blue-400 hover:text-blue-300 transition-colors uppercase tracking-widest",children:"Select All"}),e.jsx("button",{onClick:()=>x(!1),className:"text-[10px] font-black text-gray-500 hover:text-white transition-colors uppercase tracking-widest",children:"Clear"})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-8 space-y-12 custom-scrollbar",children:Object.entries(w).map(([c,S])=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 group",children:[e.jsx("input",{type:"checkbox",onChange:()=>p(S),className:"w-6 h-6 rounded-lg border-gray-700 bg-gray-900 text-blue-600 focus:ring-blue-500/20 cursor-pointer"}),e.jsxs("h4",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-4 group-hover:text-blue-400 transition-colors",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),c]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pl-10",children:Object.entries(S).map(([k,D])=>{const T=D.every(z=>P.has(z.PageName));return e.jsxs("div",{className:"bg-gray-900/40 rounded-3xl border border-white/5 p-6 shadow-xl",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-6 cursor-pointer border-b border-white/5 pb-4",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:()=>n(D),className:"w-5 h-5 rounded-md border-gray-700 bg-gray-800 text-blue-500"}),e.jsx("span",{className:"text-xs font-black text-gray-400 uppercase tracking-[0.15em]",children:k})]}),e.jsx("div",{className:"space-y-3",children:D.map(z=>e.jsxs("label",{className:`flex items-center gap-4 p-3 rounded-2xl border transition-all cursor-pointer ${P.has(z.PageName)?"bg-blue-600/10 border-blue-500/30":"bg-black/20 border-transparent hover:bg-white/5"}`,children:[e.jsx("input",{type:"checkbox",checked:P.has(z.PageName),onChange:()=>u(z.PageName),className:"w-4 h-4 rounded-md border-gray-700 bg-gray-900 text-blue-600"}),e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("img",{src:pe(z.PageLogoURL),className:"w-7 h-7 rounded-full object-cover border border-white/10",alt:""}),e.jsx("span",{className:"text-xs font-bold text-gray-300 truncate",children:z.PageName})]})]},z.PageName))})]},k)})})]},c))}),e.jsxs("div",{className:"p-8 border-t border-white/5 bg-gray-900/80 backdrop-blur-xl flex justify-between items-center",children:[e.jsx("div",{className:"flex flex-col",children:g&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{size:"sm"}),e.jsxs("p",{className:"text-xs font-black text-red-400 uppercase tracking-[0.2em] animate-pulse",children:["Processing Preview: ",b,"%"]})]}),e.jsx("div",{className:"w-64 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-600 transition-all duration-300",style:{width:`${b}%`}})})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"px-8 py-4 text-sm font-black text-gray-500 hover:text-white uppercase",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:g||P.size===0,className:`px-12 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 ${g||P.size===0?"bg-gray-800 text-gray-600":"bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20"}`,children:g?"Rendering...":"Preview Export"})]})]})]})]}),e.jsx(Jt,{storesHierarchy:w,selectedPageNames:P,teamsPerRow:r,columns:j,imageMap:N})]})},Ke=[{id:"users",title:"·û¢·üí·ûì·ûÄ·ûî·üí·ûö·ûæ·ûî·üí·ûö·û∂·ûü·üã",description:"·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûö·ûÑ·ûÇ·ûé·ûì·û∏·ûî·ûª·ûÇ·üí·ûÇ·ûõ·û∑·ûÄ ·ûì·û∑·ûÑ·ûü·û∑·ûë·üí·ûí·û∑·ûî·üí·ûö·ûæ·ûî·üí·ûö·û∂·ûü·üã",icon:"üë§",dataKey:"users",sheetName:"Users",primaryKeyField:"UserName",fields:[{name:"FullName",label:"·ûà·üí·ûò·üÑ·üá·ûñ·üÅ·ûâ",type:"text"},{name:"UserName",label:"·ûà·üí·ûò·üÑ·üá·ûÇ·ûé·ûì·û∏ (Login)",type:"text"},{name:"Password",label:"·ûñ·û∂·ûÄ·üí·ûô·ûü·ûò·üí·ûÑ·û∂·ûè·üã",type:"password"},{name:"Role",label:"·ûè·ûΩ·ûì·û∂·ûë·û∏ (Role)",type:"text"},{name:"Team",label:"·ûÄ·üí·ûö·ûª·ûò (Team)",type:"text"},{name:"ProfilePictureURL",label:"URL ·ûö·ûº·ûî·ûó·û∂·ûñ",type:"image_url"},{name:"IsSystemAdmin",label:"System Admin?",type:"checkbox"}],displayField:"FullName"},{id:"products",title:"·ûï·ûõ·û∑·ûè·ûï·ûõ",description:"·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûö·ûÑ·ûî·ûâ·üí·ûá·û∏·ûë·üÜ·ûì·û∑·ûâ ·ûè·ûò·üí·ûõ·üÉ ·ûì·û∑·ûÑ Barcode",icon:"üõçÔ∏è",dataKey:"products",sheetName:"Products",primaryKeyField:"ProductName",fields:[{name:"ProductName",label:"·ûà·üí·ûò·üÑ·üá·ûï·ûõ·û∑·ûè·ûï·ûõ",type:"text"},{name:"Barcode",label:"Barcode",type:"text"},{name:"Price",label:"·ûè·ûò·üí·ûõ·üÉ ($)",type:"number"},{name:"Cost",label:"·ûè·ûò·üí·ûõ·üÉ·ûä·ûæ·ûò ($)",type:"number"},{name:"ImageURL",label:"URL ·ûö·ûº·ûî·ûó·û∂·ûñ",type:"image_url"},{name:"Tags",label:"Tags (comma separated)",type:"text"}],displayField:"ProductName"},{id:"pages",title:"·ûÄ·üí·ûö·ûª·ûò & Page",description:"·ûÄ·üÜ·ûé·ûè·üã·ûà·üí·ûò·üÑ·üá·ûÄ·üí·ûö·ûª·ûò ·ûì·û∑·ûÑ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô Facebook Page",icon:"üë•",dataKey:"pages",sheetName:"TeamsPages",primaryKeyField:"PageName",fields:[{name:"PageName",label:"·ûà·üí·ûò·üÑ·üá Page",type:"text"},{name:"Team",label:"·ûÄ·üí·ûö·ûª·ûò",type:"text"},{name:"TelegramValue",label:"Telegram Value",type:"text"},{name:"PageLogoURL",label:"URL ·û°·ûº·û†·üí·ûÇ·üÑ",type:"image_url"}],displayField:"PageName"},{id:"shippingMethods",title:"·ûü·üÅ·ûú·û∂·ûä·ûπ·ûÄ·ûá·ûâ·üí·ûá·ûº·ûì",description:"·ûÄ·üÜ·ûé·ûè·üã·ûÄ·üí·ûö·ûª·ûò·û†·üä·ûª·ûì·ûä·ûπ·ûÄ·ûá·ûâ·üí·ûá·ûº·ûì ·ûì·û∑·ûÑ·ûõ·ûÄ·üí·ûÅ·ûÅ·ûé·üí·ûå·ûä·ûπ·ûÄ",icon:"üöö",dataKey:"shippingMethods",sheetName:"ShippingMethods",primaryKeyField:"MethodName",fields:[{name:"MethodName",label:"·ûà·üí·ûò·üÑ·üá·ûü·üÅ·ûú·û∂",type:"text"},{name:"RequireDriverSelection",label:"·ûè·üí·ûö·ûº·ûú·ûÄ·û∂·ûö·û¢·üí·ûì·ûÄ·ûä·ûπ·ûÄ?",type:"checkbox"},{name:"LogosURL",label:"URL ·û°·ûº·û†·üí·ûÇ·üÑ",type:"image_url"}],displayField:"MethodName"},{id:"drivers",title:"·û¢·üí·ûì·ûÄ·ûä·ûπ·ûÄ",description:"·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûö·ûÑ·ûñ·üê·ûè·üå·ûò·û∂·ûì·û¢·üí·ûì·ûÄ·ûä·ûπ·ûÄ·ûá·ûâ·üí·ûá·ûº·ûì·ûï·üí·ûë·û∂·ûõ·üã·ûÅ·üí·ûõ·ûΩ·ûì",icon:"üõµ",dataKey:"drivers",sheetName:"Drivers",primaryKeyField:"DriverName",fields:[{name:"DriverName",label:"·ûà·üí·ûò·üÑ·üá·û¢·üí·ûì·ûÄ·ûä·ûπ·ûÄ",type:"text"},{name:"ImageURL",label:"URL ·ûö·ûº·ûî·ûê·ûè",type:"image_url"}],displayField:"DriverName"},{id:"bankAccounts",title:"·ûÇ·ûé·ûì·û∏·ûí·ûì·û∂·ûÇ·û∂·ûö",description:"·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûö·ûÑ·ûî·ûâ·üí·ûá·û∏·ûí·ûì·û∂·ûÇ·û∂·ûö·ûü·ûò·üí·ûö·û∂·ûî·üã·ûë·ûë·ûΩ·ûõ·ûî·üí·ûö·û∂·ûÄ·üã",icon:"üè¶",dataKey:"bankAccounts",sheetName:"BankAccounts",primaryKeyField:"BankName",fields:[{name:"BankName",label:"·ûà·üí·ûò·üÑ·üá·ûí·ûì·û∂·ûÇ·û∂·ûö",type:"text"},{name:"LogoURL",label:"URL ·û°·ûº·û†·üí·ûÇ·üÑ",type:"image_url"}],displayField:"BankName"},{id:"phoneCarriers",title:"·ûÄ·üí·ûö·ûª·ûò·û†·üä·ûª·ûì·ûë·ûº·ûö·ûü·üê·ûñ·üí·ûë",description:"·ûÄ·üÜ·ûé·ûè·üã Prefixes ·ûö·ûî·ûü·üã·ûÄ·üí·ûö·ûª·ûò·û†·üä·ûª·ûì·ûë·ûº·ûö·ûü·üê·ûñ·üí·ûë",icon:"üì±",dataKey:"phoneCarriers",sheetName:"PhoneCarriers",primaryKeyField:"CarrierName",fields:[{name:"CarrierName",label:"·ûà·üí·ûò·üÑ·üá·ûÄ·üí·ûö·ûª·ûò·û†·üä·ûª·ûì",type:"text"},{name:"Prefixes",label:"Prefixes (·ûî·üÜ·ûî·üÇ·ûÄ·ûä·üÑ·ûô·ûÄ·üí·ûî·üÄ·ûü)",type:"text"},{name:"CarrierLogoURL",label:"URL ·û°·ûº·û†·üí·ûÇ·üÑ",type:"image_url"}],displayField:"CarrierName"}],je=(s,a)=>{if(!s||typeof s!="object"||!a)return;if(s[a]!==void 0)return s[a];const i=a.toLowerCase(),r=Object.keys(s).find(y=>y.toLowerCase()===i||y.toLowerCase().replace(/_/g,"")===i.replace(/_/g,""));return r?s[r]:void 0},Be=(s,a)=>{if(!s||typeof s!="object")return[];if(Array.isArray(s[a]))return s[a];const i=a.toLowerCase(),r=Object.keys(s).find(y=>y.toLowerCase()===i);if(r&&Array.isArray(s[r]))return s[r];if(a==="pages"){const y=Object.keys(s).find(g=>g.toLowerCase().includes("teampage")||g.toLowerCase().includes("page"));if(y&&Array.isArray(s[y]))return s[y]}return[]},Xt=({section:s,item:a,onClose:i,onSave:r})=>{const{refreshData:y}=o.useContext(le),[g,m]=o.useState({}),[b,l]=o.useState({}),[v,h]=o.useState(!1),[j,L]=o.useState(""),P=o.useRef({}),[A,N]=o.useState({});o.useEffect(()=>{if(a){const u={};s.fields.forEach(n=>{let p=je(a,n.name);p==null&&(p=n.type==="checkbox"?!1:n.type==="number"?0:""),u[n.name]=p}),s.id==="users"&&(u.Password=""),m(u)}else{const u=s.fields.reduce((n,p)=>(n[p.name]=p.type==="checkbox"?!1:p.type==="number"?0:"",n),{});m(u)}},[a,s]);const I=u=>{const{name:n,value:p,type:x,checked:t}=u.target;m(C=>({...C,[n]:x==="checkbox"?t:p}))},w=async(u,n)=>{if(n){l(p=>({...p,[u]:!0}));try{const p=await ot(n),x=await fetch(`${ne}/api/upload-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileData:p,fileName:n.name,mimeType:n.type})}),t=await x.json();if(!x.ok||t.status!=="success")throw new Error(t.message||"Upload failed");m(C=>({...C,[u]:t.url}))}catch(p){L(p.message)}finally{l(p=>({...p,[u]:!1}))}}},M=async()=>{L("");for(const u of s.fields)if(u.type!=="checkbox"&&(g[u.name]===void 0||g[u.name]==="")&&u.name!=="Password"&&!a){L(`·ûü·ûº·ûò·ûî·üÜ·ûñ·üÅ·ûâ·ûÖ·ûì·üí·ûõ·üÑ·üá "${u.label}"`);return}h(!0);try{const u=a?"/api/admin/update-sheet":"/api/admin/add-row",n={...g};s.fields.forEach(t=>{t.type==="number"&&(n[t.name]=Number(n[t.name]))}),a&&s.id==="users"&&!n.Password&&delete n.Password;const p={sheetName:s.sheetName,newData:n};if(a&&(p.primaryKey={[s.primaryKeyField]:je(a,s.primaryKeyField)}),!(await fetch(`${ne}${u}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)throw new Error("Save failed");await y(),r(g)}catch(u){L(u.message)}finally{h(!1)}};return e.jsxs(me,{isOpen:!0,onClose:i,maxWidth:"max-w-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-black text-white",children:[a?"·ûÄ·üÇ·ûü·ûò·üí·ûö·ûΩ·ûõ":"·ûî·ûì·üí·ûê·üÇ·ûò"," ",s.title]}),e.jsx("button",{onClick:i,className:"p-2 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"space-y-5 max-h-[65vh] overflow-y-auto pr-2 custom-scrollbar",children:s.fields.map(u=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-xs font-black text-gray-500 uppercase tracking-widest",children:u.label}),u.type==="checkbox"?e.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-3 rounded-xl border border-gray-700",children:[e.jsx("input",{type:"checkbox",name:u.name,checked:!!g[u.name],onChange:I,className:"h-6 w-6 rounded-lg border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"·ûî·ûæ·ûÄ·ûä·üÜ·ûé·ûæ·ûö·ûÄ·û∂·ûö·ûò·ûª·ûÅ·ûÑ·û∂·ûö·ûì·üÅ·üá"})]}):u.type==="image_url"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",name:u.name,value:g[u.name]||"",onChange:I,placeholder:"·ûî·û∑·ûë·ûó·üí·ûá·û∂·ûî·üã Link ·û¨ Upload ·ûö·ûº·ûî·ûó·û∂·ûñ",className:"form-input flex-grow !py-2.5"}),e.jsx("input",{type:"file",accept:"image/*",ref:n=>{P.current[u.name]=n},onChange:n=>n.target.files&&w(u.name,n.target.files[0]),className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>{var n;return(n=P.current[u.name])==null?void 0:n.click()},className:"p-2.5 bg-blue-600/10 text-blue-400 rounded-xl border border-blue-500/20 hover:bg-blue-600 hover:text-white transition-all",disabled:b[u.name],children:b[u.name]?e.jsx(se,{size:"sm"}):e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h14a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),g[u.name]&&e.jsx("div",{className:"relative w-32 h-32 bg-gray-900 rounded-2xl border border-gray-700 p-2 overflow-hidden shadow-inner mx-auto sm:mx-0",children:e.jsx("img",{src:pe(g[u.name]),className:"w-full h-full object-contain",alt:"preview"})})]}):u.type==="password"?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:A[u.name]?"text":"password",name:u.name,value:g[u.name]||"",onChange:I,className:"form-input !py-2.5 pr-12",placeholder:a?"·ûë·ûª·ûÄ·ûë·ûë·üÅ·ûî·ûæ·ûò·û∑·ûì·ûÖ·ûÑ·üã·ûî·üí·ûè·ûº·ûö":"·ûî·ûâ·üí·ûÖ·ûº·ûõ·ûñ·û∂·ûÄ·üí·ûô·ûü·ûò·üí·ûÑ·û∂·ûè·üã"}),e.jsx("button",{type:"button",onClick:()=>N(n=>({...n,[u.name]:!n[u.name]})),className:"absolute inset-y-0 right-0 px-4 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:A[u.name]?"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7 1.274-4.057 5.064-7 9.542-7 .847 0 1.67 .126 2.454 .364m-3.033 2.446a3 3 0 11-4.243 4.243m4.242-4.242l4.243 4.243M3 3l18 18":"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})})})]}):e.jsx("input",{type:u.type,name:u.name,value:g[u.name]||"",onChange:I,className:"form-input !py-2.5",readOnly:a&&u.name===s.primaryKeyField})]},u.name))}),j&&e.jsx("div",{className:"mt-4 p-3 bg-red-500/10 text-red-400 border border-red-500/20 rounded-xl text-sm font-bold",children:j}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-700/50",children:[e.jsx("button",{type:"button",onClick:i,className:"px-6 py-2.5 text-gray-400 hover:text-white font-bold transition-colors",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{type:"button",onClick:M,className:"btn btn-primary px-8 shadow-lg shadow-blue-600/20 active:scale-95",disabled:v,children:v?e.jsx(se,{size:"sm"}):"·ûö·ûÄ·üí·ûü·û∂·ûë·ûª·ûÄ"})]})]})},Zt=({isOpen:s,onClose:a,onConfirm:i,isProcessing:r})=>s?e.jsx(me,{isOpen:s,onClose:a,maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20 animate-pulse",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-xl font-black text-white mb-2 uppercase tracking-tight",children:"System Update"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-8 leading-relaxed",children:["·ûü·ûÄ·ûò·üí·ûò·ûó·û∂·ûñ·ûì·üÅ·üá·ûì·ûπ·ûÑ·ûè·ûò·üí·ûö·ûº·ûú·û±·üí·ûô·û¢·üí·ûì·ûÄ·ûî·üí·ûö·ûæ·ûî·üí·ûö·û∂·ûü·üã·ûë·û∂·üÜ·ûÑ·û¢·ûü·üã (All Users) ·ûÖ·û∂·ûÄ·ûÖ·üÅ·ûâ·ûñ·û∏·ûî·üí·ûö·ûñ·üê·ûì·üí·ûí (Log Out) ·ûä·ûæ·ûò·üí·ûî·û∏·ûí·üí·ûú·ûæ·ûî·ûÖ·üí·ûÖ·ûª·ûî·üí·ûî·ûì·üí·ûì·ûó·û∂·ûñ·üî",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"text-red-400 font-bold bg-red-900/20 px-2 py-1 rounded",children:"·ûè·ûæ·û¢·üí·ûì·ûÄ·ûî·üí·ûö·û∂·ûÄ·ûä·ûë·üÅ?"})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:a,className:"px-6 py-3 rounded-xl bg-gray-800 text-gray-400 font-bold hover:bg-gray-700 transition-all border border-gray-700",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{onClick:i,disabled:r,className:"px-6 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-500 transition-all flex items-center gap-2 shadow-lg shadow-red-900/20 active:scale-95 disabled:opacity-50",children:r?e.jsx(se,{size:"sm"}):"Confirm Update"})]})]})}):null,Qt=({onBack:s,initialSection:a})=>{const{appData:i,refreshData:r,logout:y,setMobilePageTitle:g}=o.useContext(le),[m,b]=o.useState(a||"users"),[l,v]=o.useState(a||null),[h,j]=o.useState({isOpen:!1,sectionId:"",item:null}),[L,P]=o.useState([]),[A,N]=o.useState(!1),[I,w]=o.useState(!1),[M,u]=o.useState(!1),n=window.innerWidth<768?l:m,p=Ke.find(d=>d.id===n);o.useEffect(()=>{const d=p?p.title:"·ûÄ·û∂·ûö·ûÄ·üÜ·ûé·ûè·üã";return g(d),()=>g(null)},[p,g]),o.useEffect(()=>{n==="users"&&(async()=>{if(Be(i,"users").length===0){const S=await(await fetch(`${ne}/api/users`)).json();S.status==="success"&&P(S.data||[])}})()},[n,i]);const x=o.useMemo(()=>{if(!p)return[];if(p.id==="users"){const d=Be(i,"users");return d.length>0?d:L}return Be(i,p.dataKey)},[p,i,L]),t=async(d,f)=>{if(window.confirm(`·ûè·ûæ·û¢·üí·ûì·ûÄ·ûî·üí·ûö·û∂·ûÄ·ûä·ûë·üÅ·ûê·û∂·ûÖ·ûÑ·üã·ûõ·ûª·ûî "${je(f,d.displayField)}"?`))try{await fetch(`${ne}/api/admin/delete-row`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:d.sheetName,primaryKey:{[d.primaryKeyField]:je(f,d.primaryKeyField)}})}),await r()}catch{alert("Delete failed")}},C=async()=>{u(!0);try{await fetch(`${ne}/api/admin/update-sheet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:"Settings",primaryKey:{Key:"SystemVersion"},newData:{Value:Date.now().toString(),Action:"ForceLogout"}})}),await new Promise(d=>setTimeout(d,2e3)),y(),window.location.reload()}catch(d){console.error(d),u(!1),alert("Update command failed. Check connection.")}};return n?e.jsxs("div",{className:"w-full max-w-[100rem] mx-auto p-4 lg:p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{window.innerWidth<768?v(null):s()},className:"md:hidden p-2 bg-gray-800 text-white rounded-xl border border-gray-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"hidden sm:flex text-2xl lg:text-3xl font-black text-white items-center gap-3",children:[e.jsx("span",{className:"hidden md:inline",children:p==null?void 0:p.icon}),p==null?void 0:p.title]}),e.jsx("p",{className:"text-xs lg:text-sm text-gray-500 font-bold uppercase tracking-[0.2em] mt-1",children:p==null?void 0:p.description})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>w(!0),className:"flex-1 sm:flex-none btn bg-gray-800 border border-gray-700 hover:border-red-500/50 hover:bg-red-900/10 hover:text-red-400 text-gray-400 px-4 transition-all flex items-center justify-center gap-2",title:"Update Version & Force Logout",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"hidden xl:inline text-xs font-bold uppercase tracking-wider",children:"Update Version"})]}),n==="pages"&&e.jsx("button",{onClick:()=>N(!0),className:"flex-1 sm:flex-none btn btn-secondary px-6",children:"PDF Export"}),e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:n,item:null}),className:"flex-1 sm:flex-none btn btn-primary px-10 shadow-lg shadow-blue-600/20 font-black",children:"+ ·ûî·ûì·üí·ûê·üÇ·ûò·ûê·üí·ûò·û∏"}),e.jsx("button",{onClick:s,className:"hidden md:flex btn btn-secondary px-6",children:"·ûè·üí·ûö·û°·ûî·üã"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("aside",{className:"hidden md:flex flex-col gap-2 w-72 flex-shrink-0",children:Ke.map(d=>e.jsxs("button",{onClick:()=>b(d.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all ${m===d.id?"bg-blue-600 text-white shadow-xl shadow-blue-600/20":"text-gray-400 hover:bg-gray-800 hover:text-gray-200"}`,children:[e.jsx("span",{className:"text-xl",children:d.icon}),e.jsx("span",{className:"font-black text-sm uppercase tracking-wider",children:d.title})]},d.id))}),e.jsx("main",{className:"flex-grow min-w-0",children:e.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-3xl overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"admin-table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-700",children:[e.jsx("th",{className:"w-12 text-center",children:"#"}),p==null?void 0:p.fields.map(d=>e.jsx("th",{children:d.label},d.name)),e.jsx("th",{className:"w-32 text-center uppercase tracking-widest text-[10px]",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/30",children:x.length>0?x.map((d,f)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group",children:[e.jsx("td",{className:"text-center text-gray-500 font-bold text-xs",children:f+1}),p==null?void 0:p.fields.map(c=>{const S=je(d,c.name);return e.jsx("td",{className:"py-4",children:c.type==="image_url"&&S?e.jsx("img",{src:pe(String(S)),className:"w-10 h-10 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1",alt:"logo"}):e.jsx("span",{className:`text-sm font-bold ${c.type==="password"?"text-gray-600":"text-gray-200"}`,children:c.type==="password"?"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢":typeof S=="boolean"?S?"‚úÖ Active":"‚ùå Inactive":String(S||"-")})},c.name)}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:n,item:d}),className:"p-2 bg-amber-500/10 text-amber-400 rounded-lg hover:bg-amber-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>t(p,d),className:"p-2 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},f)):e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"py-20 text-center text-gray-500 font-bold",children:"·ûò·û∑·ûì·ûò·û∂·ûì·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûè·üí·ûö·ûº·ûú·ûî·û∂·ûì·ûö·ûÄ·ûÉ·ûæ·ûâ·ûë·üÅ"})})})]})}),e.jsx("div",{className:"md:hidden divide-y divide-gray-700/50",children:x.length>0?x.map((d,f)=>{const c=je(d,(p==null?void 0:p.displayField)||""),S=p==null?void 0:p.fields.find(D=>D.type==="image_url"),k=S?je(d,S.name):null;return e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[k&&e.jsx("img",{src:pe(k),className:"w-12 h-12 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1 flex-shrink-0",alt:"logo"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-sm font-black text-white truncate",children:String(c||"-")}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase mt-0.5",children:["Item #",f+1]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:n,item:d}),className:"p-2.5 bg-gray-800 text-blue-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>t(p,d),className:"p-2.5 bg-gray-800 text-red-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},f)}):e.jsx("div",{className:"py-20 text-center text-gray-500 font-bold",children:"·ûò·û∑·ûì·ûò·û∂·ûì·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô"})})]})})]}),e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:n,item:null}),className:"md:hidden fixed bottom-24 right-6 w-16 h-16 bg-blue-600 text-white rounded-full shadow-2xl flex items-center justify-center active:scale-90 transition-transform z-40 border-4 border-gray-900",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})}),h.isOpen&&p&&e.jsx(Xt,{section:p,item:h.item,onClose:()=>j({...h,isOpen:!1}),onSave:()=>{j({...h,isOpen:!1}),r()}}),e.jsx(Zt,{isOpen:I,onClose:()=>w(!1),onConfirm:C,isProcessing:M}),A&&e.jsx(qt,{isOpen:A,onClose:()=>N(!1),pages:Be(i,"pages")})]}):e.jsxs("div",{className:"p-4 md:hidden animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden text-2xl font-black text-white",children:"·ûÄ·û∂·ûö·ûÄ·üÜ·ûé·ûè·üã"}),e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest mt-1",children:"Settings & Management"})]}),e.jsx("button",{onClick:s,className:"p-2 bg-gray-800 text-gray-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:Ke.map(d=>e.jsxs("button",{onClick:()=>v(d.id),className:"flex items-center gap-4 bg-gray-800/40 border border-gray-700/50 p-4 rounded-2xl hover:bg-gray-700/40 active:scale-[0.98] transition-all text-left",children:[e.jsx("span",{className:"text-3xl bg-gray-800 p-3 rounded-xl shadow-inner border border-gray-700",children:d.icon}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-base font-black text-white leading-tight",children:d.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-1",children:d.description})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 5l7 7-7 7"})})]},d.id))})]})},es=({isOpen:s,onClose:a,orders:i})=>{const[r,y]=o.useState("Page"),[g,m]=o.useState("a4"),[b,l]=o.useState("landscape"),[v,h]=o.useState(!1),[j,L]=o.useState({orderId:{label:"Order ID",visible:!0,width:25},date:{label:"Date",visible:!0,width:25},customer:{label:"Customer",visible:!0,width:35},phone:{label:"Phone",visible:!0,width:25},location:{label:"Location/Address",visible:!0,width:45},items:{label:"Items",visible:!0,width:50},total:{label:"Total ($)",visible:!0,width:20},status:{label:"Status",visible:!0,width:20},note:{label:"Note",visible:!1,width:30}}),P=N=>{L(I=>({...I,[N]:{...I[N],visible:!I[N].visible}}))},A=()=>{v||(h(!0),setTimeout(()=>{try{const N=new We({orientation:b,unit:"mm",format:g}),I=N.internal.pageSize.width;N.setFontSize(18),N.setTextColor(40,40,40),N.text("Orders Report",I/2,15,{align:"center"}),N.setFontSize(10),N.setTextColor(100,100,100),N.text(`Generated on: ${new Date().toLocaleString()}`,I/2,22,{align:"center"}),N.text(`Total Orders: ${i.length}`,I/2,27,{align:"center"});const w={};r==="None"?w["All Orders"]=i:i.forEach(p=>{const x=p[r]||"Unassigned";w[x]||(w[x]=[]),w[x].push(p)});const M=[Object.entries(j).filter(([p,x])=>x.visible).map(([p,x])=>x.label)];let u=35;if(Object.entries(w).sort().forEach(([p,x])=>{u>N.internal.pageSize.height-30&&(N.addPage(),u=20),r!=="None"&&(N.setFontSize(12),N.setTextColor(30,64,175),N.setFillColor(240,240,255),N.rect(14,u,I-28,8,"F"),N.text(`${r}: ${p} (${x.length} orders)`,16,u+5.5),u+=10);const t=x.map(d=>{const f=[];if(j.orderId.visible&&f.push(d["Order ID"]),j.date.visible&&f.push(new Date(d.Timestamp).toLocaleDateString()),j.customer.visible&&f.push(d["Customer Name"]),j.phone.visible&&f.push(d["Customer Phone"]),j.location.visible&&f.push(`${d.Location||""} - ${d["Address Details"]||""}`),j.items.visible){const c=d.Products.map(S=>`${S.quantity}x ${S.name}`).join(", ");f.push(c)}return j.total.visible&&f.push(`$${d["Grand Total"].toFixed(2)}`),j.status.visible&&f.push(d["Payment Status"]),j.note.visible&&f.push(d.Note||""),f}),C=x.reduce((d,f)=>d+f["Grand Total"],0);N.autoTable({startY:u,head:M,body:t,theme:"striped",headStyles:{fillColor:[43,53,72],textColor:[255,255,255]},styles:{fontSize:8,cellPadding:2,overflow:"linebreak"},margin:{top:20}}),u=N.lastAutoTable.finalY+2,r!=="None"?(N.setFontSize(10),N.setTextColor(80,80,80),N.text(`Subtotal: $${C.toFixed(2)}`,I-15,u+5,{align:"right"}),u+=12):u+=5}),r==="None"){const p=i.reduce((x,t)=>x+t["Grand Total"],0);N.setFontSize(12),N.setTextColor(0,0,0),N.text(`GRAND TOTAL: $${p.toFixed(2)}`,I-15,u+5,{align:"right"})}const n=N.internal.pages.length-1;for(let p=1;p<=n;p++)N.setPage(p),N.setFontSize(8),N.setTextColor(150),N.text(`Page ${p} of ${n}`,I/2,N.internal.pageSize.height-10,{align:"center"});N.save(`Orders_Report_${new Date().toISOString().slice(0,10)}.pdf`),h(!1),a()}catch(N){console.error("PDF Generation Error:",N),alert("Failed to generate PDF. Check console for details."),h(!1)}},100))};return e.jsxs(me,{isOpen:s,onClose:a,maxWidth:"max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"·ûë·û∂·ûâ·ûô·ûÄ·ûá·û∂ PDF (Export PDF)"]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"·ûÄ·û∂·ûö·ûÄ·üÜ·ûé·ûè·üã·ûë·ûº·ûë·üÖ (General)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"·ûë·üÜ·û†·üÜ (Size)"}),e.jsxs("select",{value:g,onChange:N=>m(N.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"a4",children:"A4"}),e.jsx("option",{value:"a3",children:"A3"}),e.jsx("option",{value:"letter",children:"Letter"}),e.jsx("option",{value:"legal",children:"Legal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"·ûë·û∑·ûü·ûä·üÖ"}),e.jsxs("select",{value:b,onChange:N=>l(N.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"portrait",children:"·ûî·ûâ·üí·ûà·ûö (Portrait)"}),e.jsx("option",{value:"landscape",children:"·ûî·üí·ûä·üÅ·ûÄ (Landscape)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Group By"}),e.jsxs("select",{value:r,onChange:N=>y(N.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"Page",children:"Page"}),e.jsx("option",{value:"Team",children:"Team"}),e.jsx("option",{value:"None",children:"None"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Columns"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Object.keys(j).map(N=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:j[N].visible,onChange:()=>P(N),className:"h-5 w-5 text-blue-600 rounded border-gray-500 bg-gray-900"}),e.jsx("span",{className:"text-sm text-gray-200",children:j[N].label})]},N))})]}),e.jsxs("div",{className:"flex justify-end pt-4 space-x-3 border-t border-gray-700",children:[e.jsx("button",{onClick:a,className:"btn btn-secondary",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{onClick:A,className:"btn btn-primary flex items-center shadow-lg",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"·ûÄ·üÜ·ûñ·ûª·ûÑ·ûä·üÜ·ûé·ûæ·ûö·ûÄ·û∂·ûö..."})]}):e.jsx(e.Fragment,{children:"·ûë·û∂·ûâ·ûô·ûÄ PDF"})})]})]})]})},ts=({selectedCount:s,isSidebarCollapsed:a,isProcessing:i,onVerify:r,onUnverify:y,onOpenModal:g,onClearSelection:m})=>{const b=a?"64px":"208px";return e.jsx("div",{className:"hidden md:flex fixed bottom-10 left-0 w-full z-[90] justify-center pointer-events-none transition-all duration-500",style:{paddingLeft:b},children:e.jsxs("div",{className:"relative bg-[#0f172a]/95 backdrop-blur-3xl border border-white/10 rounded-[3rem] shadow-[0_30px_70px_rgba(0,0,0,0.8)] p-3 flex items-center gap-6 overflow-hidden ring-1 ring-white/10 pointer-events-auto animate-fade-in-up",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3/4 h-full bg-blue-500/5 blur-[80px] pointer-events-none"}),e.jsxs("div",{className:"flex items-center gap-3.5 pl-5 relative z-10",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-black text-lg shadow-[0_0_25px_rgba(37,99,235,0.4)] animate-pulse-subtle border-2 border-white/10",children:s}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[13px] font-black text-white leading-none tracking-tight",children:"·ûá·üí·ûö·ûæ·ûü·ûö·ûæ·ûü"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"ACTIVE NODE"})]})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsxs("div",{className:"flex items-center bg-[#242f41] p-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsxs("button",{onClick:r,className:"px-6 py-2.5 bg-[#10b981] hover:bg-[#059669] text-white rounded-[1.4rem] text-[11px] font-black uppercase tracking-wider transition-all flex items-center gap-2 shadow-lg active:scale-95 disabled:opacity-50",disabled:i,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:4,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"VERIFY"]}),e.jsx("button",{onClick:y,className:"px-5 py-2.5 text-gray-400 hover:text-white text-[11px] font-black uppercase tracking-wider transition-all active:scale-95 disabled:opacity-50",disabled:i,children:"UNVERIFY"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-6 py-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsx("button",{onClick:()=>g("date"),className:"px-3.5 py-3 hover:text-white text-cyan-400 text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"DATE"}),e.jsx("button",{onClick:()=>g("cost"),className:"px-3.5 py-3 hover:text-white text-[#f6ad55] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"COST"}),e.jsx("button",{onClick:()=>g("payment"),className:"px-3.5 py-3 hover:text-white text-[#4299e1] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"PAY"}),e.jsx("button",{onClick:()=>g("shipping"),className:"px-3.5 py-3 hover:text-white text-[#9f7aea] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"SHIP"})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsx("div",{className:"pr-5 relative z-10",children:e.jsx("button",{onClick:()=>g("delete"),className:"px-6 py-3.5 bg-red-600/10 hover:bg-red-600 text-red-500 hover:text-white border border-red-500/20 rounded-[1.6rem] text-[12px] font-black transition-all active:scale-95 shadow-lg hover:shadow-red-900/20",children:"·ûõ·ûª·ûî·ûÖ·üÑ·ûõ"})}),e.jsx("button",{onClick:m,className:"absolute -top-12 left-1/2 -translate-x-1/2 px-4 py-1.5 bg-gray-800/80 backdrop-blur-md border border-white/10 rounded-full text-[9px] font-black text-gray-400 uppercase tracking-widest hover:text-white transition-all shadow-xl",children:"Clear Selection"})]})})},ss=({selectedCount:s,isProcessing:a,onVerify:i,onUnverify:r,onOpenModal:y,onClearSelection:g})=>e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 w-full z-[100] animate-slide-up",children:[e.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-xl border-t border-white/10 p-3 flex justify-between items-center shadow-2xl relative z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-black text-white text-sm shadow-lg shadow-blue-600/30",children:s}),e.jsx("span",{className:"text-xs font-bold text-gray-300",children:"items selected"})]}),e.jsx("button",{onClick:g,className:"text-[10px] font-black text-gray-500 uppercase tracking-widest bg-gray-800 px-3 py-1.5 rounded-lg border border-gray-700 active:scale-95",children:"Clear"})]}),e.jsx("div",{className:"bg-[#0f172a] p-3 pb-safe-bottom overflow-x-auto custom-scrollbar border-t border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-max",children:[e.jsxs("div",{className:"flex items-center bg-gray-800/50 p-1 rounded-xl border border-white/5",children:[e.jsxs("button",{onClick:i,disabled:a,className:"px-4 py-3 bg-emerald-600 text-white rounded-lg font-black text-[10px] uppercase tracking-wider flex items-center gap-1.5 active:scale-95 disabled:opacity-50",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"Verify"]}),e.jsx("button",{onClick:r,disabled:a,className:"px-4 py-3 text-gray-400 font-bold text-[10px] uppercase tracking-wider active:scale-95 disabled:opacity-50",children:"Unverify"})]}),e.jsxs("button",{onClick:()=>y("date"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"üìÖ"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Date"})]}),e.jsxs("button",{onClick:()=>y("cost"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"üí∞"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Cost"})]}),e.jsxs("button",{onClick:()=>y("payment"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"üí≥"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Pay"})]}),e.jsxs("button",{onClick:()=>y("shipping"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"üöö"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Ship"})]}),e.jsx("button",{onClick:()=>y("delete"),className:"px-4 py-3 bg-red-600/10 border border-red-500/20 text-red-500 rounded-xl font-black text-[10px] uppercase tracking-widest active:bg-red-600 active:text-white transition-colors",children:"Delete"})]})}),e.jsx("style",{children:`
                @keyframes slide-up {
                    from { transform: translateY(100%); }
                    to { transform: translateY(0); }
                }
                .animate-slide-up { animation: slide-up 0.3s ease-out forwards; }
                .pb-safe-bottom { padding-bottom: max(12px, env(safe-area-inset-bottom)); }
            `})]}),as=({orders:s,selectedIds:a,onComplete:i,onClearSelection:r})=>{var U,E;const{appData:y,currentUser:g,refreshData:m,isSidebarCollapsed:b}=o.useContext(le),[l,v]=o.useState(!1),[h,j]=o.useState(null),[L,P]=o.useState(""),[A,N]=o.useState(""),[I,w]=o.useState("Paid"),[M,u]=o.useState(""),[n,p]=o.useState(""),[x,t]=o.useState(""),[C,d]=o.useState(""),[f,c]=o.useState(""),S=async(O,W)=>{if(a.size!==0&&!(W&&!window.confirm(W))){v(!0);try{const q=Array.from(a);for(const oe of q){const ue=s.find(fe=>fe["Order ID"]===oe);if(!ue)continue;const Y={...ue,...O},ie={Timestamp:Y.Timestamp,"Order ID":Y["Order ID"],User:Y.User,Page:Y.Page,TelegramValue:Y.TelegramValue,"Customer Name":Y["Customer Name"],"Customer Phone":Y["Customer Phone"],Location:Y.Location,"Address Details":Y["Address Details"],Note:Y.Note||"","Shipping Fee (Customer)":Y["Shipping Fee (Customer)"],Subtotal:Y.Subtotal,"Grand Total":Y["Grand Total"],"Internal Shipping Method":Y["Internal Shipping Method"],"Internal Shipping Details":Y["Internal Shipping Details"],"Internal Cost":Number(Y["Internal Cost"])||0,"Payment Status":Y["Payment Status"],"Payment Info":Y["Payment Info"]||"","Discount ($)":Y["Discount ($)"],"Total Product Cost ($)":Y["Total Product Cost ($)"],"Fulfillment Store":Y["Fulfillment Store"],Team:Y.Team,"Scheduled Time":Y["Scheduled Time"]||"",IsVerified:Y.IsVerified};ie["Products (JSON)"]=JSON.stringify(Y.Products),await fetch(`${ne}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:oe,team:Y.Team,userName:g==null?void 0:g.UserName,newData:ie})})}await m(),j(null),i()}catch(q){console.error("Bulk update failed:",q),alert("·ûÄ·û∂·ûö·ûÄ·üÇ·ûü·ûò·üí·ûö·ûΩ·ûõ·ûî·ûö·û∂·ûá·üê·ûô!")}finally{v(!1)}}},k=async()=>{if(!(a.size===0||!A)){v(!0);try{const O=Array.from(a),[W,q,oe]=A.split("-").map(Number);for(const ue of O){const Y=s.find(he=>he["Order ID"]===ue);if(!Y)continue;const ie=new Date(Y.Timestamp),fe=new Date(W,q-1,oe,ie.getHours(),ie.getMinutes(),ie.getSeconds()),J={...Y,Timestamp:fe.toISOString()},Ne={Timestamp:J.Timestamp,"Order ID":J["Order ID"],User:J.User,Page:J.Page,TelegramValue:J.TelegramValue,"Customer Name":J["Customer Name"],"Customer Phone":J["Customer Phone"],Location:J.Location,"Address Details":J["Address Details"],Note:J.Note||"","Shipping Fee (Customer)":J["Shipping Fee (Customer)"],Subtotal:J.Subtotal,"Grand Total":J["Grand Total"],"Internal Shipping Method":J["Internal Shipping Method"],"Internal Shipping Details":J["Internal Shipping Details"],"Internal Cost":Number(J["Internal Cost"])||0,"Payment Status":J["Payment Status"],"Payment Info":J["Payment Info"]||"","Discount ($)":J["Discount ($)"],"Total Product Cost ($)":J["Total Product Cost ($)"],"Fulfillment Store":J["Fulfillment Store"],Team:J.Team,"Scheduled Time":J["Scheduled Time"]||"",IsVerified:J.IsVerified};Ne["Products (JSON)"]=JSON.stringify(J.Products),await fetch(`${ne}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:ue,team:J.Team,userName:g==null?void 0:g.UserName,newData:Ne})})}await m(),j(null),N(""),i()}catch(O){console.error("Bulk date update failed:",O),alert("·ûÄ·û∂·ûö·ûÄ·üÇ·ûî·üí·ûö·üÇ·ûÄ·û∂·ûõ·ûî·ûö·û∑·ûÖ·üí·ûÜ·üÅ·ûë·ûî·ûö·û∂·ûá·üê·ûô!")}finally{v(!1)}}},D=async()=>{if(a.size!==0){if(f!==(g==null?void 0:g.Password)){alert("·ûõ·üÅ·ûÅ·ûü·ûò·üí·ûÑ·û∂·ûè·üã·ûò·û∑·ûì·ûè·üí·ûö·ûπ·ûò·ûè·üí·ûö·ûº·ûú!");return}v(!0);try{const O=Array.from(a);for(const W of O){const q=s.find(oe=>oe["Order ID"]===W);await fetch(`${ne}/api/admin/delete-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:W,team:q==null?void 0:q.Team,userName:g==null?void 0:g.UserName,telegramMessageId1:q==null?void 0:q["Telegram Message ID 1"],telegramMessageId2:q==null?void 0:q["Telegram Message ID 2"],telegramChatId:q==null?void 0:q.TelegramValue})})}await m(),j(null),c(""),i()}catch{alert("·ûÄ·û∂·ûö·ûõ·ûª·ûî·ûî·ûö·û∂·ûá·üê·ûô!")}finally{v(!1)}}},T=(U=y.shippingMethods)==null?void 0:U.find(O=>O.MethodName===n),z=T==null?void 0:T.RequireDriverSelection;return a.size===0?null:e.jsxs(e.Fragment,{children:[!h&&e.jsxs(e.Fragment,{children:[e.jsx(ts,{selectedCount:a.size,isSidebarCollapsed:b,isProcessing:l,onVerify:()=>S({IsVerified:!0},`·ûî·ûâ·üí·ûá·û∂·ûÄ·üã·ûõ·ûæ·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã·ûë·û∂·üÜ·ûÑ ${a.size} ·ûì·üÅ·üá?`),onUnverify:()=>S({IsVerified:!1}),onOpenModal:j,onClearSelection:r}),e.jsx(ss,{selectedCount:a.size,isProcessing:l,onVerify:()=>S({IsVerified:!0},`·ûî·ûâ·üí·ûá·û∂·ûÄ·üã·ûõ·ûæ·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã·ûë·û∂·üÜ·ûÑ ${a.size} ·ûì·üÅ·üá?`),onUnverify:()=>S({IsVerified:!1}),onOpenModal:j,onClearSelection:r})]}),e.jsx(me,{isOpen:h==="date",onClose:()=>j(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-cyan-500/20 text-cyan-400 rounded-full flex items-center justify-center mx-auto mb-6 border border-cyan-500/30",children:e.jsx("span",{className:"text-3xl",children:"üìÖ"})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-2 uppercase tracking-tight",children:"·ûÄ·üÇ·ûî·üí·ûö·üÇ·ûÄ·û∂·ûõ·ûî·ûö·û∑·ûÖ·üí·ûÜ·üÅ·ûë"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold text-center mb-6 uppercase tracking-widest",children:"·ûò·üâ·üÑ·ûÑ·ûì·ûπ·ûÑ·ûö·ûÄ·üí·ûü·û∂·ûë·ûª·ûÄ·ûä·ûº·ûÖ·ûä·ûæ·ûò (Time Unchanged)"}),e.jsx("div",{className:"relative mb-8",children:e.jsx("input",{type:"date",value:A,onChange:O=>N(O.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 text-white font-bold text-center rounded-[2rem] focus:ring-4 focus:ring-cyan-500/10 transition-all w-full"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{onClick:k,className:"py-4 bg-cyan-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-cyan-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:l||!A,children:l?e.jsx(se,{size:"sm"}):"·ûö·ûÄ·üí·ûü·û∂·ûë·ûª·ûÄ"})]})]})}),e.jsx(me,{isOpen:h==="cost",onClose:()=>j(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("h3",{className:"text-xl font-black text-white text-center mb-8 uppercase tracking-tight",children:"·ûÄ·üÇ·ûî·üí·ûö·üÇ·ûê·üí·ûõ·üÉ·ûä·ûπ·ûÄ·ûä·ûæ·ûò (Cost)"}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("input",{type:"number",step:"0.01",value:L,onChange:O=>P(O.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-6 text-blue-400 font-black text-4xl text-center rounded-[2rem] focus:ring-4 focus:ring-blue-500/10 transition-all",placeholder:"0.00",autoFocus:!0}),e.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 text-gray-600 font-black text-2xl",children:"$"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{onClick:()=>S({"Internal Cost":Number(L)}),className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-blue-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:l||!L,children:l?e.jsx(se,{size:"sm"}):"·ûö·ûÄ·üí·ûü·û∂·ûë·ûª·ûÄ"})]})]})}),e.jsx(me,{isOpen:h==="payment",onClose:()=>j(null),maxWidth:"max-w-lg",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 overflow-hidden flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600/20 rounded-xl flex items-center justify-center border border-blue-500/30",children:e.jsx("span",{className:"text-xl",children:"üí≥"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter",children:"·ûÄ·üÇ·ûî·üí·ûö·üÇ·ûü·üí·ûê·û∂·ûì·ûó·û∂·ûñ·ûë·ûº·ûë·û∂·ûè·üã"})]}),e.jsxs("div",{className:"flex p-1.5 bg-black/40 rounded-2xl border border-gray-700 mb-6",children:[e.jsxs("button",{onClick:()=>{w("Paid")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${I==="Paid"?"bg-emerald-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"PAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(·ûë·ûº·ûë·û∂·ûè·üã·ûö·ûΩ·ûÖ·ûö·û∂·ûõ·üã)"})]}),e.jsxs("button",{onClick:()=>{w("Unpaid"),u("")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${I==="Unpaid"?"bg-red-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"UNPAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(·ûò·û∑·ûì·ûë·û∂·ûì·üã·ûë·ûº·ûë·û∂·ûè·üã - COD)"})]})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-1",children:I==="Paid"?e.jsxs("div",{className:"space-y-4 animate-fade-in-down pb-4",children:[e.jsxs("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"·ûá·üí·ûö·ûæ·ûü·ûö·ûæ·ûü·ûÇ·ûé·ûì·û∏·ûí·ûì·û∂·ûÇ·û∂·ûö"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:(E=y.bankAccounts)==null?void 0:E.map(O=>{const W=M===O.BankName;return e.jsxs("button",{onClick:()=>u(O.BankName),className:`flex items-center gap-4 p-4 rounded-2xl border transition-all duration-200 group ${W?"bg-blue-600/20 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.2)]":"bg-gray-800/40 border-white/5 hover:bg-gray-800 hover:border-white/20"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${W?"bg-black/40":"bg-black/20"}`,children:e.jsx("img",{src:pe(O.LogoURL),className:"w-7 h-7 object-contain",alt:""})}),e.jsx("span",{className:`text-xs font-black w-full text-left whitespace-normal leading-tight ${W?"text-white":"text-gray-400 group-hover:text-gray-200"}`,children:O.BankName}),W&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 shadow-[0_0_8px_#3b82f6]"})]},O.BankName)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center opacity-50 space-y-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-900/20 flex items-center justify-center border border-red-500/20",children:e.jsx("span",{className:"text-3xl grayscale",children:"üì¶"})}),e.jsx("p",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"·ûÄ·û∂·ûö·ûë·ûº·ûë·û∂·ûè·üã·ûì·ûπ·ûÑ·ûè·üí·ûö·ûº·ûú·ûí·üí·ûú·ûæ·û°·ûæ·ûÑ·ûñ·üÅ·ûõ·ûä·ûπ·ûÄ·ûä·ûõ·üã"})]})}),e.jsxs("div",{className:"flex-shrink-0 grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/10",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors bg-gray-800/50 rounded-2xl hover:bg-gray-800",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{onClick:()=>S({"Payment Status":I,"Payment Info":I==="Paid"?M:""}),className:"py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2",disabled:l||I==="Paid"&&!M,children:l?e.jsx(se,{size:"sm"}):"·ûö·ûÄ·üí·ûü·û∂·ûë·ûª·ûÄ·ûÄ·û∂·ûö·ûï·üí·ûõ·û∂·ûü·üã·ûî·üí·ûè·ûº·ûö"})]})]})}),e.jsx(me,{isOpen:h==="shipping",onClose:()=>j(null),maxWidth:"max-w-xl",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 max-h-[85vh] flex flex-col",children:[e.jsx("h3",{className:"text-lg font-black text-white text-center mb-6 uppercase tracking-tight flex-shrink-0",children:"·ûÄ·üÇ·ûî·üí·ûö·üÇ·ûÄ·üí·ûö·ûª·ûò·û†·üä·ûª·ûì·ûä·ûπ·ûÄ·ûá·ûâ·üí·ûá·ûº·ûì"}),e.jsxs("div",{className:"space-y-6 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"·ûá·üí·ûö·ûæ·ûü·ûö·ûæ·ûü·ûü·üÅ·ûú·û∂·ûä·ûπ·ûÄ"}),e.jsx(bt,{methods:y.shippingMethods||[],selectedMethodName:n,onSelect:O=>{p(O.MethodName),t("")}})]}),z&&e.jsxs("div",{className:"space-y-3 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("div",{className:"h-4 w-1 bg-blue-500 rounded-full"}),e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]",children:"·ûá·üí·ûö·ûæ·ûü·ûö·ûæ·ûü·û¢·üí·ûì·ûÄ·ûä·ûπ·ûÄ (DriverSelection)*"})]}),e.jsx(ft,{drivers:y.drivers||[],selectedDriverName:x,onSelect:t}),!x&&e.jsx("p",{className:"text-center text-[9px] text-gray-500 italic",children:"·ûü·ûº·ûò·ûá·üí·ûö·ûæ·ûü·ûö·ûæ·ûü·û¢·üí·ûì·ûÄ·ûä·ûπ·ûÄ·ûò·üí·ûì·û∂·ûÄ·üã"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"·ûÄ·üÇ·ûî·üí·ûö·üÇ·ûê·üí·ûõ·üÉ·ûä·ûπ·ûÄ·ûä·ûæ·ûò (Internal Cost)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",value:C,onChange:O=>d(O.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 pl-4 pr-10 rounded-2xl font-black text-white focus:border-blue-500",placeholder:"·ûî·ûâ·üí·ûÖ·ûº·ûõ·ûê·üí·ûõ·üÉ·ûä·ûπ·ûÄ·ûê·üí·ûò·û∏ (·ûî·ûæ·ûò·û∂·ûì)"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"})]}),e.jsx("div",{className:"flex gap-2",children:[0,1.25,1.5,2].map(O=>e.jsxs("button",{onClick:()=>d(String(O)),className:"flex-1 py-2 bg-gray-800 border border-gray-700 rounded-xl text-[10px] font-bold text-gray-400 hover:text-white hover:bg-gray-700 transition-all",children:["$",O]},O))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6 pt-4 border-t border-white/5 flex-shrink-0",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{onClick:()=>{const O={"Internal Shipping Method":n};z?O["Internal Shipping Details"]=x:O["Internal Shipping Details"]=n,C&&(O["Internal Cost"]=Number(C)),S(O)},className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l||!n||z&&!x,children:l?e.jsx(se,{size:"sm"}):"·ûö·ûÄ·üí·ûü·û∂·ûë·ûª·ûÄ"})]})]})}),e.jsx(me,{isOpen:h==="delete",onClose:()=>j(null),maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-4 uppercase tracking-tight",children:"·ûõ·ûª·ûî·ûî·üí·ûö·ûè·û∑·ûî·ûè·üí·ûè·û∑·ûÄ·û∂·ûö·ûé·üç·ûü·ûö·ûª·ûî"}),e.jsxs("p",{className:"text-center text-gray-500 text-sm mb-8",children:["·ûè·ûæ·û¢·üí·ûì·ûÄ·ûî·üí·ûö·û∂·ûÄ·ûä·ûë·üÅ·ûê·û∂·ûÖ·ûÑ·üã·ûõ·ûª·ûî·ûÄ·û∂·ûö·ûÄ·ûò·üí·ûò·ûÑ·üã·ûë·û∂·üÜ·ûÑ ",e.jsx("strong",{children:a.size})," ·ûì·üÅ·üá? ·ûü·ûÄ·ûò·üí·ûò·ûó·û∂·ûñ·ûì·üÅ·üá·ûò·û∑·ûì·û¢·û∂·ûÖ·ûè·üí·ûö·û°·ûî·üã·ûÄ·üí·ûö·üÑ·ûô·ûî·û∂·ûì·ûë·üÅ·üî"]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-600 uppercase tracking-widest ml-1",children:"·ûî·ûâ·üí·ûÖ·ûº·ûõ·ûñ·û∂·ûÄ·üí·ûô·ûü·ûò·üí·ûÑ·û∂·ûè·üã·ûä·ûæ·ûò·üí·ûî·û∏·ûî·ûâ·üí·ûá·û∂·ûÄ·üã"}),e.jsx("input",{type:"password",value:f,onChange:O=>c(O.target.value),className:"form-input !bg-red-500/5 !border-red-500/20 !py-4 text-center text-white font-black tracking-widest",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest",children:"·ûî·üÑ·üá·ûî·ûÑ·üã"}),e.jsx("button",{onClick:D,className:"py-4 bg-red-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-red-900/40 active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l||!f,children:l?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:"sm"}),e.jsx("span",{children:"·ûÄ·üÜ·ûñ·ûª·ûÑ·ûõ·ûª·ûî..."})]}):"·ûî·û∂·ûë, ·ûõ·ûª·ûî·ûë·û∂·üÜ·ûÑ·û¢·ûü·üã"})]})]})}),e.jsx("style",{children:`
                @keyframes pulse-subtle {
                    0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(37,99,235,0.2); }
                    50% { transform: scale(1.05); box-shadow: 0 0 35px rgba(37,99,235,0.4); }
                }
                .animate-pulse-subtle {
                    animation: pulse-subtle 2s infinite ease-in-out;
                }
            `})]})},qe=[{key:"index",label:"#"},{key:"orderId",label:"ID"},{key:"customerName",label:"·ûà·üí·ûò·üÑ·üá·û¢·ûè·û∑·ûê·û∑·ûá·ûì"},{key:"productInfo",label:"·ûñ·üê·ûè·üå·ûò·û∂·ûì Product"},{key:"location",label:"·ûë·û∏·ûè·û∂·üÜ·ûÑ"},{key:"pageInfo",label:"Page"},{key:"fulfillment",label:"·ûÉ·üí·ûõ·û∂·üÜ·ûÑ (Fulfillment)"},{key:"total",label:"·ûü·ûö·ûª·ûî"},{key:"shippingService",label:"·ûü·üÅ·ûú·û∂·ûä·ûπ·ûÄ"},{key:"shippingCost",label:"(Cost) ·ûü·üÅ·ûú·û∂·ûä·ûπ·ûÄ"},{key:"status",label:"·ûü·üí·ûê·û∂·ûì·ûó·û∂·ûñ"},{key:"date",label:"·ûÄ·û∂·ûõ·ûî·ûö·û∑·ûÖ·üí·ûÜ·üÅ·ûë & ·ûò·üâ·üÑ·ûÑ"},{key:"print",label:"·ûñ·üí·ûö·û∏·ûì"},{key:"actions",label:"·ûü·ûÄ·ûò·üí·ûò·ûó·û∂·ûñ"},{key:"check",label:"Check"}],rs=({visibleColumns:s,onToggle:a,columns:i=qe})=>{const[r,y]=o.useState(!1),g=o.useRef(null);return o.useEffect(()=>{const m=b=>{g.current&&!g.current.contains(b.target)&&y(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),e.jsxs("div",{className:"relative inline-block text-left h-full",ref:g,children:[e.jsxs("button",{onClick:()=>y(!r),className:"flex h-full items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M5 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM9 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM13 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM17 4a1 1 0 00-2 0v12a1 1 0 002 0V4z"})}),"Columns",e.jsx("svg",{className:`h-3.5 w-3.5 ml-1 transition-transform duration-500 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 9l-7 7-7-7",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})]}),r&&e.jsx("div",{className:"absolute right-0 mt-3 w-64 bg-[#1a2235]/95 border border-white/10 rounded-[1.8rem] shadow-[0_30px_70px_rgba(0,0,0,0.7)] z-[100] origin-top-right overflow-hidden backdrop-blur-3xl p-3 animate-fade-in-scale",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-[0.2em] px-3 py-2 mb-1",children:"·ûÄ·üÜ·ûé·ûè·üã·ûÄ·û∂·ûö·ûî·ûÑ·üí·û†·û∂·ûâ"}),i.map(m=>e.jsxs("label",{className:"flex items-center px-3 py-2 text-xs text-gray-300 hover:bg-white/5 rounded-xl cursor-pointer transition-colors group",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded-md border-gray-600 bg-gray-900 text-blue-500 focus:ring-blue-500/20",checked:s.has(m.key),onChange:()=>a(m.key)}),e.jsx("span",{className:"ml-3 font-bold group-hover:text-white transition-colors",children:m.label})]},m.key))]})})]})},ns=({isOpen:s,onClose:a,children:i})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`filter-panel-overlay fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] transition-opacity duration-500 ${s?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),e.jsxs("div",{className:`filter-panel fixed right-0 top-0 h-full w-[85%] max-w-md bg-[#0f172a] z-[80] shadow-2xl border-l border-white/5 transition-transform duration-500 flex flex-col ${s?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-black/20",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter italic",children:"Filter Engine"}),e.jsx("button",{onClick:a,className:"p-2 bg-white/5 rounded-xl text-gray-400 hover:text-white transition-all",children:"√ó"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow custom-scrollbar space-y-8",children:i}),e.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20",children:e.jsx("button",{onClick:a,className:"btn btn-primary w-full py-4 text-sm font-black uppercase tracking-[0.2em] shadow-xl shadow-blue-900/20 rounded-2xl active:scale-95 transition-transform",children:"Apply Configuration"})})]})]}),ls=({onBack:s,initialFilters:a})=>{const{appData:i,refreshData:r,refreshTimestamp:y,currentUser:g,setMobilePageTitle:m}=o.useContext(le),[b,l]=G("editOrder","");o.useEffect(()=>(m("·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûö·ûÑ·ûî·üí·ûö·ûè·û∑·ûî·ûè·üí·ûè·û∑·ûÄ·û∂·ûö·ûé·üç"),()=>m(null)),[m]);const[v,h]=G("teamFilter",""),[j,L]=G("dateFilter","this_month"),[P,A]=G("locationFilter",""),[N,I]=G("storeFilter",""),[w,M]=G("startDate",""),[u,n]=G("endDate",""),[p,x]=G("shippingFilter",""),[t,C]=G("driverFilter",""),[d,f]=G("brandFilter",""),[c,S]=G("paymentFilter",""),[k,D]=G("userFilter",""),[T,z]=G("pageFilter",""),[U,E]=G("costFilter",""),[O,W]=G("bankFilter",""),[q,oe]=G("productFilter",""),[ue,Y]=G("customerFilter",""),[ie,fe]=o.useState(()=>{const $=qe||[];return new Set($.filter(B=>B.key!=="productInfo"&&B.key!=="print"&&B.key!=="check"&&B.key!=="fulfillment").map(B=>B.key))}),[J,Ne]=o.useState([]),[he,Ve]=o.useState([]),[ze,Fe]=o.useState(!0),[De,Ee]=o.useState(0),[Pe,Le]=o.useState(null),[Me,ve]=o.useState(!1),[Re,ge]=o.useState(!1),[ke,Ge]=o.useState(""),[$e,ye]=o.useState(new Set),[F,Te]=o.useState(()=>{const $=new URLSearchParams(window.location.search);return{datePreset:(a==null?void 0:a.datePreset)||$.get("dateFilter")||"this_month",startDate:(a==null?void 0:a.startDate)||$.get("startDate")||"",endDate:(a==null?void 0:a.endDate)||$.get("endDate")||"",team:(a==null?void 0:a.team)||$.get("teamFilter")||"",location:(a==null?void 0:a.location)||$.get("locationFilter")||"",fulfillmentStore:(a==null?void 0:a.fulfillmentStore)||$.get("storeFilter")||"",store:(a==null?void 0:a.store)||$.get("brandFilter")||"",shippingService:(a==null?void 0:a.shippingService)||$.get("shippingFilter")||"",driver:(a==null?void 0:a.driver)||$.get("driverFilter")||"",paymentStatus:(a==null?void 0:a.paymentStatus)||$.get("paymentFilter")||"",user:(a==null?void 0:a.user)||$.get("userFilter")||"",page:(a==null?void 0:a.page)||$.get("pageFilter")||"",internalCost:(a==null?void 0:a.internalCost)||$.get("costFilter")||"",bank:(a==null?void 0:a.bank)||$.get("bankFilter")||"",product:(a==null?void 0:a.product)||$.get("productFilter")||"",customerName:(a==null?void 0:a.customerName)||$.get("customerFilter")||""}});o.useEffect(()=>{F.team!==v&&h(F.team),F.datePreset!==j&&L(F.datePreset),F.location!==P&&A(F.location),F.fulfillmentStore!==N&&I(F.fulfillmentStore),F.startDate!==w&&M(F.startDate),F.endDate!==u&&n(F.endDate),F.shippingService!==p&&x(F.shippingService),F.driver!==t&&C(F.driver),F.store!==d&&f(F.store),F.paymentStatus!==c&&S(F.paymentStatus),F.user!==k&&D(F.user),F.page!==T&&z(F.page),F.internalCost!==U&&E(F.internalCost),F.bank!==O&&W(F.bank),F.product!==q&&oe(F.product),F.customerName!==ue&&Y(F.customerName)},[F,v,j,P,N,w,u,p,t,d,c,k,T,U,O,q,ue]);const Se=o.useMemo(()=>{const $=new Date,B=new Date($.getFullYear(),$.getMonth(),$.getDate());let R=null,H=new Date;switch(F.datePreset){case"today":R=B;break;case"yesterday":R=new Date(B),R.setDate(B.getDate()-1),H=new Date(B),H.setMilliseconds(-1);break;case"this_week":const X=$.getDay();R=new Date(B),R.setDate(B.getDate()-(X===0?6:X-1));break;case"last_week":R=new Date(B),R.setDate(B.getDate()-$.getDay()-6),H=new Date(R),H.setDate(R.getDate()+6),H.setHours(23,59,59);break;case"this_month":R=new Date($.getFullYear(),$.getMonth(),1);break;case"last_month":R=new Date($.getFullYear(),$.getMonth()-1,1),H=new Date($.getFullYear(),$.getMonth(),0,23,59,59);break;case"this_year":R=new Date($.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${F.startDate||"..."} to ${F.endDate||"..."}`}const ee=X=>{const Z=X.getFullYear(),Q=String(X.getMonth()+1).padStart(2,"0"),de=String(X.getDate()).padStart(2,"0");return`${Z}-${Q}-${de}`};return R?`${ee(R)} to ${ee(H)}`:"All time data stream"},[F.datePreset,F.startDate,F.endDate]),Ze=$=>{fe(B=>{const R=new Set(B);return R.has($)?R.size>1&&R.delete($):R.add($),R})},Oe=async $=>{let R=[];for(let H=0;H<$.length;H+=500){const X=$.slice(H,H+500).map(Z=>{let Q=[];try{Z["Products (JSON)"]&&(Q=JSON.parse(Z["Products (JSON)"]))}catch{}return{...Z,Products:Q,IsVerified:String(Z.IsVerified).toUpperCase()==="TRUE"}});R=[...R,...X],Ee(Math.round((H+500)/$.length*100)),await new Promise(Z=>setTimeout(Z,0))}return R},_=$=>{const B=$.Timestamp;if(!B)return 0;const R=B.match(/^(\d{4})-(\d{1,2})-(\d{1,2})\s(\d{1,2}):(\d{2})/);return R?new Date(parseInt(R[1]),parseInt(R[2])-1,parseInt(R[3]),parseInt(R[4]),parseInt(R[5])).getTime():new Date(B).getTime()},K=async()=>{Fe(!0),Ee(0),Le(null);try{const[$,B]=await Promise.all([fetch(`${ne}/api/admin/all-orders`),fetch(`${ne}/api/users`)]),R=await $.json(),H=await B.json();if(R.status==="success"){const ee=(R.data||[]).filter(Z=>Z!==null&&Z["Order ID"]!=="Opening Balance"&&Z["Order ID"]!=="Opening_Balance"),X=await Oe(ee);Ne(X.sort((Z,Q)=>_(Q)-_(Z)))}else Le(R.message||"Failed to load orders");H.status==="success"&&Ve(H.data||[])}catch($){console.error("Fetch Error:",$),Le("·ûò·û∑·ûì·û¢·û∂·ûÖ·ûë·û∂·ûâ·ûô·ûÄ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûî·û∂·ûì·ûë·üÅ·üî ·ûü·ûº·ûò·ûñ·û∑·ûì·û∑·ûè·üí·ûô Internet ·ûö·ûî·ûü·üã·û¢·üí·ûì·ûÄ·üî")}finally{Fe(!1)}};o.useEffect(()=>{K()},[y]);const V=o.useMemo(()=>J.map($=>{var R;let B=($.Team||"").trim();if(!B){const H=he.find(ee=>ee.UserName===$.User);if(H!=null&&H.Team)B=H.Team.split(",")[0].trim();else{const ee=(R=i.pages)==null?void 0:R.find(X=>X.PageName===$.Page);ee!=null&&ee.Team&&(B=ee.Team)}}return{...$,Team:B||"Unassigned"}}),[J,he,i.pages]),re=o.useMemo(()=>V.filter($=>{var R;if(F.datePreset!=="all"){const H=_($),ee=new Date(H),X=new Date,Z=new Date(X.getFullYear(),X.getMonth(),X.getDate());let Q=null,de=null;switch(F.datePreset){case"today":Q=Z;break;case"yesterday":Q=new Date(Z),Q.setDate(Z.getDate()-1),de=new Date(Z),de.setMilliseconds(-1);break;case"this_week":const Qe=X.getDay();Q=new Date(Z),Q.setDate(Z.getDate()-(Qe===0?6:Qe-1));break;case"last_week":Q=new Date(Z),Q.setDate(Z.getDate()-X.getDay()-6),de=new Date(Q),de.setDate(Q.getDate()+6),de.setHours(23,59,59);break;case"this_month":Q=new Date(X.getFullYear(),X.getMonth(),1);break;case"last_month":Q=new Date(X.getFullYear(),X.getMonth()-1,1),de=new Date(X.getFullYear(),X.getMonth(),0,23,59,59);break;case"this_year":Q=new Date(X.getFullYear(),0,1);break;case"custom":F.startDate&&(Q=new Date(F.startDate+"T00:00:00")),F.endDate&&(de=new Date(F.endDate+"T23:59:59"));break}if(Q&&ee<Q||de&&ee>de)return!1}const B=(H,ee)=>{if(!H)return!0;const X=H.split(",").map(Q=>Q.trim().toLowerCase()),Z=(ee||"").trim().toLowerCase();return X.includes(Z)};if(!B(F.fulfillmentStore,$["Fulfillment Store"]||"Unassigned"))return!1;if(F.store){const H=(R=i.pages)==null?void 0:R.find(Z=>Z.PageName===$.Page),ee=H?H.DefaultStore:null,X=F.store.split(",");if(!ee||!X.includes(ee))return!1}if(!B(F.team,$.Team)||!B(F.user,$.User||"")||!B(F.paymentStatus,$["Payment Status"])||!B(F.shippingService,$["Internal Shipping Method"])||!B(F.driver,$["Internal Shipping Details"])||!B(F.bank,$["Payment Info"])||!B(F.page,$.Page)||!B(F.location,$.Location)||!B(F.internalCost,String($["Internal Cost"]))||!B(F.customerName,$["Customer Name"])||F.product&&!$.Products.some(H=>H.name===F.product))return!1;if(ke.trim()){const H=ke.toLowerCase();return $["Order ID"].toLowerCase().includes(H)||($["Customer Name"]||"").toLowerCase().includes(H)||($["Customer Phone"]||"").includes(H)}return!0}),[V,F,ke,i.pages]),te=$=>{ye(B=>{const R=new Set(B);return R.has($)?R.delete($):R.add($),R})},ce=$=>{const B=$.length>0&&$.every(R=>$e.has(R));ye(B?R=>{const H=new Set(R);return $.forEach(ee=>H.delete(ee)),H}:R=>new Set([...R,...$]))};if(ze)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-5",children:[e.jsx(se,{size:"lg"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-500 uppercase tracking-[0.4em] animate-pulse",children:"Syncing Operational Logs..."}),De>0&&e.jsx("div",{className:"w-48 h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${De}%`}})})]})]});if(Pe)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-6 p-6 text-center bg-gray-900/50 rounded-[3rem] border border-red-500/20 m-6 animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-2xl flex items-center justify-center border border-red-500/30 shadow-xl",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight",children:"·ûÄ·üÜ·û†·ûª·ûü·ûë·û∂·ûâ·ûô·ûÄ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô"}),e.jsx("p",{className:"text-gray-500 font-bold max-w-md",children:Pe})]}),e.jsx("button",{onClick:K,className:"btn btn-primary px-10 py-4 shadow-lg shadow-blue-600/20",children:"·ûñ·üí·ûô·û∂·ûô·û∂·ûò·ûò·üí·ûä·ûÑ·ûë·üÄ·ûè"})]});if(b){const $=V.find(B=>B["Order ID"]===b);return $?e.jsx(vt,{order:$,onSaveSuccess:()=>{l(""),K(),r()},onCancel:()=>l("")}):e.jsx("div",{className:"p-20 text-center text-gray-500 font-black uppercase italic tracking-widest",children:"·ûö·ûÄ·ûò·û∑·ûì·ûÉ·ûæ·ûâ Order ID ·ûì·üÅ·üá·ûë·üÅ"})}return e.jsxs("div",{className:"w-full max-w-full mx-auto px-3 sm:px-6 lg:px-8 animate-fade-in relative pb-40 pt-6 overflow-x-hidden",children:[e.jsx("div",{className:"md:hidden",children:e.jsx(ns,{isOpen:Me,onClose:()=>ve(!1),children:e.jsx(Je,{filters:F,setFilters:Te,orders:V,usersList:he,appData:i,calculatedRange:Se})})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(me,{isOpen:Me,onClose:()=>ve(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>ve(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"√ó"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(Je,{filters:F,setFilters:Te,orders:V,usersList:he,appData:i,calculatedRange:Se})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>ve(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end mb-10 gap-6 px-1",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden md:block text-3xl lg:text-5xl font-black text-white italic tracking-tighter leading-relaxed mb-3 py-1",children:"·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûö·ûÑ·ûî·üí·ûö·ûè·û∑·ûî·ûè·üí·ûè·û∑·ûÄ·û∂·ûö·ûé·üç"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600/10 rounded-full border border-blue-500/20",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("span",{className:"text-[11px] font-black text-blue-400 uppercase tracking-widest",children:[re.length," Entries Logged"]})]})})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:s,className:"hidden md:flex group items-center gap-3 px-8 py-4 bg-gray-800/40 backdrop-blur-xl border border-white/5 hover:border-blue-500/30 text-gray-500 hover:text-blue-400 font-black uppercase tracking-widest text-[12px] rounded-2xl transition-all shadow-xl active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Core"]})})]}),e.jsx("div",{className:"bg-gray-800/20 backdrop-blur-3xl border border-white/5 rounded-[2.5rem] p-5 sm:p-6 mb-8 shadow-2xl relative z-20 group transition-all hover:bg-gray-800/30",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"relative w-full lg:max-w-2xl group",children:[e.jsx("input",{type:"text",placeholder:"·ûü·üí·ûú·üÇ·ûÑ·ûö·ûÄ ID, ·ûà·üí·ûò·üÑ·üá, ·û¨·ûõ·üÅ·ûÅ·ûë·ûº·ûö·ûü·üê·ûñ·üí·ûë...",value:ke,onChange:$=>Ge($.target.value),className:"form-input !pl-16 !py-5 bg-black/40 border-gray-800 rounded-[1.8rem] text-[15px] font-bold text-white placeholder:text-gray-700 focus:border-blue-500/50 focus:bg-black/60 transition-all shadow-inner"}),e.jsxs("div",{className:"absolute left-6 top-1/2 -translate-y-1/2 flex items-center gap-4 text-gray-700 group-focus-within:text-blue-500 transition-colors",children:[e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("div",{className:"h-6 w-px bg-gray-800"})]})]}),e.jsxs("div",{className:"flex items-stretch gap-3 w-full lg:w-auto h-16 sm:h-[68px]",children:[e.jsxs("button",{onClick:()=>ve(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]}),e.jsxs("button",{onClick:()=>ge(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-red-600/10 border border-red-500/20 text-red-500 hover:bg-red-600 hover:text-white rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-red-950/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Export"]}),e.jsx("div",{className:"hidden lg:block h-full",children:e.jsx(rs,{columns:qe,visibleColumns:ie,onToggle:Ze})})]})]})}),e.jsx("div",{className:"relative z-10",children:e.jsx(yt,{orders:re,onEdit:$=>l($["Order ID"]),showActions:!0,visibleColumns:ie,selectedIds:$e,onToggleSelect:te,onToggleSelectAll:ce})}),e.jsx(as,{orders:V,selectedIds:$e,onComplete:()=>{ye(new Set),K()},onClearSelection:()=>ye(new Set)}),Re&&e.jsx(es,{isOpen:Re,onClose:()=>ge(!1),orders:re})]})},os=(s,a)=>{const[i,r]=o.useState(null),y=o.useMemo(()=>{const m={Pending:[],Packing:[],Shipped:[]};return s.forEach(b=>{const l=b.FulfillmentStatus||"Pending";l!=="Cancelled"&&(m[l]?m[l].push(b):m.Pending.push(b))}),m},[s]),g=o.useCallback(async(m,b)=>{r(m);try{if(!(await fetch(`${ne}/api/admin/update-sheet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:"AllOrders",primaryKey:{"Order ID":m},newData:{FulfillmentStatus:b}})})).ok)throw new Error("Failed to update status");a&&a()}catch(l){console.error("Fulfillment update error:",l),alert("·ûò·û∑·ûì·û¢·û∂·ûÖ·ûí·üí·ûú·ûæ·ûî·ûÖ·üí·ûÖ·ûª·ûî·üí·ûî·ûì·üí·ûì·ûó·û∂·ûñ·ûü·üí·ûê·û∂·ûì·ûó·û∂·ûñ·ûî·û∂·ûì·ûë·üÅ·üî ·ûü·ûº·ûò·ûñ·üí·ûô·û∂·ûô·û∂·ûò·ûò·üí·ûè·ûÑ·ûë·üÄ·ûè·üî")}finally{r(null)}},[a]);return{ordersByStatus:y,updateStatus:g,loadingId:i}},is=({order:s,onStatusChange:a,isLoading:i})=>{const r=s.FulfillmentStatus||"Pending";return e.jsxs("div",{className:"bg-gray-800/40 border border-gray-700 rounded-2xl p-5 space-y-4 hover:border-blue-500/50 transition-all shadow-lg animate-fade-in relative overflow-hidden group",children:[i&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm z-10 flex items-center justify-center",children:e.jsx(se,{size:"md"})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black uppercase text-sm tracking-tight",children:s["Order ID"].substring(0,8)}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase mt-0.5",children:[s.Page," (",s.Team,")"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-bold text-gray-300",children:s["Customer Name"]}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono",children:s["Customer Phone"]})]})]}),e.jsx("div",{className:"bg-black/20 rounded-xl p-3 border border-white/5 space-y-2",children:s.Products.map((y,g)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-900 rounded-lg border border-gray-700 overflow-hidden flex-shrink-0",children:e.jsx("img",{src:pe(y.image),className:"w-full h-full object-cover",alt:""})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-200 truncate leading-tight",children:y.name}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-blue-400 font-black",children:["Qty: ",y.quantity]}),y.colorInfo&&e.jsxs("span",{className:"text-[10px] text-purple-400 italic",children:["·ûñ·ûé·üå: ",y.colorInfo]})]})]})]},g))}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[r==="Pending"&&e.jsx("button",{onClick:()=>a(s["Order ID"],"Packing"),className:"flex-1 btn bg-blue-600 hover:bg-blue-700 text-white text-[10px] font-black uppercase py-2 rounded-xl",children:"·ûÖ·û∂·ûî·üã·ûï·üí·ûè·ûæ·ûò·ûú·üÅ·ûÖ·ûÅ·üí·ûÖ·ûî·üã"}),r==="Packing"&&e.jsx("button",{onClick:()=>a(s["Order ID"],"Shipped"),className:"flex-1 btn bg-emerald-600 hover:bg-emerald-700 text-white text-[10px] font-black uppercase py-2 rounded-xl",children:"·ûï·üí·ûâ·ûæ·ûÖ·üÅ·ûâ·ûö·ûΩ·ûÖ·ûö·û∂·ûõ·üã"}),r==="Shipped"&&e.jsx("div",{className:"flex-1 text-center py-2 bg-gray-700/50 rounded-xl text-[10px] font-black text-gray-400 uppercase",children:"‚úÖ ·ûî·û∂·ûì·ûî·ûâ·üí·ûÖ·üÅ·ûâ·ûë·üÜ·ûì·û∑·ûâ"})]})]})},cs=({orders:s})=>{const{refreshData:a,setMobilePageTitle:i}=o.useContext(le),{ordersByStatus:r,updateStatus:y,loadingId:g}=os(s,a),[m,b]=o.useState("Pending");o.useEffect(()=>(i("Fulfillment Store"),()=>i(null)),[i]);const l=o.useMemo(()=>m==="Pending"?r.Pending:m==="Packing"?r.Packing:r.Shipped,[m,r]);return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-800/20 p-5 rounded-[2rem] border border-white/5 backdrop-blur-md",children:[e.jsx("h1",{className:"hidden sm:block text-2xl font-black text-white uppercase tracking-tighter",children:"Fulfillment Store"}),e.jsx("div",{className:"flex bg-black/40 p-1 rounded-xl border border-white/5",children:["Pending","Packing","Shipped"].map(v=>e.jsxs("button",{onClick:()=>b(v),className:`px-6 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${m===v?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[v==="Pending"?"·ûè·üí·ûö·ûº·ûú·ûú·üÅ·ûÖ·ûÅ·üí·ûÖ·ûî·üã":v==="Packing"?"·ûÄ·üÜ·ûñ·ûª·ûÑ·ûú·üÅ·ûÖ·ûÅ·üí·ûÖ·ûî·üã":"·ûî·û∂·ûì·ûï·üí·ûâ·ûæ·ûÖ·üÅ·ûâ",e.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-black/30 rounded-md text-[8px]",children:r[v].length})]},v))})]}),l.length===0?e.jsx("div",{className:"py-20 text-center bg-gray-800/10 rounded-[3rem] border-2 border-dashed border-gray-700/50",children:e.jsx("p",{className:"text-gray-500 font-black uppercase tracking-[0.2em] text-sm",children:"·ûò·û∑·ûì·ûò·û∂·ûì·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûÄ·üí·ûì·ûª·ûÑ·ûî·ûâ·üí·ûá·û∏·ûì·üÅ·üá·ûë·üÅ"})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:l.map(v=>e.jsx(is,{order:v,onStatusChange:y,isLoading:g===v["Order ID"]},v["Order ID"]))})]})},gs=()=>{const{appData:s,currentUser:a,refreshTimestamp:i,isSidebarCollapsed:r}=o.useContext(le),[y,g]=G("tab","admin"),[m,b]=G("subview","dashboard"),[l,v]=G("reportType","overview"),[h,j]=o.useState(!1),[L,P]=o.useState(!1),[A,N]=o.useState(!1),[I,w]=o.useState(!1),[M,u]=o.useState("desktop"),[n,p]=o.useState([]),[x,t]=o.useState({preset:"today",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[C,d]=G("teamFilter",""),[f,c]=G("locationFilter",""),[S,k]=G("storeFilter",""),[D,T]=G("dateFilter","today"),[z,U]=G("startDate",""),[E,O]=G("endDate",""),[W,q]=G("shippingFilter",""),[oe,ue]=G("driverFilter",""),[Y,ie]=G("brandFilter",""),[fe,J]=G("paymentFilter",""),[Ne,he]=G("userFilter",""),[Ve,ze]=G("pageFilter",""),[Fe,De]=G("costFilter",""),[Ee,Pe]=G("bankFilter",""),[Le,Me]=G("productFilter","");o.useEffect(()=>{const _=()=>{const K=window.innerWidth;K<768?u("mobile"):K<1280?u("tablet"):u("desktop")};return _(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)},[]);const ve=async()=>{n.length===0&&j(!0);try{const _=await fetch(`${ne}/api/admin/all-orders`);if(_.ok){const K=await _.json();if(K.status==="success"){const re=(Array.isArray(K.data)?K.data.filter(te=>te!==null&&te["Order ID"]!=="Opening_Balance"&&te["Order ID"]!=="Opening Balance"):[]).map(te=>{let ce=[];try{te["Products (JSON)"]&&(ce=JSON.parse(te["Products (JSON)"]))}catch{}return{...te,Products:ce,IsVerified:String(te.IsVerified).toUpperCase()==="TRUE",FulfillmentStatus:te.FulfillmentStatus}});p(re)}}}catch(_){console.error(_)}finally{j(!1)}};o.useEffect(()=>{ve()},[i]);const Re=()=>{const _=new Date,K=new Date(_.getFullYear(),_.getMonth(),_.getDate());return n.filter(V=>{if(!V.Timestamp)return!1;const re=new Date(V.Timestamp);if(x.preset==="today")return re.toDateString()===_.toDateString();if(x.preset==="this_week"){const te=_.getDay(),ce=new Date(K);ce.setDate(K.getDate()-(te===0?6:te-1));const $=new Date(ce);return $.setDate(ce.getDate()+6),$.setHours(23,59,59,999),re>=ce&&re<=$}else{if(x.preset==="this_month")return re.getMonth()===_.getMonth()&&re.getFullYear()===_.getFullYear();if(x.preset==="custom"){const te=x.start?new Date(x.start+"T00:00:00"):null,ce=x.end?new Date(x.end+"T23:59:59"):null;return!(te&&re<te||ce&&re>ce)}}return re.toDateString()===_.toDateString()})},ge=o.useMemo(()=>Re(),[n,x]),ke=o.useMemo(()=>{const _={};return ge.forEach(K=>{let V=K.Team||"Unassigned";_[V]||(_[V]={name:V,revenue:0,orders:0}),_[V].revenue+=Number(K["Grand Total"])||0,_[V].orders+=1}),Object.values(_).sort((K,V)=>V.revenue-K.revenue)},[ge]),Ge=o.useMemo(()=>{const _={};return ge.forEach(K=>{let V=K["Fulfillment Store"]||"Unassigned";_[V]||(_[V]={name:V,revenue:0,orders:0}),_[V].revenue+=Number(K["Grand Total"])||0,_[V].orders+=1}),Object.values(_).sort((K,V)=>V.revenue-K.revenue)},[ge]),$e=o.useMemo(()=>{const _={};return ge.forEach(K=>{const V=(K.Location||"").split(/[,|\-|/]/)[0].trim();!V||V.toUpperCase()==="N/A"||(_[V]||(_[V]={name:V,revenue:0,orders:0}),_[V].revenue+=Number(K["Grand Total"])||0,_[V].orders+=1)}),Object.values(_).sort((K,V)=>V.revenue-K.revenue)},[ge]),ye=_=>{_==="reports"?P(!L):(["dashboard","performance"].includes(_)?(g("admin"),b(_)):g(_),P(!1))},F=_=>{g("reports"),v(_)},Te=_=>{d(""),c(""),k(""),ie(""),q(""),ue(""),J(""),he(""),ze(""),De(""),Pe(""),Me(""),_.team&&d(_.team),_.location&&c(_.location),_.fulfillmentStore&&k(_.fulfillmentStore),_.store&&ie(_.store),_.shipping&&q(_.shipping),_.driver&&ue(_.driver),_.paymentStatus&&J(_.paymentStatus),_.user&&he(_.user),_.page&&ze(_.page),_.internalCost&&De(_.internalCost),_.bank&&Pe(_.bank),_.product&&Me(_.product),_.datePreset&&(T(_.datePreset),_.datePreset==="custom"&&_.startDate&&_.endDate?(U(_.startDate),O(_.endDate)):(U(""),O(""))),g("orders")},Se=(_,K)=>{const V={};_==="team"&&(V.team=K),_==="location"&&(V.location=K),_==="store"&&(V.fulfillmentStore=K),V.datePreset=x.preset,x.preset==="custom"&&(V.startDate=x.start,V.endDate=x.end),Te(V)},Oe={activeDashboard:y,currentAdminView:m,isReportSubMenuOpen:L,setIsReportSubMenuOpen:P,isProfileSubMenuOpen:A,setIsProfileSubMenuOpen:N,onNavChange:ye,onReportSubNav:F,setEditProfileModalOpen:w,children:(()=>{if(h&&n.length===0)return e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx(se,{size:"lg"})});switch(y){case"admin":return m==="dashboard"?e.jsx(It,{currentUser:a,parsedOrders:n,dateFilter:x,setDateFilter:t,teamRevenueStats:ke,provinceStats:$e,storeStats:Ge,onTeamClick:_=>Se("team",_),onProvinceClick:_=>Se("location",_),onStoreClick:_=>Se("store",_)}):e.jsx(Wt,{orders:n,users:s.users||[],targets:s.targets||[]});case"orders":return e.jsx(ls,{onBack:()=>g("admin"),initialFilters:{team:C,location:f,fulfillmentStore:S,store:Y,datePreset:D,startDate:z,endDate:E,shippingService:W,driver:oe,paymentStatus:fe,user:Ne,page:Ve,internalCost:Fe,bank:Ee,product:Le}});case"reports":return e.jsx(Kt,{activeReport:l,onBack:()=>g("admin"),onNavigate:Te});case"settings":return e.jsx(Qt,{onBack:()=>g("admin")});case"fulfillment":return e.jsx(cs,{orders:n});default:return null}})()};return e.jsxs(e.Fragment,{children:[M==="mobile"?e.jsx(Nt,{...Oe}):M==="tablet"?e.jsx(kt,{...Oe}):e.jsx(jt,{...Oe,isSidebarCollapsed:r}),I&&e.jsx(ct,{onClose:()=>w(!1)})]})};export{gs as default};
