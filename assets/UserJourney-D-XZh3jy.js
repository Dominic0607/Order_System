import{j as e,c as H,r,M as fe,S as ne,A as me,W as ue,C as be,u as Le}from"./index-DczxMswc.js";import{B as De,d as Te,D as Fe,b as Ie,e as _e,c as ze,S as de,a as Re,E as Be,O as Oe}from"./OrdersList-SPW7tUyl.js";import"./imageCompressor-D5vYYzIg.js";const Ae=({pages:i,selectedPageName:w,onSelect:g})=>e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{className:"flex overflow-x-auto gap-3.5 pb-6 pt-2 px-1 snap-x no-scrollbar",children:[i.map(l=>{const h=w===l.PageName;return e.jsxs("button",{type:"button",onClick:()=>g(l),className:`
                                relative flex-shrink-0 w-[115px] h-[135px] snap-center rounded-[2rem] 
                                border-2 transition-all duration-700 outline-none group
                                ${h?"bg-blue-600/20 border-blue-500 shadow-[0_15px_30px_rgba(59,130,246,0.3)] scale-105":"bg-gray-800/30 backdrop-blur-xl border-white/5 hover:border-blue-500/30"}
                            `,children:[e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-3 gap-2",children:[e.jsxs("div",{className:"relative",children:[h&&e.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur-lg opacity-50 animate-pulse"}),e.jsx("div",{className:`
                                        relative w-12 h-12 rounded-full overflow-hidden border-2 transition-all duration-700
                                        ${h?"border-white scale-110 shadow-2xl rotate-[360deg]":"border-gray-700 opacity-50 group-hover:opacity-100"}
                                    `,children:e.jsx("img",{src:H(l.PageLogoURL),className:"w-full h-full object-cover",alt:l.PageName})}),h&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center border-2 border-gray-900 shadow-lg animate-bounce-slow",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:4,children:e.jsx("path",{d:"M5 13l4 4L19 7"})})})]}),e.jsxs("div",{className:"text-center w-full px-1",children:[e.jsx("span",{className:`
                                        text-[10px] font-black uppercase tracking-tighter leading-tight block truncate transition-colors duration-500
                                        ${h?"text-white":"text-gray-500 group-hover:text-gray-300"}
                                    `,children:l.PageName}),l.TelegramValue&&h&&e.jsxs("span",{className:"text-[7px] font-bold text-blue-400/80 block mt-0.5 animate-fade-in truncate",children:["@",l.TelegramValue]})]})]}),e.jsx("div",{className:`
                                absolute bottom-3 left-1/2 -translate-x-1/2 h-1 rounded-full transition-all duration-700
                                ${h?"w-6 bg-blue-400 shadow-[0_0_8px_#60a5fa]":"w-0 bg-transparent"}
                            `})]},l.PageName)}),i.length===0&&e.jsxs("div",{className:"w-full py-10 flex flex-col items-center justify-center bg-gray-900/20 rounded-[2.5rem] border-2 border-dashed border-gray-800",children:[e.jsx("svg",{className:"w-6 h-6 text-gray-700 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("p",{className:"text-[9px] font-black text-gray-600 uppercase tracking-widest italic",children:"រកមិនឃើញ Page"})]})]}),e.jsx("style",{children:`
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
                .no-scrollbar {
                    -ms-overflow-style: none;
                    scrollbar-width: none;
                }
                @keyframes bounce-slow {
                    0%, 100% { transform: translateY(0); }
                    50% { transform: translateY(-3px); }
                }
                .animate-bounce-slow {
                    animation: bounce-slow 2s infinite ease-in-out;
                }
            `})]}),We=({pages:i,selectedPageName:w,onSelect:g,placeholder:l="ជ្រើសរើស Page..."})=>{const[h,L]=r.useState(!1),[C,j]=r.useState(""),_=r.useRef(null);r.useEffect(()=>{const p=i.find(V=>V.PageName===w);p&&j(p.PageName)},[w,i]),r.useEffect(()=>{const p=V=>{if(_.current&&!_.current.contains(V.target)){L(!1);const z=i.find(t=>t.PageName===w);j(z?z.PageName:"")}};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[w,i]);const P=r.useMemo(()=>{if(!C.trim())return i;const p=C.toLowerCase();return i.filter(V=>V.PageName.toLowerCase().includes(p))},[i,C]),W=i.find(p=>p.PageName===w);return e.jsxs("div",{className:"relative w-full",ref:_,children:[e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",className:"form-input !pl-14 !pr-10 !py-3.5 bg-gray-900/50 border-gray-700 group-hover:border-blue-500/50 transition-all rounded-[1.25rem] font-bold text-gray-200",placeholder:l,value:C,onChange:p=>{j(p.target.value),L(!0)},onFocus:()=>L(!0)}),e.jsx("div",{className:"absolute left-3.5 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 overflow-hidden border border-white/5 flex items-center justify-center",children:W?e.jsx("img",{src:H(W.PageLogoURL),className:"w-full h-full object-cover",alt:""}):e.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM7.07 18.28c.43-.9 1.91-1.61 3.46-1.61s3.03.72 3.46 1.61C12.79 19.11 11.41 19.5 10 19.5s-2.79-.39-3.93-1.22zM15.6 17.03c-.78-1.13-2.56-1.86-4.6-1.86s-3.82.73-4.6 1.86c-.52-.51-.95-1.09-1.27-1.74.88-1.19 2.72-2.12 4.87-2.12s3.99.93 4.87 2.12c-.32.65-.75 1.23-1.27 1.74zM10 12.3c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"})})})}),e.jsx("div",{className:"absolute right-3.5 top-1/2 -translate-y-1/2 text-gray-600 group-focus-within:text-blue-500 transition-colors",children:e.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${h?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 9l-7 7-7-7",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),h&&e.jsx("div",{className:"absolute z-[100] w-full mt-2 bg-gray-800/95 backdrop-blur-xl border border-white/10 rounded-[1.5rem] shadow-[0_20px_60px_rgba(0,0,0,0.6)] overflow-hidden animate-fade-in-down",children:e.jsx("div",{className:"max-h-64 overflow-y-auto custom-scrollbar p-2.5 space-y-1.5",children:P.length>0?P.map(p=>e.jsxs("button",{type:"button",onClick:()=>{g(p),j(p.PageName),L(!1)},className:`w-full flex items-center gap-3.5 p-3 rounded-2xl transition-all ${w===p.PageName?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-gray-300 hover:bg-white/5"}`,children:[e.jsx("img",{src:H(p.PageLogoURL),className:"w-11 h-11 rounded-full object-cover border-2 border-white/10 shadow-sm flex-shrink-0",alt:""}),e.jsxs("div",{className:"text-left min-w-0",children:[e.jsx("p",{className:"font-black text-[15px] truncate leading-tight",children:p.PageName}),e.jsx("p",{className:`text-[10px] uppercase tracking-widest font-black mt-1 ${w===p.PageName?"text-blue-100":"text-gray-500"}`,children:p.Team})]})]},p.PageName)):e.jsx("div",{className:"p-6 text-center text-xs text-gray-500 font-black uppercase tracking-widest",children:"រកមិនឃើញ Page ទេ"})})})]})},Ee=({isOpen:i,onClose:w,url:g})=>{const[l,h]=r.useState(!0);return r.useEffect(()=>{i&&h(!0)},[i,g]),i?e.jsxs(fe,{isOpen:i,onClose:w,maxWidth:"max-w-4xl",children:[e.jsx("h2",{className:"text-xl font-bold mb-2 text-white",children:"ស្វែងរកទីតាំង"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:'បន្ទាប់ពីរកឃើញទីតាំងត្រឹមត្រូវ សូមចម្លង (Copy) អាសយដ្ឋាន ឬ Link រួចបិទផ្ទាំងនេះ ហើយបិទភ្ជាប់ (Paste) ចូលទៅក្នុងប្រអប់ "ទីតាំងលម្អិត" វិញ។'}),e.jsxs("div",{className:"relative w-full h-[70vh] bg-gray-900 rounded-lg overflow-hidden border border-gray-700",children:[l&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[e.jsx(ne,{size:"lg"}),e.jsx("span",{className:"ml-3 text-gray-300",children:"កំពុងដំណើរការផែនទី..."})]}),e.jsx("iframe",{src:g,width:"100%",height:"100%",style:{border:0},allowFullScreen:!1,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",onLoad:()=>h(!1),className:l?"opacity-0":"opacity-100 transition-opacity duration-500"})]})]}):null},Ve=({schedule:i,time:w,onChange:g})=>{const l=()=>{g({schedule:!i,time:i?"":w})};return e.jsxs("div",{className:`relative overflow-hidden p-6 rounded-[2rem] border transition-all duration-500 ${i?"bg-cyan-500/10 border-cyan-500 shadow-[0_0_25px_rgba(6,182,212,0.15)]":"bg-gray-900/40 border-gray-700"}`,children:[e.jsx("style",{children:`
                /* ប្ដូរពណ៌ និងពង្រីកទំហំ Default Calendar Icon របស់ Browser */
                .cyan-calendar-picker::-webkit-calendar-picker-indicator {
                    cursor: pointer;
                    /* ប្ដូរពណ៌ទៅជា Cyan */
                    filter: invert(56%) sepia(86%) saturate(2256%) hue-rotate(150deg) brightness(98%) contrast(101%);
                    padding: 8px;
                    width: 24px;
                    height: 24px;
                    transform: scale(1.3); /* ពង្រីកឱ្យធំជាងមុន */
                    border-radius: 12px;
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                }
                .cyan-calendar-picker::-webkit-calendar-picker-indicator:hover {
                    background: rgba(6, 182, 212, 0.15);
                    transform: scale(1.45);
                    filter: invert(60%) sepia(90%) saturate(2500%) hue-rotate(160deg) brightness(110%) contrast(110%);
                }
                .cyan-calendar-picker::-webkit-calendar-picker-indicator:active {
                    transform: scale(1.2);
                }
            `}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-500 ${i?"bg-cyan-500 text-white shadow-lg shadow-cyan-500/30":"bg-gray-800 text-gray-500"}`,children:e.jsx("svg",{className:"w-7 h-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:`text-sm font-black uppercase tracking-widest transition-colors ${i?"text-cyan-400":"text-gray-400"}`,children:"កំណត់ពេល Telegram"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase opacity-60",children:"Auto-Send Schedule"})]})]}),e.jsx("button",{type:"button",onClick:l,className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors focus:outline-none ${i?"bg-cyan-500":"bg-gray-700"}`,children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform duration-300 ease-in-out ${i?"translate-x-6":"translate-x-1"}`})})]}),i&&e.jsxs("div",{className:"animate-fade-in-down pt-6 mt-4 border-t border-cyan-500/10",children:[e.jsx("div",{className:"relative group",children:e.jsx("input",{type:"datetime-local",value:w||"",onChange:h=>g({schedule:i,time:h.target.value}),onClick:h=>{try{"showPicker"in HTMLInputElement.prototype&&h.currentTarget.showPicker()}catch{}},className:"cyan-calendar-picker form-input !py-4 !pl-5 !pr-14 bg-black/40 border-cyan-500/20 text-white font-mono font-bold rounded-2xl focus:border-cyan-500 focus:ring-4 focus:ring-cyan-500/10 transition-all text-sm w-full cursor-pointer",min:new Date().toISOString().slice(0,16)})}),e.jsx("p",{className:"text-[9px] text-cyan-400/60 font-black uppercase tracking-widest text-center mt-3",children:"សារនឹងត្រូវផ្ញើដោយស្វ័យប្រវត្តិតាមម៉ោងកំណត់"})]}),e.jsx("div",{className:`absolute -right-6 -bottom-6 w-24 h-24 bg-cyan-500 transition-opacity duration-700 rounded-full blur-[40px] pointer-events-none ${i?"opacity-10":"opacity-0"}`})]})},xe={id:Date.now(),name:"",quantity:1,originalPrice:0,finalPrice:0,total:0,discountPercent:0,colorInfo:"",image:"",cost:0,discountType:"percent",discountAmountInput:"",discountPercentInput:"",finalPriceInput:"",applyDiscountToTotal:!1},ie=[{number:1,title:"អតិថិជន"},{number:2,title:"ផលិតផល"},{number:3,title:"ដឹកជញ្ជូន"},{number:4,title:"ផ្ទៀងផ្ទាត់"}],Ue=({team:i,onSaveSuccess:w,onCancel:g})=>{const{appData:l,currentUser:h,apiKey:L,previewImage:C}=r.useContext(me),[j,_]=r.useState(1),[P,W]=r.useState(!1),p=r.useRef(new Audio("https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3")),V=r.useRef(new Audio("https://samnangh849-source.github.io/ButtonTest/Send.mp3"));r.useEffect(()=>{p.current.volume=.4,V.current.volume=.6},[]);const z=r.useMemo(()=>({page:"",telegramValue:"",fulfillmentStore:"",pageSelectMode:"cards",customer:{name:"",phone:"",province:"",district:"",sangkat:"",additionalLocation:"",shippingFee:""},products:[{...xe,id:Date.now()}],shipping:{method:"",details:"",cost:""},payment:{status:"Unpaid",info:""},telegram:{schedule:!1,time:""},subtotal:0,grandTotal:0,note:""}),[]),[t,S]=r.useState(z),[Z,Q]=r.useState(!1),[X,G]=r.useState(""),[I,A]=r.useState(null),[O,u]=r.useState(null),[D,$]=r.useState(""),[U,J]=r.useState(""),[se,v]=r.useState(""),[N,m]=r.useState(!1),[k,B]=r.useState("charge"),[q,a]=r.useState(!1),[b,M]=r.useState(""),[y,T]=r.useState("increment"),E=r.useMemo(()=>`createOrderDraft_${h==null?void 0:h.UserName}_${i}`,[h,i]);r.useEffect(()=>{window.innerWidth<768&&window.scrollTo({top:0,behavior:"smooth"})},[j]),r.useEffect(()=>{var n,x;try{const o=localStorage.getItem(E);if(o){const d=JSON.parse(o);if(S(s=>({...s,...d})),d.customer&&typeof d.customer.shippingFee=="number"&&B(d.customer.shippingFee===0?"free":"charge"),d.customer.phone){const s=d.customer.phone,c=(n=l.phoneCarriers)==null?void 0:n.find(f=>(f.Prefixes||"").split(",").some(R=>s.startsWith(R.trim())));$(c?H(c.CarrierLogoURL):"")}if(d.shipping.method){const s=(x=l.shippingMethods)==null?void 0:x.find(c=>c.MethodName===d.shipping.method);u(s||null),J(s?H(s.LogosURL):"")}}}catch{localStorage.removeItem(E)}},[E,l.phoneCarriers,l.shippingMethods]),r.useEffect(()=>{const n=setTimeout(()=>{localStorage.setItem(E,JSON.stringify(t))},500);return()=>clearTimeout(n)},[t,E]);const Y=()=>W(!0),ee=()=>{localStorage.removeItem(E),W(!1),g()},K=r.useMemo(()=>l.pages?l.pages.filter(n=>n.Team===i):[],[l.pages,i]);r.useEffect(()=>{if(K.length===1&&!t.page){const n=K[0];S(x=>({...x,page:n.PageName,telegramValue:n.TelegramValue,fulfillmentStore:n.DefaultStore||t.fulfillmentStore}))}},[K,t.page]);const te=r.useMemo(()=>l.locations?[...new Set(l.locations.map(n=>n.Province))]:[],[l.locations]),we=r.useMemo(()=>!l.locations||!t.customer.province?[]:[...new Set(l.locations.filter(n=>n.Province===t.customer.province).map(n=>n.District))].sort((n,x)=>String(n).localeCompare(String(x),"km")),[l.locations,t.customer.province]),ye=r.useMemo(()=>!l.locations||!t.customer.province||!t.customer.district?[]:[...new Set(l.locations.filter(n=>n.Province===t.customer.province&&n.District===t.customer.district).map(n=>n.Sangkat).filter(Boolean))].sort((n,x)=>String(n).localeCompare(String(x),"km")),[l.locations,t.customer.province,t.customer.district]);r.useEffect(()=>{const n=t.products.reduce((o,d)=>o+(d.total||0),0),x=n+(Number(t.customer.shippingFee)||0);(n!==t.subtotal||x!==t.grandTotal)&&S(o=>({...o,subtotal:n,grandTotal:x}))},[t.products,t.customer.shippingFee]);const ce=(n,x)=>{const o={...n},d=x.find(R=>R.ProductName===o.name);o.quantity=Math.max(1,Number(o.quantity)||1),o.originalPrice=Math.max(0,d&&Number(d.Price)||0),o.cost=Math.max(0,d&&Number(d.Cost)||0);const s=o.quantity*o.originalPrice;let c=s,f=0;switch(o.discountType){case"percent":const R=Math.max(0,Number(o.discountPercentInput)||0);f=s*(R/100),c=s-f;break;case"amount":const F=Math.max(0,Number(o.discountAmountInput)||0);f=o.quantity>1&&o.applyDiscountToTotal?F:F*o.quantity,c=s-f;break;case"custom":const le=Math.max(0,Number(o.finalPriceInput)||0);c=o.quantity*le,f=s-c,o.finalPrice=le;break}return o.total=Math.max(0,c),o.finalPrice=o.quantity>0?o.total/o.quantity:0,o.discountPercent=s>0?f/s*100:0,o.discountType!=="custom"&&(o.finalPriceInput=o.finalPrice.toFixed(2)),o},je=r.useCallback(n=>{const x=l.products.find(o=>o.Barcode&&o.Barcode.trim()===n.trim());x&&(S(o=>{const d=o.products.findIndex(c=>c.name===x.ProductName);let s;if(d>-1){const c={...o.products[d]};y==="increment"&&(c.quantity+=1);const f=ce(c,l.products);s=[...o.products],s[d]=f}else{const c=o.products.findIndex(F=>!F.name),f={...xe,id:Date.now(),name:x.ProductName,quantity:1,originalPrice:x.Price,cost:x.Cost,image:x.ImageURL,tags:x.Tags},R=ce(f,l.products);c>-1?(s=[...o.products],s[c]=R):s=[...o.products,R]}return{...o,products:s}}),y==="single"&&m(!1))},[l.products,y]),re=n=>{const{name:x,value:o}=n.target;if(x==="phone"){let d=o.replace(/[^0-9]/g,"");d.length>1&&d.startsWith("00")?d="0"+d.substring(2):d.length>0&&!d.startsWith("0")&&(d="0"+d);let s=null;d.length>=2&&l.phoneCarriers&&(s=l.phoneCarriers.find(c=>(c.Prefixes||"").split(",").some(f=>d.startsWith(f.trim())))),$(s?H(s.CarrierLogoURL):""),S(c=>({...c,customer:{...c.customer,phone:d}}));return}if(x==="shippingFee"){const d=o===""?"":Math.max(0,parseFloat(o));S(s=>({...s,customer:{...s.customer,shippingFee:d}}));return}S(d=>{let s={...d.customer,[x]:o};return x==="province"?(s.district="",s.sangkat=""):x==="district"&&(s.sangkat=""),{...d,customer:s}})},ae=(n,x,o,d)=>{S(s=>{const c=[...s.products];let f={...c[n]};if(["discountPercentInput","discountAmountInput","finalPriceInput"].includes(x)){let R=String(o).replace(/[^0-9.]/g,"").replace(/(\..*?)\./g,"$1");R.startsWith("0")&&R.length>1&&!R.startsWith("0.")&&(R=String(parseFloat(R))),f[x]=R}else x==="quantity"?f[x]=o===""?0:Math.max(0,parseInt(o)||0):f[x]=o;if(x==="name"){const R=l.products.find(F=>F.ProductName===o);f.name=o,R?(f.originalPrice=R.Price,f.image=R.ImageURL,f.cost=R.Cost,f.discountType="percent",f.finalPrice=R.Price,f.finalPriceInput=String(R.Price),f.tags=d!==void 0?d:R.Tags):(f.originalPrice=0,f.image="",f.cost=0,f.discountType="custom",f.finalPrice=0,f.tags="")}return x==="discountType"&&(f.discountPercentInput="",f.discountAmountInput="",f.finalPrice=f.originalPrice,f.finalPriceInput=String(f.originalPrice)),c[n]=ce(f,l.products),{...s,products:c}})},ve=n=>{u(n),J(H(n.LogosURL)),S(x=>({...x,shipping:{...x.shipping,method:n.MethodName,details:n.RequireDriverSelection?"":n.MethodName}}))},pe=n=>{const{name:x,value:o}=n.target;let d=o;if(x==="cost"){d.startsWith("0")&&d.length>1&&!d.startsWith("0.")&&(d=String(parseFloat(d)));const s=parseFloat(d)||0;d=String(Math.max(0,s))}S(s=>({...s,shipping:{...s.shipping,[x]:d}}))},Ne=n=>{S(x=>({...x,shipping:{...x.shipping,details:n}}))},ke=n=>{var o;const x=((o=l.bankAccounts)==null?void 0:o.find(d=>d.BankName===n))||null;v(x?H(x.LogoURL):""),S(d=>({...d,payment:{...d.payment,info:n}}))},ge=n=>{B(n),S(x=>({...x,customer:{...x.customer,shippingFee:n==="free"?0:""}}))},Se=()=>{if(!L){alert("API Key Required for Maps.");return}const{province:n,district:x,sangkat:o,additionalLocation:d}=t.customer,s=[d,o,x,n,"Cambodia"].filter(Boolean).join(", ");M(`https://www.google.com/maps/embed/v1/search?key=${L}&q=${encodeURIComponent(s)}`),a(!0)},he=n=>{switch(G(""),n){case 1:return!t.customer.name||!t.customer.phone||!t.customer.province||!t.page||!t.fulfillmentStore?(G("សូមបំពេញឈ្មោះ, លេខទូរស័ព្ទ, ខេត្ត/ក្រុង, Page និងឃ្លាំងបញ្ចេញទំនិញ។"),!1):k==="charge"&&(t.customer.shippingFee===""||t.customer.shippingFee<0)?(G("សូមបញ្ចូលតម្លៃដឹកជញ្ជូនឱ្យបានត្រឹមត្រូវ។"),!1):!0;case 2:return t.products.length===0||t.products.some(x=>!x.name||x.quantity<=0)?(G("សូមពិនិត្យទិន្នន័យផលិតផល។"),!1):!0;case 3:return!t.shipping.method||O!=null&&O.RequireDriverSelection&&!t.shipping.details||t.shipping.cost===""||parseFloat(t.shipping.cost)<0?(G("សូមពិនិត្យព័ត៌មានដឹកជញ្ជូន។"),!1):!0;case 4:return t.payment.status==="Paid"&&!t.payment.info?(G("សូមជ្រើសរើសគណនីធនាគារ Tune។"),!1):t.telegram.schedule&&!t.telegram.time?(G("សូមជ្រើសរើសពេលវេលាផ្ញើសារ។"),!1):!0;default:return!0}},Ce=()=>{he(j)&&_(j+1)},Pe=()=>{j>1&&_(j-1)},$e=async()=>{for(const c of ie)if(!he(c.number)){_(c.number);return}Q(!0);let n="0"+t.customer.phone.replace(/[^0-9]/g,"").replace(/^0+/,"");const o=[t.customer.additionalLocation,t.customer.sangkat,t.customer.district].filter(Boolean).join(", ");let d=t.telegram.schedule?t.telegram.time:"";d&&(d=d.replace("T"," "));const s={currentUser:h,selectedTeam:i,page:t.page,telegramValue:t.telegramValue,customer:{...t.customer,phone:n,shippingFee:Number(t.customer.shippingFee)||0},"Customer Name":t.customer.name,"Customer Phone":n,Location:t.customer.province,"Address Details":o,"Internal Shipping Method":t.shipping.method,"Internal Shipping Details":t.shipping.details,"Internal Cost":Number(t.shipping.cost)||0,"Payment Status":t.payment.status,"Payment Info":t.payment.info,"Fulfillment Store":t.fulfillmentStore,products:t.products.map(c=>({name:c.name,quantity:Number(c.quantity)||1,originalPrice:Number(c.originalPrice)||0,finalPrice:Number(c.finalPrice)||0,total:Number(c.total)||0,colorInfo:c.colorInfo,cost:Number(c.cost)||0,tags:c.tags})),shipping:{...t.shipping,cost:Number(t.shipping.cost)||0},payment:t.payment,subtotal:Number(t.subtotal)||0,grandTotal:Number(t.grandTotal)||0,note:t.note,fulfillmentStore:t.fulfillmentStore,scheduledTime:d};try{const c=await fetch(`${ue}/api/submit-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),f=await c.json();if(!c.ok||f.status!=="success")throw new Error(f.message||"Error");V.current.currentTime=0,V.current.play().catch(()=>{}),localStorage.removeItem(E),A({type:"success",message:`ជោគជ័យ! Order ID: ${f.orderId}`}),setTimeout(w,3e3)}catch(c){A({type:"error",message:`បរាជ័យ: ${c.message}`}),setTimeout(()=>A(null),3e3)}finally{Q(!1)}},Me=()=>{var n,x,o;switch(j){case 1:return e.jsxs("fieldset",{className:"border border-gray-600 p-3 sm:p-4 rounded-lg animate-fade-in space-y-6",children:[e.jsx("legend",{className:"px-2 text-base sm:text-lg font-semibold text-blue-300",children:"ព័ត៌មានអតិថិជន & Page"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("label",{className:"input-label font-black text-xs uppercase tracking-widest text-gray-500 mb-0 block",children:"Facebook Page*"}),e.jsxs("div",{className:"flex bg-gray-900/80 p-1 rounded-xl border border-gray-700",children:[e.jsxs("button",{type:"button",onClick:()=>S({...t,pageSelectMode:"cards"}),className:`px-3 py-1.5 text-[10px] font-black uppercase rounded-lg transition-all flex items-center gap-2 ${t.pageSelectMode==="cards"?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2z",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})}),"Card View"]}),e.jsxs("button",{type:"button",onClick:()=>S({...t,pageSelectMode:"search"}),className:`px-3 py-1.5 text-[10px] font-black uppercase rounded-lg transition-all flex items-center gap-2 ${t.pageSelectMode==="search"?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})}),"Search View"]})]})]}),e.jsx("div",{className:"animate-fade-in-down",children:t.pageSelectMode==="cards"?e.jsx(Ae,{pages:K,selectedPageName:t.page,onSelect:s=>S({...t,page:s.PageName,telegramValue:s.TelegramValue,fulfillmentStore:s.DefaultStore||t.fulfillmentStore})}):e.jsx(We,{pages:K,selectedPageName:t.page,onSelect:s=>S({...t,page:s.PageName,telegramValue:s.TelegramValue,fulfillmentStore:s.DefaultStore||t.fulfillmentStore})})})]}),e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"w-1.5 h-4 bg-orange-500 rounded-full"}),e.jsx("label",{className:"input-label !mb-0 font-black text-xs uppercase tracking-widest text-orange-400",children:"ឃ្លាំងបញ្ចេញទំនិញ (Store)*"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:(n=l.stores)==null?void 0:n.map(s=>{const c=t.fulfillmentStore===s.StoreName;return e.jsxs("button",{type:"button",onClick:()=>S({...t,fulfillmentStore:s.StoreName}),className:`relative overflow-hidden group p-4 rounded-2xl border-2 transition-all duration-300 flex flex-col items-center text-center gap-2 ${c?"bg-orange-500/10 border-orange-500 shadow-[0_0_20px_rgba(249,115,22,0.2)]":"bg-gray-900 border-gray-800 hover:border-gray-600"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center transition-colors ${c?"bg-orange-500 text-white":"bg-gray-800 text-gray-500 group-hover:text-gray-300"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsx("span",{className:`text-[11px] font-black uppercase tracking-tight ${c?"text-white":"text-gray-400"}`,children:s.StoreName}),c&&e.jsx("div",{className:"absolute top-1 right-1",children:e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]},s.StoreName)})})]}),e.jsx("input",{type:"text",name:"name",value:t.customer.name,placeholder:"ឈ្មោះអតិថិជន*",className:"form-input !py-3 rounded-xl border-gray-700 bg-gray-900",onChange:re,required:!0}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"tel",name:"phone",value:t.customer.phone,placeholder:"លេខទូរស័ព្ទ*",className:"form-input !py-3 rounded-xl border-gray-700 bg-gray-900 pr-12",onChange:re,required:!0}),D&&e.jsx("img",{src:D,alt:"Carrier",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-auto object-contain"})]}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(ze,{provinces:te,selectedProvince:t.customer.province,onSelect:s=>re({target:{name:"province",value:s}})}),e.jsxs("select",{name:"district",value:t.customer.district,className:"form-select",onChange:re,disabled:!t.customer.province,children:[e.jsx("option",{value:"",children:"-- ស្រុក/ខណ្ឌ --"}),we.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{name:"sangkat",value:t.customer.sangkat,className:"form-select",onChange:re,disabled:!t.customer.district,children:[e.jsx("option",{value:"",children:"-- ឃុំ/សង្កាត់ --"}),ye.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"input-label font-black text-[10px] uppercase text-gray-500 tracking-widest mb-2 block",children:"ទីតាំងលម្អិត (ផ្ទះលេខ, ផ្លូវ)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",name:"additionalLocation",value:t.customer.additionalLocation,placeholder:"បញ្ចូលទីតាំងលម្អិត...",className:"form-input !py-3 rounded-xl bg-gray-900 border-gray-700",onChange:re}),e.jsx("button",{type:"button",onClick:Se,className:"p-3 bg-blue-600/10 text-blue-400 rounded-xl border border-blue-500/20 hover:bg-blue-600 hover:text-white transition-all active:scale-90",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"input-label font-black text-[10px] uppercase text-gray-500 tracking-widest mb-2 block",children:"ថ្លៃសេវាដឹកជញ្ជូន"}),e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsx("button",{type:"button",onClick:()=>ge("charge"),className:`flex-1 py-3 px-4 rounded-xl text-xs font-black uppercase transition-all border ${k==="charge"?"bg-blue-600 border-blue-500 text-white shadow-lg shadow-blue-600/20":"bg-gray-800 border-gray-700 text-gray-400 hover:text-gray-300"}`,children:"គិតថ្លៃសេវា"}),e.jsx("button",{type:"button",onClick:()=>ge("free"),className:`flex-1 py-3 px-4 rounded-xl text-xs font-black uppercase transition-all border ${k==="free"?"bg-emerald-600 border-emerald-500 text-white shadow-lg shadow-emerald-600/20":"bg-gray-800 border-gray-700 text-gray-400 hover:text-gray-300"}`,children:"មិនគិតថ្លៃសេវា"})]}),k==="charge"&&e.jsxs("div",{className:"space-y-3 animate-fade-in",children:[e.jsx("input",{type:"number",min:"0",name:"shippingFee",value:t.customer.shippingFee,placeholder:"តម្លៃដឹកជញ្ជូន (ឧ. 1.5)*",className:"form-input !py-3 rounded-xl border-gray-700 bg-gray-900",onChange:re,required:!0}),e.jsx("div",{className:"flex gap-2",children:[1,1.5,2].map(s=>{const c=parseFloat(t.customer.shippingFee)===s;return e.jsxs("button",{type:"button",onClick:()=>re({target:{name:"shippingFee",value:String(s)}}),className:`flex-1 py-2 border font-black rounded-xl text-xs transition-all active:scale-95 ${c?"bg-blue-600 border-blue-500 text-white shadow-lg shadow-blue-600/20":"bg-gray-800 border-gray-700 text-gray-400 hover:text-gray-200"}`,children:["$",s]},s)})})]})]})]})]});case 2:return e.jsxs("fieldset",{className:"border border-gray-600 p-3 sm:p-4 rounded-lg animate-fade-in space-y-4 sm:space-y-6",children:[e.jsx("legend",{className:"px-2 text-base sm:text-lg font-semibold text-blue-300",children:"ផលិតផល & ការបញ្ចុះតម្លៃ"}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:t.products.map((s,c)=>{const f=(Number(s.quantity)||0)*(Number(s.originalPrice)||0),R=f-(Number(s.total)||0);return e.jsxs("div",{className:"p-3 sm:p-5 bg-gray-800/40 rounded-2xl sm:rounded-3xl border border-gray-700 relative shadow-xl overflow-hidden group",children:[e.jsx("button",{type:"button",onClick:()=>{t.products.length>1&&S({...t,products:t.products.filter((F,le)=>le!==c)})},className:"absolute top-2 right-2 sm:top-4 sm:right-4 text-red-400 bg-red-400/10 rounded-full h-6 w-6 sm:h-8 sm:w-8 flex items-center justify-center border border-red-400/20 hover:bg-red-600 hover:text-white transition-all z-10 active:scale-90",disabled:t.products.length<=1,children:"×"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3 sm:gap-6 mb-4 sm:mb-6",children:[e.jsx("div",{className:"md:col-span-2 flex justify-center",children:e.jsx("div",{className:"w-20 h-20 sm:w-28 sm:h-28 bg-gray-900 rounded-xl sm:rounded-2xl overflow-hidden border-2 border-gray-700 shadow-inner group-hover:border-blue-500/50 transition-colors",children:e.jsx("img",{src:H(s.image),className:"w-full h-full object-cover",alt:""})})}),e.jsxs("div",{className:"md:col-span-10 grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"ឈ្មោះផលិតផល*"}),e.jsx(Ie,{products:l.products||[],selectedProductName:s.name,onSelect:(F,le)=>ae(c,"name",F,le)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(_e,{value:s.quantity,onChange:F=>ae(c,"quantity",F)}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"ពណ៌/សម្គាល់"}),e.jsx("input",{type:"text",list:`colors-datalist-${s.id}`,value:s.colorInfo,onChange:F=>ae(c,"colorInfo",F.target.value),className:"form-input text-sm !py-2.5 rounded-xl bg-gray-900 border-gray-700",placeholder:"ឧ. ខៀវ, XL"}),e.jsx("datalist",{id:`colors-datalist-${s.id}`,children:(l.colors||[]).map((F,le)=>e.jsx("option",{value:F.ColorName},le))})]})]})]})]}),e.jsxs("div",{className:"bg-black/20 rounded-xl sm:rounded-[2rem] p-3 sm:p-6 border border-white/5 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"h-px flex-grow bg-gray-700/50"}),e.jsx("span",{className:"text-[9px] sm:text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] sm:tracking-[0.3em] whitespace-nowrap",children:"Pricing & Discount"}),e.jsx("div",{className:"h-px flex-grow bg-gray-700/50"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"flex bg-gray-900/50 p-1 rounded-xl sm:rounded-2xl border border-gray-700 shadow-inner",children:["percent","amount","custom"].map(F=>e.jsx("button",{type:"button",onClick:()=>ae(c,"discountType",F),className:`flex-1 flex flex-col items-center justify-center py-2 sm:py-2.5 rounded-lg sm:rounded-xl transition-all duration-300 active:scale-95 ${s.discountType===F?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:e.jsx("span",{className:"text-[9px] sm:text-[11px] font-black uppercase tracking-widest",children:F==="percent"?"បញ្ចុះ %":F==="amount"?"បញ្ចុះ $":"កែតម្លៃលក់"})},F))}),e.jsxs("div",{className:"relative animate-fade-in",children:[s.discountType==="percent"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 ml-1",children:"បញ្ចូលភាគរយបញ្ចុះតម្លៃ (%)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:"0",max:"100",placeholder:"0",value:s.discountPercentInput,onChange:F=>ae(c,"discountPercentInput",F.target.value),className:"form-input !text-base sm:!text-lg !font-black !py-2 sm:!py-3 pr-10 text-right text-blue-400 bg-gray-900 border-gray-700"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-black",children:"%"})]})]}),s.discountType==="amount"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 ml-1",children:"បញ្ចូលទឹកប្រាក់បញ្ចុះតម្លៃ ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:"0",placeholder:"0.00",value:s.discountAmountInput,onChange:F=>ae(c,"discountAmountInput",F.target.value),className:"form-input !text-base sm:!text-lg !font-black !py-2 sm:!py-3 pr-10 text-right text-red-400 bg-gray-900 border-gray-700"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-black",children:"$"})]}),s.quantity>1&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 bg-black/20 rounded-lg mt-1 sm:mt-2 border border-white/5 active:scale-95 transition-transform",children:[e.jsx("input",{type:"checkbox",checked:s.applyDiscountToTotal,onChange:F=>ae(c,"applyDiscountToTotal",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-blue-500"}),e.jsx("span",{className:"text-[9px] sm:text-[10px] text-gray-400 uppercase font-black",children:"បញ្ចុះលើតម្លៃសរុប"})]})]}),s.discountType==="custom"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 ml-1",children:"កំណត់តម្លៃលក់ថ្មីក្នុង ១ ឯកតា ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",inputMode:"decimal",placeholder:"0.00",value:s.finalPriceInput,onChange:F=>ae(c,"finalPriceInput",F.target.value),className:"form-input !text-base sm:!text-lg !font-black !py-2 sm:!py-3 pr-10 text-right text-emerald-400 bg-gray-900 border-gray-700"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-black",children:"$"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-900/60 rounded-xl sm:rounded-[1.5rem] p-3 sm:p-5 border border-white/5 flex flex-col justify-between",children:[e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-[10px] sm:text-xs",children:[e.jsx("span",{className:"text-gray-500 font-bold uppercase",children:"Original Subtotal"}),e.jsxs("span",{className:"text-blue-400 font-black",children:["$",f.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center text-[10px] sm:text-xs",children:[e.jsx("span",{className:"text-gray-500 font-bold uppercase",children:"Discount Applied"}),e.jsxs("span",{className:"text-red-400 font-black",children:["-",R>0?`$${R.toFixed(2)}`:"$0.00"]})]}),e.jsx("div",{className:"h-px bg-gray-700/50 my-1"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[9px] sm:text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Net Total"}),e.jsxs("span",{className:"text-xl sm:text-2xl font-black text-white tracking-tighter",children:["$",(s.total||0).toFixed(2)]})]})]}),e.jsx("div",{className:"mt-3 sm:mt-4 pt-2 sm:pt-3 border-t border-white/5 flex justify-center",children:e.jsxs("span",{className:"text-[8px] sm:text-[9px] bg-emerald-500/10 text-emerald-400 px-2 sm:px-3 py-1 rounded-full border border-emerald-500/20 font-black uppercase tracking-widest",children:["Avg. $",(s.finalPrice||0).toFixed(2)," / unit"]})})]})]})]})]},s.id)})}),e.jsxs("div",{className:"bg-gray-900/80 p-4 rounded-2xl border border-blue-500/20 shadow-lg flex flex-col sm:flex-row justify-between items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg text-blue-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Total Quantity"}),e.jsxs("span",{className:"text-lg font-black text-white",children:[t.products.reduce((s,c)=>s+(Number(c.quantity)||0),0)," items"]})]})]}),e.jsx("div",{className:"h-px w-full sm:w-px sm:h-10 bg-gray-700"}),e.jsxs("div",{className:"flex flex-col items-center sm:items-end",children:[e.jsx("span",{className:"text-[10px] font-black text-blue-400 uppercase tracking-widest",children:"Estimated Subtotal"}),e.jsxs("span",{className:"text-3xl font-black text-white tracking-tighter drop-shadow-md",children:["$",(t.subtotal||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 mt-6",children:[e.jsxs("button",{type:"button",onClick:()=>S({...t,products:[...t.products,{...xe,id:Date.now()}]}),className:"flex-1 py-4 px-6 bg-gray-800 border border-gray-700 rounded-2xl text-gray-300 font-black uppercase text-[11px] tracking-widest hover:bg-gray-700 hover:border-blue-500 transition-all flex items-center justify-center gap-2 active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})}),"បន្ថែមផលិតផល"]}),e.jsxs("button",{type:"button",onClick:()=>m(!0),className:"flex-1 py-4 px-6 bg-blue-600/10 border border-blue-500/30 rounded-2xl text-blue-400 font-black uppercase text-[11px] tracking-widest hover:bg-blue-600 hover:text-white transition-all flex items-center justify-center gap-2 shadow-lg shadow-blue-900/10 active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2M17 3h2a2 2 0 0 1 2 2v2M21 17v2a2 2 0 0 1-2 2h-2M7 21H5a2 2 0 0 1-2-2v-2M7 12h10",strokeWidth:"3"})}),"Scan Barcode"]})]})]});case 3:return e.jsxs("fieldset",{className:"border border-gray-600 p-3 sm:p-4 rounded-lg animate-fade-in space-y-4 sm:space-y-6",children:[e.jsx("legend",{className:"px-2 text-base sm:text-lg font-semibold text-blue-300",children:"ដឹកជញ្ជូន"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"input-label font-black text-[10px] uppercase text-gray-500 tracking-widest mb-2 block",children:"វិធីសាស្រ្តដឹកជញ្ជូន*"}),e.jsx(Te,{methods:l.shippingMethods||[],selectedMethodName:t.shipping.method,onSelect:ve})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"input-label font-black text-[10px] uppercase text-gray-500 tracking-widest mb-2 block",children:"ថ្លៃសេវាឲ្យអ្នកដឹក (Cost)*"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:"0",step:"0.01",name:"cost",placeholder:"0.00",value:t.shipping.cost,className:"form-input !py-3 rounded-xl bg-gray-900 border-gray-700 text-blue-400 font-black pr-12",onChange:pe,required:!0}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"})]}),e.jsx("div",{className:"flex gap-2",children:[1.25,1.5,2].map(s=>{const c=parseFloat(t.shipping.cost)===s;return e.jsxs("button",{type:"button",onClick:()=>pe({target:{name:"cost",value:String(s)}}),className:`flex-1 py-2 border font-black rounded-xl text-xs transition-all active:scale-95 ${c?"bg-blue-600 border-blue-500 text-white shadow-lg shadow-blue-600/20":"bg-gray-800 border-gray-700 text-gray-400 hover:text-gray-200"}`,children:["$",s]},s)})})]})]}),(O==null?void 0:O.RequireDriverSelection)&&e.jsxs("div",{className:"md:col-span-2 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("div",{className:"h-4 w-1 bg-blue-500 rounded-full"}),e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]",children:"ជ្រើសរើសអ្នកដឹក (DriverSelection)*"})]}),e.jsx(Fe,{drivers:l.drivers||[],selectedDriverName:t.shipping.details,onSelect:Ne}),!t.shipping.details&&e.jsx("p",{className:"text-center text-[9px] text-gray-500 italic mt-1",children:"សូមជ្រើសរើសអ្នកដឹកម្នាក់"})]})]})]});case 4:const d=(x=l.drivers)==null?void 0:x.find(s=>s.DriverName===t.shipping.details);return e.jsxs("div",{className:"animate-fade-in space-y-4 sm:space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2 sm:mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"})," ព័ត៌មានអតិថិជន"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 bg-gray-900/60 p-3 sm:p-5 rounded-2xl sm:rounded-3xl border border-white/5 shadow-inner",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Customer Info"}),e.jsx("p",{className:"text-white font-black text-base sm:text-lg",children:t.customer.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-blue-400 font-bold font-mono text-sm",children:t.customer.phone}),D&&e.jsx("img",{src:D,className:"h-4 sm:h-5 w-auto object-contain",alt:"Carrier"})]})]}),e.jsxs("div",{className:"space-y-1 md:text-right",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Location / Store"}),e.jsx("p",{className:"text-gray-200 font-bold text-xs sm:text-sm leading-tight",children:`${t.customer.additionalLocation}, ${t.customer.sangkat}, ${t.customer.district}, ${t.customer.province}`.replace(/^,|,$/g,"").trim()}),e.jsxs("p",{className:"text-purple-400 font-black text-[9px] uppercase tracking-wider",children:["Fulfillment: ",t.fulfillmentStore]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2 sm:mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-orange-500"})," ព័ត៌មានដឹកជញ្ជូន"]}),e.jsxs("div",{className:"bg-gray-900/40 p-3 sm:p-5 rounded-2xl sm:rounded-3xl border border-white/5 shadow-inner grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Shipping Method"}),e.jsxs("div",{className:"flex items-center gap-2",children:[U&&e.jsx("img",{src:U,className:"h-4 sm:h-5 w-auto object-contain",alt:"Logo"}),e.jsx("p",{className:"text-white font-black text-xs sm:text-sm",children:t.shipping.method})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Driver / Details"}),e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsx("img",{src:H(d.ImageURL),className:"h-6 w-6 sm:h-8 sm:w-8 rounded-full object-cover border border-gray-700 cursor-pointer active:scale-95 transition-transform",alt:"Driver",onClick:()=>C(H(d.ImageURL))}),e.jsx("p",{className:"text-white font-bold text-xs sm:text-sm",children:t.shipping.details||"N/A"})]})]}),e.jsxs("div",{className:"space-y-1 sm:text-right",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-bold uppercase",children:"Internal Cost ($)"}),e.jsxs("p",{className:"text-orange-400 font-black text-base sm:text-lg font-mono",children:["$",(Number(t.shipping.cost)||0).toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2 sm:mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"})," បញ្ជីទំនិញកុម្ម៉ង់"]}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:t.products.map(s=>e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 bg-gray-900/40 p-2 sm:p-3 rounded-xl sm:rounded-2xl border border-white/5 group hover:border-blue-500/30 transition-all",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-800 rounded-lg sm:rounded-xl overflow-hidden border border-gray-700 flex-shrink-0 relative",children:e.jsx("img",{src:H(s.image),className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",alt:s.name})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-0.5 sm:mb-1",children:[e.jsx("h4",{className:"text-white font-black text-xs sm:text-sm truncate leading-tight",children:s.name}),e.jsx("div",{className:"flex gap-1.5",children:e.jsxs("span",{className:"bg-blue-600/10 text-blue-400 text-[9px] sm:text-[10px] font-black px-1.5 sm:px-2.5 py-0.5 sm:py-1 rounded-lg border border-blue-500/20",children:["x",s.quantity]})})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.colorInfo&&e.jsx("span",{className:"text-[9px] bg-purple-500/10 text-purple-400 px-1.5 py-0.5 rounded-md font-bold",children:s.colorInfo}),e.jsxs("p",{className:"text-[9px] text-gray-500 font-bold uppercase tracking-tight",children:[e.jsxs("span",{children:["$",(s.finalPrice||0).toFixed(2)]})," / unit"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-white font-black text-sm sm:text-base tracking-tight",children:["$",(s.total||0).toFixed(2)]}),e.jsx("p",{className:"text-[8px] text-gray-600 font-bold uppercase",children:"Subtotal"})]})]},s.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-gray-900/40 p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-white/5 text-center",children:[e.jsx("p",{className:"text-[8px] sm:text-[9px] text-gray-500 font-black uppercase mb-1",children:"សរុបទំនិញ"}),e.jsxs("p",{className:"text-white font-black text-base sm:text-lg",children:["$",(t.subtotal||0).toFixed(2)]})]}),e.jsxs("div",{className:"bg-gray-900/40 p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-white/5 text-center",children:[e.jsx("p",{className:"text-[8px] sm:text-[9px] text-gray-500 font-black uppercase mb-1",children:"សេវាដឹក"}),e.jsxs("p",{className:"text-white font-black text-base sm:text-lg",children:["$",(Number(t.customer.shippingFee)||0).toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2 bg-blue-600/10 p-3 sm:p-4 rounded-xl sm:rounded-2xl border border-blue-500/20 text-center shadow-lg shadow-blue-900/10",children:[e.jsx("p",{className:"text-[9px] sm:text-[10px] text-blue-400 font-black uppercase mb-1 tracking-widest",children:"សរុបរួម (Grand Total)"}),e.jsxs("p",{className:"text-white font-black text-2xl sm:text-3xl tracking-tighter",children:["$",(t.grandTotal||0).toFixed(2)]})]})]}),e.jsxs("fieldset",{className:"border border-gray-700 p-4 sm:p-6 rounded-2xl sm:rounded-3xl bg-gray-900/20",children:[e.jsx("legend",{className:"px-3 text-[10px] sm:text-xs font-black text-blue-400 uppercase tracking-[0.2em]",children:"ស្ថានភាពទូទាត់"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("select",{value:t.payment.status,onChange:s=>S({...t,payment:{...t.payment,status:s.target.value,info:""}}),className:"form-select bg-gray-800 text-sm",children:[e.jsx("option",{value:"Unpaid",children:"មិនទាន់ទូទាត់ (COD)"}),e.jsx("option",{value:"Paid",children:"ទូទាត់រួច (Paid)"})]}),t.payment.status==="Paid"&&e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 animate-fade-in",children:[e.jsxs("select",{value:t.payment.info,onChange:s=>ke(s.target.value),className:"form-select bg-gray-800 flex-grow text-sm",children:[e.jsx("option",{value:"",children:"ជ្រើសរើសធនាគារ"}),(o=l.bankAccounts)==null?void 0:o.map(s=>e.jsx("option",{value:s.BankName,children:s.BankName},s.BankName))]}),se&&e.jsx("img",{src:se,className:"h-8 w-12 sm:h-10 sm:w-16 object-contain bg-white/10 p-1 rounded-lg sm:rounded-xl active:scale-95 transition-transform",alt:"bank"})]})]})]}),e.jsx(Ve,{schedule:t.telegram.schedule,time:t.telegram.time,onChange:s=>S({...t,telegram:s})}),e.jsxs("div",{className:"space-y-2 sm:space-y-3 pt-4",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"ចំណាំ & Link Google Map"}),e.jsx("textarea",{placeholder:"ចំណាំបន្ថែម...",value:t.note,rows:4,onChange:s=>S({...t,note:s.target.value}),className:"form-textarea bg-gray-900/60 !rounded-[1.5rem] sm:!rounded-[2rem] border-white/5 focus:border-blue-500/50 text-sm"})]})]});default:return null}};return e.jsxs("div",{className:"w-full max-w-4xl mx-auto mt-2 sm:mt-10 lg:mt-14 px-1 sm:px-0",children:[e.jsx("style",{children:`
                @keyframes shimmer {
                    0% { background-position: -200% 0; }
                    100% { background-position: 200% 0; }
                }
                .btn-shimmer {
                    background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0) 100%);
                    background-size: 200% 100%;
                    animation: shimmer 3s infinite linear;
                }
                @keyframes pulse-glow {
                    0%, 100% { box-shadow: 0 0 15px rgba(37,99,235,0.3); }
                    50% { box-shadow: 0 0 30px rgba(37,99,235,0.6); }
                }
                .btn-pulse { animation: pulse-glow 2s infinite ease-in-out; }
                @keyframes spin-border {
                    from { --angle: 0deg; }
                    to { --angle: 360deg; }
                }
                @property --angle {
                    syntax: '<angle>';
                    initial-value: 0deg;
                    inherits: false;
                }
                .card-flux {
                    position: relative;
                    background: #0f172a;
                    z-index: 1;
                }
                .card-flux-active::after, .card-flux-active::before {
                    content: '';
                    position: absolute;
                    inset: -2px;
                    z-index: -1;
                    background: conic-gradient(from var(--angle), transparent 70%, #3b82f6, #8b5cf6, #ec4899, #3b82f6);
                    border-radius: inherit;
                    animation: spin-border 3s linear infinite;
                }
                .card-flux-active::before {
                    filter: blur(10px);
                    opacity: 0.7;
                }
                @keyframes float-y {
                    0%, 100% { transform: translateY(0); }
                    50% { transform: translateY(-5px); }
                }
                .animate-float-y { animation: float-y 3s ease-in-out infinite; }
                @keyframes pulse-soft {
                    0%, 100% { opacity: 1; }
                    50% { opacity: 0.6; }
                }
                .animate-pulse-soft { animation: pulse-soft 2s ease-in-out infinite; }
             `}),I&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[100] animate-fade-in p-4",children:e.jsxs("div",{className:"page-card text-center flex flex-col items-center animate-fade-in-scale",children:[I.type==="success"?e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-green-500/20 text-green-400 rounded-full flex items-center justify-center mb-4 border border-green-500/30 shadow-[0_0_30px_rgba(34,197,94,0.2)]",children:e.jsx("svg",{className:"h-8 w-8 sm:h-10 sm:w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}):e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-red-500/20 text-red-400 rounded-full flex items-center justify-center mb-4 border border-red-500/30",children:e.jsx("svg",{className:"h-8 w-8 sm:h-10 sm:w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("p",{className:"text-base sm:text-lg font-black text-white",children:I.message})]})}),e.jsx(Ee,{isOpen:q,onClose:()=>a(!1),url:b}),N&&e.jsx(De,{onClose:()=>m(!1),onCodeScanned:je,scanMode:y,setScanMode:T,productsInOrder:t.products,masterProducts:l.products||[]}),e.jsx(fe,{isOpen:P,onClose:()=>W(!1),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-6 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto w-14 h-14 sm:w-16 sm:h-16 bg-red-500/10 text-red-500 rounded-full flex items-center justify-center border border-red-500/20 shadow-xl shadow-red-900/10 animate-bounce-slow",children:e.jsx("svg",{className:"h-7 w-7 sm:h-8 sm:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg sm:text-xl font-black text-white uppercase tracking-tighter",children:"បោះបង់ការបញ្ចូល?"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>W(!1),className:"px-6 py-3 bg-gray-800 border border-gray-700 text-gray-300 rounded-2xl flex-1 font-black text-xs sm:text-sm transition-all hover:bg-gray-700 active:scale-95",children:"ទេ (ត្រឡប់)"}),e.jsx("button",{onClick:ee,className:"px-6 py-3 bg-red-600 border border-red-500 text-white rounded-2xl flex-1 font-black text-xs sm:text-sm transition-all hover:bg-red-700 active:scale-95 shadow-lg shadow-red-900/20",children:"បាទ (បោះបង់)"})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 sm:mb-10 gap-4",children:[e.jsxs("h1",{className:"hidden md:flex text-2xl sm:text-3xl font-black text-white uppercase tracking-tighter items-center gap-3 sm:gap-4",children:[e.jsx("span",{className:"text-blue-500",children:"កុម្ម៉ង់ថ្មី"}),e.jsx("span",{className:"text-[9px] sm:text-[10px] bg-blue-600/20 text-blue-400 px-3 sm:px-4 py-1.5 rounded-full border border-blue-500/20 uppercase tracking-[0.15em] sm:tracking-[0.2em]",children:i})]}),e.jsx("button",{onClick:Y,className:"hidden md:block px-6 py-2.5 bg-gray-800 border border-gray-700 hover:border-red-500 hover:bg-red-500/10 text-gray-400 hover:text-red-400 font-black rounded-2xl uppercase text-[10px] sm:text-[11px] tracking-widest transition-all active:scale-90",children:"បោះបង់"})]}),e.jsxs("div",{className:"bg-gray-800/30 backdrop-blur-3xl border border-white/5 rounded-[1.5rem] sm:rounded-[3rem] p-3 sm:p-10 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 sm:mb-12 relative px-2 sm:px-4",children:[e.jsx("div",{className:"absolute left-6 right-6 sm:left-10 sm:right-10 top-1/2 w-[calc(100%-48px)] sm:w-[calc(100%-80px)] h-0.5 bg-gray-700 -z-10"}),e.jsx("div",{className:"absolute left-6 sm:left-10 top-1/2 h-0.5 bg-blue-500 -z-10 transition-all duration-500",style:{width:`${(j-1)/(ie.length-1)*(100-48/400*100)}%`}}),ie.map(n=>e.jsxs("div",{className:`relative flex flex-col items-center z-10 transition-all duration-500 ${j>=n.number?"scale-110":"opacity-40 scale-90"}`,children:[e.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 rounded-xl sm:rounded-2xl flex items-center justify-center font-black text-[10px] sm:text-xs border-2 transition-all duration-500 ${j>=n.number?"border-blue-500 bg-blue-600 text-white shadow-[0_0_20px_rgba(37,99,235,0.4)]":"border-gray-600 bg-gray-800 text-gray-500"}`,children:j>n.number?"✓":n.number}),e.jsx("span",{className:`absolute -bottom-6 sm:-bottom-7 text-[8px] sm:text-[9px] font-black uppercase tracking-widest whitespace-nowrap ${j>=n.number?"text-blue-400":"text-gray-600"}`,children:n.title})]},n.number))]}),e.jsx("div",{className:"mt-8 sm:mt-16",children:Me()}),X&&e.jsx("div",{className:"mt-4 sm:mt-6 p-3 sm:p-4 bg-red-500/10 border border-red-500/20 rounded-xl sm:rounded-2xl text-red-400 text-center text-[10px] sm:text-xs font-bold animate-shake",children:X}),e.jsxs("div",{className:"mt-8 sm:mt-10 pt-6 sm:pt-8 border-t border-white/5 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex gap-3 sm:gap-4 h-12 sm:h-16",children:[j>1&&e.jsxs("button",{type:"button",onClick:Pe,className:"flex-1 px-4 sm:px-8 bg-gray-800 border border-gray-700 text-gray-300 rounded-2xl font-black uppercase text-[10px] sm:text-[12px] tracking-[0.15em] transition-all hover:bg-gray-700 flex items-center justify-center gap-2 active:scale-95",children:[e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M15 19l-7-7 7-7"})}),"ត្រឡប់"]}),j<ie.length?e.jsxs("button",{type:"button",onClick:Ce,className:"relative flex-[2] bg-blue-600 hover:bg-blue-700 text-white rounded-2xl font-black uppercase text-[12px] sm:text-[14px] tracking-[0.2em] shadow-2xl active:scale-95 transition-all flex items-center justify-center gap-3 group overflow-hidden btn-pulse",children:[e.jsx("div",{className:"absolute inset-0 btn-shimmer pointer-events-none"}),e.jsx("span",{className:"relative z-10",children:"ជំហានបន្ទាប់"}),e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 relative z-10 transform group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M9 5l7 7-7 7"})})]}):e.jsxs("button",{type:"button",onClick:$e,className:"relative flex-[2] bg-emerald-600 hover:bg-emerald-700 text-white rounded-2xl font-black uppercase text-[12px] sm:text-[14px] tracking-[0.2em] shadow-2xl active:scale-95 transition-all flex items-center justify-center gap-3 overflow-hidden",disabled:Z,children:[e.jsx("div",{className:"absolute inset-0 btn-shimmer pointer-events-none"}),Z?e.jsx(ne,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"relative z-10",children:"បញ្ជូនកម្ម៉ង់ឥឡូវនេះ"}),e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 relative z-10 animate-bounce-x",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M5 13l4 4L19 7"})})]})]})]}),e.jsx("button",{onClick:Y,className:"md:hidden w-full py-4 bg-gray-800/40 text-gray-500 hover:text-red-400 font-black rounded-2xl uppercase text-[10px] tracking-widest transition-all active:scale-95 border border-white/5",children:"បោះបង់ការបញ្ចូល"})]})]}),e.jsx("style",{children:".animate-bounce-x { animation: bounce-x 1s infinite ease-in-out; } @keyframes bounce-x { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(5px); } }"})]})},qe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],He=({data:i,grandTotals:w,sortConfig:g,onToggleSort:l,showAllPages:h,setShowAllPages:L,onExportPDF:C,isExporting:j,onPreviewImage:_})=>{const[P,W]=r.useState(!0),[p,V]=r.useState(!1),[z,t]=r.useState(!0),[S,Z]=r.useState(!0),{rowSpans:Q,displayRow:X}=r.useMemo(()=>{const I=new Array(i.length).fill(0),A=new Array(i.length).fill(!0);let O=0;for(;O<i.length;){const u=i[O].teamName;let D=1;for(;O+D<i.length&&i[O+D].teamName===u;)D++;I[O]=D,A[O]=!0;for(let $=1;$<D;$++)I[O+$]=0,A[O+$]=!1;O+=D}return{rowSpans:I,displayRow:A}},[i]),G=(I,A)=>{const O=[{key:"index",label:"#"},{key:"teamName",label:"ក្រុម (Team)",sortable:!0,sortKey:"teamName"},{key:"logo",label:"Logo"},{key:"pageName",label:"ឈ្មោះ Page",sortable:!0,sortKey:"pageName"},{key:`total${I}`,label:`សរុប (${I})`,sortable:!0,sortKey:I.toLowerCase()},...qe.map(u=>({key:`${A}_${u}`,label:u}))];return e.jsxs("div",{className:"hidden xl:flex page-card flex-col mb-8 !p-6 border-gray-700/50 shadow-xl overflow-hidden bg-gray-900/40",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:`text-xl font-black flex items-center gap-2 ${I==="Revenue"?"text-blue-300":"text-green-400"}`,children:[e.jsx("span",{className:`w-2 h-6 rounded-full ${I==="Revenue"?"bg-blue-600":"bg-green-600"}`}),"តារាង",I==="Revenue"?"ចំណូល":"ប្រាក់ចំណេញ","តាម Page (Desktop)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[I==="Revenue"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>L(!h),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${h?"bg-purple-600 border-purple-500 text-white shadow-lg shadow-purple-900/20":"bg-gray-800 border-gray-700 text-gray-400"}`,children:h?"ALL PAGES":"ACTIVE ONLY"}),e.jsxs("button",{onClick:C,disabled:j,className:"btn !py-1 !px-4 text-[10px] font-black bg-red-600/20 border border-red-500/30 text-red-400 hover:bg-red-600 hover:text-white transition-all flex items-center gap-2",children:[j?e.jsx(ne,{size:"sm"}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"EXPORT PDF"]})]}),e.jsx("button",{onClick:()=>Z(!S),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${S?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"MERGE"}),e.jsx("button",{onClick:()=>t(!z),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${z?"bg-orange-600 border-orange-500 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"COLOR"}),e.jsx("button",{onClick:()=>V(!p),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${p?"bg-blue-600 border-blue-500 text-white shadow-lg":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"FREEZE"}),e.jsx("button",{onClick:()=>W(!P),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${P?"bg-gray-700 border-gray-600 text-white shadow-lg":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"BORDER"})]})]}),e.jsx("div",{className:`overflow-x-auto custom-scrollbar pb-2 ${P?"border-2 border-white/20 rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.6)]":""}`,children:e.jsxs("table",{className:`report-table w-full border-separate border-spacing-0 text-sm ${P?"border-collapse":""}`,children:[e.jsx("thead",{className:"bg-[#0f172a] backdrop-blur-md",children:e.jsx("tr",{className:"border-b-2 border-white/20",children:O.map(u=>{let D="",$={};p&&(u.key==="index"?(D="sticky left-0 z-30 bg-[#0f172a]",$={width:"45px",minWidth:"45px"}):u.key==="teamName"?(D="sticky left-[45px] z-30 bg-[#0f172a] border-r border-white/20 shadow-md",$={minWidth:"130px"}):u.key==="logo"?(D="sticky z-30 bg-[#0f172a]",$={left:"175px",width:"50px",minWidth:"50px"}):u.key==="pageName"?(D="sticky z-30 bg-[#0f172a] shadow-md",$={left:"225px",minWidth:"160px"}):u.key.includes("total")&&(D="sticky z-30 bg-[#0f172a] border-r border-white/20 shadow-lg",$={left:"385px",width:"100px",minWidth:"100px"}));const U=u.key.includes("total")?I==="Revenue"?"bg-blue-900/80":"bg-green-900/80":"";return e.jsx("th",{onClick:()=>u.sortable&&l(u.sortKey),className:`px-4 py-5 whitespace-nowrap text-left font-black uppercase tracking-wider border-b-2 border-white/20 ${P?"border-x border-white/10":""} ${D} ${U} ${u.sortable?"cursor-pointer hover:bg-gray-700":""}`,style:$,children:e.jsxs("div",{className:"flex items-center gap-1",children:[u.label," ",u.sortable&&g.key===u.sortKey&&e.jsx("span",{children:g.direction==="asc"?"↑":"↓"})]})},u.key)})})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:i.map((u,D)=>{const $=S?X[D]:!0,U=S?Q[D]:1,J=Array.from(String(u.teamName)).reduce((m,k)=>m+k.charCodeAt(0),0)%5,v=[{bg:"bg-blue-500/5",border:"border-l-4 border-l-blue-500"},{bg:"bg-purple-500/5",border:"border-l-4 border-l-purple-500"},{bg:"bg-emerald-500/5",border:"border-l-4 border-l-emerald-500"},{bg:"bg-orange-500/5",border:"border-l-4 border-l-orange-500"},{bg:"bg-pink-500/5",border:"border-l-4 border-l-pink-500"}][J],N=z?v.bg:"hover:bg-blue-500/5";return e.jsx("tr",{className:`${N} transition-colors group border-b border-white/10`,children:O.map(m=>{const k=`px-4 py-4 lg:py-5 whitespace-nowrap border-white/10 ${P?"border-x border-white/10":""}`;let B="",q={};if(p&&(m.key==="index"?(B="sticky left-0 z-10 bg-[#020617]",q={width:"45px",minWidth:"45px"}):m.key==="teamName"?(B="sticky left-[45px] z-10 bg-[#020617] border-r border-white/20 shadow-md",q={width:"130px",minWidth:"130px"}):m.key==="logo"?(B="sticky z-10 bg-[#020617]",q={left:"175px",width:"50px",minWidth:"50px"}):m.key==="pageName"?(B="sticky z-10 bg-[#020617] shadow-md",q={left:"225px",minWidth:"160px"}):m.key.includes("total")&&(B="sticky z-10 bg-[#020617] border-r border-white/20 shadow-lg",q={left:"385px",width:"100px",minWidth:"100px"})),m.key==="index")return e.jsx("td",{className:`${k} text-center font-bold text-gray-500 ${B}`,style:q,children:D+1},m.key);if(m.key==="teamName")return $?e.jsx("td",{rowSpan:U,className:`${k} font-black text-white bg-gray-900/95 align-middle text-center ${B} ${z?v.border:""} border-b border-white/10`,style:q,children:e.jsx("div",{className:"bg-gray-800/80 py-1 px-3 rounded-xl border border-white/5 shadow-sm inline-block",children:u.teamName})},m.key):null;if(m.key==="logo")return e.jsx("td",{className:`${k} text-center ${B} border-b border-white/10`,style:q,children:e.jsx("img",{src:H(u.logoUrl),className:"w-9 h-9 rounded-full border border-gray-700 mx-auto shadow-md",alt:"logo",onClick:()=>_(H(u.logoUrl))})},m.key);if(m.key==="pageName")return e.jsx("td",{className:`${k} font-black text-white ${B} border-b border-white/10`,style:q,children:u.pageName},m.key);if(m.key.includes("total"))return e.jsxs("td",{className:`${k} text-right font-black ${B} ${I==="Revenue"?"text-blue-100 bg-blue-600/10":"text-green-100 bg-green-600/10"} border-b border-white/10`,style:q,children:["$",(I==="Revenue"?u.revenue:u.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},m.key);if(m.key.startsWith(A)){const a=u[m.key]||0,b=I==="Profit"?a>0?"text-green-400":a<0?"text-red-400":"text-gray-500":a>0?"text-blue-300":"text-gray-500";return e.jsx("td",{className:`${k} text-right font-bold font-mono ${b} border-b border-white/10`,children:a!==0?`$${a.toLocaleString(void 0,{minimumFractionDigits:2})}`:"-"},m.key)}return e.jsx("td",{className:`${k} border-b border-white/10`,children:"-"},m.key)})},u.pageName)})}),e.jsx("tfoot",{className:"bg-[#0f172a] font-black border-t-2 border-white/20",children:e.jsx("tr",{className:"border-t-2 border-white/20",children:O.map((u,D)=>{const $=`px-4 py-5 whitespace-nowrap border-t-2 border-white/20 ${P?"border-x border-white/10":""}`;let U="",J={};return p&&(u.key==="index"?(U="sticky left-0 z-30 bg-[#0f172a]",J={width:"45px",minWidth:"45px"}):u.key==="teamName"?(U="sticky left-[45px] z-30 bg-[#0f172a] border-r border-white/20 shadow-md",J={minWidth:"130px"}):u.key==="logo"?(U="sticky z-30 bg-[#0f172a]",J={left:"175px",width:"50px",minWidth:"50px"}):u.key==="pageName"?(U="sticky z-30 bg-[#0f172a] shadow-md",J={left:"225px",minWidth:"160px"}):u.key.includes("total")&&(U="sticky z-30 bg-[#0f172a] border-r border-white/20 shadow-lg",J={left:"385px",width:"100px",minWidth:"100px"})),D===0?e.jsx("td",{className:`${$} uppercase tracking-widest text-white font-black ${U}`,style:J,colSpan:4,children:"សរុបរួម (GRAND TOTAL)"},u.key):["teamName","logo","pageName"].includes(u.key)?null:u.key.includes("total")?e.jsxs("td",{className:`${$} text-right ${U} ${I==="Revenue"?"text-blue-300 bg-blue-600/10":"text-green-300 bg-green-600/10"}`,style:J,children:["$",(I==="Revenue"?w.revenue:w.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},u.key):u.key.startsWith(A)?e.jsxs("td",{className:`${$} text-right text-gray-300 font-mono`,children:["$",w[u.key].toLocaleString(void 0,{minimumFractionDigits:2})]},u.key):e.jsx("td",{className:$},u.key)})})})]})})]})};return e.jsxs(e.Fragment,{children:[G("Revenue","rev"),G("Profit","prof")]})},Je=({data:i,dataType:w,rowSpans:g,displayRow:l,MONTHS:h,grandTotals:L})=>e.jsx("div",{className:"bg-[#0f172a] border border-white/10 rounded-[2.5rem] overflow-hidden shadow-2xl animate-fade-in flex flex-col w-full relative",children:e.jsx("div",{className:"overflow-x-auto custom-scrollbar w-full relative",children:e.jsxs("table",{className:"w-max min-w-full text-sm border-separate border-spacing-0",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"h-16 bg-[#0f172a]",children:[e.jsx("th",{className:"sticky left-0 z-30 bg-[#0f172a] px-2 text-center text-gray-500 font-black border-b border-white/10 w-[50px] min-w-[50px] border-r border-white/5",children:"#"}),e.jsx("th",{className:"sticky left-[50px] z-30 bg-[#0f172a] px-4 text-left text-white font-black uppercase tracking-wider border-b border-white/10 w-[110px] min-w-[110px] border-r border-white/5",children:"Team"}),e.jsx("th",{className:"sticky left-[160px] z-30 bg-[#0f172a] px-4 text-left text-white font-black uppercase tracking-wider border-b border-white/10 w-[200px] min-w-[200px] shadow-[6px_0_15px_-3px_rgba(0,0,0,0.5)] border-r border-white/5",children:"Page Name"}),e.jsxs("th",{className:`px-6 text-right font-black uppercase tracking-wider border-b border-white/10 ${w==="revenue"?"text-blue-300 bg-blue-900/10":"text-green-300 bg-green-900/10"} min-w-[140px]`,children:["Total ",w==="revenue"?"Rev":"Prof"]}),h.map(C=>e.jsx("th",{className:"px-4 text-right text-gray-400 font-bold uppercase border-b border-white/10 min-w-[90px]",children:C},C))]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:i.map((C,j)=>{const _=Array.from(String(C.teamName)).reduce((z,t)=>z+t.charCodeAt(0),0)%5,W=["bg-blue-500/[0.02]","bg-purple-500/[0.02]","bg-emerald-500/[0.02]","bg-orange-500/[0.02]","bg-pink-500/[0.02]"][_],p="bg-[#111827]",V=w==="revenue"?"rev":"prof";return e.jsxs("tr",{className:`${W} hover:bg-white/5 transition-colors h-16 group`,children:[e.jsx("td",{className:`sticky left-0 z-20 ${p} border-r border-white/5 border-b border-white/5 text-center font-bold text-gray-600`,children:j+1}),l[j]?e.jsx("td",{rowSpan:g[j],className:`sticky left-[50px] z-20 ${p} border-r border-white/5 border-b border-white/5 align-middle px-4`,children:e.jsx("div",{className:"font-black text-white bg-gray-800 border border-white/10 px-2.5 py-1.5 rounded-xl inline-block shadow-sm text-[10px] tracking-wide truncate max-w-[90px]",children:C.teamName})}):null,e.jsx("td",{className:`sticky left-[160px] z-20 ${p} border-r border-white/5 border-b border-white/5 shadow-[6px_0_15px_-3px_rgba(0,0,0,0.5)] px-4`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg p-0.5 bg-gray-800 border border-white/10 flex-shrink-0",children:e.jsx("img",{src:H(C.logoUrl),className:"w-full h-full rounded-md object-cover",alt:""})}),e.jsx("span",{className:"truncate max-w-[140px] text-xs font-bold text-gray-200 group-hover:text-white transition-colors",title:C.pageName,children:C.pageName})]})}),e.jsxs("td",{className:`px-6 text-right font-black ${w==="revenue"?"text-blue-400 bg-blue-900/5":"text-emerald-400 bg-emerald-900/5"} border-r border-white/5 border-b border-white/5 text-sm`,children:["$",(w==="revenue"?C.revenue:C.profit).toLocaleString()]}),h.map(z=>{const t=C[`${V}_${z}`]||0;return e.jsx("td",{className:`px-4 text-right font-mono text-xs border-b border-white/5 ${t>0?"text-gray-300 font-bold":"text-gray-700"}`,children:t!==0?t.toLocaleString():"-"},z)})]},C.pageName)})}),L&&e.jsx("tfoot",{className:"bg-[#0f172a] font-black border-t-2 border-white/20",children:e.jsxs("tr",{className:"h-16",children:[e.jsx("td",{className:"sticky left-0 bg-[#0f172a] z-30 border-r border-white/5 border-b border-white/5"}),e.jsx("td",{className:"sticky left-[50px] bg-[#0f172a] z-30 border-r border-white/5 border-b border-white/5"}),e.jsx("td",{className:"sticky left-[160px] bg-[#0f172a] z-30 px-4 text-right uppercase tracking-widest text-white shadow-[6px_0_15px_-3px_rgba(0,0,0,0.5)] border-r border-white/5 border-b border-white/5 text-xs flex items-center justify-end h-16",children:"Grand Total"}),e.jsxs("td",{className:`px-6 text-right ${w==="revenue"?"text-blue-300":"text-green-300"} border-r border-white/5 border-b border-white/5 text-base bg-[#1e293b]`,children:["$",(w==="revenue"?L.revenue:L.profit).toLocaleString()]}),h.map(C=>{const _=L[`${w==="revenue"?"rev":"prof"}_${C}`]||0;return e.jsx("td",{className:"px-4 text-right text-gray-400 font-mono text-[10px] border-b border-white/5 bg-[#0f172a]",children:_!==0?_.toLocaleString():"-"},C)})]})})]})})}),Ye=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ge=({data:i,grandTotals:w,onPreviewImage:g})=>{const[l,h]=r.useState("table"),[L,C]=r.useState("revenue"),{rowSpans:j,displayRow:_}=r.useMemo(()=>{if(l!=="table")return{rowSpans:[],displayRow:[]};const P=new Array(i.length).fill(0),W=new Array(i.length).fill(!0);let p=0;for(;p<i.length;){const V=i[p].teamName;let z=1;for(;p+z<i.length&&i[p+z].teamName===V;)z++;P[p]=z,W[p]=!0;for(let t=1;t<z;t++)P[p+t]=0,W[p+t]=!1;p+=z}return{rowSpans:P,displayRow:W}},[i,l]);return e.jsxs("div",{className:"hidden md:block xl:hidden space-y-5 pb-12 px-1",children:[e.jsxs("div",{className:"bg-gray-900/80 backdrop-blur-xl p-4 rounded-3xl border border-white/10 shadow-2xl flex flex-col sm:flex-row justify-between items-center gap-4 sticky top-20 z-40",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-blue-900/30",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-white uppercase tracking-tight",children:"Tablet Report"}),e.jsxs("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),i.length," Active Pages"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"bg-black/40 p-1.5 rounded-2xl border border-white/5 flex",children:[e.jsx("button",{onClick:()=>C("revenue"),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-wider transition-all ${L==="revenue"?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Revenue"}),e.jsx("button",{onClick:()=>C("profit"),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-wider transition-all ${L==="profit"?"bg-emerald-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Profit"})]}),e.jsxs("div",{className:"bg-black/40 p-1.5 rounded-2xl border border-white/5 flex",children:[e.jsx("button",{onClick:()=>h("table"),className:`p-2.5 rounded-xl transition-all ${l==="table"?"bg-gray-700 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("button",{onClick:()=>h("grid"),className:`p-2.5 rounded-xl transition-all ${l==="grid"?"bg-gray-700 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2z"})})})]})]})]}),l==="grid"?e.jsx("div",{className:"grid grid-cols-2 gap-5 animate-fade-in",children:i.map(P=>e.jsxs("div",{className:"bg-gray-800/40 border border-white/10 rounded-[2.5rem] p-6 shadow-xl flex flex-col relative overflow-hidden group hover:border-blue-500/30 transition-all",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-white/5 to-transparent rounded-bl-[100px] pointer-events-none transition-opacity group-hover:opacity-100 opacity-50"}),e.jsxs("div",{className:"flex items-center gap-5 mb-5 relative z-10",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl overflow-hidden border-2 border-gray-700 bg-gray-950 p-0.5 flex-shrink-0 shadow-2xl group-hover:scale-105 transition-transform",children:e.jsx("img",{src:H(P.logoUrl),className:"w-full h-full object-cover rounded-xl",alt:"",onClick:()=>g(H(P.logoUrl))})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-base font-black text-white truncate leading-tight uppercase tracking-tight",children:P.pageName}),e.jsx("span",{className:"text-[10px] bg-blue-900/30 text-blue-300 px-3 py-1 rounded-full border border-blue-500/20 font-black uppercase mt-1.5 inline-block tracking-widest",children:P.teamName})]})]}),e.jsxs("div",{className:"space-y-3 flex-grow relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Revenue"}),e.jsxs("span",{className:"text-base font-black text-blue-400 tracking-tight",children:["$",P.revenue.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-2xl border border-white/5",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Profit"}),e.jsxs("span",{className:"text-base font-black text-emerald-400 tracking-tight",children:["$",P.profit.toLocaleString()]})]})]})]},P.pageName))}):e.jsx(Je,{data:i,dataType:L,rowSpans:j,displayRow:_,MONTHS:Ye,grandTotals:w})]})},Ke=({data:i,onPreviewImage:w})=>e.jsxs("div",{className:"md:hidden space-y-4 pb-12 px-1",children:[e.jsxs("h3",{className:"text-lg font-black text-white px-2 flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"w-1.5 h-5 bg-indigo-500 rounded-full"}),"របាយការណ៍តាម Page (Mobile)"]}),i.map(g=>{const l=g.orderCount>0?g.revenue/g.orderCount:0;return e.jsxs("div",{className:"bg-gray-800/40 border border-white/10 rounded-[2.5rem] p-6 shadow-xl space-y-5 animate-fade-in-up group relative overflow-hidden",children:[e.jsx("div",{className:"flex justify-between items-center border-b border-white/5 pb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl overflow-hidden border border-gray-700 bg-gray-950 shadow-inner p-0.5",children:e.jsx("img",{src:H(g.logoUrl),className:"w-full h-full object-cover rounded-lg",alt:"",onClick:()=>w(H(g.logoUrl))})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-base font-black text-white truncate leading-tight uppercase tracking-tight",children:g.pageName}),e.jsx("p",{className:"text-[10px] text-indigo-400 font-black uppercase tracking-[0.2em] mt-1",children:g.teamName})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"ចំណូលសរុប"}),e.jsxs("p",{className:"text-lg font-black text-blue-400 tracking-tighter",children:["$",g.revenue.toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"ប្រាក់ចំណេញ"}),e.jsxs("p",{className:"text-lg font-black text-emerald-400 tracking-tighter",children:["$",g.profit.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:[g.orderCount," Orders"]})]}),e.jsxs("span",{className:"text-[10px] font-black text-purple-400 uppercase tracking-widest",children:["AOV: $",l.toFixed(0)]})]}),e.jsx("div",{className:"absolute -right-8 -bottom-8 w-24 h-24 bg-indigo-600/10 rounded-full blur-[40px] pointer-events-none group-hover:bg-indigo-600/20 transition-all duration-700"})]},g.pageName)})]}),oe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Qe=({orders:i,onBack:w,team:g})=>{const{appData:l,previewImage:h}=r.useContext(me),[L,C]=r.useState(!0),[j,_]=r.useState(!1),[P,W]=r.useState(!0),[p,V]=r.useState(!0),[z,t]=r.useState(!1),[S,Z]=r.useState({key:"revenue",direction:"desc"}),[Q,X]=r.useState([]),[G,I]=r.useState(!1),[A,O]=r.useState("this_month"),[u,D]=r.useState(new Date().toISOString().split("T")[0]),[$,U]=r.useState(new Date().toISOString().split("T")[0]),J=async()=>{const a="user_sales_report_full_data",M=be.get(a);if(M)console.log("Using cached data for report"),X(M);else{console.log("Fetching fresh data for report..."),I(!0);try{const T=await(await fetch(`${ue}/api/admin/all-orders`)).json();if(T.status==="success"){const Y=(Array.isArray(T.data)?T.data.filter(ee=>ee!==null):[]).map(ee=>{let K=[];try{ee["Products (JSON)"]&&(K=JSON.parse(ee["Products (JSON)"]))}catch{}return{...ee,Products:K}});X(Y),be.set(a,Y,3e5)}}catch(y){console.error("Failed to fetch report data",y)}finally{I(!1)}}};r.useEffect(()=>{J()},[]);const se=a=>{Z(b=>({key:a,direction:b.key===a&&b.direction==="desc"?"asc":"desc"}))},v=a=>{O(a),J()},N=r.useMemo(()=>{const a=Q.length>0?Q:i,b=new Date,M=new Date(b.getFullYear(),b.getMonth(),b.getDate());let y=null,T=null;switch(A){case"today":y=M,T=new Date(M),T.setHours(23,59,59,999);break;case"yesterday":y=new Date(M),y.setDate(M.getDate()-1),T=new Date(M),T.setMilliseconds(-1);break;case"this_week":const E=b.getDay();y=new Date(M),y.setDate(M.getDate()-(E===0?6:E-1)),T=new Date(y),T.setDate(y.getDate()+6),T.setHours(23,59,59,999);break;case"this_month":y=new Date(b.getFullYear(),b.getMonth(),1),T=new Date(b.getFullYear(),b.getMonth()+1,0,23,59,59,999);break;case"last_month":y=new Date(b.getFullYear(),b.getMonth()-1,1),T=new Date(b.getFullYear(),b.getMonth(),0,23,59,59,999);break;case"all":y=null,T=null;break;case"custom":y=new Date(u+"T00:00:00"),T=new Date($+"T23:59:59");break}return a.filter(E=>{if((E.Team||"").trim().toLowerCase()!==g.trim().toLowerCase())return!1;if(!y)return!0;const Y=new Date(E.Timestamp);return T?Y>=y&&Y<=T:Y>=y})},[Q,i,g,A,u,$]),m=r.useMemo(()=>{const a={};l.pages&&l.pages.filter(y=>(y.Team||"").trim()===g).forEach(y=>{a[y.PageName]={pageName:y.PageName,teamName:g,logoUrl:y.PageLogoURL||"",revenue:0,profit:0,orderCount:0},oe.forEach(T=>{a[y.PageName][`rev_${T}`]=0,a[y.PageName][`prof_${T}`]=0})}),N.forEach(M=>{var ee;const y=M.Page||"Unknown";if(!a[y]){const K=(ee=l.pages)==null?void 0:ee.find(te=>te.PageName===y);a[y]={pageName:y,teamName:g,logoUrl:(K==null?void 0:K.PageLogoURL)||"",revenue:0,profit:0,orderCount:0},oe.forEach(te=>{a[y][`rev_${te}`]=0,a[y][`prof_${te}`]=0})}const T=Number(M["Grand Total"])||0,E=(Number(M["Total Product Cost ($)"])||0)+(Number(M["Internal Cost"])||0),Y=T-E;if(a[y].revenue+=T,a[y].profit+=Y,a[y].orderCount+=1,M.Timestamp){const K=new Date(M.Timestamp),te=oe[K.getMonth()];a[y][`rev_${te}`]+=T,a[y][`prof_${te}`]+=Y}});let b=Object.values(a);return p||(b=b.filter(M=>M.revenue>0)),b.sort((M,y)=>{const T=S.direction==="asc"?1:-1,E=M[S.key],Y=y[S.key];return typeof E=="string"?E.localeCompare(Y)*T:(E-Y)*T})},[N,S,l.pages,p,g]),k=r.useMemo(()=>{const a={revenue:0,profit:0,pagesCount:m.length,orders:0};return oe.forEach(b=>{a[`rev_${b}`]=0,a[`prof_${b}`]=0}),m.forEach(b=>{a.revenue+=b.revenue,a.profit+=b.profit,a.orders+=b.orderCount,oe.forEach(M=>{a[`rev_${M}`]+=b[`rev_${M}`],a[`prof_${M}`]+=b[`prof_${M}`]})}),a},[m]),B=()=>{t(!0),setTimeout(()=>{try{const a=new Be({orientation:"landscape"}),b=a.internal.pageSize.width;a.setFontSize(18),a.text(`Sales Report - Team: ${g}`,b/2,15,{align:"center"}),a.setFontSize(12),a.text(`Period: ${A.toUpperCase()}`,b/2,22,{align:"center"}),a.autoTable({startY:30,head:[["Metric","Value"]],body:[["Total Revenue",`$${k.revenue.toLocaleString()}`],["Total Orders",k.orders]],theme:"grid",headStyles:{fillColor:[41,128,185]}}),a.save(`Page_Report_${g}_${Date.now()}.pdf`)}catch(a){console.error(a),alert("Export failed")}finally{t(!1)}},100)},q=r.useMemo(()=>[...m].sort((a,b)=>b.revenue-a.revenue).slice(0,5).map(a=>({label:a.pageName,value:a.revenue,imageUrl:a.logoUrl})),[m]);return G&&Q.length===0?e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx(ne,{size:"lg"})}):e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:w,className:"bg-gray-800 p-3 rounded-2xl border border-gray-700 hover:bg-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-black text-white uppercase tracking-tighter italic",children:"Page Report"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:g})]})]}),e.jsxs("div",{className:"flex overflow-x-auto gap-2 p-1 bg-gray-900/50 rounded-2xl border border-white/5 max-w-full no-scrollbar",children:[["today","yesterday","this_week","this_month","last_month","all"].map(a=>e.jsx("button",{onClick:()=>v(a),className:`px-4 py-2 text-[10px] font-black uppercase rounded-xl whitespace-nowrap transition-all ${A===a?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:bg-white/5"}`,children:a.replace("_"," ")},a)),e.jsx("button",{onClick:()=>v("custom"),className:`px-4 py-2 text-[10px] font-black uppercase rounded-xl whitespace-nowrap transition-all ${A==="custom"?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:bg-white/5"}`,children:"Custom"})]})]}),A==="custom"&&e.jsxs("div",{className:"flex items-center gap-4 bg-gray-800/30 p-4 rounded-2xl border border-white/5 animate-fade-in-down",children:[e.jsx("input",{type:"date",value:u,onChange:a=>D(a.target.value),className:"bg-gray-900 border border-gray-700 rounded-xl px-4 py-2 text-white text-xs font-bold"}),e.jsx("span",{className:"text-gray-500 font-bold",children:"-"}),e.jsx("input",{type:"date",value:$,onChange:a=>U(a.target.value),className:"bg-gray-900 border border-gray-700 rounded-xl px-4 py-2 text-white text-xs font-bold"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(de,{label:"ចំណូលសរុប (Revenue)",value:`$${k.revenue.toLocaleString()}`,icon:"💰",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(de,{label:"ការកម្មង់ (Orders)",value:k.orders,icon:"📦",colorClass:"from-purple-600 to-pink-500"}),e.jsx(de,{label:"Page សកម្ម",value:k.pagesCount,icon:"📄",colorClass:"from-orange-500 to-yellow-500"})]}),e.jsx(He,{data:m,grandTotals:k,sortConfig:S,onToggleSort:se,showAllPages:p,setShowAllPages:V,onExportPDF:B,isExporting:z,onPreviewImage:h}),e.jsx(Ge,{data:m,grandTotals:k,onPreviewImage:h}),e.jsx(Ke,{data:m,onPreviewImage:h}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 pb-10",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(Re,{data:q,title:"Page ដែលមានចំណូលខ្ពស់បំផុត (Top 5 Pages Revenue)"})})}),e.jsxs("div",{className:"lg:col-span-4 flex flex-col justify-center page-card !p-5 bg-gray-800/30 border-gray-700/50",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-6",children:[e.jsx("span",{className:"w-1.5 h-4 bg-indigo-500 rounded-full"}),"សង្ខេប"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"ចំនួន Page សកម្ម:"}),e.jsx("span",{className:"text-white font-black text-sm",children:k.pagesCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"មធ្យមភាគ/Page:"}),e.jsxs("span",{className:"text-blue-400 font-black text-sm",children:["$",(k.revenue/(k.pagesCount||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},Xe=({team:i,onAdd:w})=>{const[g,l]=r.useState([]),[h,L]=r.useState([]),[C,j]=r.useState(!0),[_,P]=r.useState(!1),[W,p]=r.useState(""),[V,z]=r.useState(!1),[t,S]=r.useState("today"),[Z,Q]=r.useState(new Date().toISOString().split("T")[0]),[X,G]=r.useState(new Date().toISOString().split("T")[0]),I=r.useRef([]),A=r.useRef(!1),O=r.useMemo(()=>new Set(["index","orderId","customerName","productInfo","location","pageInfo","total","shippingService","status","date","print"]),[]),u=v=>{const N=new Date,m=new Date(N.getFullYear(),N.getMonth(),N.getDate());let k=null,B=new Date;switch(v){case"today":k=m;break;case"yesterday":k=new Date(m),k.setDate(m.getDate()-1),B=new Date(m),B.setMilliseconds(-1);break;case"this_week":const q=N.getDay();k=new Date(m),k.setDate(m.getDate()-(q===0?6:q-1));break;case"this_month":k=new Date(N.getFullYear(),N.getMonth(),1);break;case"custom":k=new Date(Z+"T00:00:00"),B=new Date(X+"T23:59:59");break}return{start:k,end:B}};r.useEffect(()=>{(async()=>{j(!0);try{const m=await(await fetch(`${ue}/api/admin/all-orders`)).json();if(m.status==="success"){const k=Array.isArray(m.data)?m.data.filter(B=>B!==null):[];I.current=k,A.current=!0,D("today")}}catch(N){console.error(N)}finally{j(!1)}})()},[]);const D=v=>{A.current&&(P(!0),setTimeout(()=>{const{start:N,end:m}=u(v),B=I.current.filter(a=>{if(!a.Timestamp)return!1;const b=new Date(a.Timestamp);return!(N&&b<N||m&&b>m)}).map(a=>{let b=[];try{a["Products (JSON)"]&&(b=JSON.parse(a["Products (JSON)"]))}catch{}return{...a,Products:b}});L(B);const q=B.filter(a=>(a.Team||"").trim()===(i||"").trim());l(q.sort((a,b)=>new Date(b.Timestamp).getTime()-new Date(a.Timestamp).getTime())),P(!1)},10))};r.useEffect(()=>{A.current&&D(t)},[t,Z,X,i]);const $=r.useMemo(()=>g.filter(v=>{if(W.trim()){const N=W.toLowerCase();return v["Order ID"].toLowerCase().includes(N)||(v["Customer Name"]||"").toLowerCase().includes(N)||(v["Customer Phone"]||"").includes(N)}return!0}),[g,W]),U=r.useMemo(()=>$.reduce((v,N)=>v+(Number(N["Grand Total"])||0),0),[$]),J=r.useMemo(()=>{const v={};return h.forEach(N=>{const m=(N.Team||"Unassigned").trim();v[m]=(v[m]||0)+(Number(N["Grand Total"])||0)}),Object.entries(v).map(([N,m])=>({name:N,revenue:m})).sort((N,m)=>m.revenue-N.revenue).slice(0,3)},[h]),se=r.useMemo(()=>{switch(t){case"today":return"ថ្ងៃនេះ";case"yesterday":return"ម្សិលមិញ";case"this_week":return"សប្តាហ៍នេះ";case"this_month":return"ខែនេះ";case"custom":return"តាមកំណត់";default:return""}},[t]);return C?e.jsxs("div",{className:"flex flex-col justify-center items-center h-96 gap-4",children:[e.jsx(ne,{size:"lg"}),e.jsx("p",{className:"text-[10px] font-black text-blue-500 uppercase tracking-[0.4em] animate-pulse",children:"Initializing Data Stream..."})]}):V?e.jsx("div",{className:"animate-fade-in p-2",children:e.jsx(Qe,{orders:g,onBack:()=>z(!1),team:i})}):e.jsxs("div",{className:"space-y-6 flex flex-col min-h-screen",children:[e.jsx("style",{children:`
                .hide-scrollbar::-webkit-scrollbar { display: none; }
                .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
            `}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-5 bg-blue-500 rounded-full"}),e.jsx("h3",{className:"text-xs font-black text-white uppercase tracking-widest",children:"តារាងក្រុមឆ្នើម"})]}),e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase",children:se})]}),e.jsx("div",{className:"flex overflow-x-auto gap-4 px-2 pb-4 hide-scrollbar snap-x",children:J.length===0?e.jsxs("div",{className:"text-gray-500 text-xs p-4 italic",children:["មិនមានទិន្នន័យសម្រាប់ ",se]}):J.map((v,N)=>e.jsxs("div",{className:"flex-shrink-0 w-[240px] sm:w-[300px] snap-center bg-gray-900/60 backdrop-blur-xl border border-white/5 p-5 rounded-[2rem] flex items-center gap-4 relative overflow-hidden",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl border ${N===0?"bg-yellow-500/20 text-yellow-500 border-yellow-500/30":N===1?"bg-gray-400/20 text-gray-300 border-gray-400/30":"bg-orange-600/20 text-orange-500 border-orange-600/30"}`,children:N===0?"🥇":N===1?"🥈":"🥉"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"text-sm font-black text-white truncate uppercase tracking-tighter",children:v.name}),e.jsxs("p",{className:"text-lg font-black text-blue-400",children:["$",v.revenue.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),e.jsx("div",{className:`absolute -right-4 -bottom-4 w-20 h-20 rounded-full blur-3xl opacity-10 ${N===0?"bg-yellow-500":N===1?"bg-gray-400":"bg-orange-600"}`})]},v.name))})]}),e.jsxs("div",{className:"bg-gray-900/60 backdrop-blur-3xl p-4 rounded-[2rem] border border-white/5 space-y-4 shadow-2xl mx-1",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto hide-scrollbar bg-black/40 p-1 rounded-xl border border-white/5",children:["today","this_week","this_month","custom"].map(v=>e.jsx("button",{onClick:()=>S(v),className:`flex-shrink-0 px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${t===v?"bg-blue-600 text-white shadow-lg shadow-blue-600/40":"text-gray-500"}`,children:v==="today"?"ថ្ងៃនេះ":v==="this_week"?"សប្តាហ៍នេះ":v==="this_month"?"ខែនេះ":"កំណត់"},v))}),e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest",children:"ប្រតិបត្តិការណ៍"}),e.jsxs("span",{className:"text-lg font-black text-white",children:[$.length," ",e.jsx("span",{className:"text-[10px] text-gray-600 italic",children:"Orders"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-[9px] font-black text-blue-500 uppercase tracking-widest",children:"ទឹកប្រាក់សរុប"}),e.jsxs("p",{className:"text-xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-blue-200 to-blue-400",children:["$",U.toLocaleString(void 0,{minimumFractionDigits:0})]})]})]}),e.jsxs("button",{onClick:()=>z(!0),className:"w-full py-3 bg-indigo-600/10 border border-indigo-500/30 text-indigo-400 rounded-xl font-black uppercase text-[10px] tracking-widest hover:bg-indigo-600 hover:text-white transition-all flex items-center justify-center gap-2 active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"មើលរបាយការណ៍ Page (Page Report)"]})]}),t==="custom"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 animate-fade-in-down",children:[e.jsx("input",{type:"date",value:Z,onChange:v=>Q(v.target.value),className:"bg-gray-800 border-none text-[10px] font-black text-white rounded-lg p-2"}),e.jsx("input",{type:"date",value:X,onChange:v=>G(v.target.value),className:"bg-gray-800 border-none text-[10px] font-black text-white rounded-lg p-2"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",placeholder:"ស្វែងរកតាម ID, ឈ្មោះ, ឬទូរស័ព្ទ...",value:W,onChange:v=>p(v.target.value),className:"w-full bg-black/40 border border-gray-800 rounded-xl py-3 pl-10 pr-4 text-xs font-bold text-white placeholder:text-gray-700 focus:border-blue-500/50 transition-all"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})]})]}),e.jsx("div",{className:"px-1",children:_?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(ne,{size:"md"})}):$.length===0?e.jsx("div",{className:"text-center py-20 bg-gray-800/10 rounded-[2rem] border-2 border-dashed border-gray-800/50",children:e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase tracking-widest italic",children:"រកមិនឃើញទិន្នន័យ"})}):e.jsx("div",{className:"animate-fade-in-up",children:e.jsx(Oe,{orders:$,showActions:!1,visibleColumns:O})})}),e.jsx("div",{className:"md:hidden fixed bottom-6 left-6 right-6 z-40",children:e.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-3xl p-4 rounded-3xl shadow-2xl border border-white/10 flex justify-between items-center ring-1 ring-white/5",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[8px] font-black text-blue-500 uppercase tracking-[0.2em] mb-0.5",children:"Session Revenue"}),e.jsxs("span",{className:"text-white font-black text-xl tracking-tighter",children:["$",U.toLocaleString()]})]}),e.jsx("button",{onClick:w,className:"bg-blue-600 hover:bg-blue-500 text-white p-4 rounded-2xl shadow-lg shadow-blue-600/40 active:scale-90 transition-all",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 4v16m8-8H4",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})})]})}),e.jsx("div",{className:"h-32 md:hidden"})]})},st=({onBackToRoleSelect:i})=>{const{currentUser:w,setChatVisibility:g}=r.useContext(me),[l,h]=r.useState("list"),[L,C]=Le("team",""),j=r.useMemo(()=>((w==null?void 0:w.Team)||"").split(",").map(_=>_.trim()).filter(Boolean),[w]);return r.useEffect(()=>{g(l!=="create")},[l,g]),r.useEffect(()=>{j.length===1&&!L&&C(j[0])},[j,L,C]),j.length===0?e.jsxs("div",{className:"page-card text-center p-12 mt-20 max-w-lg mx-auto bg-gray-900/60 backdrop-blur-xl border border-white/5 rounded-[3rem]",children:[e.jsxs("h2",{className:"text-xl font-black text-white mb-4",children:["សួស្តី, ",w==null?void 0:w.FullName]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"គណនីរបស់អ្នកមិនទាន់មានក្រុមការងារនៅឡើយទេ។"}),e.jsx("button",{onClick:i,className:"btn btn-secondary mt-8 w-full rounded-2xl font-black",children:"ត្រឡប់ក្រោយ"})]}):L?l==="create"?e.jsx(Ue,{team:L,onSaveSuccess:()=>h("list"),onCancel:()=>h("list")}):e.jsxs("div",{className:"w-full max-w-[100rem] mx-auto p-2 sm:p-4 animate-fade-in min-h-screen relative overflow-x-hidden",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end mb-8 gap-4 px-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-black text-white italic tracking-tighter leading-none",children:"MY ORDERS"}),e.jsx("div",{className:"h-6 w-px bg-white/10"}),e.jsx("span",{className:"text-blue-500 font-black text-xs uppercase tracking-widest",children:L})]}),e.jsx("div",{className:"flex gap-2",children:j.length>1&&e.jsxs("button",{onClick:()=>C(""),className:"text-[9px] font-black uppercase text-gray-500 hover:text-blue-400 transition-colors flex items-center gap-1.5 bg-gray-800/50 px-3 py-1.5 rounded-lg border border-white/5 active:scale-95",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4",strokeWidth:3})}),"Switch Team"]})})]}),e.jsxs("button",{onClick:()=>h("create"),className:"hidden md:flex px-10 py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white font-black uppercase tracking-widest text-xs rounded-2xl shadow-xl shadow-blue-900/20 transition-all active:scale-95 items-center gap-3 border border-blue-400/20",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M12 4v16m8-8H4"})}),"Create Order"]})]}),e.jsx("div",{className:"relative",children:e.jsx(Xe,{team:L,onAdd:()=>h("create")})})]}):e.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 mt-6 animate-fade-in flex flex-col items-center",children:[e.jsxs("div",{className:"text-center space-y-3 mb-10",children:[e.jsx("p",{className:"text-blue-500 font-black uppercase tracking-[0.4em] text-[10px]",children:"Access Identification"}),e.jsx("h2",{className:"text-4xl sm:text-5xl font-black text-white tracking-tighter italic",children:"ជ្រើសរើសក្រុមការងារ"}),e.jsx("div",{className:"w-16 h-1.5 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full mx-auto shadow-[0_0_15px_rgba(59,130,246,0.5)]"})]}),e.jsx("div",{className:"w-full space-y-4 max-w-md",children:j.map((_,P)=>e.jsxs("button",{onClick:()=>C(_),className:"group relative w-full overflow-hidden bg-gray-900/60 backdrop-blur-3xl border border-white/5 rounded-[2.5rem] p-6 hover:border-blue-500/40 transition-all duration-500 active:scale-[0.97] shadow-xl flex items-center gap-6",children:[e.jsxs("div",{className:"absolute top-4 left-6",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-ping opacity-75"}),e.jsx("div",{className:"absolute top-0 w-1.5 h-1.5 bg-emerald-500 rounded-full"})]}),e.jsx("div",{className:"relative z-10 w-16 h-16 sm:w-20 sm:h-20 bg-gray-800 rounded-3xl flex items-center justify-center border border-white/5 shadow-inner group-hover:bg-blue-600/10 group-hover:border-blue-500/20 transition-all duration-500 group-hover:rotate-6",children:e.jsx("span",{className:"text-3xl sm:text-4xl font-black text-transparent bg-clip-text bg-gradient-to-br from-blue-400 to-blue-600",children:_.charAt(0)})}),e.jsxs("div",{className:"relative z-10 flex-grow text-left",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-black text-white uppercase tracking-tight mb-1",children:_}),e.jsxs("p",{className:"text-[9px] text-gray-500 font-bold uppercase tracking-widest opacity-60",children:["Team Operational Node ",P+1]})]}),e.jsx("div",{className:"relative z-10 p-3 bg-white/5 rounded-2xl group-hover:bg-blue-600 group-hover:text-white transition-all text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M9 5l7 7-7 7",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/0 via-blue-600/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),e.jsx("div",{className:"absolute -bottom-10 -right-10 w-32 h-32 bg-blue-500 opacity-0 group-hover:opacity-5 blur-[40px] transition-opacity"})]},_))}),e.jsxs("button",{onClick:i,className:"mt-12 flex items-center gap-2 text-[10px] font-black text-gray-600 uppercase tracking-widest hover:text-blue-500 transition-all active:scale-95",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M15 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),"ត្រឡប់ទៅតួនាទី"]})]})};export{st as default};
