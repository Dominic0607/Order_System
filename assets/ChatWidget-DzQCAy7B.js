import{r as a,j as t,S as We,A as ut,d as Oe,N as _e,W as L,c as ht,R as Ve,f as ft}from"./index-DZxpEuRM.js";import{c as pt}from"./imageCompressor-D5vYYzIg.js";import{U as Se}from"./UserAvatar-BCwvITrW.js";import{r as Be,s as ze}from"./notificationUtils-Daxn_erD.js";import{a as M,f as He}from"./dateUtils-cpsDkxhO.js";const mt=["audio/mp4","audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/ogg"],xt=()=>{const[g,E]=a.useState(!1),l=a.useRef(null),x=a.useRef([]),A=a.useRef("audio/webm");return{isRecording:g,startRecording:async()=>{if(!g)try{const u=await navigator.mediaDevices.getUserMedia({audio:!0}),y=mt.find(j=>MediaRecorder.isTypeSupported(j));if(!y){alert("Your browser does not support any of the required audio recording formats."),console.error("No supported audio MIME types found.");return}A.current=y,console.log(`Using MIME type for recording: ${y}`),l.current=new MediaRecorder(u,{mimeType:y}),x.current=[],l.current.ondataavailable=j=>{x.current.push(j.data)},l.current.onstop=()=>{u.getTracks().forEach(j=>j.stop())},l.current.start(),E(!0)}catch(u){console.error("Error starting audio recording:",u),u instanceof DOMException&&(u.name==="NotAllowedError"||u.name==="PermissionDeniedError")?alert("áž€áž¶ážšáž¢áž“áž»áž‰áŸ’áž‰áž¶ážáž±áŸ’áž™áž”áŸ’ážšáž¾áž˜áž¸áž€áŸ’ážšáž¼áž áŸ’ážœáž¼áž“ážáŸ’ážšáž¼ážœáž”áž¶áž“áž”ážŠáž·ážŸáŸáž’áŸ” ážŸáž¼áž˜áž¢áž“áž»áž‰áŸ’áž‰áž¶ážáž±áŸ’áž™áž…áž¼áž›áž”áŸ’ážšáž¾áž˜áž¸áž€áŸ’ážšáž¼áž áŸ’ážœáž¼áž“áž“áŸ…áž€áŸ’áž“áž»áž„áž€áž¶ážšáž€áŸ†ážŽážáŸ‹áž€áž˜áŸ’áž˜ážœáž·áž’áž¸ážšáž»áž€ážšáž€ážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€ ážŠáž¾áž˜áŸ’áž”áž¸áž”áŸ’ážšáž¾áž˜áž»ážáž„áž¶ážšáž“áŸáŸ‡áŸ”"):alert("áž˜áž·áž“áž¢áž¶áž…áž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜áž€áž¶ážšážážážŸáŸ†áž¡áŸáž„áž”áž¶áž“áž‘áŸáŸ” ážŸáž¼áž˜áž”áŸ’ážšáž¶áž€ážŠážáž¶áž¢áŸ’áž“áž€áž”áž¶áž“áž—áŸ’áž‡áž¶áž”áŸ‹áž˜áž¸áž€áŸ’ážšáž¼áž áŸ’ážœáž¼áž“ áž áž¾áž™áž”áž¶áž“áž•áŸ’ážáž›áŸ‹áž€áž¶ážšáž¢áž“áž»áž‰áŸ’áž‰áž¶ážáŸ”")}},stopRecording:()=>new Promise(u=>{if(!l.current||!g){u(null);return}l.current.onstop=()=>{const y=new Blob(x.current,{type:A.current});l.current&&l.current.stream.getTracks().forEach(j=>j.stop()),u(y)},l.current.stop(),E(!1)})}},gt=({src:g,duration:E,isMe:l=!1})=>{const x=a.useRef(null),[A,R]=a.useState(!1),[P,u]=a.useState(0),[y,j]=a.useState(0),[ee,J]=a.useState(!1),[te,U]=a.useState(null),_=d=>{if(!d)return 0;const p=d.split(":");return p.length!==2?0:parseInt(p[0])*60+parseInt(p[1])},k=a.useMemo(()=>P>0?P:_(E),[P,E]);a.useEffect(()=>()=>{const d=x.current;d&&(d.pause(),d.removeAttribute("src"),d.load())},[]);const B=d=>{const p=()=>{d.duration&&isFinite(d.duration)&&(u(d.duration),J(!0),U(null))},F=()=>j(d.currentTime),H=()=>{R(!1),j(0)},Y=()=>{console.error("Audio Error",d.error),U("Unavailable"),J(!1)};d.onloadedmetadata=p,d.oncanplay=p,d.ontimeupdate=F,d.onended=H,d.onerror=Y},w=()=>{const d=x.current;if(d){if(!ee&&!A&&!te){B(d),document.querySelectorAll("audio").forEach(p=>{p!==d&&p.pause()}),d.play().then(()=>{R(!0),J(!0)}).catch(p=>{console.error("Play failed",p),U("Unavailable")});return}A?(d.pause(),R(!1)):(document.querySelectorAll("audio").forEach(p=>{p!==d&&p.pause()}),d.play().catch(p=>console.error("Play failed",p)),R(!0))}},z=d=>{const p=parseFloat(d.target.value);x.current&&(x.current.currentTime=p,j(p))},I=d=>{if(!isFinite(d)||d<0)return"0:00";const p=Math.floor(d/60),F=Math.floor(d%60);return`${p}:${F<10?"0":""}${F}`};return te?t.jsx("div",{className:"text-[10px] text-red-300 bg-red-900/20 px-2 py-1 rounded",children:"Audio Unavailable"}):t.jsxs("div",{className:`flex items-center gap-3 pr-4 pl-1 py-1 rounded-full min-w-[220px] transition-all ${l?"text-blue-100":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx("audio",{ref:x,src:g,preload:"metadata"}),t.jsx("button",{onClick:w,disabled:!ee&&!E,className:`w-9 h-9 flex items-center justify-center rounded-full shadow-md transition-all active:scale-95 flex-shrink-0 ${l?"bg-white text-blue-600 hover:bg-gray-100":"bg-blue-600 text-white hover:bg-blue-500"}`,children:!ee&&!E?t.jsx(We,{size:"sm"}):A?t.jsx("svg",{className:"w-3.5 h-3.5 fill-current",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}):t.jsx("svg",{className:"w-3.5 h-3.5 fill-current ml-0.5",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M8 5v14l11-7z"})})}),t.jsxs("div",{className:"flex flex-col flex-grow justify-center gap-1 min-w-[120px]",children:[t.jsx("input",{type:"range",min:"0",max:k||100,value:y,onChange:z,className:`w-full h-1.5 rounded-lg appearance-none cursor-pointer focus:outline-none focus:ring-0 ${l?"bg-blue-800/30 accent-white":"bg-gray-300 dark:bg-gray-600 accent-blue-600"}`}),t.jsxs("div",{className:"flex justify-between w-full text-[10px] font-mono font-medium opacity-90 px-0.5",children:[t.jsx("span",{children:I(y)}),t.jsx("span",{children:I(k)})]})]})]})},bt=({users:g,loading:E,onRefresh:l})=>E?t.jsxs("div",{className:"flex flex-col items-center justify-center py-10 space-y-3",children:[t.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Loading members..."})]}):!g||g.length===0?t.jsxs("div",{className:"text-center text-gray-500 py-10 flex flex-col items-center",children:[t.jsx("p",{className:"text-xs uppercase tracking-widest mb-2",children:"(No members found)"}),t.jsx("button",{onClick:l,className:"text-[10px] text-blue-400 hover:text-white underline",children:"Retry Loading"})]}):t.jsx("div",{className:"p-4 space-y-3 animate-fade-in",children:g.map(x=>t.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-2xl bg-gray-800/40 border border-white/5 hover:bg-gray-800 transition-colors cursor-default group",children:[t.jsx(Se,{avatarUrl:x.ProfilePictureURL,name:x.FullName,size:"md",className:"ring-2 ring-blue-500/20 group-hover:ring-blue-500/50 transition-all"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-black text-white",children:x.FullName}),t.jsxs("p",{className:"text-[10px] text-gray-500 font-mono uppercase tracking-wider",children:["@",x.UserName]})]}),t.jsx("div",{className:"ml-auto flex flex-col items-end gap-1",children:t.jsx("div",{className:`w-2 h-2 rounded-full ${x.IsSystemAdmin?"bg-yellow-500 shadow-[0_0_5px_#eab308]":"bg-blue-500 shadow-[0_0_5px_#3b82f6]"}`})})]},x.UserName))}),yt=Ve.memo(gt),Rt=({isOpen:g,onClose:E})=>{const{currentUser:l,appData:x,previewImage:A,setUnreadCount:R,showNotification:P,advancedSettings:u}=a.useContext(ut),y=a.useMemo(()=>l?`chatHistoryCache_${l.UserName}`:null,[l]),{isRecording:j,startRecording:ee,stopRecording:J}=xt(),[te,U]=a.useState(0),_=a.useRef(null),k=a.useRef(null),B=a.useRef(null);a.useEffect(()=>{k.current=new Audio(Oe.NOTIFICATION),B.current=new Audio(Oe.SENT)},[]);const[w,z]=a.useState(()=>{if(!y)return[];try{const e=localStorage.getItem(y);return e&&e!=="undefined"?JSON.parse(e).slice(-20):[]}catch{return[]}}),[I,d]=a.useState([]),[p,F]=a.useState(!1),[H,Y]=a.useState(""),[Je,Ce]=a.useState(!1),[Te,fe]=a.useState(!1),[q,Ye]=a.useState(()=>localStorage.getItem("chatMuted")==="true"),[ae,Me]=a.useState(!1),[qe,pe]=a.useState("disconnected"),[O,Ee]=a.useState("chat"),[Ke,Qe]=a.useState(!1),[Ie,Le]=a.useState(!1),[ne,$e]=a.useState(""),[Ge,me]=a.useState(!1),[S,xe]=a.useState(null),Ue=a.useRef(null),ge=a.useRef(null),D=a.useRef(null),be=a.useRef(null),K=a.useRef(g),De=a.useRef(I),ye=a.useRef(l),we=a.useRef(q),W=a.useRef(null),V=a.useRef([]),Ae=a.useRef(!1),Q=a.useRef(null),ve=a.useRef(!1),re=a.useRef(!1),Ne=a.useRef(!1),oe=a.useMemo(()=>w.filter(e=>e.isPinned&&!e.isDeleted),[w]);a.useEffect(()=>{if(y&&V.current.length===0)try{const e=localStorage.getItem(y);if(e&&e!=="undefined"){const r=JSON.parse(e);r.length>20&&(V.current=r.slice(0,-20))}}catch{}},[y]),a.useEffect(()=>{const e=(u==null?void 0:u.notificationSound)||"default",r=_e.find(n=>n.id===e)||_e[0],s=(u==null?void 0:u.notificationVolume)??1;k.current&&(k.current.src=r.url,k.current.volume=s),B.current&&(B.current.volume=s)},[u==null?void 0:u.notificationSound,u==null?void 0:u.notificationVolume]),a.useEffect(()=>{De.current=I},[I]),a.useEffect(()=>{ye.current=l},[l]),a.useEffect(()=>{we.current=q},[q]),a.useEffect(()=>{K.current=g},[g]),a.useEffect(()=>{if(w.length>0&&!W.current){const e=[...w].sort((r,s)=>M(r.timestamp)-M(s.timestamp));W.current=e[e.length-1].id}},[]);const je=a.useCallback(async()=>{if(x.users&&x.users.length>0){d(x.users),F(!1);return}F(!0);try{const r=await(await fetch(`${L}/api/users`)).json();r.status==="success"&&Array.isArray(r.data)&&d(r.data)}catch(e){console.warn("Fallback user fetch failed",e)}finally{F(!1)}},[x.users]);a.useEffect(()=>{je()},[je]),a.useEffect(()=>{g?R(0):re.current=!1},[g,R]),a.useEffect(()=>{Be()},[]);const Xe=async()=>{await ee(),U(0),_.current=setInterval(()=>{U(e=>e+1)},1e3)},Ze=async()=>{await J(),_.current&&clearInterval(_.current),U(0)},et=async()=>{_.current&&clearInterval(_.current),fe(!0);try{const e=await J();if(!e)throw new Error("No audio captured");const r=new FileReader;r.readAsDataURL(e),r.onloadend=async()=>{const n=r.result.split(",")[1];try{const i=await fetch(`${L}/api/upload-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileData:n,fileName:`voice_${Date.now()}.webm`,mimeType:"audio/webm",userName:(l==null?void 0:l.UserName)||"unknown"})}),c=await i.json();if(!i.ok||c.status!=="success")throw new Error(c.message||"Audio upload failed");let o=c.fileId||c.id;if(!o&&c.url){const v=c.url.match(/(?:d\/|id=)([^/?&]+)/);v&&v[1]&&(o=v[1])}if(!o)throw console.error("Could not determine FileID from upload result:",c),new Error("Failed to get File ID");const f=Pe(te);await de(f,"audio",o)}catch(i){console.error("Audio Upload Workflow Failed",i),alert("áž€áž¶ážšáž”áž‰áŸ’áž‡áž¼áž“ážŸáž˜áŸ’áž›áŸáž„áž”ážšáž¶áž‡áŸáž™ (Failed to upload audio).")}finally{fe(!1),U(0)}}}catch(e){console.error("Recording Error",e),fe(!1),U(0)}},Pe=e=>{const r=Math.floor(e/60),s=e%60;return`${r}:${s<10?"0":""}${s}`},se=a.useCallback(e=>{z(r=>{const s=typeof e=="function"?e(r):e;if(y){const n=[...V.current,...s];localStorage.setItem(y,JSON.stringify(n.slice(-500)))}return s})},[y]),ie=a.useCallback(e=>{const r=De.current.find(c=>c.UserName===e.UserName),s=(e.MessageType||"text").toLowerCase();let n=e.Content,i;return(s==="audio"||s==="video")&&e.FileID?(n=`${L}/api/chat/${s}/${e.FileID}`,i=e.Content):s==="image"&&(n=ht(e.Content)),{id:e.Timestamp,user:e.UserName,fullName:(r==null?void 0:r.FullName)||e.UserName,avatar:(r==null?void 0:r.ProfilePictureURL)||"",content:n,timestamp:e.Timestamp,type:s,fileID:e.FileID,duration:i,isOptimistic:!1,isDeleted:e.IsDeleted,isPinned:e.IsPinned,replyTo:e.ReplyTo?{id:e.ReplyTo.ID,user:e.ReplyTo.User,content:e.ReplyTo.Content,type:e.ReplyTo.Type}:void 0}},[]),le=a.useCallback(e=>{if(e.length===0)return;const r=W.current;let s=[];const n=Date.now(),i=120*1e3;if(!r){W.current=e[e.length-1].id;return}const c=e.findIndex(o=>o.id===r);c!==-1?s=e.slice(c+1):s=e.filter(o=>o.id>r),s.forEach(o=>{var C;if(o.user===((C=ye.current)==null?void 0:C.UserName))return;const v=M(o.timestamp);if(n-v>i)return;const h=o.content&&o.content.includes("ðŸ“¢ NEW ORDER:"),N=o.content&&o.content.includes("ðŸ“¢ SYSTEM_ALERT:");if(h||N){let m=o.content;h?m=o.content.replace("ðŸ“¢ NEW ORDER:","").trim():N&&(m=o.content.replace("ðŸ“¢ SYSTEM_ALERT:","").trim()),P(m,"success"),!we.current&&k.current&&(k.current.currentTime=0,k.current.play().catch($=>console.warn("Audio play failed",$))),ze("áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹ážáŸ’áž˜áž¸ ðŸ“¦",m)}else{const m=o.fullName||o.user;let $=o.content;o.type==="image"?$="ðŸ“· Sent an image":o.type==="audio"&&($="ðŸŽ¤ Sent a voice message"),P(`${m}: ${$}`,"info"),(document.hidden||!K.current)&&(ze(m,$),K.current||R(X=>X+1)),!we.current&&k.current&&(k.current.currentTime=0,k.current.play().catch(()=>{}))}}),s.length>0&&(W.current=s[s.length-1].id)},[P,R]),G=a.useCallback(async(e=!1,r=!1)=>{if(ve.current)return;w.length===0&&K.current&&Me(!0),ve.current=!0;const n=D.current,i=r&&n?n.scrollHeight:0;Q.current&&Q.current.abort(),Q.current=new AbortController;const c=Q.current.signal;try{const o=e,f=o?`${L}/api/chat/messages`:`${L}/api/chat/messages?days=2&limit=20`;o&&(Ae.current=!0);const v=await fetch(f,{signal:c});if(!v.ok)throw new Error(`HTTP error! status: ${v.status}`);const h=await v.json();if(h.status==="success"){const C=h.data.map(ie).sort((m,$)=>M(m.timestamp)-M($.timestamp));le(C),se(m=>{const $=m.filter(b=>b.isOptimistic),X=m.filter(b=>!b.isOptimistic),ct=[...X,...V.current,...C],Fe=new Set,Z=ct.filter(b=>Fe.has(b.id)?!1:(Fe.add(b.id),!0)).sort((b,T)=>M(b.timestamp)-M(T.timestamp));let ue=[],ke=[];if(Ne.current||X.length===0)ue=Z.slice(-20),ke=Z.slice(0,-20);else{const b=X[0].id;let T=Z.findIndex(Re=>Re.id===b);T===-1&&(T=Math.max(0,Z.length-X.length)),r&&(T=Math.max(0,T-20)),ue=Z.slice(T),ke=Z.slice(0,T)}V.current=ke,Ne.current=!1,r&&i>0&&requestAnimationFrame(()=>{if(D.current){const b=D.current.scrollHeight;D.current.scrollTop=b-i}});const dt=$.filter(b=>{const T=ue.some(he=>he.user===b.user&&he.type===b.type&&(he.content===b.content||Math.abs(M(he.timestamp)-M(b.timestamp))<15e3)),Re=Date.now()-M(b.timestamp)>3e4;return!T&&!Re});return[...ue,...dt].sort((b,T)=>M(b.timestamp)-M(T.timestamp))})}}catch(o){o.name!=="AbortError"&&console.warn("Chat history service unavailable")}finally{Me(!1),ve.current=!1}},[ie,se,le,K,w.length]),ce=(e="smooth")=>{ge.current&&ge.current.scrollIntoView({behavior:e})};a.useEffect(()=>{const e=window.location.protocol==="https:"?"wss":"ws",r=L.replace(/^https?:\/\//,""),s=`${e}://${r}/api/chat/ws`,n=()=>{var c;if(((c=be.current)==null?void 0:c.readyState)===WebSocket.OPEN)return;pe("connecting");const i=new WebSocket(s);be.current=i,i.onopen=()=>{pe("connected"),G()},i.onclose=()=>{pe("disconnected"),setTimeout(n,3e3)},i.onmessage=o=>{try{const f=JSON.parse(o.data);if(f.action==="new_message"){const v=f.payload,h=ie(v);W.current&&h.id<=W.current||le([h]),se(N=>{if(N.some(m=>m.id===h.id))return N;const C=N.findIndex(m=>m.isOptimistic&&m.user===h.user&&m.type===h.type&&(m.type==="text"?m.content===h.content:!0));if(C!==-1){const m=[...N];return m[C]=h,m}return[...N,h]}),K.current&&setTimeout(()=>ce("smooth"),100)}}catch(f){console.error("WS Message Error",f)}}};return n(),()=>{var i;(i=be.current)==null||i.close()}},[le,ie,se]),a.useEffect(()=>{g?(R(0),Ne.current=!0,G()):re.current=!1},[g,G,R]),a.useEffect(()=>{const e=setInterval(()=>{document.visibilityState==="visible"&&G()},3e3);return()=>{clearInterval(e),Q.current&&Q.current.abort()}},[G]);const tt=()=>{if(!D.current)return;const{scrollTop:e,scrollHeight:r,clientHeight:s}=D.current,n=r-e-s<200;if(Qe(!n),e<5&&!Ie&&!ae)if(V.current.length>0){Le(!0);const i=D.current,c=i.scrollHeight;setTimeout(()=>{const o=V.current.splice(-20);o.length>0&&(se(f=>[...o,...f]),requestAnimationFrame(()=>{if(i){const f=i.scrollHeight;i.scrollTop=f-c}})),Le(!1)},400)}else Ae.current||G(!0,!0)};a.useEffect(()=>{if(!g||O!=="chat"||ae)return;const e=D.current;if(e){const{scrollTop:r,scrollHeight:s,clientHeight:n}=e,i=s-r-n<250,c=w[w.length-1];if((c==null?void 0:c.user)===(l==null?void 0:l.UserName)||c!=null&&c.isOptimistic||i||!re.current){const f=re.current?"smooth":"auto";ce(f),w.length>0&&(re.current=!0)}}else ce("auto")},[w,g,O,ae]);const de=async(e,r,s)=>{if(!e&&r==="text")return;const n=ye.current;if(!n){alert("Please login to send messages.");return}const i=Date.now().toString();let c=e,o;r==="image"&&!e.startsWith("http")&&!e.startsWith("data:")?c=`data:image/jpeg;base64,${e}`:r==="audio"&&s&&(c=`${L}/api/chat/audio/${s}`,o=e);const f={id:i,user:n.UserName||"Unknown",fullName:n.FullName||"Me",avatar:n.ProfilePictureURL||"",content:c,timestamp:new Date().toISOString(),type:r,fileID:s,duration:o,isOptimistic:!0,replyTo:S?{id:S.id,user:S.fullName||S.user,content:S.content,type:S.type}:void 0};z(h=>[...h,f]),r==="text"&&Y(""),xe(null);const v=r.charAt(0).toUpperCase()+r.slice(1);try{const h={userName:n.UserName,UserName:n.UserName,type:v,MessageType:v,content:e.trim(),Content:e.trim()};s&&(h.FileID=s,h.fileId=s),f.replyTo&&(h.ReplyTo={ID:f.replyTo.id,User:f.replyTo.user,Content:f.replyTo.content,Type:f.replyTo.type});const N=await fetch(`${L}/api/chat/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!N.ok){const C=await N.text();throw new Error(`Server returned ${N.status}: ${C}`)}q||(B.current.currentTime=0,B.current.play().catch(()=>{}))}catch(h){console.error("Send Error:",h),z(N=>N.filter(C=>C.id!==i)),r==="text"&&Y(e),alert("áž€áž¶ážšáž”áž‰áŸ’áž‡áž¼áž“ážŸáž¶ážšáž”ážšáž¶áž‡áŸáž™ (Send Failed). Please try again.")}},rt=async e=>{Ce(!0);try{const r=await pt(e),s=await ft(r),n=await fetch(`${L}/api/upload-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileData:s,fileName:`img_${Date.now()}.jpg`,mimeType:"image/jpeg",userName:(l==null?void 0:l.UserName)||"unknown"})}),i=await n.json();if(!n.ok||i.status!=="success")throw new Error(i.message||"Image upload failed");let c=i.fileId||i.id;if(!c&&i.url){const o=i.url.match(/(?:d\/|id=)([^/?&]+)/);o&&o[1]&&(c=o[1])}if(!c)throw new Error("Failed to get File ID");await de(i.url,"image",c)}catch(r){console.error("Image Upload Error:",r),alert("áž€áž¶ážšáž”áž‰áŸ’áž‡áž¼áž“ážšáž¼áž”áž—áž¶áž–áž”ážšáž¶áž‡áŸáž™ (Failed to upload image).")}finally{Ce(!1)}},st=async e=>{if(confirm("Are you sure you want to delete this message?")){z(r=>r.map(s=>s.id===e?{...s,isDeleted:!0}:s));try{await fetch(`${L}/api/chat/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messageId:e,userName:l==null?void 0:l.UserName})})}catch(r){console.error("Delete failed",r)}}},at=async(e,r)=>{z(s=>s.map(n=>n.id===e?{...n,isPinned:!r}:n));try{await fetch(`${L}/api/chat/pin`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messageId:e,isPinned:!r,userName:l==null?void 0:l.UserName})})}catch(s){console.error("Pin failed",s)}},nt=(e,r)=>{const s=document.createElement("a");s.href=e,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s)},ot=e=>{const r=e.target.value;Y(r);const s=r.split(/[\s\n]+/).pop();s&&s.startsWith("@")?($e(s.slice(1)),me(!0)):me(!1)},it=e=>{const r=H.split(/([\s\n]+)/),s=r.length-1;r[s]=`@${e} `,Y(r.join("")),me(!1),$e("");const n=document.querySelector(".chat-input-area textarea");n&&n.focus()},lt=e=>e.split(/(@[\w\u1780-\u17FF]+)/g).map((s,n)=>{if(s.startsWith("@")){const i=s.slice(1);if(I.some(o=>o.UserName===i||o.FullName===i)||s.length>2)return t.jsx("span",{className:"text-blue-300 font-bold bg-blue-500/20 px-1 rounded-md mx-0.5",children:s},n)}return t.jsx("span",{children:s},n)});return t.jsxs("div",{className:`chat-widget-container ${g?"":"closed"}`,children:[t.jsxs("div",{className:"chat-header",children:[t.jsxs("div",{className:"title-group flex items-center gap-2",children:[t.jsx("div",{className:`connection-status w-3 h-3 rounded-full ${qe==="connected"?"bg-green-500 shadow-[0_0_10px_#22c55e]":"bg-yellow-500 animate-pulse"}`}),t.jsx("h3",{className:"font-black text-white uppercase tracking-wider text-sm",children:"Team Chat"})]}),t.jsxs("div",{className:"controls flex items-center gap-2",children:[t.jsx("button",{onClick:()=>{const e=!q;Ye(e),localStorage.setItem("chatMuted",String(e)),e||Be().then(r=>{r&&console.log("Notification permission granted via toggle")})},className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:q?"ðŸ”‡":"ðŸ””"}),t.jsx("button",{onClick:E,className:"p-2 hover:bg-red-500/20 hover:text-red-400 rounded-full transition-colors text-gray-400",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),t.jsxs("div",{className:"chat-tabs bg-gray-900/50 p-1",children:[t.jsx("button",{onClick:()=>Ee("chat"),className:`text-xs font-bold uppercase tracking-wider transition-all ${O==="chat"?"active bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Chat Stream"}),t.jsx("button",{onClick:()=>Ee("users"),className:`text-xs font-bold uppercase tracking-wider transition-all ${O==="users"?"active bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:"Members"})]}),O==="chat"&&oe.length>0&&t.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-md border-b border-white/5 p-2.5 flex items-center gap-3 sticky top-0 z-30 shadow-2xl",children:[t.jsx("div",{className:"flex-shrink-0 flex items-center justify-center w-8 h-8 bg-yellow-500/10 rounded-xl border border-yellow-500/20",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-500 drop-shadow-[0_0_5px_rgba(234,179,8,0.5)]",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M16 12V4h1V2H7v2h1v8l-2 2v2h5v6l1 1 1-1v-6h5v-2l-2-2z"})})}),t.jsx("div",{className:"flex-grow overflow-hidden",children:t.jsx("div",{className:"flex gap-3 overflow-x-auto custom-scrollbar no-scrollbar py-0.5 px-0.5 snap-x",children:oe.map((e,r)=>t.jsxs("div",{className:"flex-shrink-0 min-w-[180px] max-w-[220px] bg-white/5 hover:bg-white/10 rounded-xl p-2 border border-white/5 cursor-pointer transition-all active:scale-95 snap-center group/pin",onClick:()=>{var s;return(s=document.getElementById(`msg-${e.id}`))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})},children:[t.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[t.jsxs("p",{className:"text-[10px] font-black text-yellow-500/80 uppercase tracking-wider truncate",children:["Pinned #",r+1]}),t.jsx("p",{className:"text-[9px] font-bold text-gray-500",children:e.fullName})]}),t.jsx("p",{className:"text-[11px] text-gray-200 truncate leading-tight",children:e.type==="text"?e.content:e.type==="image"?"ðŸ“· Photo":e.type==="audio"?"ðŸŽ¤ Voice":"ðŸŽ¥ Video"})]},e.id))})}),oe.length>1&&t.jsx("div",{className:"flex-shrink-0 bg-gray-800 px-2 py-1 rounded-lg border border-white/5 shadow-inner",children:t.jsx("p",{className:"text-[10px] font-black text-gray-400",children:oe.length})})]}),t.jsx("div",{className:"chat-body custom-scrollbar bg-[#0f172a] relative",ref:D,onScroll:tt,children:O==="chat"?t.jsxs("div",{className:"chat-messages p-4 space-y-6 min-h-full pb-20",children:[Ie&&t.jsx("div",{className:"flex justify-center py-2 animate-fade-in",children:t.jsxs("div",{className:"bg-gray-800/80 border border-white/5 px-4 py-1.5 rounded-full flex items-center gap-2 shadow-lg",children:[t.jsx("div",{className:"w-3 h-3 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400",children:"Loading messages..."})]})}),ae?t.jsxs("div",{className:"flex flex-col items-center justify-center py-10 space-y-3",children:[t.jsx(We,{size:"md"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Loading history..."})]}):w.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center opacity-50",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),t.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-gray-500",children:"No messages yet"}),t.jsx("p",{className:"text-[10px] text-gray-600 mt-1",children:"Start the conversation!"})]}):w.map((e,r)=>{const s=e.user===(l==null?void 0:l.UserName),n=I.find(h=>h.UserName===e.user),i=r===0||w[r-1].user!==e.user,c=e.content.includes("SYSTEM_ALERT")||e.content.includes("NEW ORDER"),o=He(e.timestamp),f=r>0?He(w[r-1].timestamp):null,v=o!==f;return t.jsxs(Ve.Fragment,{children:[v&&t.jsx("div",{className:"flex justify-center my-6",children:t.jsx("div",{className:"bg-gray-800/50 border border-gray-700/50 px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-[0.2em] text-gray-500 shadow-sm",children:o})}),t.jsx("div",{id:`msg-${e.id}`,className:`flex flex-col ${s?"items-end":"items-start"} animate-fade-in-up group/msg relative`,children:c?t.jsx("div",{className:"w-full flex justify-center my-2",children:t.jsx("div",{className:"bg-blue-900/40 border border-blue-500/30 rounded-xl px-4 py-2 text-[10px] font-bold text-blue-300 text-center shadow-lg",children:e.content.replace("ðŸ“¢ SYSTEM_ALERT:","").replace("ðŸ“¢ NEW ORDER:","").trim()})}):t.jsxs("div",{className:`flex max-w-[85%] gap-3 ${s?"flex-row-reverse":""}`,children:[t.jsx("div",{className:"flex-shrink-0 w-8 flex flex-col justify-end",children:i?t.jsx(Se,{avatarUrl:(n==null?void 0:n.ProfilePictureURL)||e.avatar,name:(n==null?void 0:n.FullName)||e.fullName,size:"sm",className:"ring-2 ring-white/10"}):t.jsx("div",{className:"w-8"})}),t.jsxs("div",{className:`relative px-4 py-3 shadow-lg transition-all ${s?"bg-blue-600 text-white rounded-2xl rounded-tr-sm":"bg-gray-800 text-gray-200 rounded-2xl rounded-tl-sm border border-white/5"} ${e.isOptimistic?"opacity-70":""} ${e.isDeleted?"italic opacity-60 border-dashed border-gray-600":""}`,children:[e.replyTo&&!e.isDeleted&&t.jsxs("div",{className:`mb-2 p-2 rounded-lg border-l-4 text-xs ${s?"bg-blue-700/50 border-blue-300":"bg-gray-900/50 border-gray-600"}`,children:[t.jsx("p",{className:"font-bold opacity-80",children:e.replyTo.user}),t.jsx("p",{className:"truncate opacity-70",children:e.replyTo.type==="text"?e.replyTo.content:`[${e.replyTo.type}]`})]}),!s&&i&&t.jsx("p",{className:"text-[10px] font-black text-blue-400 mb-1 uppercase tracking-wider",children:(n==null?void 0:n.FullName)||e.fullName}),e.isDeleted?t.jsx("p",{className:"text-sm text-gray-400",children:"ðŸš« This message was deleted"}):t.jsxs(t.Fragment,{children:[e.type==="text"&&t.jsx("p",{className:"leading-relaxed text-sm whitespace-pre-wrap",children:lt(e.content)}),e.type==="image"&&t.jsx("img",{src:e.content,loading:"lazy",className:"rounded-xl max-w-full cursor-pointer hover:opacity-90 transition-opacity border border-black/20",onClick:()=>A(e.content),alt:"attachment"}),e.type==="audio"&&t.jsx(yt,{src:e.content,duration:e.duration,isMe:s}),e.type==="video"&&t.jsxs("video",{controls:!0,className:"rounded-xl max-w-full border border-black/20",style:{maxHeight:"200px"},children:[t.jsx("source",{src:e.content,type:"video/mp4"}),"Your browser does not support the video tag."]})]}),t.jsxs("div",{className:"flex items-center justify-end gap-1.5 mt-1.5 border-t border-white/5 pt-1.5",children:[e.isPinned&&t.jsxs("div",{className:"flex items-center gap-1 bg-yellow-500/10 px-1.5 py-0.5 rounded-md border border-yellow-500/20 mr-auto",children:[t.jsx("svg",{className:"w-2.5 h-2.5 text-yellow-500",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M16 12V4h1V2H7v2h1v8l-2 2v2h5v6l1 1 1-1v-6h5v-2l-2-2z"})}),t.jsx("span",{className:"text-[8px] font-black text-yellow-500/80 uppercase tracking-tighter",children:"Pinned"})]}),t.jsx("p",{className:`text-[9px] font-medium ${s?"text-blue-200":"text-gray-500"}`,children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.isOptimistic&&t.jsxs("svg",{className:"w-3 h-3 text-white/50 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]}),!e.isDeleted&&!e.isOptimistic&&t.jsxs("div",{className:`absolute top-0 ${s?"-left-12":"-right-12"} opacity-0 group-hover/msg:opacity-100 transition-all duration-300 transform group-hover/msg:translate-x-0 ${s?"translate-x-2":"-translate-x-2"} flex flex-col gap-1.5 p-1 z-10`,children:[t.jsx("button",{onClick:()=>xe(e),className:"p-2 bg-gray-900/80 backdrop-blur-sm text-gray-400 hover:text-blue-400 rounded-xl shadow-xl border border-white/10 transition-all hover:scale-110 active:scale-90",title:"Reply",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("button",{onClick:()=>at(e.id,!!e.isPinned),className:`p-2 bg-gray-900/80 backdrop-blur-sm rounded-xl shadow-xl border border-white/10 transition-all hover:scale-110 active:scale-90 ${e.isPinned?"text-yellow-500 bg-yellow-500/10 border-yellow-500/20":"text-gray-400 hover:text-yellow-500"}`,title:e.isPinned?"Unpin":"Pin",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M16 12V4h1V2H7v2h1v8l-2 2v2h5v6l1 1 1-1v-6h5v-2l-2-2z"})})}),(e.type==="image"||e.type==="video")&&t.jsx("button",{onClick:()=>nt(e.content,`${e.type}_${e.id}.${e.type==="video"?"mp4":"jpg"}`),className:"p-2 bg-gray-900/80 backdrop-blur-sm text-gray-400 hover:text-emerald-400 rounded-xl shadow-xl border border-white/10 transition-all hover:scale-110 active:scale-90",title:"Download",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),s&&t.jsx("button",{onClick:()=>st(e.id),className:"p-2 bg-gray-900/80 backdrop-blur-sm text-red-400 hover:bg-red-500/20 rounded-xl shadow-xl border border-red-500/20 transition-all hover:scale-110 active:scale-90",title:"Delete",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})})]},e.id+r)}),t.jsx("div",{ref:ge})]}):t.jsx(bt,{users:I,loading:p,onRefresh:je})}),O==="chat"&&Ke&&t.jsx("button",{onClick:()=>ce("smooth"),className:"absolute bottom-24 right-6 p-3 bg-blue-600 text-white rounded-full shadow-lg shadow-blue-900/50 hover:bg-blue-500 transition-all animate-bounce z-50 flex items-center justify-center w-10 h-10 border border-blue-400/30",title:"Scroll to bottom",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),O==="chat"&&t.jsxs("div",{className:"chat-input-area p-3 bg-gray-900 border-t border-gray-800 relative z-20",children:[Ge&&t.jsxs("div",{className:"absolute bottom-full left-4 mb-2 bg-gray-800 border border-gray-700 rounded-xl shadow-xl w-64 max-h-60 overflow-y-auto custom-scrollbar z-50 animate-fade-in-up flex flex-col",children:[t.jsx("div",{className:"p-2 sticky top-0 bg-gray-800/95 backdrop-blur border-b border-gray-700 z-10",children:t.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:"Suggested Members"})}),I.filter(e=>{var r,s;return(((r=e.FullName)==null?void 0:r.toLowerCase().includes(ne.toLowerCase()))||((s=e.UserName)==null?void 0:s.toLowerCase().includes(ne.toLowerCase())))&&e.UserName!==(l==null?void 0:l.UserName)}).slice(0,10).map(e=>t.jsxs("button",{onClick:()=>it(e.UserName),className:"w-full flex items-center gap-3 p-2 hover:bg-white/5 transition-colors text-left group border-b border-gray-700/50 last:border-0",children:[t.jsx(Se,{name:e.FullName,avatarUrl:e.ProfilePictureURL,size:"sm",className:"ring-1 ring-white/10"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-sm font-bold text-gray-200 group-hover:text-blue-400 truncate",children:e.FullName}),t.jsxs("p",{className:"text-[10px] text-gray-500 truncate",children:["@",e.UserName]})]})]},e.UserID)),I.filter(e=>{var r,s;return((r=e.FullName)==null?void 0:r.toLowerCase().includes(ne.toLowerCase()))||((s=e.UserName)==null?void 0:s.toLowerCase().includes(ne.toLowerCase()))}).length===0&&t.jsx("div",{className:"p-4 text-center text-gray-500 text-[10px] uppercase tracking-wider",children:"No matching members"})]}),S&&t.jsxs("div",{className:"flex items-center justify-between bg-gray-800/80 border-l-4 border-blue-500 p-2 mb-2 rounded-r-lg animate-fade-in-up",children:[t.jsxs("div",{className:"flex flex-col text-xs overflow-hidden",children:[t.jsxs("span",{className:"font-bold text-blue-400",children:["Replying to ",S.fullName||S.user]}),t.jsx("span",{className:"text-gray-400 truncate",children:S.type==="text"?S.content:`[${S.type}]`})]}),t.jsx("button",{onClick:()=>xe(null),className:"p-1 hover:bg-gray-700 rounded-full text-gray-500 hover:text-white",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),j?t.jsxs("div",{className:"flex items-center gap-3 bg-gray-800 p-2 rounded-2xl border border-red-500/50 shadow-[0_0_15px_rgba(239,68,68,0.2)] animate-fade-in relative overflow-hidden h-[60px]",children:[t.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-10 pointer-events-none gap-1 px-10",children:[...Array(20)].map((e,r)=>t.jsx("div",{className:"w-1 bg-red-500 rounded-full animate-pulse",style:{height:`${30+Math.random()*50}%`,animationDuration:`${.6+Math.random()*.4}s`,animationDelay:`${Math.random()*.5}s`}},r))}),t.jsxs("div",{className:"flex-shrink-0 w-10 h-10 flex items-center justify-center bg-red-500/10 rounded-full relative z-10 ml-1",children:[t.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-[ping_1.5s_cubic-bezier(0,0,0.2,1)_infinite]"}),t.jsx("div",{className:"absolute w-2 h-2 bg-red-500 rounded-full"})]}),t.jsxs("div",{className:"flex-grow flex flex-col justify-center relative z-10",children:[t.jsx("p",{className:"text-white font-black text-lg font-mono tracking-widest leading-none",children:Pe(te)}),t.jsx("p",{className:"text-[9px] text-red-400 font-bold uppercase tracking-widest mt-0.5",children:"Recording..."})]}),t.jsxs("div",{className:"flex gap-2 relative z-10 mr-1",children:[t.jsx("button",{onClick:Ze,className:"p-2.5 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded-full transition-all active:scale-90",title:"Cancel",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("button",{onClick:et,className:"p-2.5 bg-blue-600 text-white rounded-full shadow-lg shadow-blue-600/30 hover:bg-blue-500 transition-all active:scale-90 hover:scale-105",title:"Send",children:t.jsx("svg",{className:"w-5 h-5 ml-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})})]})]}):t.jsxs("div",{className:"flex items-end gap-2 relative",children:[t.jsx("button",{onClick:()=>{var e;return(e=Ue.current)==null?void 0:e.click()},className:"p-3 text-gray-400 hover:text-blue-400 hover:bg-gray-800 rounded-xl transition-all flex-shrink-0 h-[44px] w-[44px] flex items-center justify-center",title:"Attach Image",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h14a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"file",ref:Ue,className:"hidden",accept:"image/*",onChange:e=>e.target.files&&rt(e.target.files[0])}),t.jsx("div",{className:"flex-grow relative",children:t.jsx("textarea",{value:H,onChange:ot,onKeyDown:e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),de(H,"text"))},placeholder:"Type a message...",className:"w-full bg-gray-800 text-white rounded-2xl py-3 pl-4 pr-10 border-transparent focus:border-blue-500 focus:ring-0 resize-none text-sm custom-scrollbar",rows:1,style:{minHeight:"44px",maxHeight:"100px"}})}),H.trim()?t.jsx("button",{onClick:()=>de(H,"text"),className:"p-3 bg-blue-600 text-white rounded-xl shadow-lg shadow-blue-600/20 active:scale-95 transition-all hover:bg-blue-500 flex-shrink-0 h-[44px] w-[44px] flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 transform rotate-90",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})}):t.jsx("button",{onClick:Xe,disabled:Te,className:"p-3 bg-gray-800 text-white rounded-xl border border-gray-700 hover:bg-red-500/10 hover:border-red-500/50 hover:text-red-500 transition-all active:scale-95 group flex-shrink-0 h-[44px] w-[44px] flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})})]}),(Je||Te)&&t.jsx("div",{className:"absolute inset-x-0 bottom-full bg-blue-600/90 text-white text-[10px] font-black uppercase tracking-widest text-center py-1",children:"Processing Transfer..."})]})]})};export{Rt as default};
