import{r as c,A as re,j as e,c as xe,a as Ee,S as te,R as Xe,u as H,M as he,W as ae,i as st,f as at}from"./index-D6PKsju5.js";import{U as ke}from"./UserAvatar-DpwsAV81.js";import{t as rt,E as lt}from"./EditProfileModal-BOZcVNQK.js";import{S as se,P as nt,a as ot,G as it,b as ct,c as Qe,E as Be,d as dt,e as xt,f as mt,g as ht,h as ut,D as pt,i as gt,O as bt}from"./OrdersList-Dy3FO8Gl.js";import ft from"./html2canvas.esm-QH1iLAAe.js";import"./imageCompressor-D5vYYzIg.js";import"./dateUtils-cpsDkxhO.js";const Ze=({activeDashboard:s,currentAdminView:a,isReportSubMenuOpen:i,isProfileSubMenuOpen:r,onNavChange:f,onReportSubNav:b,setIsReportSubMenuOpen:w,setIsProfileSubMenuOpen:g,setEditProfileModalOpen:n,isMobile:N=!1})=>{const{currentUser:p,logout:j,refreshData:F,isSidebarCollapsed:A,setIsSidebarCollapsed:L,setAppState:v,setIsChatOpen:$,unreadCount:y,language:O,setLanguage:h}=c.useContext(re),[l,u]=c.useState(!1),m=rt[O],t=[{id:"overview",title:m.overview,icon:"ðŸ“Š"},{id:"sales_team",title:m.sales_team_report,icon:"ðŸ‘¥"},{id:"sales_page",title:m.sales_page_report,icon:"ðŸ“„"},{id:"performance",title:m.performance,icon:"ðŸ“ˆ"},{id:"profitability",title:m.profitability,icon:"ðŸ’°"},{id:"forecasting",title:m.forecasting,icon:"ðŸ”®"},{id:"shipping",title:m.shipping_report,icon:"ðŸšš"}],D=[{id:"dashboard",label:m.dashboard,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),component:"admin"},{id:"fulfillment",label:"Fulfillment",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",strokeWidth:2})}),component:"fulfillment"},{id:"orders",label:m.orders,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),component:"orders"},{id:"reports",label:m.reports,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),component:"reports"},{id:"settings",label:m.settings,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),component:"settings"}],d=(p==null?void 0:p.IsSystemAdmin)&&((p==null?void 0:p.Team)||"").split(",").map(k=>k.trim()).filter(Boolean).length>0,x=async()=>{u(!0);try{await F(),window.location.reload()}catch{u(!1)}},o=N?"w-full flex flex-col h-full bg-transparent":`fixed left-0 top-0 h-screen border-r border-white/5 z-50 transition-all duration-300 ease-in-out ${A?"w-20":"w-64"} bg-[#020617]/95 backdrop-blur-3xl flex flex-col shadow-2xl`;return e.jsxs("aside",{className:o,children:[!N&&e.jsxs("div",{className:"h-20 flex items-center gap-4 px-6 border-b border-white/5 overflow-hidden relative group shrink-0",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-600/20 flex-shrink-0 transition-all border border-white/10 z-10",children:e.jsx("img",{src:xe(Ee),alt:"Logo",className:"w-5 h-5 object-contain"})}),!A&&e.jsxs("div",{className:"flex flex-col z-10 animate-fade-in min-w-0",children:[e.jsx("h1",{className:"text-base font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em]",children:"Admin"})]})]}),!N&&e.jsx("button",{onClick:()=>L(!A),className:"absolute top-[4.5rem] -right-3 w-6 h-6 bg-[#0f172a] border border-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-white shadow-xl z-[60] transition-all hover:scale-110 hover:border-blue-500/50",children:e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 ${A?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:e.jsx("path",{d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-0 py-6 space-y-1",children:[N&&e.jsx("div",{className:"px-4 mb-6",children:e.jsxs("button",{onClick:()=>$(!0),className:"w-full flex items-center justify-between px-4 py-3.5 rounded-2xl bg-gradient-to-r from-blue-600/20 to-indigo-600/20 text-blue-300 border border-blue-500/30 active:scale-[0.98] transition-all shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative p-1.5 bg-blue-500/20 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),y>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-gray-900 animate-pulse"})]}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:m.chat_system})]}),y>0&&e.jsx("span",{className:"bg-red-500 text-white text-[9px] font-black px-2 py-0.5 rounded-full shadow-lg",children:y})]})}),D.map(k=>{const C=k.id==="reports",T=s===k.component&&(k.component!=="admin"||k.id===a),M=C&&i;return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>f(k.id),className:`
                                    w-full flex items-center justify-between px-6 py-4 transition-all duration-200 group relative
                                    ${T?"text-white bg-gradient-to-r from-blue-600/30 to-transparent border-l-4 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5 border-l-4 border-transparent"}
                                `,title:A&&!N?k.label:"",children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("span",{className:`transition-transform duration-300 ${T?"scale-110 text-blue-400":"group-hover:text-gray-200"}`,children:k.icon}),(N||!A)&&e.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${T?"text-white":""}`,children:k.label})]}),C&&(N||!A)&&e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 opacity-50 ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-black/20 ${M&&(N||!A)?"max-h-[500px] opacity-100 py-2":"max-h-0 opacity-0"}`,children:t.map(U=>e.jsxs("button",{onClick:()=>b(U.id),className:"w-full flex items-center gap-3 px-6 pl-14 py-2.5 text-[10px] font-bold uppercase tracking-wider text-gray-500 hover:text-white hover:bg-white/5 transition-all relative group",children:[e.jsx("div",{className:"absolute left-10 w-1.5 h-1.5 rounded-full bg-gray-700 group-hover:bg-blue-500 transition-colors"}),e.jsx("span",{className:"truncate",children:U.title})]},U.id))})]},k.id)})]}),e.jsxs("div",{className:`p-4 shrink-0 ${N?"":"border-t border-white/5 bg-black/20"}`,children:[e.jsxs("button",{onClick:()=>g(!r),className:`
                        w-full flex items-center gap-3 p-2.5 rounded-2xl transition-all duration-300
                        ${r?"bg-gray-800":"hover:bg-white/5"}
                        ${!N&&A?"justify-center":""}
                    `,children:[e.jsx(ke,{avatarUrl:p==null?void 0:p.ProfilePictureURL,name:(p==null?void 0:p.FullName)||"",size:"md",className:"ring-2 ring-white/5 shadow-md flex-shrink-0"}),(N||!A)&&e.jsxs("div",{className:"min-w-0 flex-grow text-left",children:[e.jsx("p",{className:"text-xs font-black text-white truncate leading-tight",children:p==null?void 0:p.FullName}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-widest mt-0.5 truncate",children:p==null?void 0:p.Role})]}),(N||!A)&&e.jsx("svg",{className:`w-3 h-3 text-gray-500 transition-transform duration-300 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]}),e.jsx("div",{className:`
                    overflow-hidden transition-all duration-300 ease-in-out
                    ${r&&(N||!A)?"max-h-[300px] mt-4 opacity-100":"max-h-0 opacity-0"}
                `,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-900 rounded-xl p-1 flex border border-white/5",children:[e.jsx("button",{onClick:()=>h("en"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${O==="en"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"ENG"}),e.jsx("button",{onClick:()=>h("km"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${O==="km"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"KH"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>n(!0),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-blue-600/20 hover:border-blue-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400 mb-1.5 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Profile"})]}),e.jsxs("button",{onClick:x,disabled:l,className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-emerald-600/20 hover:border-emerald-500/30 transition-all group",children:[l?e.jsx(te,{size:"sm"}):e.jsx("svg",{className:"w-4 h-4 text-emerald-400 mb-1.5 group-hover:rotate-180 transition-transform duration-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Sync"})]}),d&&e.jsxs("button",{onClick:()=>v("role_selection"),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-yellow-600/20 hover:border-yellow-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-400 mb-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Switch"})]}),e.jsxs("button",{onClick:j,className:`flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-red-600/20 hover:border-red-500/30 transition-all group ${d?"":"col-span-2"}`,children:[e.jsx("svg",{className:"w-4 h-4 text-red-400 mb-1.5 group-hover:translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Logout"})]})]})]})})]})]})},yt=({children:s,activeDashboard:a,currentAdminView:i,isSidebarCollapsed:r,onNavChange:f,onReportSubNav:b,isReportSubMenuOpen:w,setIsReportSubMenuOpen:g,isProfileSubMenuOpen:n,setIsProfileSubMenuOpen:N,setEditProfileModalOpen:p})=>e.jsxs("div",{className:"flex min-h-screen bg-gray-950",children:[e.jsx(Ze,{activeDashboard:a,currentAdminView:i,isReportSubMenuOpen:w,isProfileSubMenuOpen:n,onNavChange:f,onReportSubNav:b,setIsReportSubMenuOpen:g,setIsProfileSubMenuOpen:N,setEditProfileModalOpen:p}),e.jsxs("main",{className:`flex-1 transition-all duration-300 ease-in-out ${r?"pl-20":"pl-64"}`,children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-50 overflow-hidden",children:e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-600/5 rounded-full blur-[120px]"})}),e.jsx("div",{className:"p-4 md:p-6 lg:p-8 xl:p-10 2xl:p-12 max-w-[2400px] mx-auto min-h-screen relative z-10 transition-all duration-300",children:s})]})]}),et=({activeDashboard:s,currentAdminView:a,onNavChange:i,onReportSubNav:r,isReportSubMenuOpen:f,setIsReportSubMenuOpen:b,isProfileSubMenuOpen:w,setIsProfileSubMenuOpen:g,setEditProfileModalOpen:n})=>{const{isMobileMenuOpen:N,setIsMobileMenuOpen:p}=c.useContext(re);return N?e.jsxs("div",{className:"fixed inset-0 z-[100] flex overflow-hidden",children:[e.jsx("style",{children:`
                @keyframes slide-right {
                    from { transform: translateX(-100%); }
                    to { transform: translateX(0); }
                }
                .animate-slide-right {
                    animation: slide-right 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
                }
            `}),e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md transition-opacity duration-300",onClick:()=>p(!1)}),e.jsxs("div",{className:"relative w-[85%] max-w-[320px] h-full bg-[#020617] shadow-2xl animate-slide-right flex flex-col border-r border-white/10",children:[e.jsxs("div",{className:"flex-shrink-0 px-6 pt-12 pb-6 flex items-center justify-between bg-gradient-to-b from-[#0f172a] to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/40 border border-white/10 overflow-hidden p-1.5",children:e.jsx("img",{src:xe(Ee),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"Core Access"})]})]}),e.jsx("button",{onClick:()=>p(!1),className:"w-9 h-9 rounded-full bg-white/5 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 border border-white/5 transition-all active:scale-90",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 18L18 6M6 6l12 12",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex-grow overflow-hidden relative z-10",children:e.jsx(Ze,{isMobile:!0,activeDashboard:s,currentAdminView:a,isReportSubMenuOpen:f,isProfileSubMenuOpen:w,onNavChange:j=>{i(j),j!=="reports"&&p(!1)},onReportSubNav:j=>{r(j),p(!1)},setIsReportSubMenuOpen:b,setIsProfileSubMenuOpen:g,setEditProfileModalOpen:n})})]})]}):null},vt=({children:s,activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:f,isReportSubMenuOpen:b,setIsReportSubMenuOpen:w,isProfileSubMenuOpen:g,setIsProfileSubMenuOpen:n,setEditProfileModalOpen:N})=>{const{setIsMobileMenuOpen:p,currentUser:j}=c.useContext(re);return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-5%] left-[-10%] w-[60%] h-[40%] bg-blue-600/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-5%] right-[-5%] w-[60%] h-[40%] bg-indigo-600/10 rounded-full blur-[120px]"})]}),e.jsxs("header",{className:"sticky top-0 z-40 bg-[#0f172a]/80 backdrop-blur-xl border-b border-white/5 px-4 py-3 flex justify-between items-center shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>p(!0),className:"p-2 rounded-xl bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white transition-all border border-white/5 active:scale-95",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-lg shadow-blue-900/20 p-1 border border-white/10",children:e.jsx("img",{src:xe(Ee),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-base font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.2em]",children:"Mobile Admin"})]})]})]}),e.jsx(ke,{avatarUrl:j==null?void 0:j.ProfilePictureURL,name:(j==null?void 0:j.FullName)||"",size:"sm",className:"ring-2 ring-white/10 shadow-md"})]}),e.jsx(et,{activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:f,isReportSubMenuOpen:b,setIsReportSubMenuOpen:w,isProfileSubMenuOpen:g,setIsProfileSubMenuOpen:n,setEditProfileModalOpen:N}),e.jsx("main",{className:"flex-1 pb-12 px-3 pt-3 overflow-x-hidden relative z-10",children:e.jsx("div",{className:"max-w-xl mx-auto",children:s})}),e.jsx("div",{className:"h-1 w-24 bg-white/5 rounded-full mx-auto mb-4"})]})},jt=({children:s,activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:f,isReportSubMenuOpen:b,setIsReportSubMenuOpen:w,isProfileSubMenuOpen:g,setIsProfileSubMenuOpen:n,setEditProfileModalOpen:N})=>{const{setIsMobileMenuOpen:p,currentUser:j}=Xe.useContext(re);return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-5%] w-[50%] h-[50%] bg-blue-900/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-5%] w-[50%] h-[50%] bg-purple-900/10 rounded-full blur-[120px]"})]}),e.jsxs("header",{className:"sticky top-0 z-40 bg-[#0f172a]/80 backdrop-blur-xl border-b border-white/5 px-6 py-4 flex justify-between items-center shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>p(!0),className:"p-2.5 rounded-xl bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white transition-all border border-white/5 active:scale-95",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/20 p-1.5 border border-white/10",children:e.jsx("img",{src:xe(Ee),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[10px] text-blue-400 font-bold uppercase tracking-[0.2em]",children:"Tablet Admin"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-sm font-bold text-white leading-tight",children:j==null?void 0:j.FullName}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono uppercase",children:j==null?void 0:j.Role})]}),e.jsx(ke,{avatarUrl:j==null?void 0:j.ProfilePictureURL,name:(j==null?void 0:j.FullName)||"",size:"md",className:"ring-2 ring-white/10 shadow-md"})]})]}),e.jsx(et,{activeDashboard:a,currentAdminView:i,onNavChange:r,onReportSubNav:f,isReportSubMenuOpen:b,setIsReportSubMenuOpen:w,isProfileSubMenuOpen:g,setIsProfileSubMenuOpen:n,setEditProfileModalOpen:N}),e.jsx("main",{className:"flex-1 p-6 relative z-10 overflow-x-hidden",children:e.jsx("div",{className:"w-full mx-auto",children:s})})]})},wt=({stats:s,onStatClick:a})=>{const i=c.useMemo(()=>s.reduce((r,f)=>({revenue:r.revenue+f.revenue,orders:r.orders+f.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"}),e.jsx("path",{d:"M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"})]}),"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”ážáž¶áž˜áž€áŸ’ážšáž»áž˜"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"áž€áŸ’ážšáž»áž˜"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,f)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",f+1]}),e.jsx("span",{className:"group-hover:text-blue-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:i.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",i.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},Nt=({stats:s,onProvinceClick:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-black text-slate-100 flex items-center px-1 tracking-tight",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"ážŸáž„áŸ’ážáŸáž”ážáž¶áž˜ážáŸážáŸ’áž/ážšáž¶áž‡áž’áž¶áž“áž¸"]}),e.jsx("div",{className:"bg-slate-900/80 backdrop-blur-xl rounded-2xl border border-slate-700/50 overflow-hidden shadow-2xl h-[450px] lg:h-[550px] xl:h-[600px]",children:e.jsx("div",{className:"overflow-y-auto h-full custom-scrollbar",children:e.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[e.jsx("thead",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest bg-slate-950/80 border-b border-slate-700/50 sticky top-0 z-20 backdrop-blur-md",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-4",children:"ážáŸážáŸ’áž/ážšáž¶áž‡áž’áž¶áž“áž¸"}),e.jsx("th",{className:"px-5 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[s.map((i,r)=>e.jsxs("tr",{className:"hover:bg-indigo-500/10 transition-colors cursor-pointer group",onClick:()=>a==null?void 0:a(i.name),children:[e.jsx("td",{className:"px-5 py-3.5 font-bold text-slate-200 group-hover:text-indigo-300 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-lg text-[10px] font-black flex items-center justify-center border shadow-sm
                                                ${r<3?"bg-gradient-to-br from-indigo-500 to-violet-600 border-indigo-400/50 text-white":"bg-slate-800 border-slate-700 text-slate-500"}`,children:r+1}),e.jsx("span",{className:"truncate max-w-[150px] font-medium tracking-wide",children:i.name})]})}),e.jsxs("td",{className:"px-5 py-3.5 text-right",children:[e.jsxs("span",{className:"text-cyan-400 font-black block group-hover:text-cyan-300 drop-shadow-sm text-base",children:["$",i.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsxs("span",{className:"text-[9px] text-slate-500 uppercase tracking-wider font-semibold group-hover:text-slate-400",children:[i.orders," orders"]})]})]},i.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-6 py-12 text-center text-slate-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]})]})})})]}),kt=({dateRange:s,onRangeChange:a,customStart:i,onCustomStartChange:r,customEnd:f,onCustomEndChange:b})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx("div",{className:"flex items-center gap-1 bg-gray-800/80 p-1 rounded-xl border border-gray-700 shadow-inner",children:["today","this_week","this_month","custom"].map(w=>e.jsx("button",{onClick:()=>a(w),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${s===w?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:w==="today"?"ážáŸ’áž„áŸƒáž“áŸáŸ‡":w==="this_week"?"ážŸáž”áŸ’ážáž¶áž áŸáž“áŸáŸ‡":w==="this_month"?"ážáŸ‚áž“áŸáŸ‡":"áž€áŸ†ážŽážáŸ‹"},w))})}),s==="custom"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-gray-900/40 rounded-2xl border border-gray-800 animate-fade-in-down",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"áž…áž¶áž”áŸ‹áž–áž¸"}),e.jsx("input",{type:"date",value:i,onChange:w=>r(w.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"ážŠáž›áŸ‹"}),e.jsx("input",{type:"date",value:f,onChange:w=>b(w.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]})]})]}),St=({stats:s,onStatClick:a})=>{const i=c.useMemo(()=>s.reduce((r,f)=>({revenue:r.revenue+f.revenue,orders:r.orders+f.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-orange-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"ážƒáŸ’áž›áž¶áŸ†áž„áž”áž‰áŸ’áž…áŸáž‰áž‘áŸ†áž“áž·áž‰ (Stock)"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"ážˆáŸ’áž˜áŸ„áŸ‡ážƒáŸ’áž›áž¶áŸ†áž„ (Store)"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž…áŸ†áž“áž½áž“ Orders"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,f)=>e.jsxs("tr",{className:"hover:bg-orange-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",f+1]}),e.jsx("span",{className:"group-hover:text-orange-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:i.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",i.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},Ct=({stats:s,onStatClick:a})=>{const i=c.useMemo(()=>s.reduce((r,f)=>({revenue:r.revenue+f.revenue,orders:r.orders+f.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-indigo-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"STORE (BRAND/SALES)"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"ážˆáŸ’áž˜áŸ„áŸ‡áž áž¶áž„ (Brand)"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž…áŸ†áž“áž½áž“ Orders"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,f)=>e.jsxs("tr",{className:"hover:bg-indigo-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",f+1]}),e.jsx("span",{className:"group-hover:text-indigo-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:i.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",i.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},Dt=({currentUser:s,parsedOrders:a,dateFilter:i,setDateFilter:r,teamRevenueStats:f,provinceStats:b,storeStats:w,brandStats:g,onTeamClick:n,onProvinceClick:N,onStoreClick:p,onBrandClick:j})=>{const F=v=>new Date(v.Timestamp),A=a.filter(v=>{if(!v.Timestamp)return!1;const $=F(v),y=new Date,O=new Date(y.getFullYear(),y.getMonth(),y.getDate());if(i.preset==="today")return $.toDateString()===y.toDateString();if(i.preset==="this_week"){const h=y.getDay(),l=new Date(O);l.setDate(O.getDate()-(h===0?6:h-1));const u=new Date(l);return u.setDate(l.getDate()+6),u.setHours(23,59,59),$>=l&&$<=u}else{if(i.preset==="this_month")return $.getMonth()===y.getMonth()&&$.getFullYear()===y.getFullYear();if(i.preset==="custom"){const h=i.start?new Date(i.start+"T00:00:00"):null,l=i.end?new Date(i.end+"T23:59:59"):null;return!(h&&$<h||l&&$>l)}}return!0}),L={revenue:A.reduce((v,$)=>v+(Number($["Grand Total"])||0),0),orders:A.length,unpaid:A.filter(v=>v["Payment Status"]==="Unpaid").length};return e.jsxs("div",{className:"space-y-6 lg:space-y-8 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-800/10 p-5 rounded-[2rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl lg:text-2xl 2xl:text-3xl font-black text-white leading-tight",children:["ážŸáž½ážŸáŸ’ážáž¸, ",s==null?void 0:s.FullName," ðŸ‘‹"]}),e.jsx("p",{className:"text-gray-500 text-xs lg:text-sm font-bold uppercase tracking-widest mt-1.5",children:new Date().toLocaleDateString("km-KH",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsx("div",{className:"w-full md:w-auto",children:e.jsx(kt,{dateRange:i.preset,onRangeChange:v=>r({...i,preset:v}),customStart:i.start,onCustomStartChange:v=>r({...i,start:v}),customEnd:i.end,onCustomEndChange:v=>r({...i,end:v})})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6",children:[e.jsx(se,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”",value:`$${L.revenue.toLocaleString(void 0,{minimumFractionDigits:2})}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-blue-400"}),e.jsx(se,{label:"áž…áŸ†áž“áž½áž“áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹",value:L.orders,icon:"ðŸ“¦",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(se,{label:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž‘áž¼áž‘áž¶ážáŸ‹",value:L.unpaid,icon:"â³",colorClass:"from-orange-500 to-yellow-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8",children:[e.jsx(wt,{stats:f,onStatClick:n}),e.jsx(Ct,{stats:g,onStatClick:j}),e.jsx(St,{stats:w,onStatClick:p})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-6 lg:gap-8",children:[e.jsx("div",{className:"xl:col-span-8",children:e.jsx(nt,{data:b,onProvinceClick:N})}),e.jsx("div",{className:"xl:col-span-4",children:e.jsx(Nt,{stats:b,onProvinceClick:N})})]})]})},He=s=>{const a=s["Grand Total"]||0,i=s["Total Product Cost ($)"]||0,r=s["Internal Cost"]||0;return a-i-r},Pt=s=>{try{if(!s)return new Date().toISOString().slice(0,7);const a=new Date(s);return isNaN(a.getTime())?new Date().toISOString().slice(0,7):a.toISOString().slice(0,7)}catch{return new Date().toISOString().slice(0,7)}},Lt=(s,a,i)=>c.useMemo(()=>{const r=Array.isArray(a)?a.filter(y=>y&&y.UserName):[],f=Array.isArray(s)?s.filter(y=>y&&y["Grand Total"]!==void 0):[],b=Array.isArray(i)?i:[],w=f.reduce((y,O)=>y+(O["Grand Total"]||0),0),g=f.reduce((y,O)=>y+He(O),0),n=f.length,N=new Date().toISOString().slice(0,7),p=r.map(y=>{const O=f.filter(d=>d.User===y.UserName),h=O.reduce((d,x)=>d+(x["Grand Total"]||0),0),l=O.reduce((d,x)=>d+He(x),0),u=O.length,m=b.find(d=>d.UserName===y.UserName&&d.Month===N),t=(m==null?void 0:m.TargetAmount)||0,D=t>0?h/t*100:0;return{userName:y.UserName,fullName:y.FullName,profilePictureURL:y.ProfilePictureURL,team:y.Team,revenue:h,profit:l,orderCount:u,target:t,achievement:D}}),F=Array.from(new Set(r.map(y=>y.Team).filter(Boolean))).map(y=>{const O=p.filter(D=>D.team===y),h=O.reduce((D,d)=>D+d.revenue,0),l=O.reduce((D,d)=>D+d.profit,0),u=O.reduce((D,d)=>D+d.orderCount,0),m=O.reduce((D,d)=>D+d.target,0),t=m>0?h/m*100:0;return{teamName:y,revenue:h,profit:l,orderCount:u,target:m,achievement:t}}),A=F.reduce((y,O)=>y+O.target,0),L=A>0?w/A*100:0,v={};f.forEach(y=>{const O=Pt(y.Timestamp);v[O]||(v[O]={revenue:0,profit:0,orders:0}),v[O].revenue+=y["Grand Total"]||0,v[O].profit+=He(y),v[O].orders+=1});const $=Object.entries(v).sort(([y],[O])=>y.localeCompare(O)).map(([y,O])=>({label:y,value:O.revenue,...O}));return{summary:{totalRevenue:w,totalProfit:g,totalOrders:n,overallTarget:A,overallAchievement:L},byUser:p,byTeam:F,monthlyTrend:$,hasData:r.length>0}},[s,a,i]),Tt=({value:s,label:a})=>{const i=Math.max(0,s),r=Math.min(i/100,1),f=80,b=14,w=f-b/2,n=2*Math.PI*w*.75,N=n*(1-r),j=i<50?"#ef4444":i<90?"#f59e0b":"#10b981";return e.jsx("div",{className:"relative flex items-center justify-center w-full max-w-[280px] mx-auto h-[220px]",children:e.jsxs("svg",{viewBox:"0 0 200 160",className:"w-full h-full transform transition-all duration-700",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gaugeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),e.jsx("stop",{offset:"50%",stopColor:"#f59e0b"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981"})]}),e.jsxs("filter",{id:"gaugeGlow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"4",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})]}),e.jsx("path",{d:`M 35 130 A ${w} ${w} 0 1 1 165 130`,fill:"none",stroke:"#1f2937",strokeWidth:b,strokeLinecap:"round",className:"opacity-40"}),e.jsx("path",{d:`M 35 130 A ${w} ${w} 0 1 1 165 130`,fill:"none",stroke:j,strokeWidth:b,strokeLinecap:"round",strokeDasharray:n,strokeDashoffset:N,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)",filter:i>0?"url(#gaugeGlow)":"none"}}),e.jsxs("g",{className:"text-center select-none",children:[e.jsx("text",{x:"100",y:"95",textAnchor:"middle",className:"text-5xl font-black fill-white tracking-tighter",children:`${Math.round(i)}%`}),a&&e.jsx("text",{x:"100",y:"122",textAnchor:"middle",className:"text-[8px] font-black uppercase tracking-[0.2em] fill-gray-500",children:a})]})]})})},tt=({data:s,title:a})=>{const[i,r]=c.useState(null);if(!s||s.length===0)return e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 min-h-[300px]",children:"No data available for chart."});const f=300,b=500,n={top:20,right:20,bottom:40,left:50},N=Math.max(...s.map(y=>y.value),0),p=N===0?0:(f-n.top-n.bottom)/N,j=(b-n.left-n.right)/(s.length-1||1),F=()=>{if(s.length<2)return"";let y=`M ${n.left},${f-n.bottom-s[0].value*p}`;return s.slice(1).forEach((O,h)=>{const l=n.left+(h+1)*j,u=f-n.bottom-O.value*p;y+=` L ${l},${u}`}),y},A=(y,O)=>{const h=y.currentTarget.getBoundingClientRect(),l=`${O.label}: $${O.value.toLocaleString(void 0,{maximumFractionDigits:2})}`;r({visible:!0,x:h.left+window.scrollX,y:h.top+window.scrollY,content:l})},L=()=>{r(null)},$=(y=>{if(y===0)return[0];const O=5,h=Math.ceil(y/O/10)*10;return h===0?[0,y]:Array.from({length:O+1},(l,u)=>u*h).filter(l=>l<=y*1.1)})(N);return e.jsxs("div",{className:"relative w-full",children:[e.jsx("h3",{className:"text-sm sm:text-lg font-black mb-6 text-white text-center uppercase tracking-widest",children:a}),e.jsx("div",{className:"w-full overflow-hidden",children:e.jsxs("svg",{viewBox:`0 0 ${b} ${f}`,className:"w-full h-auto",preserveAspectRatio:"xMinYMin meet",children:[e.jsx("g",{className:"y-axis",children:$.map(y=>e.jsxs("g",{transform:`translate(0, ${f-n.bottom-y*p})`,children:[e.jsx("line",{x1:n.left-5,y1:"0",x2:b-n.right,y2:"0",stroke:"#374151"}),e.jsx("text",{x:n.left-10,y:"3",textAnchor:"end",fill:"#9ca3af",fontSize:"12",children:y>=1e3?`${(y/1e3).toFixed(0)}k`:y})]},y))}),e.jsx("g",{className:"x-axis",children:s.map((y,O)=>{const h=s.length,l=h>10?Math.ceil(h/6):h>6?2:1;return O%l!==0&&O!==h-1?null:e.jsx("text",{x:n.left+O*j,y:f-n.bottom+20,textAnchor:"middle",fill:"#9ca3af",fontSize:"10",className:"font-bold",children:y.label},O)})}),e.jsx("path",{d:F(),fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),s.map((y,O)=>e.jsx("circle",{cx:n.left+O*j,cy:f-n.bottom-y.value*p,r:"4",fill:"#3b82f6",stroke:"#111827",strokeWidth:"2",onMouseOver:h=>A(h,y),onMouseOut:L,className:"cursor-pointer"},O))]})}),i&&e.jsx("div",{className:"fixed p-2 text-xs text-white bg-gray-900 border border-gray-600 rounded-md shadow-lg z-50",style:{left:i.x,top:i.y-35,pointerEvents:"none",transform:"translateX(-50%)"},children:i.content})]})},Mt=({summary:s,monthlyTrend:a})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 animate-fade-in",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(se,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Revenue)",value:`$${s.totalRevenue.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"})}),colorClass:"from-blue-600 to-blue-400"}),e.jsx(se,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Profit)",value:`$${s.totalProfit.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),colorClass:"from-emerald-600 to-green-400"}),e.jsx(se,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹ážŸážšáž»áž” (Orders)",value:s.totalOrders,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),colorClass:"from-purple-600 to-pink-400"}),e.jsx(se,{label:"áž‚áŸ„áž›ážŠáŸ…ážŸážšáž»áž” (Overall Target)",value:s.overallTarget>0?`$${s.overallTarget.toLocaleString()}`:"N/A",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),colorClass:"from-orange-500 to-yellow-400"})]}),e.jsx("div",{className:"glass-card p-6 rounded-2xl shadow-xl border border-gray-700/50",children:e.jsx(tt,{data:a,title:"áž“áž·áž“áŸ’áž“áž¶áž€áž¶ážšáž…áŸ†ážŽáž¼áž› (Revenue Trend)"})})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"glass-card p-8 rounded-2xl shadow-xl flex flex-col items-center justify-center h-full min-h-[400px]",children:[e.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em] mb-8",children:"ážœážŒáŸ’ážáž“áž—áž¶áž–áž‚áŸ„áž›ážŠáŸ…ážšáž½áž˜"}),e.jsx(Tt,{value:s.overallAchievement,label:"Overall Achievement"}),e.jsx("div",{className:"mt-10 grid grid-cols-1 gap-4 w-full",children:e.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase mb-1",children:"áž“áŸ…ážáŸ’ážœáŸ‡ (To Target)"}),e.jsxs("p",{className:"text-2xl font-black text-white",children:["$",Math.max(0,s.overallTarget-s.totalRevenue).toLocaleString()]})]})})]})})]}),qe=({rank:s})=>{const a={1:{emoji:"ðŸ¥‡",bg:"bg-yellow-500/20",border:"border-yellow-500/50",text:"text-yellow-500",glow:"shadow-[0_0_15px_rgba(234,179,8,0.4)]"},2:{emoji:"ðŸ¥ˆ",bg:"bg-gray-300/20",border:"border-gray-300/50",text:"text-gray-300",glow:"shadow-[0_0_15px_rgba(209,213,219,0.3)]"},3:{emoji:"ðŸ¥‰",bg:"bg-orange-600/20",border:"border-orange-600/50",text:"text-orange-600",glow:"shadow-[0_0_15px_rgba(234,88,12,0.3)]"}}[s];return a?e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${a.bg} ${a.border} ${a.text} ${a.glow} border-2 animate-bounce-slow`,children:e.jsx("span",{className:"text-xl",children:a.emoji})}):e.jsxs("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-gray-800 border border-gray-700 text-gray-500 font-black text-sm italic",children:["#",s]})},$t=({data:s,metric:a,onMetricChange:i,datePreset:r,previewImage:f})=>{const b=g=>g>=100?"text-emerald-400":g>=70?"text-yellow-400":"text-red-400",w=g=>g>=100?"bg-emerald-500":g>=70?"bg-yellow-500":"bg-red-500";return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white tracking-tight",children:"ážáž¶ážšáž¶áž„áž…áŸ†ážŽáž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹áž¢áŸ’áž“áž€áž›áž€áŸ‹áž†áŸ’áž“áž¾áž˜"}),e.jsxs("p",{className:"text-gray-500 text-xs mt-1 uppercase tracking-wider font-bold",children:["áž•áŸ’áž¢áŸ‚áž€áž›áž¾: ",r.replace("_"," ")]})]}),e.jsx("div",{className:"flex bg-gray-900/50 p-1 rounded-xl border border-gray-800",children:["revenue","orderCount","achievement"].map(g=>e.jsx("button",{onClick:()=>i(g),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${a===g?"bg-gray-700 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:g==="revenue"?"áž…áŸ†ážŽáž¼áž›":g==="orderCount"?"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹":"% ážŸáž˜áŸ’ážšáŸáž…"},g))})]}),e.jsxs("div",{className:"glass-card rounded-3xl shadow-2xl overflow-hidden border border-gray-700/50",children:[e.jsx("div",{className:"block md:hidden divide-y divide-gray-800",children:s.map((g,n)=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(qe,{rank:n+1}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{avatarUrl:g.profilePictureURL,name:g.fullName,size:"sm",className:"ring-2 ring-blue-500/20"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white leading-none",children:g.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1 font-bold",children:g.team})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-black text-blue-400",children:["$",g.revenue.toLocaleString()]}),e.jsxs("p",{className:`text-[10px] font-bold ${b(g.achievement)}`,children:[g.achievement.toFixed(1),"%"]})]})]},g.userName))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-800",children:[e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center w-24",children:"Rank"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"áž¢áŸ’áž“áž€áž›áž€áŸ‹"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center",children:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"áž€áž¶ážšážŸáž˜áŸ’ážšáŸáž…áž‚áŸ„áž›ážŠáŸ… (%)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800/50",children:s.map((g,n)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-all group",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(qe,{rank:n+1})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{avatarUrl:g.profilePictureURL,name:g.fullName,size:"md",className:"border border-gray-700 shadow-md group-hover:scale-110 transition-transform",onClick:()=>f(xe(g.profilePictureURL))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white group-hover:text-blue-300 transition-colors",children:g.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black tracking-tighter",children:g.team})]})]})}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-blue-400 font-black text-lg",children:["$",g.revenue.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-center font-black text-gray-300",children:g.orderCount}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`text-xs font-black mb-1.5 ${b(g.achievement)}`,children:[g.achievement.toFixed(1),"%"]}),e.jsx("div",{className:"w-32 h-1.5 bg-gray-800 rounded-full overflow-hidden border border-gray-700 shadow-inner",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out progress-glow ${w(g.achievement)}`,style:{width:`${Math.min(g.achievement,100)}%`}})})]})})]},g.userName))})]})})]})]})},Ot=({data:s})=>{const a=r=>r>=100?"text-emerald-400":r>=70?"text-yellow-400":"text-red-400",i=r=>r>=100?"bg-emerald-500":r>=70?"bg-yellow-500":"bg-red-500";return e.jsx("div",{className:"animate-fade-in grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:s.map(r=>e.jsxs("div",{className:"glass-card p-6 rounded-3xl shadow-xl hover:border-blue-500/50 transition-all group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{avatarUrl:r.profilePictureURL,name:r.fullName,size:"md",className:"ring-4 ring-blue-500/10 group-hover:ring-blue-500/20 transition-all"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black leading-none mb-1 group-hover:text-blue-300 transition-colors",children:r.fullName}),e.jsx("span",{className:"text-[9px] bg-blue-900/40 text-blue-300 px-2.5 py-0.5 rounded-full font-black uppercase tracking-wider border border-blue-500/20",children:r.team||"No Team"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest mb-1",children:"áž‚áŸ„áž›ážŠáŸ…ážáŸ‚áž“áŸáŸ‡"}),e.jsxs("p",{className:"text-blue-400 font-black text-lg tracking-tight",children:["$",r.target.toLocaleString()]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"ážœážŒáŸ’ážáž“áž—áž¶áž–ážŸáž˜áŸ’ážšáŸáž…áž”áž¶áž“"}),e.jsxs("span",{className:`text-sm font-black ${a(r.achievement)}`,children:[r.achievement.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full h-3.5 bg-gray-900 rounded-full overflow-hidden border border-gray-800 shadow-inner p-0.5",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out shadow-[0_0_8px_rgba(0,0,0,0.5)] ${i(r.achievement)}`,style:{width:`${Math.min(r.achievement,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-800/50",children:[e.jsxs("div",{className:"bg-gray-900/30 p-3 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"áž›áž€áŸ‹áž”áž¶áž“"}),e.jsxs("p",{className:"text-white font-black",children:["$",r.revenue.toLocaleString()]})]}),e.jsxs("div",{className:`p-3 rounded-xl border ${r.achievement>=100?"bg-emerald-900/10 border-emerald-900/30":"bg-red-900/10 border-red-900/30"}`,children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"áž“áŸ…ážŸáž›áŸ‹"}),e.jsx("p",{className:`font-black ${r.achievement>=100?"text-emerald-400":"text-red-400"}`,children:r.achievement>=100?"SUCCESS ðŸ†":`$${Math.max(0,r.target-r.revenue).toLocaleString()}`})]})]})]})]},r.userName))})},At=({orders:s,users:a,targets:i})=>{const{previewImage:r,setMobilePageTitle:f}=c.useContext(re),[b,w]=c.useState("overview"),[g,n]=c.useState({datePreset:"this_month",team:"",store:""}),[N,p]=c.useState("revenue");c.useEffect(()=>(f("PERFORMANCE"),()=>f(null)),[f]);const j=c.useMemo(()=>{const l=new Set;return s.forEach(u=>{u["Fulfillment Store"]&&l.add(u["Fulfillment Store"])}),Array.from(l).sort()},[s]),F=c.useMemo(()=>{const l=new Set;return s.forEach(u=>{u.Team&&l.add(u.Team)}),Array.from(l).sort()},[s]),A=c.useMemo(()=>{const l=new Date;let u=null,m=new Date;switch(g.datePreset){case"this_month":u=new Date(l.getFullYear(),l.getMonth(),1);break;case"last_month":u=new Date(l.getFullYear(),l.getMonth()-1,1),m=new Date(l.getFullYear(),l.getMonth(),0,23,59,59);break;case"quarter":const t=Math.floor(l.getMonth()/3);u=new Date(l.getFullYear(),t*3,1);break;case"year":u=new Date(l.getFullYear(),0,1);break;case"all":u=null,m=null;break}return s.filter(t=>{if(!t.Timestamp)return!1;const D=new Date(t.Timestamp),d=(!u||D>=u)&&(!m||D<=m),x=!g.team||t.Team===g.team,o=!g.store||t["Fulfillment Store"]===g.store;return d&&x&&o})},[s,g]),L=Lt(A,a,i),v=c.useMemo(()=>L?[...L.byUser].sort((l,u)=>u[N]-l[N]):[],[L,N]);if(!L.hasData&&a.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500 page-card",children:[e.jsx("svg",{className:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.jsx("p",{className:"text-lg font-bold",children:"ážšáž€áž˜áž·áž“ážƒáž¾áž‰áž‘áž·áž“áŸ’áž“áž“áŸáž™áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹"}),e.jsx("p",{className:"text-sm",children:"ážŸáž¼áž˜áž”áŸ’ážšáž¶áž€ážŠážáž¶áž¢áŸ’áž“áž€áž”áž¶áž“áž”áž„áŸ’áž€áž¾ážáž‚ážŽáž“áž¸áž¢áŸ’áž“áž€áž›áž€áŸ‹áž€áŸ’áž“áž»áž„áž”áŸ’ážšáž–áŸáž“áŸ’áž’áŸ”"})]});const{summary:$,byUser:y,monthlyTrend:O}=L,h=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center bg-gray-800/20 border-2 border-dashed border-gray-700 rounded-3xl animate-fade-in",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‡áž˜áŸ’ážšáž¾ážŸáž“áŸáŸ‡"}),e.jsx("p",{className:"text-gray-400 max-w-xs mx-auto mb-6 text-sm",children:'ážŸáž¼áž˜ážŸáž¶áž€áž›áŸ’áž”áž„áž”áŸ’ážáž¼ážš "áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘" áž¬ "áž€áŸ’ážšáž»áž˜/Store" ážŠáž¾áž˜áŸ’áž”áž¸áž˜áž¾áž›áž‘áž·áž“áŸ’áž“áž“áŸáž™áž•áŸ’ážŸáŸáž„áž‘áŸ€ážáŸ”'}),e.jsx("button",{onClick:()=>n({...g,datePreset:"all",team:"",store:""}),className:"btn btn-secondary text-xs",children:"áž”áž„áŸ’áž áž¶áž‰áž‘áž·áž“áŸ’áž“áž“áŸáž™áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Time)"})]});return e.jsxs("div",{className:"space-y-6 animate-fade-in px-2 sm:px-0 pb-12",children:[e.jsx("style",{children:`
                @keyframes bounce-slow { 0%, 100% { transform: translateY(-5%); } 50% { transform: translateY(0); } }
                .animate-bounce-slow { animation: bounce-slow 3s infinite ease-in-out; }
                .glass-card { background: rgba(31, 41, 55, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(75, 85, 99, 0.3); }
                .progress-glow { filter: drop-shadow(0 0 4px currentColor); }
            `}),e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsx("div",{className:"flex bg-gray-800/80 p-1.5 rounded-2xl border border-gray-700 backdrop-blur-md shadow-inner",children:["overview","leaderboard","targets"].map(l=>e.jsx("button",{onClick:()=>w(l),className:`px-5 py-2.5 text-xs font-black rounded-xl transition-all duration-300 ${b===l?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:l==="overview"?"áž‘áž·áž“áŸ’áž“áž“áŸáž™ážŸáž„áŸ’ážáŸáž”":l==="leaderboard"?"áž…áŸ†ážŽáž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹":"áž‚áŸ„áž›ážŠáŸ…"},l))}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full lg:w-auto",children:[e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-blue-400 cursor-pointer w-full sm:w-auto",value:g.datePreset,onChange:l=>n({...g,datePreset:l.target.value}),children:[e.jsx("option",{value:"this_month",children:"ážáŸ‚áž“áŸáŸ‡"}),e.jsx("option",{value:"last_month",children:"ážáŸ‚áž˜áž»áž“"}),e.jsx("option",{value:"quarter",children:"ážáŸ’ážšáž¸áž˜áž¶ážŸáž“áŸáŸ‡"}),e.jsx("option",{value:"year",children:"áž†áŸ’áž“áž¶áŸ†áž“áŸáŸ‡"}),e.jsx("option",{value:"all",children:"áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹"})]})]}),e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"Store:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-emerald-400 cursor-pointer w-full sm:w-auto",value:g.store,onChange:l=>n({...g,store:l.target.value}),children:[e.jsx("option",{value:"",children:"All Stores"}),j.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"Team:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-purple-400 cursor-pointer w-full sm:w-auto",value:g.team,onChange:l=>n({...g,team:l.target.value}),children:[e.jsx("option",{value:"",children:"All Teams"}),F.map(l=>e.jsx("option",{value:l,children:l},l))]})]})]})]}),b==="overview"&&($.totalRevenue===0?e.jsx(h,{}):e.jsx(Mt,{summary:$,monthlyTrend:O})),b==="leaderboard"&&e.jsx($t,{data:v,metric:N,onMetricChange:p,datePreset:g.datePreset,previewImage:r}),b==="targets"&&(y.length===0?e.jsx("div",{className:"col-span-full py-12 text-center text-gray-500",children:"áž˜áž·áž“áž˜áž¶áž“áž–áŸážáŸŒáž˜áž¶áž“áž‚áŸ„áž›ážŠáŸ…áž¢áŸ’áž“áž€áž›áž€áŸ‹ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‡áž˜áŸ’ážšáž¾ážŸáž“áŸáŸ‡"}):e.jsx(Ot,{data:y}))]})},Le=({orders:s,reportType:a,dateFilter:i,startDate:r,endDate:f,onNavigate:b,contextFilters:w})=>{const{appData:g}=c.useContext(re),[n,N]=c.useState(""),[p,j]=c.useState(!1);if(a==="shipping")return e.jsx(ot,{orders:s,appData:g,dateFilter:i,startDate:r,endDate:f,onNavigate:b,contextFilters:w});const F=c.useMemo(()=>{const L=s.reduce((x,o)=>x+(Number(o["Grand Total"])||0),0),v=s.reduce((x,o)=>x+(Number(o["Total Product Cost ($)"])||0),0),$=s.reduce((x,o)=>x+(Number(o["Internal Cost"])||0),0),y=L-v-$,O=L>0?y/L*100:0,h={},l={},u={Paid:0,Unpaid:0},m={};s.forEach(x=>{var T;const o=x.User||"Unknown";if(!h[o]){const M=(T=g.users)==null?void 0:T.find(U=>U.UserName===o);h[o]={revenue:0,orders:0,name:(M==null?void 0:M.FullName)||o,avatar:(M==null?void 0:M.ProfilePictureURL)||""}}h[o].revenue+=Number(x["Grand Total"])||0,h[o].orders+=1;const k=x.Team||"Unassigned";l[k]||(l[k]={revenue:0,orders:0}),l[k].revenue+=Number(x["Grand Total"])||0,l[k].orders+=1;const C=x["Payment Status"]||"Unpaid";if(u[C]=(u[C]||0)+1,x.Timestamp){const M=new Date(x.Timestamp),U=M.toLocaleDateString("en-US",{month:"short",day:"numeric"}),V=M.toISOString().split("T")[0];m[V]||(m[V]={label:U,value:0}),m[V].value+=Number(x["Grand Total"])||0}});const t=Object.values(h).sort((x,o)=>o.revenue-x.revenue).slice(0,5),D=Object.entries(l).map(([x,o])=>({name:x,...o})).sort((x,o)=>o.revenue-x.revenue),d=Object.keys(m).sort().map(x=>({label:m[x].label,value:m[x].value}));return{revenue:L,totalOrders:s.length,totalProfit:y,margin:O,shippingCost:$,topUsers:t,teamStats:D,paymentMap:u,chartData:d}},[s,g.users]),A=async()=>{j(!0);try{const L={revenue:F.revenue,orders:F.totalOrders,profit:F.totalProfit,margin:F.margin,topPerformers:F.topUsers.map($=>({name:$.name,revenue:$.revenue}))},v=await ct(L,{reportType:a});N(v)}catch{N("AI Analysis error.")}finally{j(!1)}};return e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(se,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”",value:`$${F.revenue.toLocaleString(void 0,{minimumFractionDigits:2})}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-blue-400"}),e.jsx(se,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹",value:F.totalOrders,icon:"ðŸ“¦",colorClass:"from-indigo-600 to-indigo-400"}),e.jsx(se,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰",value:`$${F.totalProfit.toLocaleString(void 0,{minimumFractionDigits:2})}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(se,{label:"Margin (%)",value:`${F.margin.toFixed(1)}%`,icon:"âš–ï¸",colorClass:"from-amber-500 to-orange-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6 lg:space-y-8",children:[e.jsx("div",{className:"page-card p-4 sm:!p-8 bg-gray-900/40 border-white/5 h-full min-h-[300px] sm:min-h-[400px] flex flex-col justify-center",children:e.jsx(tt,{data:F.chartData,title:"áž“áž·áž“áŸ’áž“áž¶áž€áž¶ážšáž…áŸ†ážŽáž¼áž› (Revenue Trends)"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8",children:[e.jsxs("div",{className:"page-card !p-6 bg-gray-900/40 border-white/5",children:[e.jsxs("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-blue-500 rounded-full"}),"Performance by Team"]}),e.jsx("div",{className:"space-y-4",children:F.teamStats.map(L=>e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"text-xs font-black text-white uppercase",children:L.name}),e.jsxs("span",{className:"text-xs font-mono font-bold text-blue-400",children:["$",L.revenue.toLocaleString()]})]}),e.jsx("div",{className:"w-full h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-1000",style:{width:`${L.revenue/F.revenue*100}%`}})}),e.jsxs("div",{className:"flex justify-between text-[9px] font-bold text-gray-600 uppercase tracking-widest",children:[e.jsxs("span",{children:[L.orders," Orders"]}),e.jsxs("span",{children:[(L.revenue/F.revenue*100).toFixed(1),"% of Total"]})]})]},L.name))})]}),e.jsxs("div",{className:"page-card !p-6 bg-gray-900/40 border-white/5 flex flex-col",children:[e.jsxs("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-emerald-500 rounded-full"}),"Payment Status"]}),e.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-8",children:[e.jsxs("div",{className:"flex justify-around items-center",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-black text-emerald-400",children:F.paymentMap.Paid||0}),e.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1",children:"Paid Orders"})]}),e.jsx("div",{className:"h-10 w-px bg-gray-800"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-black text-orange-400",children:F.paymentMap.Unpaid||0}),e.jsx("div",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mt-1",children:"Unpaid Orders"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex h-3 w-full rounded-full overflow-hidden border border-white/5",children:[e.jsx("div",{className:"bg-emerald-500",style:{width:`${F.paymentMap.Paid/F.totalOrders*100}%`}}),e.jsx("div",{className:"bg-orange-500",style:{width:`${F.paymentMap.Unpaid/F.totalOrders*100}%`}})]}),e.jsxs("div",{className:"flex justify-between text-[9px] font-black uppercase tracking-widest",children:[e.jsxs("span",{className:"text-emerald-500",children:["Paid: ",(F.paymentMap.Paid/F.totalOrders*100||0).toFixed(1),"%"]}),e.jsxs("span",{className:"text-orange-500",children:["Unpaid: ",(F.paymentMap.Unpaid/F.totalOrders*100||0).toFixed(1),"%"]})]})]})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-6 lg:space-y-8",children:[e.jsxs("div",{className:"page-card !p-6 bg-gray-900/40 border-white/5",children:[e.jsxs("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-purple-500 rounded-full"}),"Top Performers"]}),e.jsxs("div",{className:"space-y-5",children:[F.topUsers.map((L,v)=>e.jsxs("div",{className:"flex items-center gap-4 group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl overflow-hidden border border-white/10 group-hover:border-purple-500/50 transition-colors bg-black/40",children:L.avatar?e.jsx("img",{src:xe(L.avatar),className:"w-full h-full object-cover",alt:""}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] font-black text-gray-600 uppercase",children:L.name.substring(0,2)})}),e.jsx("div",{className:"absolute -top-2 -left-2 w-5 h-5 bg-gray-900 rounded-lg border border-white/10 flex items-center justify-center text-[10px] font-black text-purple-400",children:v+1})]}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"text-xs font-black text-white truncate",children:L.name}),e.jsxs("span",{className:"text-xs font-mono font-black text-purple-400",children:["$",L.revenue.toLocaleString()]})]}),e.jsxs("p",{className:"text-[9px] font-bold text-gray-500 uppercase tracking-widest mt-0.5",children:[L.orders," Orders Completed"]})]})]},L.name)),F.topUsers.length===0&&e.jsx("p",{className:"text-[10px] text-gray-600 text-center py-4 italic",children:"No sales data recorded"})]})]}),e.jsxs("div",{className:"page-card !p-6 bg-gray-900/40 border-white/5 flex flex-col min-h-[300px]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em]",children:"AI Intelligence"}),e.jsx(it,{onClick:A,isLoading:p,children:"Analyze"})]}),e.jsx("div",{className:"flex-grow bg-black/40 rounded-[2rem] p-5 border border-white/5 overflow-y-auto custom-scrollbar",children:n?e.jsx("div",{className:"text-sm text-gray-300 leading-relaxed font-medium",children:n}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20",children:[e.jsx("svg",{className:"w-12 h-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("p",{className:"text-[10px] text-center uppercase font-black tracking-[0.3em]",children:"Ready for Analysis"})]})})]})]})]})]})},Ne=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],It=({orders:s,onBack:a})=>{const{appData:i}=c.useContext(re),[r,f]=c.useState(!0),[b,w]=c.useState(!1),[g,n]=c.useState(!0),[N,p]=c.useState("revenue"),[j,F]=c.useState({key:"revenue",direction:"desc"}),[A,L]=c.useState(!1),v=m=>{F(t=>({key:m,direction:t.key===m&&t.direction==="desc"?"asc":"desc"}))},$=c.useMemo(()=>{const m={};return s.forEach(t=>{var o,k,C;let D=t.Team||t.User&&((C=(k=(o=i.users)==null?void 0:o.find(T=>T.UserName===t.User))==null?void 0:k.Team)==null?void 0:C.split(",")[0].trim())||"Unassigned";m[D]||(m[D]={name:D,revenue:0,profit:0,orders:0,members:new Set},Ne.forEach(T=>{m[D][`rev_${T}`]=0,m[D][`prof_${T}`]=0}));const d=Number(t["Grand Total"])||0,x=(Number(t["Total Product Cost ($)"])||0)+(Number(t["Internal Cost"])||0);if(m[D].revenue+=d,m[D].profit+=d-x,m[D].orders+=1,t.User&&m[D].members.add(t.User),t.Timestamp){const T=new Date(t.Timestamp),M=Ne[T.getMonth()];m[D][`rev_${M}`]+=d,m[D][`prof_${M}`]+=d-x}}),Object.values(m).sort((t,D)=>{const d=j.direction==="asc"?1:-1,x=t[j.key],o=D[j.key];return typeof x=="string"?x.localeCompare(o)*d:(x-o)*d})},[s,j,i.users]),y=c.useMemo(()=>{const m={revenue:0,profit:0,orders:0};return Ne.forEach(t=>{m[`rev_${t}`]=0,m[`prof_${t}`]=0}),$.forEach(t=>{m.revenue+=t.revenue,m.profit+=t.profit,m.orders+=t.orders,Ne.forEach(D=>{m[`rev_${D}`]+=t[`rev_${D}`],m[`prof_${D}`]+=t[`prof_${D}`]})}),m},[$]),O=()=>{L(!0),setTimeout(()=>{try{const m=new Be({orientation:"landscape"}),t=m.internal.pageSize.width;m.setFontSize(18),m.text("Sales Report by Team",t/2,15,{align:"center"}),m.save(`Team_Sales_Report_${Date.now()}.pdf`)}catch(m){console.error(m)}finally{L(!1)}},100)},h=c.useMemo(()=>$.slice(0,10).map(m=>({label:m.name,value:m.revenue})),[$]),l=(m,t)=>{const d=[{key:"index",label:"#"},{key:"teamName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜ (Team)",sortable:!0,sortKey:"name"},{key:`total${m}`,label:`ážŸážšáž»áž” (${m})`,sortable:!0,sortKey:m.toLowerCase()},...Ne.map(x=>({key:`${t}_${x}`,label:x}))];return e.jsxs("div",{className:"hidden md:flex page-card flex-col mb-8 !p-6 border-gray-700/50 shadow-xl overflow-hidden bg-gray-900/40",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:`text-xl font-black flex items-center gap-2 ${m==="Revenue"?"text-blue-300":"text-green-400"}`,children:[e.jsx("span",{className:`w-2 h-6 rounded-full ${m==="Revenue"?"bg-blue-600":"bg-green-600"}`}),"ážáž¶ážšáž¶áž„",m==="Revenue"?"áž…áŸ†ážŽáž¼áž›":"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰","ážáž¶áž˜áž€áŸ’ážšáž»áž˜"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[m==="Revenue"&&e.jsxs("button",{onClick:O,disabled:A,className:"btn !py-1 !px-4 text-[10px] font-black bg-red-600/20 border border-red-500/30 text-red-400 hover:bg-red-600 hover:text-white transition-all flex items-center gap-2",children:[A?e.jsx(te,{size:"sm"}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"EXPORT PDF"]}),e.jsx("button",{onClick:()=>n(!g),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${g?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"COLOR"}),e.jsx("button",{onClick:()=>w(!b),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${b?"bg-blue-600 border-blue-500 text-white shadow-lg":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"FREEZE"}),e.jsx("button",{onClick:()=>f(!r),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${r?"bg-gray-700 border-gray-600 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"BORDER"})]})]}),e.jsx("div",{className:`overflow-x-auto custom-scrollbar pb-2 ${r?"border-2 border-white/10 rounded-2xl shadow-[0_0_30px_rgba(0,0,0,0.5)]":""}`,children:e.jsxs("table",{className:`report-table w-full border-separate border-spacing-0 text-sm ${r?"border-collapse":""}`,children:[e.jsx("thead",{className:"bg-[#0f172a] backdrop-blur-md",children:e.jsx("tr",{className:"border-b-2 border-white/20",children:d.map(x=>{let o="",k={};b&&(x.key==="index"?(o="sticky left-0 z-30 bg-[#0f172a]",k={width:"45px",minWidth:"45px"}):x.key==="teamName"?(o="sticky left-[45px] z-30 bg-[#0f172a] border-r border-white/10 shadow-md",k={width:"140px",minWidth:"140px"}):x.key.includes("total")&&(o="sticky left-[185px] z-30 bg-[#0f172a] border-r border-white/10 shadow-lg",k={width:"100px",minWidth:"100px"}));const C=x.key.includes("total")?m==="Revenue"?"bg-blue-900/80":"bg-green-900/80":"";return e.jsx("th",{onClick:()=>x.sortable&&v(x.sortKey),className:`px-4 py-5 whitespace-nowrap text-left font-black uppercase tracking-wider border-b-2 border-white/20 ${r?"border-x border-white/5":""} ${o} ${C} ${x.sortable?"cursor-pointer hover:bg-gray-700":""}`,style:k,children:e.jsxs("div",{className:"flex items-center gap-1",children:[x.label," ",x.sortable&&j.key===x.sortKey&&e.jsx("span",{children:j.direction==="asc"?"â†‘":"â†“"})]})},x.key)})})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:$.map((x,o)=>{const k=Array.from(String(x.name)).reduce((M,U)=>M+U.charCodeAt(0),0)%5,T=g?["bg-blue-500/5","bg-purple-500/5","bg-emerald-500/5","bg-orange-500/5","bg-pink-500/5"][k]:"hover:bg-blue-500/5";return e.jsx("tr",{className:`${T} transition-colors group border-b border-white/5`,children:d.map(M=>{const U=`px-4 py-4 lg:py-5 whitespace-nowrap border-white/5 ${r?"border-x border-white/5":""}`;let V="",E={};if(b&&(M.key==="index"?(V="sticky left-0 z-10 bg-[#020617]",E={width:"45px",minWidth:"45px"}):M.key==="teamName"?(V="sticky left-[45px] z-10 bg-[#020617] border-r border-white/5 shadow-md",E={width:"140px",minWidth:"140px"}):M.key.includes("total")&&(V="sticky left-[185px] z-10 bg-[#020617] border-r border-white/5 shadow-lg",E={width:"100px",minWidth:"100px"})),M.key==="index")return e.jsx("td",{className:`${U} text-center font-bold text-gray-500 ${V}`,style:E,children:o+1},M.key);if(M.key==="teamName")return e.jsx("td",{className:`${U} font-black text-white ${V}`,style:E,children:x.name},M.key);if(M.key.includes("total"))return e.jsxs("td",{className:`${U} text-right font-black ${V} ${m==="Revenue"?"text-blue-200 bg-blue-600/10":"text-green-200 bg-green-600/10"}`,style:E,children:["$",(m==="Revenue"?x.revenue:x.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},M.key);if(M.key.startsWith(t)){const I=x[M.key]||0,G=m==="Profit"?I>0?"text-green-400":I<0?"text-red-400":"text-gray-500":I>0?"text-blue-300":"text-gray-500";return e.jsx("td",{className:`${U} text-right font-bold font-mono ${G}`,children:I!==0?`$${I.toLocaleString(void 0,{minimumFractionDigits:2})}`:"-"},M.key)}return e.jsx("td",{className:U,children:"-"},M.key)})},x.name)})}),e.jsx("tfoot",{className:"bg-[#0f172a] font-black border-t-2 border-white/20",children:e.jsx("tr",{className:"border-t-2 border-white/20",children:d.map((x,o)=>{const k=`px-4 py-5 whitespace-nowrap border-t-2 border-white/20 ${r?"border-x border-white/5":""}`;let C="",T={};return b&&(x.key==="index"?(C="sticky left-0 z-30 bg-[#0f172a]",T={width:"45px",minWidth:"45px"}):x.key==="teamName"?(C="sticky left-[45px] z-30 bg-[#0f172a] shadow-md",T={width:"140px",minWidth:"140px"}):x.key.includes("total")&&(C="sticky left-[185px] z-30 bg-[#0f172a] shadow-lg",T={width:"100px",minWidth:"100px"})),o===0?e.jsx("td",{className:`${k} uppercase tracking-widest text-white font-black ${C}`,style:T,colSpan:2,children:"ážŸážšáž»áž”ážšáž½áž˜ (GRAND TOTAL)"},x.key):x.key==="teamName"?null:x.key.includes("total")?e.jsxs("td",{className:`${k} text-right ${C} ${m==="Revenue"?"text-blue-400 bg-blue-600/10":"text-green-400 bg-green-600/10"}`,style:T,children:["$",(m==="Revenue"?y.revenue:y.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},x.key):x.key.startsWith(t)?e.jsxs("td",{className:`${k} text-right text-gray-300 font-mono`,children:["$",y[x.key].toLocaleString(void 0,{minimumFractionDigits:2})]},x.key):e.jsx("td",{className:k},x.key)})})})]})})]})},u=()=>e.jsxs("div",{className:"md:hidden space-y-6 pb-12 px-1",children:[e.jsxs("div",{className:"flex bg-gray-900/60 p-1 rounded-2xl border border-white/10 shadow-inner",children:[e.jsx("button",{onClick:()=>p("revenue"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${N==="revenue"?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-gray-500"}`,children:"áž…áŸ†ážŽáž¼áž› (Revenue)"}),e.jsx("button",{onClick:()=>p("profit"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${N==="profit"?"bg-emerald-600 text-white shadow-lg shadow-emerald-600/20":"text-gray-500"}`,children:"áž…áŸ†ážŽáŸáž‰ (Profit)"})]}),e.jsx("div",{className:"space-y-4",children:$.map((m,t)=>{const D=N==="revenue"?m.revenue:m.profit,d=N==="revenue"?y.revenue:y.profit,x=D/(d||1)*100;return e.jsxs("div",{className:"bg-gray-800/40 border border-white/10 rounded-[2.5rem] p-6 shadow-xl space-y-5 animate-fade-in-up group relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start border-b border-white/5 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-10 h-10 bg-gray-950 rounded-2xl flex items-center justify-center border border-gray-700 text-gray-500 font-black text-xs shadow-inner",children:["#",t+1]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-black text-white uppercase tracking-tight",children:m.name}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest mt-0.5",children:[m.orders," Orders Total"]})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest ${N==="revenue"?"bg-blue-600/10 text-blue-400":"bg-emerald-600/10 text-emerald-400"}`,children:N==="revenue"?"Revenue Node":"Profit Node"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"ážŸážšáž»áž”áž”áŸ’ážšáž…áž¶áŸ†ážáŸ‚"}),e.jsxs("p",{className:`text-xl font-black ${N==="revenue"?"text-blue-400":"text-emerald-400"}`,children:["$",D.toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5 flex flex-col justify-center",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"áž…áŸ†ážŽáŸ‚áž€áž‘áž¸áž•áŸ’ážŸáž¶ážš"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-white font-black text-sm",children:[x.toFixed(1),"%"]}),e.jsx("div",{className:"flex-grow h-1 bg-gray-900 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${N==="revenue"?"bg-blue-500":"bg-emerald-500"}`,style:{width:`${Math.min(100,x)}%`}})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"Monthly Breakdown (Recent 3)"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ne.slice(-3).map(o=>e.jsxs("div",{className:"bg-gray-900/50 p-2 rounded-xl border border-white/5 text-center",children:[e.jsx("p",{className:"text-[8px] text-gray-600 font-bold uppercase mb-0.5",children:o}),e.jsxs("p",{className:"text-[10px] text-gray-300 font-black",children:["$",(m[`${N==="revenue"?"rev":"prof"}_${o}`]||0).toLocaleString(void 0,{maximumFractionDigits:0})]})]},o))})]}),e.jsx("div",{className:`absolute -right-10 -bottom-10 w-32 h-32 rounded-full blur-[50px] opacity-10 transition-colors ${N==="revenue"?"bg-blue-600":"bg-emerald-600"}`})]},m.name)})})]});return e.jsxs("div",{className:"w-full space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(se,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Revenue)",value:`$${y.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(se,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Profit)",value:`$${y.profit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-teal-500"}),e.jsx(se,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹ážŸážšáž»áž” (Orders)",value:y.orders,icon:"ðŸ“¦",colorClass:"from-purple-600 to-pink-500"})]}),e.jsxs("div",{className:"hidden md:block space-y-8",children:[l("Revenue","rev"),l("Profit","prof")]}),e.jsx(u,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pb-10",children:[e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(Qe,{data:h,title:"áž…áŸ†ážŽáž¼áž›ážáž¶áž˜áž€áŸ’ážšáž»áž˜ (Top Teams Revenue)"})}),e.jsxs("div",{className:"page-card !p-6 bg-gray-800/40 border-gray-700/50 flex flex-col justify-center",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-blue-500 rounded-full"})," ážŸáŸ’ážáž·ážáž·áž€áŸ’ážšáž»áž˜áž›áž€áŸ‹"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž…áŸ†áž“áž½áž“áž€áŸ’ážšáž»áž˜ážŸáž€áž˜áŸ’áž˜:"}),e.jsx("span",{className:"text-white font-black text-lg",children:$.length})]}),e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚áž…áŸ†ážŽáž¼áž›/áž€áŸ’ážšáž»áž˜:"}),e.jsxs("span",{className:"text-blue-400 font-black text-lg",children:["$",(y.revenue/($.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚áž…áŸ†ážŽáŸáž‰/áž€áŸ’ážšáž»áž˜:"}),e.jsxs("span",{className:"text-emerald-400 font-black text-lg",children:["$",(y.profit/($.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},Te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ft=({orders:s,onBack:a,onNavigate:i,contextFilters:r,dateFilter:f,startDate:b,endDate:w})=>{const{appData:g,previewImage:n}=c.useContext(re),[N,p]=c.useState(!0),[j,F]=c.useState(!1),[A,L]=c.useState({key:"teamName",direction:"asc"}),v=t=>{L(D=>({key:t,direction:D.key===t&&D.direction==="desc"?"asc":"desc"}))},$=()=>{const t={};return r&&(r.team&&(t.team=r.team),r.store&&(t.store=r.store),r.paymentStatus&&(t.paymentStatus=r.paymentStatus),r.user&&(t.user=r.user),r.fulfillmentStore&&(t.fulfillmentStore=r.fulfillmentStore),r.location&&(t.location=r.location),r.shippingService&&(t.shipping=r.shippingService),r.driver&&(t.driver=r.driver),r.bank&&(t.bank=r.bank),r.product&&(t.product=r.product),r.internalCost&&(t.internalCost=r.internalCost)),t},y=(t,D)=>{if(i){const d=$();t==="page"&&(d.page=D),t==="team"&&(d.team=D),d.datePreset=f,d.startDate=b,d.endDate=w,i(d)}},O=(t,D)=>{if(i){const d=$(),x=new Date().getFullYear(),o=f==="last_year"?x-1:x,k=new Date(o,D,1),C=new Date(o,D+1,0,23,59,59),T=M=>{const U=M.getFullYear(),V=String(M.getMonth()+1).padStart(2,"0"),E=String(M.getDate()).padStart(2,"0");return`${U}-${V}-${E}`};d.page=t,d.datePreset="custom",d.startDate=T(k),d.endDate=T(C),i(d)}},h=c.useMemo(()=>{const t={};g.pages&&g.pages.forEach(d=>{t[d.PageName]={pageName:d.PageName,teamName:d.Team||"Unassigned",logoUrl:d.PageLogoURL||"",revenue:0,profit:0,orderCount:0},Te.forEach(x=>{t[d.PageName][`rev_${x}`]=0,t[d.PageName][`prof_${x}`]=0})}),s.forEach(d=>{var C;const x=d.Page||"Unknown";if(!t[x]){const T=(C=g.pages)==null?void 0:C.find(M=>M.PageName===x);t[x]={pageName:x,teamName:d.Team||"Unassigned",logoUrl:(T==null?void 0:T.PageLogoURL)||"",revenue:0,profit:0,orderCount:0},Te.forEach(M=>{t[x][`rev_${M}`]=0,t[x][`prof_${M}`]=0})}const o=Number(d["Grand Total"])||0,k=(Number(d["Total Product Cost ($)"])||0)+(Number(d["Internal Cost"])||0);if(t[x].revenue+=o,t[x].profit+=o-k,t[x].orderCount+=1,d.Timestamp){const T=new Date(d.Timestamp),M=Te[T.getMonth()];t[x][`rev_${M}`]+=o,t[x][`prof_${M}`]+=o-k}});let D=Object.values(t);return N||(D=D.filter(d=>d.revenue>0)),D.sort((d,x)=>{const o=A.direction==="asc"?1:-1,k=d[A.key],C=x[A.key];return typeof k=="string"?k.localeCompare(C)*o:(k-C)*o})},[s,A,g.pages,N]),l=c.useMemo(()=>{const t={revenue:0,profit:0,pagesCount:h.length};return Te.forEach(D=>{t[`rev_${D}`]=0,t[`prof_${D}`]=0}),h.forEach(D=>{t.revenue+=D.revenue,t.profit+=D.profit,Te.forEach(d=>{t[`rev_${d}`]+=D[`rev_${d}`],t[`prof_${d}`]+=D[`prof_${d}`]})}),t},[h]),u=()=>{F(!0),setTimeout(()=>{try{const t=new Be({orientation:"landscape"}),D=t.internal.pageSize.width;t.setFontSize(18),t.text("Sales Report by Page",D/2,15,{align:"center"}),t.save(`Page_Sales_Report_${Date.now()}.pdf`)}catch(t){console.error(t),alert("Export failed")}finally{F(!1)}},100)},m=c.useMemo(()=>[...h].sort((t,D)=>D.revenue-t.revenue).slice(0,5).map(t=>({label:t.pageName,value:t.revenue,imageUrl:t.logoUrl})),[h]);return e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(se,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Total Rev)",value:`$${l.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(se,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Total Profit)",value:`$${l.profit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-green-500"})]}),e.jsx(dt,{data:h,grandTotals:l,sortConfig:A,onToggleSort:v,showAllPages:N,setShowAllPages:p,onExportPDF:u,isExporting:j,onPreviewImage:n,onNavigate:y,onMonthClick:O}),e.jsx(xt,{data:h,grandTotals:l,onPreviewImage:n,onNavigate:y,onMonthClick:O}),e.jsx(mt,{data:h,onPreviewImage:n,onNavigate:y,onMonthClick:O}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 pb-10",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(Qe,{data:m,title:"Page ážŠáŸ‚áž›áž˜áž¶áž“áž…áŸ†ážŽáž¼áž›ážáŸ’áž–ážŸáŸ‹áž”áŸ†áž•áž»áž (Top 5 Pages Revenue)"})})}),e.jsxs("div",{className:"lg:col-span-4 flex flex-col justify-center page-card !p-5 bg-gray-800/30 border-gray-700/50",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-6",children:[e.jsx("span",{className:"w-1.5 h-4 bg-indigo-500 rounded-full"}),"ážŸáž„áŸ’ážáŸáž”"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"áž…áŸ†áž“áž½áž“ Page ážŸáž€áž˜áŸ’áž˜:"}),e.jsx("span",{className:"text-white font-black text-sm",children:l.pagesCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚/Page:"}),e.jsxs("span",{className:"text-blue-400 font-black text-sm",children:["$",(l.revenue/(l.pagesCount||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},zt=[{label:"áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Time)",value:"all"},{label:"ážáŸ’áž„áŸƒáž“áŸáŸ‡ (Today)",value:"today"},{label:"áž˜áŸ’ážŸáž·áž›áž˜áž·áž‰ (Yesterday)",value:"yesterday"},{label:"ážŸáž”áŸ’ážáž¶áž áŸáž“áŸáŸ‡ (This Week)",value:"this_week"},{label:"ážŸáž”áŸ’ážáž¶áž áŸáž˜áž»áž“ (Last Week)",value:"last_week"},{label:"ážáŸ‚áž“áŸáŸ‡ (This Month)",value:"this_month"},{label:"ážáŸ‚áž˜áž»áž“ (Last Month)",value:"last_month"},{label:"áž†áŸ’áž“áž¶áŸ†áž“áŸáŸ‡ (This Year)",value:"this_year"},{label:"áž†áŸ’áž“áž¶áŸ†áž˜áž»áž“ (Last Year)",value:"last_year"},{label:"áž€áŸ†ážŽážáŸ‹ážáŸ’áž›áž½áž“áž¯áž„ (Custom)",value:"custom"}],_t=({datePreset:s,setDatePreset:a,startDate:i,setStartDate:r,endDate:f,setEndDate:b,calculatedRange:w})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 p-5 rounded-[1.8rem] border border-white/5 shadow-inner",children:[e.jsx("label",{className:"text-[10px] font-black text-blue-500 mb-3 block uppercase tracking-[0.2em] ml-2",children:"Temporal Window"}),e.jsx("select",{value:s,onChange:g=>a(g.target.value),className:"form-select !bg-gray-900 border-gray-800 !py-3.5 !px-5 rounded-2xl font-bold text-gray-200 focus:border-blue-500/50",children:zt.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value))}),e.jsx("div",{className:"mt-3 bg-black/40 p-3 rounded-xl text-center text-[10px] font-mono text-gray-500 border border-white/5 uppercase tracking-widest",children:w})]}),s==="custom"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 animate-fade-in px-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"From"}),e.jsx("input",{type:"date",value:i,onChange:g=>r(g.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"To"}),e.jsx("input",{type:"date",value:f,onChange:g=>b(g.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]})]})]}),de=({label:s,value:a,onChange:i,options:r,placeholder:f="All",variant:b="default",multiple:w=!1,searchable:g=!0})=>{const[n,N]=c.useState(!1),[p,j]=c.useState(""),F=c.useRef(null),A=c.useRef(null);c.useEffect(()=>{const t=D=>{F.current&&!F.current.contains(D.target)&&(N(!1),j(""))};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),c.useEffect(()=>{n&&g&&A.current&&setTimeout(()=>{var t;return(t=A.current)==null?void 0:t.focus()},100)},[n,g]);const L=a?a.split(","):[],v=t=>typeof t=="string"?t:t.label,$=t=>typeof t=="string"?t:t.value,y=c.useMemo(()=>{if(!p)return r;const t=p.toLowerCase();return r.filter(D=>{const d=v(D).toLowerCase(),x=$(D).toLowerCase();return d.includes(t)||x.includes(t)})},[r,p]),O=t=>{if(w){let D;L.includes(t)?D=L.filter(d=>d!==t):D=[...L,t],i(D.join(","))}else i(t),N(!1),j("")},h=t=>{t.stopPropagation(),i(""),w||N(!1)};let l=f;if(L.length>0)if(L.length===1){const t=r.find(D=>$(D)===L[0]);l=t?v(t):L[0]}else l=`${L.length} Selected`;let u="relative w-full cursor-pointer bg-gray-900 border border-gray-800 py-3.5 px-4 rounded-2xl font-bold transition-all focus:border-blue-500/50 flex justify-between items-center",m="text-gray-400";return b==="payment"?L.includes("Paid")?(u+=" border-emerald-500/30 shadow-[0_0_15px_rgba(16,185,129,0.1)]",m="text-emerald-400"):L.includes("Unpaid")&&(u+=" border-red-500/30 shadow-[0_0_15px_rgba(239,68,68,0.1)]",m="text-red-400"):L.length>0&&(m="text-white",u+=" border-blue-500/30"),e.jsxs("div",{className:"w-full",ref:F,children:[e.jsxs("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:[s," ",w&&e.jsx("span",{className:"text-[9px] text-blue-500 bg-blue-500/10 px-1.5 py-0.5 rounded ml-1",children:"MULTI"})]}),e.jsxs("div",{className:u,onClick:()=>N(!n),children:[e.jsx("span",{className:`truncate mr-2 text-sm ${m}`,children:l}),e.jsxs("div",{className:"flex items-center gap-2",children:[L.length>0&&e.jsx("button",{onClick:h,className:"p-1 hover:bg-gray-700 rounded-full text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),n&&e.jsxs("div",{className:"absolute top-full left-0 w-full mt-2 bg-[#1a2235] border border-white/10 rounded-2xl shadow-2xl z-50 overflow-hidden animate-fade-in-down max-h-72 flex flex-col",children:[g&&e.jsx("div",{className:"p-2 border-b border-white/5 sticky top-0 bg-[#1a2235] z-10",children:e.jsx("input",{ref:A,type:"text",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-sm text-white focus:border-blue-500 focus:outline-none placeholder-gray-600",placeholder:"Search...",value:p,onChange:t=>j(t.target.value),onClick:t=>t.stopPropagation()})}),e.jsx("div",{className:"overflow-y-auto custom-scrollbar flex-grow",children:y.length>0?y.map((t,D)=>{const d=$(t),x=v(t),o=L.includes(d);return e.jsxs("div",{onClick:k=>{k.stopPropagation(),O(d)},className:`
                                                px-4 py-3 flex items-center justify-between cursor-pointer border-b border-white/5 last:border-none transition-colors
                                                ${o?"bg-blue-600/10":"hover:bg-white/5"}
                                            `,children:[e.jsx("span",{className:`text-sm font-bold truncate ${o?"text-blue-400":"text-gray-300"}`,children:x}),o&&e.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),!o&&w&&e.jsx("div",{className:"w-5 h-5 rounded border-2 border-gray-600 flex-shrink-0 ml-2"})]},`${d}-${D}`)}):e.jsx("div",{className:"p-4 text-center text-xs text-gray-500 font-bold uppercase",children:"No Matches Found"})})]})]})]})},Ye=({filters:s,setFilters:a,orders:i,usersList:r,appData:f,calculatedRange:b})=>{var N;const w=c.useMemo(()=>{const p=new Set,j=new Set,F=new Set,A=new Set,L=new Set,v=new Set,$=new Set,y=new Set,O=new Map;i.forEach(l=>{l.Page&&p.add(l.Page),l.Location&&j.add(l.Location),l["Internal Shipping Method"]&&F.add(l["Internal Shipping Method"]),l["Internal Shipping Details"]&&A.add(l["Internal Shipping Details"]),l["Fulfillment Store"]&&L.add(l["Fulfillment Store"]),l["Payment Info"]&&v.add(l["Payment Info"]),l["Internal Cost"]!==void 0&&$.add(String(l["Internal Cost"])),l.Team&&y.add(l.Team),l["Customer Name"]&&O.set(l["Customer Name"],l["Customer Phone"]||"")});const h=Array.from(O.entries()).sort((l,u)=>l[0].localeCompare(u[0])).map(([l,u])=>({label:`${l} ${u?`(${u})`:""}`,value:l}));return{pages:Array.from(p).sort(),locations:Array.from(j).sort(),shippingMethods:Array.from(F).sort(),drivers:Array.from(A).sort(),fulfillmentStores:Array.from(L).sort(),banks:Array.from(v).sort(),costs:Array.from($).sort((l,u)=>Number(l)-Number(u)),teams:Array.from(y).sort(),customerOptions:h}},[i]),g=()=>{a({datePreset:"this_month",startDate:"",endDate:"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:"",customerName:""})},n=(p,j)=>{a({...s,[p]:j})};return e.jsxs("div",{className:"space-y-8",children:[e.jsx(_t,{datePreset:s.datePreset,setDatePreset:p=>a({...s,datePreset:p}),startDate:s.startDate,setStartDate:p=>n("startDate",p),endDate:s.endDate,setEndDate:p=>n("endDate",p),calculatedRange:b}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-x-6 gap-y-6 px-1",children:[e.jsx(de,{label:"Customer Name (ážˆáŸ’áž˜áŸ„áŸ‡áž¢ážáž·ážáž·áž‡áž“)",value:s.customerName,onChange:p=>n("customerName",p),options:w.customerOptions,placeholder:"Search by Name or Phone...",multiple:!0,searchable:!0}),e.jsx(de,{label:"Payment Status",value:s.paymentStatus,onChange:p=>n("paymentStatus",p),options:[{label:"Paid (ážšáž½áž…ážšáž¶áž›áŸ‹)",value:"Paid"},{label:"Unpaid (COD)",value:"Unpaid"}],placeholder:"All Statuses",variant:"payment",multiple:!0}),e.jsx(de,{label:"Store (Brand/Sales)",value:s.store,onChange:p=>n("store",p),options:((N=f.stores)==null?void 0:N.map(p=>p.StoreName))||[],placeholder:"All Stores (Brands)",multiple:!0}),e.jsx(de,{label:"Team Allocation",value:s.team,onChange:p=>n("team",p),options:w.teams,placeholder:"All Operational Teams",multiple:!0}),e.jsx(de,{label:"Source Page",value:s.page,onChange:p=>n("page",p),options:w.pages,placeholder:"All Pages",multiple:!0}),e.jsx(de,{label:"Fulfillment Store (Stock)",value:s.fulfillmentStore,onChange:p=>n("fulfillmentStore",p),options:w.fulfillmentStores,placeholder:"All Fulfillment Centers",multiple:!0}),e.jsx(de,{label:"Geography (Location)",value:s.location,onChange:p=>n("location",p),options:w.locations,placeholder:"All Regions",multiple:!0}),e.jsx(de,{label:"Logistics Method",value:s.shippingService,onChange:p=>n("shippingService",p),options:w.shippingMethods,placeholder:"All Shipping Methods",multiple:!0}),e.jsx(de,{label:"Logistics Driver",value:s.driver,onChange:p=>n("driver",p),options:w.drivers,placeholder:"All Drivers / Details",multiple:!0}),e.jsx(de,{label:"Merchant Node (User)",value:s.user,onChange:p=>n("user",p),options:r.map(p=>({label:p.FullName,value:p.UserName})),placeholder:"All Registered Users",multiple:!0}),e.jsx(de,{label:"Exp. Cost (Internal)",value:s.internalCost,onChange:p=>n("internalCost",p),options:w.costs.map(p=>({label:`$${p}`,value:p})),placeholder:"All Costs",multiple:!0}),e.jsx(de,{label:"áž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš (Bank)",value:s.bank,onChange:p=>n("bank",p),options:w.banks,placeholder:"All Bank Accounts",multiple:!0}),e.jsxs("div",{className:"sm:col-span-2 xl:col-span-3",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:"Asset Selection (Product)"}),e.jsx(ht,{products:f.products,selectedProductName:s.product,onSelect:p=>n("product",p),showTagEditor:!1})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:g,className:"w-full py-4 text-[11px] font-black text-gray-500 uppercase tracking-widest hover:text-white border border-dashed border-gray-800 rounded-2xl transition-all active:scale-95 hover:border-red-500/30 hover:bg-red-500/10",children:"Reset All Configurations"})})]})},Ut=({activeReport:s,onBack:a,onNavigate:i})=>{const{appData:r,refreshTimestamp:f,setMobilePageTitle:b}=c.useContext(re),[w,g]=c.useState(!0),[n,N]=c.useState([]),[p,j]=c.useState([]),[F,A]=c.useState(!1),L={overview:"OVERVIEW",sales_team:"SALES TEAM REPORT",sales_page:"SALES PAGE REPORT",performance:"PERFORMANCE",profitability:"PROFITABILITY",shipping:"SHIPPING COST",forecasting:"FORECASTING"};c.useEffect(()=>(b(L[s]),()=>b(null)),[s,b]);const[v,$]=H("dateFilter","this_month"),[y,O]=H("startDate",""),[h,l]=H("endDate",""),[u,m]=H("customerFilter",""),[t,D]=c.useState({datePreset:v||"this_month",startDate:y||"",endDate:h||"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:"",customerName:u||""});c.useEffect(()=>{t.datePreset!==v&&$(t.datePreset),t.startDate!==y&&O(t.startDate),t.endDate!==h&&l(t.endDate),t.customerName!==u&&m(t.customerName)},[t.datePreset,t.startDate,t.endDate,t.customerName,v,y,h,u,$,O,l,m]);const d=async()=>{g(!0);try{const[C,T]=await Promise.all([fetch(`${ae}/api/admin/all-orders`),fetch(`${ae}/api/users`)]),M=await C.json(),U=await T.json();if(M.status==="success"){const V=(M.data||[]).filter(E=>E!==null&&E["Order ID"]!=="Opening_Balance"&&E["Order ID"]!=="Opening Balance").map(E=>{let I=[];try{E["Products (JSON)"]&&(I=JSON.parse(E["Products (JSON)"]))}catch{}return{...E,Products:I}});N(V)}U.status==="success"&&j(U.data||[])}catch(C){console.error(C)}finally{g(!1)}};c.useEffect(()=>{d()},[f]);const x=c.useMemo(()=>{const C=new Date,T=new Date(C.getFullYear(),C.getMonth(),C.getDate());let M=null,U=new Date;switch(t.datePreset){case"today":M=T;break;case"yesterday":M=new Date(T),M.setDate(T.getDate()-1),U=new Date(T),U.setMilliseconds(-1);break;case"this_week":const E=C.getDay();M=new Date(T),M.setDate(T.getDate()-(E===0?6:E-1));break;case"last_week":M=new Date(T),M.setDate(T.getDate()-C.getDay()-6),U=new Date(M),U.setDate(M.getDate()+6),U.setHours(23,59,59);break;case"this_month":M=new Date(C.getFullYear(),C.getMonth(),1);break;case"last_month":M=new Date(C.getFullYear(),C.getMonth()-1,1),U=new Date(C.getFullYear(),C.getMonth(),0,23,59,59);break;case"this_year":M=new Date(C.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${t.startDate||"..."} to ${t.endDate||"..."}`}const V=E=>{const I=E.getFullYear(),G=String(E.getMonth()+1).padStart(2,"0"),q=String(E.getDate()).padStart(2,"0");return`${I}-${G}-${q}`};return M?`${V(M)} to ${V(U)}`:"All time data stream"},[t.datePreset,t.startDate,t.endDate]),o=c.useMemo(()=>n.filter(C=>{var M;if(t.datePreset!=="all"){const U=new Date(C.Timestamp),V=new Date,E=new Date(V.getFullYear(),V.getMonth(),V.getDate());let I=null,G=new Date;switch(t.datePreset){case"today":I=E;break;case"yesterday":I=new Date(E),I.setDate(E.getDate()-1),G=new Date(E),G.setMilliseconds(-1);break;case"this_week":const q=V.getDay();I=new Date(E),I.setDate(E.getDate()-(q===0?6:q-1));break;case"last_week":I=new Date(E),I.setDate(E.getDate()-V.getDay()-6),G=new Date(I),G.setDate(I.getDate()+6),G.setHours(23,59,59);break;case"this_month":I=new Date(V.getFullYear(),V.getMonth(),1);break;case"last_month":I=new Date(V.getFullYear(),V.getMonth()-1,1),G=new Date(V.getFullYear(),V.getMonth(),0,23,59,59);break;case"this_year":I=new Date(V.getFullYear(),0,1);break;case"custom":t.startDate&&(I=new Date(t.startDate+"T00:00:00")),t.endDate&&(G=new Date(t.endDate+"T23:59:59"));break}if(I&&U<I||G&&U>G)return!1}const T=(U,V)=>{if(!U)return!0;const E=U.split(",").map(G=>G.trim().toLowerCase()),I=(V||"").trim().toLowerCase();return E.includes(I)};if(!T(t.team,C.Team)||!T(t.user,C.User||"")||!T(t.paymentStatus,C["Payment Status"])||!T(t.shippingService,C["Internal Shipping Method"])||!T(t.driver,C["Internal Shipping Details"])||!T(t.bank,C["Payment Info"])||!T(t.fulfillmentStore,C["Fulfillment Store"])||!T(t.page,C.Page)||!T(t.location,C.Location)||!T(t.internalCost,String(C["Internal Cost"]))||t.product&&!C.Products.some(U=>U.name===t.product))return!1;if(t.store){const U=(M=r.pages)==null?void 0:M.find(I=>I.PageName===C.Page),V=U?U.DefaultStore:null,E=t.store.split(",");if(!V||!E.includes(V))return!1}return!!T(t.customerName,C["Customer Name"])}),[n,t,r.pages]);if(w)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-950",children:e.jsx(te,{size:"lg"})});const k=Object.values(t).filter(C=>C!==""&&C!=="this_month"&&C!=="all").length;return e.jsxs("div",{className:"animate-fade-in space-y-8 pb-20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-gray-800/20 p-6 rounded-[2.5rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden sm:block text-2xl font-black text-white uppercase tracking-tight italic",children:L[s]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("p",{className:"text-[10px] text-blue-400 font-black uppercase tracking-widest",children:[x," ",k>0&&` â€¢ ${k} Active Filters`]})]})]}),e.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:e.jsxs("button",{onClick:()=>A(!0),className:"relative flex-1 sm:flex-none btn btn-secondary !py-2.5 !px-6 rounded-2xl border border-gray-700 flex items-center justify-center gap-3 transition-all hover:bg-gray-700 active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter Engine",k>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-600 text-white text-[10px] font-black rounded-full flex items-center justify-center border-2 border-gray-900",children:k})]})})]}),e.jsxs("div",{className:"min-h-[500px]",children:[s==="overview"&&e.jsx(Le,{orders:o,reportType:"overview",allOrders:n,dateFilter:t.datePreset}),s==="sales_team"&&e.jsx(It,{orders:o,onBack:a}),s==="sales_page"&&e.jsx(Ft,{orders:o,onBack:a,onNavigate:i,contextFilters:t,dateFilter:t.datePreset,startDate:t.startDate,endDate:t.endDate}),s==="shipping"&&e.jsx(Le,{orders:o,reportType:"shipping",allOrders:n,dateFilter:t.datePreset,startDate:t.startDate,endDate:t.endDate,onNavigate:i,contextFilters:t}),s==="profitability"&&e.jsx(Le,{orders:o,reportType:"profitability",allOrders:n,dateFilter:t.datePreset}),s==="performance"&&e.jsx(Le,{orders:o,reportType:"performance",allOrders:n,dateFilter:t.datePreset}),s==="forecasting"&&e.jsx(Le,{orders:n,reportType:"forecasting",allOrders:n,dateFilter:t.datePreset})]}),e.jsx(he,{isOpen:F,onClose:()=>A(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>A(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"Ã—"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(Ye,{filters:t,setFilters:D,orders:n,usersList:p,appData:r,calculatedRange:x})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>A(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})]})},Rt=({storesHierarchy:s,selectedPageNames:a,teamsPerRow:i,columns:r,imageMap:f})=>{const b=a.size,g=c.useCallback(()=>b>60?.45:b>45?.6:b>30?.75:b>=20?.85:1,[b])(),n=N=>Math.round(N*g);return e.jsxs("div",{id:"png-export-layer",style:{display:"none",width:"2560px",minHeight:"1440px",height:"auto",position:"relative",backgroundColor:"#020617",fontFamily:"'Kantumruy Pro', sans-serif",WebkitFontSmoothing:"antialiased",paddingBottom:n(100)},className:"flex flex-col items-center",children:[e.jsx("style",{children:`
                #png-export-layer * {
                    box-sizing: border-box;
                    line-height: 1.6 !important;
                }
                .khmer-text {
                    font-family: 'Kantumruy Pro', sans-serif !important;
                    padding-bottom: 2px;
                }
                .item-container {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }
                .team-badge-gradient {
                    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
                    border: ${n(2)}px solid rgba(59, 130, 246, 0.5);
                }
            `}),e.jsx("div",{className:"absolute inset-0 opacity-[0.12] pointer-events-none",style:{backgroundImage:"radial-gradient(#3b82f6 1.2px, transparent 1.2px)",backgroundSize:"40px 40px",height:"100%"}}),e.jsx("div",{className:"w-full h-full flex flex-col p-[50px] relative z-10 justify-center",children:e.jsx("div",{className:"w-full",children:Object.entries(s).map(([N,p],j)=>Object.values(p).some(A=>A.some(L=>a.has(L.PageName)))?e.jsxs("div",{className:"w-full item-container flex flex-col mb-[70px] last:mb-0 items-center",children:[e.jsxs("div",{className:"flex items-center gap-[30px] mb-[60px] justify-center",children:[e.jsx("div",{style:{width:n(100),height:n(100),borderRadius:n(28),fontSize:n(50)},className:"bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center font-black shadow-[0_0_40px_rgba(59,130,246,0.3)] border border-white/20 flex-shrink-0",children:(j+1).toString().padStart(2,"0")}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("h2",{style:{fontSize:n(100)},className:"font-black text-white uppercase tracking-tighter leading-none khmer-text drop-shadow-2xl",children:N})})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${i}, minmax(0, 1fr))`,gap:n(60),width:"100%",maxWidth:"95%",direction:"ltr"},children:Object.entries(p).map(([A,L])=>{const v=L.filter($=>a.has($.PageName));return v.length===0?null:e.jsxs("div",{style:{borderRadius:n(45),padding:n(40),paddingTop:n(65)},className:"bg-gray-900/40 border border-white/10 shadow-2xl flex flex-col relative backdrop-blur-xl",children:[e.jsx("div",{style:{top:n(-42),left:"50%",transform:"translateX(-50%)",borderRadius:n(20),padding:`${n(14)}px ${n(50)}px`,fontSize:n(34),minWidth:n(220),display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 ${n(15)}px ${n(35)}px rgba(0,0,0,0.8), inset 0 0 ${n(10)}px rgba(59, 130, 246, 0.2)`},className:"absolute team-badge-gradient font-black uppercase tracking-widest text-blue-400 khmer-text whitespace-nowrap z-20",children:A}),e.jsx("div",{className:"space-y-[20px] flex-grow",children:v.map($=>e.jsxs("div",{style:{borderRadius:n(28),padding:n(18)},className:"flex items-center gap-[20px] bg-black/40 border border-white/5 shadow-inner hover:border-blue-500/30 transition-all",children:[r.logoImage&&f[$.PageName]&&e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:f[$.PageName],style:{width:n(85),height:n(85),borderRadius:n(22)},className:"object-cover border-[3px] border-gray-700 shadow-lg",alt:""})}),e.jsxs("div",{className:"flex-grow min-w-0 text-left",style:{marginTop:n(-25)},children:[e.jsx("span",{style:{fontSize:n(36)},className:"font-black block text-white uppercase tracking-tight khmer-text leading-tight break-words",children:$.PageName}),r.telegramValue&&e.jsxs("div",{style:{marginTop:n(8)},className:"flex items-center gap-2",children:[e.jsx("svg",{style:{width:n(20),height:n(20)},className:"text-blue-500 opacity-80",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h-2v-6h2v6zm-1-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})}),e.jsxs("span",{style:{fontSize:n(24)},className:"text-blue-400/70 font-mono font-bold tracking-wider leading-none",children:["@",$.TelegramValue]})]})]})]},$.PageName))})]},A)})})})]},N):null)})})]})},Et=({isOpen:s,onClose:a,pages:i})=>{const[r,f]=c.useState(3),[b,w]=c.useState(!1),[g,n]=c.useState(0),[N,p]=c.useState(null),[j,F]=c.useState({pageName:!0,telegramValue:!0,logoImage:!0}),[A,L]=c.useState(new Set),[v,$]=c.useState({});c.useEffect(()=>{s&&i&&i.length>0&&A.size===0&&L(new Set(i.map(o=>o.PageName))),s||p(null)},[s,i]);const y=c.useMemo(()=>{const o={};return i&&i.forEach(k=>{const C=k.DefaultStore||"No Store",T=k.Team||"No Team";o[C]||(o[C]={}),o[C][T]||(o[C][T]=[]),o[C][T].push(k)}),o},[i]),O=o=>{F(k=>({...k,[o]:!k[o]}))},h=o=>{L(k=>{const C=new Set(k);return C.has(o)?C.delete(o):C.add(o),C})},l=o=>{const k=o.every(C=>A.has(C.PageName));L(C=>{const T=new Set(C);return o.forEach(M=>{k?T.delete(M.PageName):T.add(M.PageName)}),T})},u=o=>{const k=Object.values(o).flat(),C=k.every(T=>A.has(T.PageName));L(T=>{const M=new Set(T);return k.forEach(U=>{C?M.delete(U.PageName):M.add(U.PageName)}),M})},m=o=>{L(o?new Set(i.map(k=>k.PageName)):new Set)},t=async o=>{const k={...v};let C=0;for(const T of o){if(T.PageLogoURL&&!k[T.PageName])try{const M=await st(T.PageLogoURL);M&&(k[T.PageName]=`data:image/png;base64,${M}`)}catch{console.warn(`Failed to load logo for ${T.PageName}`)}C++,n(Math.round(C/o.length*100))}return $(k),k},D=async()=>{if(A.size===0)return;w(!0),n(0);const o=document.getElementById("png-export-layer");if(!o){w(!1);return}const k=o.getAttribute("style")||"";try{const C=i.filter(I=>A.has(I.PageName));await t(C),await document.fonts.ready;const T=2560;o.style.display="flex",o.style.width=`${T}px`,o.style.height="auto",o.style.position="fixed",o.style.top="0",o.style.left="-10000px",o.style.zIndex="-100",await new Promise(I=>setTimeout(I,1e3));const M=o.scrollHeight,U=Math.max(1440,M),E=(await ft(o,{backgroundColor:"#020617",scale:1.5,useCORS:!0,logging:!1,width:T,height:U,windowWidth:T,windowHeight:U,allowTaint:!0,imageTimeout:15e3,onclone:I=>{const G=I.getElementById("png-export-layer");G&&(G.style.fontFamily="'Kantumruy Pro', sans-serif",G.querySelectorAll("*").forEach(oe=>{const le=oe;le.style.letterSpacing="normal",le.style.textTransform="none",le.style.fontFamily="'Kantumruy Pro', sans-serif"}))}})).toDataURL("image/png",.9);p(E)}catch(C){console.error("Preview Generation Error:",C),alert("áž€áž¶ážšáž”áž„áŸ’áž€áž¾áž Preview áž”ážšáž¶áž‡áŸáž™áŸ”")}finally{o.setAttribute("style",k),w(!1)}},d=()=>{if(N)try{const o=new Be({orientation:"landscape",unit:"mm",format:"a4"}),k=o.getImageProperties(N),C=o.internal.pageSize.getWidth(),T=k.height*C/k.width;o.deletePage(1),o.addPage([C,T]),o.addImage(N,"PNG",0,0,C,T),o.save(`Organization_Chart_${new Date().getTime()}.pdf`),a()}catch(o){console.error(o),alert("Export PDF Error")}},x=()=>{if(!N)return;const o=document.createElement("a");o.href=N,o.download=`Organization_Chart_${new Date().getTime()}.png`,document.body.appendChild(o),o.click(),document.body.removeChild(o)};return e.jsxs(he,{isOpen:s,onClose:a,maxWidth:"max-w-7xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-white/5 pb-6",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-3xl font-black text-white flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-600/20 rounded-2xl flex items-center justify-center border border-red-500/30",children:e.jsx("svg",{className:"w-7 h-7 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),"Premium HD Export"]})}),e.jsx("button",{onClick:a,className:"p-3 bg-gray-800 text-gray-400 hover:text-white rounded-2xl active:scale-95 transition-all",children:"Ã—"})]}),N?e.jsxs("div",{className:"flex flex-col h-[70vh]",children:[e.jsx("div",{className:"flex-grow overflow-auto bg-gray-950/50 rounded-3xl border border-white/10 p-4 flex items-center justify-center relative",children:e.jsx("img",{src:N,className:"max-w-full h-auto shadow-2xl rounded-lg",alt:"Preview"})}),e.jsxs("div",{className:"mt-6 flex flex-wrap justify-between items-center border-t border-white/5 pt-6 gap-4",children:[e.jsxs("button",{onClick:()=>p(null),className:"px-8 py-4 text-sm font-black text-gray-400 hover:text-white uppercase flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})}),"Back to Settings"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:x,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16l4 4m0 0l4-4m-4 4V4"})}),"Download PNG"]}),e.jsxs("button",{onClick:d,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-emerald-600 text-white hover:bg-emerald-700 shadow-emerald-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download PDF"]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 h-[70vh]",children:[e.jsx("div",{className:"lg:col-span-3 space-y-8 overflow-y-auto pr-4 custom-scrollbar",children:e.jsxs("div",{className:"bg-black/40 p-6 rounded-[2.5rem] border border-white/5 space-y-8 shadow-inner",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Density Control"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-900/50 p-1.5 rounded-2xl border border-gray-800",children:[1,2,3,4,5,6].map(o=>e.jsx("button",{onClick:()=>f(o),className:`py-2.5 rounded-xl text-xs font-black transition-all ${r===o?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Display Fields"}),e.jsx("div",{className:"space-y-2",children:Object.keys(j).map(o=>e.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-2xl border border-gray-800 cursor-pointer hover:bg-blue-600/5 transition-colors group",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-gray-200 capitalize",children:o.replace(/([A-Z])/g," $1")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:j[o],onChange:()=>O(o),className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]},o))})]})]})}),e.jsxs("div",{className:"lg:col-span-9 flex flex-col bg-gray-950/40 rounded-[3rem] border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 bg-white/5 flex justify-between items-center backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsxs("p",{className:"text-xs font-black text-white uppercase tracking-widest",children:[A.size," Nodes Linked"]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("button",{onClick:()=>m(!0),className:"text-[10px] font-black text-blue-400 hover:text-blue-300 transition-colors uppercase tracking-widest",children:"Select All"}),e.jsx("button",{onClick:()=>m(!1),className:"text-[10px] font-black text-gray-500 hover:text-white transition-colors uppercase tracking-widest",children:"Clear"})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-8 space-y-12 custom-scrollbar",children:Object.entries(y).map(([o,k])=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 group",children:[e.jsx("input",{type:"checkbox",onChange:()=>u(k),className:"w-6 h-6 rounded-lg border-gray-700 bg-gray-900 text-blue-600 focus:ring-blue-500/20 cursor-pointer"}),e.jsxs("h4",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-4 group-hover:text-blue-400 transition-colors",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),o]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pl-10",children:Object.entries(k).map(([C,T])=>{const M=T.every(U=>A.has(U.PageName));return e.jsxs("div",{className:"bg-gray-900/40 rounded-3xl border border-white/5 p-6 shadow-xl",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-6 cursor-pointer border-b border-white/5 pb-4",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:()=>l(T),className:"w-5 h-5 rounded-md border-gray-700 bg-gray-800 text-blue-500"}),e.jsx("span",{className:"text-xs font-black text-gray-400 uppercase tracking-[0.15em]",children:C})]}),e.jsx("div",{className:"space-y-3",children:T.map(U=>e.jsxs("label",{className:`flex items-center gap-4 p-3 rounded-2xl border transition-all cursor-pointer ${A.has(U.PageName)?"bg-blue-600/10 border-blue-500/30":"bg-black/20 border-transparent hover:bg-white/5"}`,children:[e.jsx("input",{type:"checkbox",checked:A.has(U.PageName),onChange:()=>h(U.PageName),className:"w-4 h-4 rounded-md border-gray-700 bg-gray-900 text-blue-600"}),e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("img",{src:xe(U.PageLogoURL),className:"w-7 h-7 rounded-full object-cover border border-white/10",alt:""}),e.jsx("span",{className:"text-xs font-bold text-gray-300 truncate",children:U.PageName})]})]},U.PageName))})]},C)})})]},o))}),e.jsxs("div",{className:"p-8 border-t border-white/5 bg-gray-900/80 backdrop-blur-xl flex justify-between items-center",children:[e.jsx("div",{className:"flex flex-col",children:b&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{size:"sm"}),e.jsxs("p",{className:"text-xs font-black text-red-400 uppercase tracking-[0.2em] animate-pulse",children:["Processing Preview: ",g,"%"]})]}),e.jsx("div",{className:"w-64 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-600 transition-all duration-300",style:{width:`${g}%`}})})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"px-8 py-4 text-sm font-black text-gray-500 hover:text-white uppercase",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:b||A.size===0,className:`px-12 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 ${b||A.size===0?"bg-gray-800 text-gray-600":"bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20"}`,children:b?"Rendering...":"Preview Export"})]})]})]})]}),e.jsx(Rt,{storesHierarchy:y,selectedPageNames:A,teamsPerRow:r,columns:j,imageMap:v})]})},Ge=[{id:"users",title:"áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž‚ážŽáž“áž¸áž”áž»áž‚áŸ’áž‚áž›áž·áž€ áž“áž·áž„ážŸáž·áž‘áŸ’áž’áž·áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹",icon:"ðŸ‘¤",dataKey:"users",sheetName:"Users",primaryKeyField:"UserName",fields:[{name:"FullName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž–áŸáž‰",type:"text"},{name:"UserName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž‚ážŽáž“áž¸ (Login)",type:"text"},{name:"Password",label:"áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹",type:"password"},{name:"Role",label:"ážáž½áž“áž¶áž‘áž¸ (Role)",type:"text"},{name:"Team",label:"áž€áŸ’ážšáž»áž˜ (Team)",type:"text"},{name:"ProfilePictureURL",label:"URL ážšáž¼áž”áž—áž¶áž–",type:"image_url"},{name:"IsSystemAdmin",label:"System Admin?",type:"checkbox"}],displayField:"FullName"},{id:"products",title:"áž•áž›áž·ážáž•áž›",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áž‰áŸ’áž‡áž¸áž‘áŸ†áž“áž·áž‰ ážáž˜áŸ’áž›áŸƒ áž“áž·áž„ Barcode",icon:"ðŸ›ï¸",dataKey:"products",sheetName:"Products",primaryKeyField:"ProductName",fields:[{name:"ProductName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž•áž›áž·ážáž•áž›",type:"text"},{name:"Barcode",label:"Barcode",type:"text"},{name:"Price",label:"ážáž˜áŸ’áž›áŸƒ ($)",type:"number"},{name:"Cost",label:"ážáž˜áŸ’áž›áŸƒážŠáž¾áž˜ ($)",type:"number"},{name:"ImageURL",label:"URL ážšáž¼áž”áž—áž¶áž–",type:"image_url"},{name:"Tags",label:"Tags (comma separated)",type:"text"}],displayField:"ProductName"},{id:"pages",title:"áž€áŸ’ážšáž»áž˜ & Page",description:"áž€áŸ†ážŽážáŸ‹ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜ áž“áž·áž„áž‘áž·áž“áŸ’áž“áž“áŸáž™ Facebook Page",icon:"ðŸ‘¥",dataKey:"pages",sheetName:"TeamsPages",primaryKeyField:"PageName",fields:[{name:"PageName",label:"ážˆáŸ’áž˜áŸ„áŸ‡ Page",type:"text"},{name:"Team",label:"áž€áŸ’ážšáž»áž˜",type:"text"},{name:"TelegramValue",label:"Telegram Value",type:"text"},{name:"PageLogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"PageName"},{id:"shippingMethods",title:"ážŸáŸážœáž¶ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“",description:"áž€áŸ†ážŽážáŸ‹áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“ áž“áž·áž„áž›áž€áŸ’ážážážŽáŸ’ážŒážŠáž¹áž€",icon:"ðŸšš",dataKey:"shippingMethods",sheetName:"ShippingMethods",primaryKeyField:"MethodName",fields:[{name:"MethodName",label:"ážˆáŸ’áž˜áŸ„áŸ‡ážŸáŸážœáž¶",type:"text"},{name:"RequireDriverSelection",label:"ážáŸ’ážšáž¼ážœáž€áž¶ážšáž¢áŸ’áž“áž€ážŠáž¹áž€?",type:"checkbox"},{name:"LogosURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"MethodName"},{id:"drivers",title:"áž¢áŸ’áž“áž€ážŠáž¹áž€",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž–áŸážáŸŒáž˜áž¶áž“áž¢áŸ’áž“áž€ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“áž•áŸ’áž‘áž¶áž›áŸ‹ážáŸ’áž›áž½áž“",icon:"ðŸ›µ",dataKey:"drivers",sheetName:"Drivers",primaryKeyField:"DriverName",fields:[{name:"DriverName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž¢áŸ’áž“áž€ážŠáž¹áž€",type:"text"},{name:"ImageURL",label:"URL ážšáž¼áž”ážáž",type:"image_url"}],displayField:"DriverName"},{id:"bankAccounts",title:"áž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áž‰áŸ’áž‡áž¸áž’áž“áž¶áž‚áž¶ážšážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‘áž‘áž½áž›áž”áŸ’ážšáž¶áž€áŸ‹",icon:"ðŸ¦",dataKey:"bankAccounts",sheetName:"BankAccounts",primaryKeyField:"BankName",fields:[{name:"BankName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž’áž“áž¶áž‚áž¶ážš",type:"text"},{name:"LogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"BankName"},{id:"phoneCarriers",title:"áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“áž‘áž¼ážšážŸáŸáž–áŸ’áž‘",description:"áž€áŸ†ážŽážáŸ‹ Prefixes ážšáž”ážŸáŸ‹áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“áž‘áž¼ážšážŸáŸáž–áŸ’áž‘",icon:"ðŸ“±",dataKey:"phoneCarriers",sheetName:"PhoneCarriers",primaryKeyField:"CarrierName",fields:[{name:"CarrierName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“",type:"text"},{name:"Prefixes",label:"Prefixes (áž”áŸ†áž”áŸ‚áž€ážŠáŸ„áž™áž€áŸ’áž”áŸ€ážŸ)",type:"text"},{name:"CarrierLogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"CarrierName"}],ve=(s,a)=>{if(!s||typeof s!="object"||!a)return;if(s[a]!==void 0)return s[a];const i=a.toLowerCase(),r=Object.keys(s).find(f=>f.toLowerCase()===i||f.toLowerCase().replace(/_/g,"")===i.replace(/_/g,""));return r?s[r]:void 0},Re=(s,a)=>{if(!s||typeof s!="object")return[];if(Array.isArray(s[a]))return s[a];const i=a.toLowerCase(),r=Object.keys(s).find(f=>f.toLowerCase()===i);if(r&&Array.isArray(s[r]))return s[r];if(a==="pages"){const f=Object.keys(s).find(b=>b.toLowerCase().includes("teampage")||b.toLowerCase().includes("page"));if(f&&Array.isArray(s[f]))return s[f]}return[]},Bt=({section:s,item:a,onClose:i,onSave:r})=>{const{refreshData:f}=c.useContext(re),[b,w]=c.useState({}),[g,n]=c.useState({}),[N,p]=c.useState(!1),[j,F]=c.useState(""),A=c.useRef({}),[L,v]=c.useState({});c.useEffect(()=>{if(a){const h={};s.fields.forEach(l=>{let u=ve(a,l.name);u==null&&(u=l.type==="checkbox"?!1:l.type==="number"?0:""),h[l.name]=u}),s.id==="users"&&(h.Password=""),w(h)}else{const h=s.fields.reduce((l,u)=>(l[u.name]=u.type==="checkbox"?!1:u.type==="number"?0:"",l),{});w(h)}},[a,s]);const $=h=>{const{name:l,value:u,type:m,checked:t}=h.target;w(D=>({...D,[l]:m==="checkbox"?t:u}))},y=async(h,l)=>{if(l){n(u=>({...u,[h]:!0}));try{const u=await at(l),m=await fetch(`${ae}/api/upload-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileData:u,fileName:l.name,mimeType:l.type})}),t=await m.json();if(!m.ok||t.status!=="success")throw new Error(t.message||"Upload failed");w(D=>({...D,[h]:t.url}))}catch(u){F(u.message)}finally{n(u=>({...u,[h]:!1}))}}},O=async()=>{F("");for(const h of s.fields)if(h.type!=="checkbox"&&(b[h.name]===void 0||b[h.name]==="")&&h.name!=="Password"&&!a){F(`ážŸáž¼áž˜áž”áŸ†áž–áŸáž‰áž…áž“áŸ’áž›áŸ„áŸ‡ "${h.label}"`);return}p(!0);try{const h=a?"/api/admin/update-sheet":"/api/admin/add-row",l={...b};s.fields.forEach(t=>{t.type==="number"&&(l[t.name]=Number(l[t.name]))}),a&&s.id==="users"&&!l.Password&&delete l.Password;const u={sheetName:s.sheetName,newData:l};if(a&&(u.primaryKey={[s.primaryKeyField]:ve(a,s.primaryKeyField)}),!(await fetch(`${ae}${h}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).ok)throw new Error("Save failed");await f(),r(b)}catch(h){F(h.message)}finally{p(!1)}};return e.jsxs(he,{isOpen:!0,onClose:i,maxWidth:"max-w-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-black text-white",children:[a?"áž€áŸ‚ážŸáž˜áŸ’ážšáž½áž›":"áž”áž“áŸ’ážáŸ‚áž˜"," ",s.title]}),e.jsx("button",{onClick:i,className:"p-2 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"space-y-5 max-h-[65vh] overflow-y-auto pr-2 custom-scrollbar",children:s.fields.map(h=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-xs font-black text-gray-500 uppercase tracking-widest",children:h.label}),h.type==="checkbox"?e.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-3 rounded-xl border border-gray-700",children:[e.jsx("input",{type:"checkbox",name:h.name,checked:!!b[h.name],onChange:$,className:"h-6 w-6 rounded-lg border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"áž”áž¾áž€ážŠáŸ†ážŽáž¾ážšáž€áž¶ážšáž˜áž»ážáž„áž¶ážšáž“áŸáŸ‡"})]}):h.type==="image_url"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",name:h.name,value:b[h.name]||"",onChange:$,placeholder:"áž”áž·áž‘áž—áŸ’áž‡áž¶áž”áŸ‹ Link áž¬ Upload ážšáž¼áž”áž—áž¶áž–",className:"form-input flex-grow !py-2.5"}),e.jsx("input",{type:"file",accept:"image/*",ref:l=>{A.current[h.name]=l},onChange:l=>l.target.files&&y(h.name,l.target.files[0]),className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>{var l;return(l=A.current[h.name])==null?void 0:l.click()},className:"p-2.5 bg-blue-600/10 text-blue-400 rounded-xl border border-blue-500/20 hover:bg-blue-600 hover:text-white transition-all",disabled:g[h.name],children:g[h.name]?e.jsx(te,{size:"sm"}):e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h14a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),b[h.name]&&e.jsx("div",{className:"relative w-32 h-32 bg-gray-900 rounded-2xl border border-gray-700 p-2 overflow-hidden shadow-inner mx-auto sm:mx-0",children:e.jsx("img",{src:xe(b[h.name]),className:"w-full h-full object-contain",alt:"preview"})})]}):h.type==="password"?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:L[h.name]?"text":"password",name:h.name,value:b[h.name]||"",onChange:$,className:"form-input !py-2.5 pr-12",placeholder:a?"áž‘áž»áž€áž‘áž‘áŸáž”áž¾áž˜áž·áž“áž…áž„áŸ‹áž”áŸ’ážáž¼ážš":"áž”áž‰áŸ’áž…áž¼áž›áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹"}),e.jsx("button",{type:"button",onClick:()=>v(l=>({...l,[h.name]:!l[h.name]})),className:"absolute inset-y-0 right-0 px-4 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:L[h.name]?"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7 1.274-4.057 5.064-7 9.542-7 .847 0 1.67 .126 2.454 .364m-3.033 2.446a3 3 0 11-4.243 4.243m4.242-4.242l4.243 4.243M3 3l18 18":"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})})})]}):e.jsx("input",{type:h.type,name:h.name,value:b[h.name]||"",onChange:$,className:"form-input !py-2.5",readOnly:a&&h.name===s.primaryKeyField})]},h.name))}),j&&e.jsx("div",{className:"mt-4 p-3 bg-red-500/10 text-red-400 border border-red-500/20 rounded-xl text-sm font-bold",children:j}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-700/50",children:[e.jsx("button",{type:"button",onClick:i,className:"px-6 py-2.5 text-gray-400 hover:text-white font-bold transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{type:"button",onClick:O,className:"btn btn-primary px-8 shadow-lg shadow-blue-600/20 active:scale-95",disabled:N,children:N?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})},Wt=({isOpen:s,onClose:a,onConfirm:i,isProcessing:r})=>{const[f,b]=Xe.useState("We are updating the system to improve performance and add new features.");return s?e.jsx(he,{isOpen:s,onClose:a,maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20 animate-pulse",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-xl font-black text-white mb-2 uppercase tracking-tight",children:"System Update"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4 leading-relaxed",children:"ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž“áŸáŸ‡áž“áž¹áž„ážáž˜áŸ’ážšáž¼ážœáž±áŸ’áž™áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Users) áž…áž¶áž€áž…áŸáž‰áž–áž¸áž”áŸ’ážšáž–áŸáž“áŸ’áž’ (Log Out) ážŠáž¾áž˜áŸ’áž”áž¸áž’áŸ’ážœáž¾áž”áž…áŸ’áž…áž»áž”áŸ’áž”áž“áŸ’áž“áž—áž¶áž–áŸ”"}),e.jsxs("div",{className:"mb-6 text-left",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1",children:"Notification Message"}),e.jsx("textarea",{value:f,onChange:w=>b(w.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-xl p-3 text-sm text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 transition-all resize-none h-24",placeholder:"Enter notification message for users..."})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:a,className:"px-6 py-3 rounded-xl bg-gray-800 text-gray-400 font-bold hover:bg-gray-700 transition-all border border-gray-700",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>i(f),disabled:r,className:"px-6 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-500 transition-all flex items-center gap-2 shadow-lg shadow-red-900/20 active:scale-95 disabled:opacity-50",children:r?e.jsx(te,{size:"sm"}):"Confirm Update"})]})]})}):null},Vt=({onBack:s,initialSection:a})=>{const{appData:i,refreshData:r,logout:f,setMobilePageTitle:b}=c.useContext(re),[w,g]=c.useState(a||"users"),[n,N]=c.useState(a||null),[p,j]=c.useState({isOpen:!1,sectionId:"",item:null}),[F,A]=c.useState([]),[L,v]=c.useState(!1),[$,y]=c.useState(!1),[O,h]=c.useState(!1),l=window.innerWidth<768?n:w,u=Ge.find(d=>d.id===l);c.useEffect(()=>{const d=u?u.title:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹";return b(d),()=>b(null)},[u,b]),c.useEffect(()=>{l==="users"&&(async()=>{if(Re(i,"users").length===0){const k=await(await fetch(`${ae}/api/users`)).json();k.status==="success"&&A(k.data||[])}})()},[l,i]);const m=c.useMemo(()=>{if(!u)return[];if(u.id==="users"){const d=Re(i,"users");return d.length>0?d:F}return Re(i,u.dataKey)},[u,i,F]),t=async(d,x)=>{if(window.confirm(`ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸážáž¶áž…áž„áŸ‹áž›áž»áž” "${ve(x,d.displayField)}"?`))try{await fetch(`${ae}/api/admin/delete-row`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:d.sheetName,primaryKey:{[d.primaryKeyField]:ve(x,d.primaryKeyField)}})}),await r()}catch{alert("Delete failed")}},D=async d=>{h(!0);try{await fetch(`${ae}/api/admin/update-sheet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:"Settings",primaryKey:{Key:"SystemVersion"},newData:{Value:Date.now().toString(),Action:"ForceLogout",Message:d||"System Update in progress. Please log in again."}})}),await new Promise(x=>setTimeout(x,2e3)),f(),window.location.reload()}catch(x){console.error(x),h(!1),alert("Update command failed. Check connection.")}};return l?e.jsxs("div",{className:"w-full max-w-[100rem] mx-auto p-4 lg:p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{window.innerWidth<768?N(null):s()},className:"md:hidden p-2 bg-gray-800 text-white rounded-xl border border-gray-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"hidden sm:flex text-2xl lg:text-3xl font-black text-white items-center gap-3",children:[e.jsx("span",{className:"hidden md:inline",children:u==null?void 0:u.icon}),u==null?void 0:u.title]}),e.jsx("p",{className:"text-xs lg:text-sm text-gray-500 font-bold uppercase tracking-[0.2em] mt-1",children:u==null?void 0:u.description})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>y(!0),className:"flex-1 sm:flex-none btn bg-gray-800 border border-gray-700 hover:border-red-500/50 hover:bg-red-900/10 hover:text-red-400 text-gray-400 px-4 transition-all flex items-center justify-center gap-2",title:"Update Version & Force Logout",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"hidden xl:inline text-xs font-bold uppercase tracking-wider",children:"Update Version"})]}),l==="pages"&&e.jsx("button",{onClick:()=>v(!0),className:"flex-1 sm:flex-none btn btn-secondary px-6",children:"PDF Export"}),e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:l,item:null}),className:"flex-1 sm:flex-none btn btn-primary px-10 shadow-lg shadow-blue-600/20 font-black",children:"+ áž”áž“áŸ’ážáŸ‚áž˜ážáŸ’áž˜áž¸"}),e.jsx("button",{onClick:s,className:"hidden md:flex btn btn-secondary px-6",children:"ážáŸ’ážšáž¡áž”áŸ‹"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("aside",{className:"hidden md:flex flex-col gap-2 w-72 flex-shrink-0",children:Ge.map(d=>e.jsxs("button",{onClick:()=>g(d.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all ${w===d.id?"bg-blue-600 text-white shadow-xl shadow-blue-600/20":"text-gray-400 hover:bg-gray-800 hover:text-gray-200"}`,children:[e.jsx("span",{className:"text-xl",children:d.icon}),e.jsx("span",{className:"font-black text-sm uppercase tracking-wider",children:d.title})]},d.id))}),e.jsx("main",{className:"flex-grow min-w-0",children:e.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-3xl overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"admin-table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-700",children:[e.jsx("th",{className:"w-12 text-center",children:"#"}),u==null?void 0:u.fields.map(d=>e.jsx("th",{children:d.label},d.name)),e.jsx("th",{className:"w-32 text-center uppercase tracking-widest text-[10px]",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/30",children:m.length>0?m.map((d,x)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group",children:[e.jsx("td",{className:"text-center text-gray-500 font-bold text-xs",children:x+1}),u==null?void 0:u.fields.map(o=>{const k=ve(d,o.name);return e.jsx("td",{className:"py-4",children:o.type==="image_url"&&k?e.jsx("img",{src:xe(String(k)),className:"w-10 h-10 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1",alt:"logo"}):e.jsx("span",{className:`text-sm font-bold ${o.type==="password"?"text-gray-600":"text-gray-200"}`,children:o.type==="password"?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":typeof k=="boolean"?k?"âœ… Active":"âŒ Inactive":String(k||"-")})},o.name)}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:l,item:d}),className:"p-2 bg-amber-500/10 text-amber-400 rounded-lg hover:bg-amber-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>t(u,d),className:"p-2 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},x)):e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"py-20 text-center text-gray-500 font-bold",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™ážáŸ’ážšáž¼ážœáž”áž¶áž“ážšáž€ážƒáž¾áž‰áž‘áŸ"})})})]})}),e.jsx("div",{className:"md:hidden divide-y divide-gray-700/50",children:m.length>0?m.map((d,x)=>{const o=ve(d,(u==null?void 0:u.displayField)||""),k=u==null?void 0:u.fields.find(T=>T.type==="image_url"),C=k?ve(d,k.name):null;return e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[C&&e.jsx("img",{src:xe(C),className:"w-12 h-12 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1 flex-shrink-0",alt:"logo"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-sm font-black text-white truncate",children:String(o||"-")}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase mt-0.5",children:["Item #",x+1]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:l,item:d}),className:"p-2.5 bg-gray-800 text-blue-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>t(u,d),className:"p-2.5 bg-gray-800 text-red-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},x)}):e.jsx("div",{className:"py-20 text-center text-gray-500 font-bold",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]})})]}),e.jsx("button",{onClick:()=>j({isOpen:!0,sectionId:l,item:null}),className:"md:hidden fixed bottom-24 right-6 w-16 h-16 bg-blue-600 text-white rounded-full shadow-2xl flex items-center justify-center active:scale-90 transition-transform z-40 border-4 border-gray-900",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})}),p.isOpen&&u&&e.jsx(Bt,{section:u,item:p.item,onClose:()=>j({...p,isOpen:!1}),onSave:()=>{j({...p,isOpen:!1}),r()}}),e.jsx(Wt,{isOpen:$,onClose:()=>y(!1),onConfirm:D,isProcessing:O}),L&&e.jsx(Et,{isOpen:L,onClose:()=>v(!1),pages:Re(i,"pages")})]}):e.jsxs("div",{className:"p-4 md:hidden animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden text-2xl font-black text-white",children:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹"}),e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest mt-1",children:"Settings & Management"})]}),e.jsx("button",{onClick:s,className:"p-2 bg-gray-800 text-gray-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:Ge.map(d=>e.jsxs("button",{onClick:()=>N(d.id),className:"flex items-center gap-4 bg-gray-800/40 border border-gray-700/50 p-4 rounded-2xl hover:bg-gray-700/40 active:scale-[0.98] transition-all text-left",children:[e.jsx("span",{className:"text-3xl bg-gray-800 p-3 rounded-xl shadow-inner border border-gray-700",children:d.icon}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-base font-black text-white leading-tight",children:d.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-1",children:d.description})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 5l7 7-7 7"})})]},d.id))})]})},Ht=({isOpen:s,onClose:a,orders:i})=>{const[r,f]=c.useState("Page"),[b,w]=c.useState("a4"),[g,n]=c.useState("landscape"),[N,p]=c.useState(!1),[j,F]=c.useState({orderId:{label:"Order ID",visible:!0,width:25},date:{label:"Date",visible:!0,width:25},customer:{label:"Customer",visible:!0,width:35},phone:{label:"Phone",visible:!0,width:25},location:{label:"Location/Address",visible:!0,width:45},items:{label:"Items",visible:!0,width:50},total:{label:"Total ($)",visible:!0,width:20},status:{label:"Status",visible:!0,width:20},note:{label:"Note",visible:!1,width:30}}),A=v=>{F($=>({...$,[v]:{...$[v],visible:!$[v].visible}}))},L=()=>{N||(p(!0),setTimeout(()=>{try{const v=new Be({orientation:g,unit:"mm",format:b}),$=v.internal.pageSize.width;v.setFontSize(18),v.setTextColor(40,40,40),v.text("Orders Report",$/2,15,{align:"center"}),v.setFontSize(10),v.setTextColor(100,100,100),v.text(`Generated on: ${new Date().toLocaleString()}`,$/2,22,{align:"center"}),v.text(`Total Orders: ${i.length}`,$/2,27,{align:"center"});const y={};r==="None"?y["All Orders"]=i:i.forEach(u=>{const m=u[r]||"Unassigned";y[m]||(y[m]=[]),y[m].push(u)});const O=[Object.entries(j).filter(([u,m])=>m.visible).map(([u,m])=>m.label)];let h=35;if(Object.entries(y).sort().forEach(([u,m])=>{h>v.internal.pageSize.height-30&&(v.addPage(),h=20),r!=="None"&&(v.setFontSize(12),v.setTextColor(30,64,175),v.setFillColor(240,240,255),v.rect(14,h,$-28,8,"F"),v.text(`${r}: ${u} (${m.length} orders)`,16,h+5.5),h+=10);const t=m.map(d=>{const x=[];if(j.orderId.visible&&x.push(d["Order ID"]),j.date.visible&&x.push(new Date(d.Timestamp).toLocaleDateString()),j.customer.visible&&x.push(d["Customer Name"]),j.phone.visible&&x.push(d["Customer Phone"]),j.location.visible&&x.push(`${d.Location||""} - ${d["Address Details"]||""}`),j.items.visible){const o=d.Products.map(k=>`${k.quantity}x ${k.name}`).join(", ");x.push(o)}return j.total.visible&&x.push(`$${d["Grand Total"].toFixed(2)}`),j.status.visible&&x.push(d["Payment Status"]),j.note.visible&&x.push(d.Note||""),x}),D=m.reduce((d,x)=>d+x["Grand Total"],0);v.autoTable({startY:h,head:O,body:t,theme:"striped",headStyles:{fillColor:[43,53,72],textColor:[255,255,255]},styles:{fontSize:8,cellPadding:2,overflow:"linebreak"},margin:{top:20}}),h=v.lastAutoTable.finalY+2,r!=="None"?(v.setFontSize(10),v.setTextColor(80,80,80),v.text(`Subtotal: $${D.toFixed(2)}`,$-15,h+5,{align:"right"}),h+=12):h+=5}),r==="None"){const u=i.reduce((m,t)=>m+t["Grand Total"],0);v.setFontSize(12),v.setTextColor(0,0,0),v.text(`GRAND TOTAL: $${u.toFixed(2)}`,$-15,h+5,{align:"right"})}const l=v.internal.pages.length-1;for(let u=1;u<=l;u++)v.setPage(u),v.setFontSize(8),v.setTextColor(150),v.text(`Page ${u} of ${l}`,$/2,v.internal.pageSize.height-10,{align:"center"});v.save(`Orders_Report_${new Date().toISOString().slice(0,10)}.pdf`),p(!1),a()}catch(v){console.error("PDF Generation Error:",v),alert("Failed to generate PDF. Check console for details."),p(!1)}},100))};return e.jsxs(he,{isOpen:s,onClose:a,maxWidth:"max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"áž‘áž¶áž‰áž™áž€áž‡áž¶ PDF (Export PDF)"]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white text-2xl",children:"Ã—"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹áž‘áž¼áž‘áŸ… (General)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"áž‘áŸ†áž áŸ† (Size)"}),e.jsxs("select",{value:b,onChange:v=>w(v.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"a4",children:"A4"}),e.jsx("option",{value:"a3",children:"A3"}),e.jsx("option",{value:"letter",children:"Letter"}),e.jsx("option",{value:"legal",children:"Legal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"áž‘áž·ážŸážŠáŸ…"}),e.jsxs("select",{value:g,onChange:v=>n(v.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"portrait",children:"áž”áž‰áŸ’ážˆážš (Portrait)"}),e.jsx("option",{value:"landscape",children:"áž”áŸ’ážŠáŸáž€ (Landscape)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Group By"}),e.jsxs("select",{value:r,onChange:v=>f(v.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"Page",children:"Page"}),e.jsx("option",{value:"Team",children:"Team"}),e.jsx("option",{value:"None",children:"None"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Columns"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Object.keys(j).map(v=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:j[v].visible,onChange:()=>A(v),className:"h-5 w-5 text-blue-600 rounded border-gray-500 bg-gray-900"}),e.jsx("span",{className:"text-sm text-gray-200",children:j[v].label})]},v))})]}),e.jsxs("div",{className:"flex justify-end pt-4 space-x-3 border-t border-gray-700",children:[e.jsx("button",{onClick:a,className:"btn btn-secondary",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:L,className:"btn btn-primary flex items-center shadow-lg",disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(te,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"áž€áŸ†áž–áž»áž„ážŠáŸ†ážŽáž¾ážšáž€áž¶ážš..."})]}):e.jsx(e.Fragment,{children:"áž‘áž¶áž‰áž™áž€ PDF"})})]})]})]})},Gt=({selectedCount:s,isSidebarCollapsed:a,isProcessing:i,onVerify:r,onUnverify:f,onOpenModal:b,onClearSelection:w})=>{const g=a?"64px":"208px";return e.jsx("div",{className:"hidden md:flex fixed bottom-10 left-0 w-full z-[90] justify-center pointer-events-none transition-all duration-500",style:{paddingLeft:g},children:e.jsxs("div",{className:"relative bg-[#0f172a]/95 backdrop-blur-3xl border border-white/10 rounded-[3rem] shadow-[0_30px_70px_rgba(0,0,0,0.8)] p-3 flex items-center gap-6 overflow-hidden ring-1 ring-white/10 pointer-events-auto animate-fade-in-up",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3/4 h-full bg-blue-500/5 blur-[80px] pointer-events-none"}),e.jsxs("div",{className:"flex items-center gap-3.5 pl-5 relative z-10",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-black text-lg shadow-[0_0_25px_rgba(37,99,235,0.4)] animate-pulse-subtle border-2 border-white/10",children:s}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[13px] font-black text-white leading-none tracking-tight",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸ"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"ACTIVE NODE"})]})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsxs("div",{className:"flex items-center bg-[#242f41] p-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsxs("button",{onClick:r,className:"px-6 py-2.5 bg-[#10b981] hover:bg-[#059669] text-white rounded-[1.4rem] text-[11px] font-black uppercase tracking-wider transition-all flex items-center gap-2 shadow-lg active:scale-95 disabled:opacity-50",disabled:i,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:4,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"VERIFY"]}),e.jsx("button",{onClick:f,className:"px-5 py-2.5 text-gray-400 hover:text-white text-[11px] font-black uppercase tracking-wider transition-all active:scale-95 disabled:opacity-50",disabled:i,children:"UNVERIFY"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-6 py-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsx("button",{onClick:()=>b("date"),className:"px-3.5 py-3 hover:text-white text-cyan-400 text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"DATE"}),e.jsx("button",{onClick:()=>b("cost"),className:"px-3.5 py-3 hover:text-white text-[#f6ad55] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"COST"}),e.jsx("button",{onClick:()=>b("payment"),className:"px-3.5 py-3 hover:text-white text-[#4299e1] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"PAY"}),e.jsx("button",{onClick:()=>b("shipping"),className:"px-3.5 py-3 hover:text-white text-[#9f7aea] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"SHIP"})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsx("div",{className:"pr-5 relative z-10",children:e.jsx("button",{onClick:()=>b("delete"),className:"px-6 py-3.5 bg-red-600/10 hover:bg-red-600 text-red-500 hover:text-white border border-red-500/20 rounded-[1.6rem] text-[12px] font-black transition-all active:scale-95 shadow-lg hover:shadow-red-900/20",children:"áž›áž»áž”áž…áŸ„áž›"})}),e.jsx("button",{onClick:w,className:"absolute -top-12 left-1/2 -translate-x-1/2 px-4 py-1.5 bg-gray-800/80 backdrop-blur-md border border-white/10 rounded-full text-[9px] font-black text-gray-400 uppercase tracking-widest hover:text-white transition-all shadow-xl",children:"Clear Selection"})]})})},Yt=({selectedCount:s,isProcessing:a,onVerify:i,onUnverify:r,onOpenModal:f,onClearSelection:b})=>e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 w-full z-[100] animate-slide-up",children:[e.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-xl border-t border-white/10 p-3 flex justify-between items-center shadow-2xl relative z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-black text-white text-sm shadow-lg shadow-blue-600/30",children:s}),e.jsx("span",{className:"text-xs font-bold text-gray-300",children:"items selected"})]}),e.jsx("button",{onClick:b,className:"text-[10px] font-black text-gray-500 uppercase tracking-widest bg-gray-800 px-3 py-1.5 rounded-lg border border-gray-700 active:scale-95",children:"Clear"})]}),e.jsx("div",{className:"bg-[#0f172a] p-3 pb-safe-bottom overflow-x-auto custom-scrollbar border-t border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-max",children:[e.jsxs("div",{className:"flex items-center bg-gray-800/50 p-1 rounded-xl border border-white/5",children:[e.jsxs("button",{onClick:i,disabled:a,className:"px-4 py-3 bg-emerald-600 text-white rounded-lg font-black text-[10px] uppercase tracking-wider flex items-center gap-1.5 active:scale-95 disabled:opacity-50",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"Verify"]}),e.jsx("button",{onClick:r,disabled:a,className:"px-4 py-3 text-gray-400 font-bold text-[10px] uppercase tracking-wider active:scale-95 disabled:opacity-50",children:"Unverify"})]}),e.jsxs("button",{onClick:()=>f("date"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ“…"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Date"})]}),e.jsxs("button",{onClick:()=>f("cost"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’°"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Cost"})]}),e.jsxs("button",{onClick:()=>f("payment"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’³"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Pay"})]}),e.jsxs("button",{onClick:()=>f("shipping"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸšš"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Ship"})]}),e.jsx("button",{onClick:()=>f("delete"),className:"px-4 py-3 bg-red-600/10 border border-red-500/20 text-red-500 rounded-xl font-black text-[10px] uppercase tracking-widest active:bg-red-600 active:text-white transition-colors",children:"Delete"})]})}),e.jsx("style",{children:`
                @keyframes slide-up {
                    from { transform: translateY(100%); }
                    to { transform: translateY(0); }
                }
                .animate-slide-up { animation: slide-up 0.3s ease-out forwards; }
                .pb-safe-bottom { padding-bottom: max(12px, env(safe-area-inset-bottom)); }
            `})]}),Kt=({orders:s,selectedIds:a,onComplete:i,onClearSelection:r})=>{var V,E;const{appData:f,currentUser:b,refreshData:w,isSidebarCollapsed:g}=c.useContext(re),[n,N]=c.useState(!1),[p,j]=c.useState(null),[F,A]=c.useState(""),[L,v]=c.useState(""),[$,y]=c.useState("Paid"),[O,h]=c.useState(""),[l,u]=c.useState(""),[m,t]=c.useState(""),[D,d]=c.useState(""),[x,o]=c.useState(""),k=async(I,G)=>{if(a.size!==0&&!(G&&!window.confirm(G))){N(!0);try{const q=Array.from(a);for(const oe of q){const le=s.find(ue=>ue["Order ID"]===oe);if(!le)continue;const K={...le,...I},me={Timestamp:K.Timestamp,"Order ID":K["Order ID"],User:K.User,Page:K.Page,TelegramValue:K.TelegramValue,"Customer Name":K["Customer Name"],"Customer Phone":K["Customer Phone"],Location:K.Location,"Address Details":K["Address Details"],Note:K.Note||"","Shipping Fee (Customer)":K["Shipping Fee (Customer)"],Subtotal:K.Subtotal,"Grand Total":K["Grand Total"],"Internal Shipping Method":K["Internal Shipping Method"],"Internal Shipping Details":K["Internal Shipping Details"],"Internal Cost":Number(K["Internal Cost"])||0,"Payment Status":K["Payment Status"],"Payment Info":K["Payment Info"]||"","Discount ($)":K["Discount ($)"],"Total Product Cost ($)":K["Total Product Cost ($)"],"Fulfillment Store":K["Fulfillment Store"],Team:K.Team,"Scheduled Time":K["Scheduled Time"]||"",IsVerified:K.IsVerified};me["Products (JSON)"]=JSON.stringify(K.Products),await fetch(`${ae}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:oe,team:K.Team,userName:b==null?void 0:b.UserName,newData:me})})}await w(),j(null),i()}catch(q){console.error("Bulk update failed:",q),alert("áž€áž¶ážšáž€áŸ‚ážŸáž˜áŸ’ážšáž½áž›áž”ážšáž¶áž‡áŸáž™!")}finally{N(!1)}}},C=async()=>{if(!(a.size===0||!L)){N(!0);try{const I=Array.from(a),[G,q,oe]=L.split("-").map(Number);for(const le of I){const K=s.find(pe=>pe["Order ID"]===le);if(!K)continue;const me=new Date(K.Timestamp),ue=new Date(G,q-1,oe,me.getHours(),me.getMinutes(),me.getSeconds()),J={...K,Timestamp:ue.toISOString()},fe={Timestamp:J.Timestamp,"Order ID":J["Order ID"],User:J.User,Page:J.Page,TelegramValue:J.TelegramValue,"Customer Name":J["Customer Name"],"Customer Phone":J["Customer Phone"],Location:J.Location,"Address Details":J["Address Details"],Note:J.Note||"","Shipping Fee (Customer)":J["Shipping Fee (Customer)"],Subtotal:J.Subtotal,"Grand Total":J["Grand Total"],"Internal Shipping Method":J["Internal Shipping Method"],"Internal Shipping Details":J["Internal Shipping Details"],"Internal Cost":Number(J["Internal Cost"])||0,"Payment Status":J["Payment Status"],"Payment Info":J["Payment Info"]||"","Discount ($)":J["Discount ($)"],"Total Product Cost ($)":J["Total Product Cost ($)"],"Fulfillment Store":J["Fulfillment Store"],Team:J.Team,"Scheduled Time":J["Scheduled Time"]||"",IsVerified:J.IsVerified};fe["Products (JSON)"]=JSON.stringify(J.Products),await fetch(`${ae}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:le,team:J.Team,userName:b==null?void 0:b.UserName,newData:fe})})}await w(),j(null),v(""),i()}catch(I){console.error("Bulk date update failed:",I),alert("áž€áž¶ážšáž€áŸ‚áž”áŸ’ážšáŸ‚áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘áž”ážšáž¶áž‡áŸáž™!")}finally{N(!1)}}},T=async()=>{if(a.size!==0){if(x!==(b==null?void 0:b.Password)){alert("áž›áŸážážŸáž˜áŸ’áž„áž¶ážáŸ‹áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœ!");return}N(!0);try{const I=Array.from(a);for(const G of I){const q=s.find(oe=>oe["Order ID"]===G);await fetch(`${ae}/api/admin/delete-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:G,team:q==null?void 0:q.Team,userName:b==null?void 0:b.UserName,telegramMessageId1:q==null?void 0:q["Telegram Message ID 1"],telegramMessageId2:q==null?void 0:q["Telegram Message ID 2"],telegramChatId:q==null?void 0:q.TelegramValue})})}await w(),j(null),o(""),i()}catch{alert("áž€áž¶ážšáž›áž»áž”áž”ážšáž¶áž‡áŸáž™!")}finally{N(!1)}}},M=(V=f.shippingMethods)==null?void 0:V.find(I=>I.MethodName===l),U=M==null?void 0:M.RequireDriverSelection;return a.size===0?null:e.jsxs(e.Fragment,{children:[!p&&e.jsxs(e.Fragment,{children:[e.jsx(Gt,{selectedCount:a.size,isSidebarCollapsed:g,isProcessing:n,onVerify:()=>k({IsVerified:!0},`áž”áž‰áŸ’áž‡áž¶áž€áŸ‹áž›áž¾áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ${a.size} áž“áŸáŸ‡?`),onUnverify:()=>k({IsVerified:!1}),onOpenModal:j,onClearSelection:r}),e.jsx(Yt,{selectedCount:a.size,isProcessing:n,onVerify:()=>k({IsVerified:!0},`áž”áž‰áŸ’áž‡áž¶áž€áŸ‹áž›áž¾áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ${a.size} áž“áŸáŸ‡?`),onUnverify:()=>k({IsVerified:!1}),onOpenModal:j,onClearSelection:r})]}),e.jsx(he,{isOpen:p==="date",onClose:()=>j(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-cyan-500/20 text-cyan-400 rounded-full flex items-center justify-center mx-auto mb-6 border border-cyan-500/30",children:e.jsx("span",{className:"text-3xl",children:"ðŸ“…"})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-2 uppercase tracking-tight",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold text-center mb-6 uppercase tracking-widest",children:"áž˜áŸ‰áŸ„áž„áž“áž¹áž„ážšáž€áŸ’ážŸáž¶áž‘áž»áž€ážŠáž¼áž…ážŠáž¾áž˜ (Time Unchanged)"}),e.jsx("div",{className:"relative mb-8",children:e.jsx("input",{type:"date",value:L,onChange:I=>v(I.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 text-white font-bold text-center rounded-[2rem] focus:ring-4 focus:ring-cyan-500/10 transition-all w-full"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:C,className:"py-4 bg-cyan-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-cyan-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:n||!L,children:n?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(he,{isOpen:p==="cost",onClose:()=>j(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("h3",{className:"text-xl font-black text-white text-center mb-8 uppercase tracking-tight",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážáŸ’áž›áŸƒážŠáž¹áž€ážŠáž¾áž˜ (Cost)"}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("input",{type:"number",step:"0.01",value:F,onChange:I=>A(I.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-6 text-blue-400 font-black text-4xl text-center rounded-[2rem] focus:ring-4 focus:ring-blue-500/10 transition-all",placeholder:"0.00",autoFocus:!0}),e.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 text-gray-600 font-black text-2xl",children:"$"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>k({"Internal Cost":Number(F)}),className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-blue-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:n||!F,children:n?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(he,{isOpen:p==="payment",onClose:()=>j(null),maxWidth:"max-w-lg",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 overflow-hidden flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600/20 rounded-xl flex items-center justify-center border border-blue-500/30",children:e.jsx("span",{className:"text-xl",children:"ðŸ’³"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážŸáŸ’ážáž¶áž“áž—áž¶áž–áž‘áž¼áž‘áž¶ážáŸ‹"})]}),e.jsxs("div",{className:"flex p-1.5 bg-black/40 rounded-2xl border border-gray-700 mb-6",children:[e.jsxs("button",{onClick:()=>{y("Paid")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${$==="Paid"?"bg-emerald-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"PAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(áž‘áž¼áž‘áž¶ážáŸ‹ážšáž½áž…ážšáž¶áž›áŸ‹)"})]}),e.jsxs("button",{onClick:()=>{y("Unpaid"),h("")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${$==="Unpaid"?"bg-red-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"UNPAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(áž˜áž·áž“áž‘áž¶áž“áŸ‹áž‘áž¼áž‘áž¶ážáŸ‹ - COD)"})]})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-1",children:$==="Paid"?e.jsxs("div",{className:"space-y-4 animate-fade-in-down pb-4",children:[e.jsxs("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:(E=f.bankAccounts)==null?void 0:E.map(I=>{const G=O===I.BankName;return e.jsxs("button",{onClick:()=>h(I.BankName),className:`flex items-center gap-4 p-4 rounded-2xl border transition-all duration-200 group ${G?"bg-blue-600/20 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.2)]":"bg-gray-800/40 border-white/5 hover:bg-gray-800 hover:border-white/20"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${G?"bg-black/40":"bg-black/20"}`,children:e.jsx("img",{src:xe(I.LogoURL),className:"w-7 h-7 object-contain",alt:""})}),e.jsx("span",{className:`text-xs font-black w-full text-left whitespace-normal leading-tight ${G?"text-white":"text-gray-400 group-hover:text-gray-200"}`,children:I.BankName}),G&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 shadow-[0_0_8px_#3b82f6]"})]},I.BankName)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center opacity-50 space-y-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-900/20 flex items-center justify-center border border-red-500/20",children:e.jsx("span",{className:"text-3xl grayscale",children:"ðŸ“¦"})}),e.jsx("p",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"áž€áž¶ážšáž‘áž¼áž‘áž¶ážáŸ‹áž“áž¹áž„ážáŸ’ážšáž¼ážœáž’áŸ’ážœáž¾áž¡áž¾áž„áž–áŸáž›ážŠáž¹áž€ážŠáž›áŸ‹"})]})}),e.jsxs("div",{className:"flex-shrink-0 grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/10",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors bg-gray-800/50 rounded-2xl hover:bg-gray-800",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>k({"Payment Status":$,"Payment Info":$==="Paid"?O:""}),className:"py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2",disabled:n||$==="Paid"&&!O,children:n?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€áž€áž¶ážšáž•áŸ’áž›áž¶ážŸáŸ‹áž”áŸ’ážáž¼ážš"})]})]})}),e.jsx(he,{isOpen:p==="shipping",onClose:()=>j(null),maxWidth:"max-w-xl",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 max-h-[85vh] flex flex-col",children:[e.jsx("h3",{className:"text-lg font-black text-white text-center mb-6 uppercase tracking-tight flex-shrink-0",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“"}),e.jsxs("div",{className:"space-y-6 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸážŸáŸážœáž¶ážŠáž¹áž€"}),e.jsx(ut,{methods:f.shippingMethods||[],selectedMethodName:l,onSelect:I=>{u(I.MethodName),t("")}})]}),U&&e.jsxs("div",{className:"space-y-3 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("div",{className:"h-4 w-1 bg-blue-500 rounded-full"}),e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž¢áŸ’áž“áž€ážŠáž¹áž€ (DriverSelection)*"})]}),e.jsx(pt,{drivers:f.drivers||[],selectedDriverName:m,onSelect:t}),!m&&e.jsx("p",{className:"text-center text-[9px] text-gray-500 italic",children:"ážŸáž¼áž˜áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž¢áŸ’áž“áž€ážŠáž¹áž€áž˜áŸ’áž“áž¶áž€áŸ‹"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážáŸ’áž›áŸƒážŠáž¹áž€ážŠáž¾áž˜ (Internal Cost)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",value:D,onChange:I=>d(I.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 pl-4 pr-10 rounded-2xl font-black text-white focus:border-blue-500",placeholder:"áž”áž‰áŸ’áž…áž¼áž›ážáŸ’áž›áŸƒážŠáž¹áž€ážáŸ’áž˜áž¸ (áž”áž¾áž˜áž¶áž“)"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"})]}),e.jsx("div",{className:"flex gap-2",children:[0,1.25,1.5,2].map(I=>e.jsxs("button",{onClick:()=>d(String(I)),className:"flex-1 py-2 bg-gray-800 border border-gray-700 rounded-xl text-[10px] font-bold text-gray-400 hover:text-white hover:bg-gray-700 transition-all",children:["$",I]},I))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6 pt-4 border-t border-white/5 flex-shrink-0",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>{const I={"Internal Shipping Method":l};U?I["Internal Shipping Details"]=m:I["Internal Shipping Details"]=l,D&&(I["Internal Cost"]=Number(D)),k(I)},className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:n||!l||U&&!m,children:n?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(he,{isOpen:p==="delete",onClose:()=>j(null),maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-4 uppercase tracking-tight",children:"áž›áž»áž”áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸážŸážšáž»áž”"}),e.jsxs("p",{className:"text-center text-gray-500 text-sm mb-8",children:["ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸážáž¶áž…áž„áŸ‹áž›áž»áž”áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ",e.jsx("strong",{children:a.size})," áž“áŸáŸ‡? ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž“áŸáŸ‡áž˜áž·áž“áž¢áž¶áž…ážáŸ’ážšáž¡áž”áŸ‹áž€áŸ’ážšáŸ„áž™áž”áž¶áž“áž‘áŸáŸ”"]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-600 uppercase tracking-widest ml-1",children:"áž”áž‰áŸ’áž…áž¼áž›áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹ážŠáž¾áž˜áŸ’áž”áž¸áž”áž‰áŸ’áž‡áž¶áž€áŸ‹"}),e.jsx("input",{type:"password",value:x,onChange:I=>o(I.target.value),className:"form-input !bg-red-500/5 !border-red-500/20 !py-4 text-center text-white font-black tracking-widest",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>j(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:T,className:"py-4 bg-red-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-red-900/40 active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:n||!x,children:n?e.jsxs(e.Fragment,{children:[e.jsx(te,{size:"sm"}),e.jsx("span",{children:"áž€áŸ†áž–áž»áž„áž›áž»áž”..."})]}):"áž”áž¶áž‘, áž›áž»áž”áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹"})]})]})}),e.jsx("style",{children:`
                @keyframes pulse-subtle {
                    0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(37,99,235,0.2); }
                    50% { transform: scale(1.05); box-shadow: 0 0 35px rgba(37,99,235,0.4); }
                }
                .animate-pulse-subtle {
                    animation: pulse-subtle 2s infinite ease-in-out;
                }
            `})]})},Ke=[{key:"index",label:"áž›áŸážážšáŸ€áž„"},{key:"actions",label:"áž”áŸŠáž¼ážáž»áž„"},{key:"customerName",label:"áž¢ážáž·ážáž·áž‡áž“"},{key:"productInfo",label:"áž‘áŸ†áž“áž·áž‰"},{key:"location",label:"áž‘áž¸ážáž¶áŸ†áž„"},{key:"pageInfo",label:"Page"},{key:"fulfillment",label:"ážƒáŸ’áž›áž¶áŸ†áž„"},{key:"total",label:"ážáž˜áŸ’áž›áŸƒážŸážšáž»áž”"},{key:"shippingService",label:"ážŸáŸážœáž¶ážŠáž¹áž€"},{key:"shippingCost",label:"ážáŸ’áž›áŸƒážŠáž¹áž€"},{key:"status",label:"ážŸáŸ’ážáž¶áž“áž—áž¶áž–áž”áž„áŸ‹áž”áŸ’ážšáž¶áž€áŸ‹"},{key:"date",label:"áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘"},{key:"note",label:"áž…áŸ†ážŽáž¶áŸ† (Note)"},{key:"print",label:"Print"},{key:"check",label:"áž•áŸ’áž‘áŸ€áž„áž•áŸ’áž‘áž¶ážáŸ‹"},{key:"orderId",label:"ID"}],Jt=({visibleColumns:s,onToggle:a,columns:i=Ke})=>{const[r,f]=c.useState(!1),b=c.useRef(null);return c.useEffect(()=>{const w=g=>{b.current&&!b.current.contains(g.target)&&f(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),e.jsxs("div",{className:"relative inline-block text-left h-full",ref:b,children:[e.jsxs("button",{onClick:()=>f(!r),className:"flex h-full items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M5 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM9 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM13 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM17 4a1 1 0 00-2 0v12a1 1 0 002 0V4z"})}),"Columns",e.jsx("svg",{className:`h-3.5 w-3.5 ml-1 transition-transform duration-500 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 9l-7 7-7-7",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})]}),r&&e.jsx("div",{className:"absolute right-0 mt-3 w-64 bg-[#1a2235]/95 border border-white/10 rounded-[1.8rem] shadow-[0_30px_70px_rgba(0,0,0,0.7)] z-[100] origin-top-right overflow-hidden backdrop-blur-3xl p-3 animate-fade-in-scale",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-[0.2em] px-3 py-2 mb-1",children:"áž€áŸ†ážŽážáŸ‹áž€áž¶ážšáž”áž„áŸ’áž áž¶áž‰"}),i.map(w=>e.jsxs("label",{className:"flex items-center px-3 py-2 text-xs text-gray-300 hover:bg-white/5 rounded-xl cursor-pointer transition-colors group",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded-md border-gray-600 bg-gray-900 text-blue-500 focus:ring-blue-500/20",checked:s.has(w.key),onChange:()=>a(w.key)}),e.jsx("span",{className:"ml-3 font-bold group-hover:text-white transition-colors",children:w.label})]},w.key))]})})]})},qt=({isOpen:s,onClose:a,children:i})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`filter-panel-overlay fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] transition-opacity duration-500 ${s?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),e.jsxs("div",{className:`filter-panel fixed right-0 top-0 h-full w-[85%] max-w-md bg-[#0f172a] z-[80] shadow-2xl border-l border-white/5 transition-transform duration-500 flex flex-col ${s?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-black/20",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter italic",children:"Filter Engine"}),e.jsx("button",{onClick:a,className:"p-2 bg-white/5 rounded-xl text-gray-400 hover:text-white transition-all",children:"Ã—"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow custom-scrollbar space-y-8",children:i}),e.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20",children:e.jsx("button",{onClick:a,className:"btn btn-primary w-full py-4 text-sm font-black uppercase tracking-[0.2em] shadow-xl shadow-blue-900/20 rounded-2xl active:scale-95 transition-transform",children:"Apply Configuration"})})]})]}),Xt=({onBack:s,initialFilters:a})=>{const{appData:i,refreshData:r,refreshTimestamp:f,currentUser:b,setMobilePageTitle:w}=c.useContext(re),[g,n]=H("editOrder","");c.useEffect(()=>(w("áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸ"),()=>w(null)),[w]);const[N,p]=H("teamFilter",""),[j,F]=H("dateFilter","this_month"),[A,L]=H("locationFilter",""),[v,$]=H("storeFilter",""),[y,O]=H("startDate",""),[h,l]=H("endDate",""),[u,m]=H("shippingFilter",""),[t,D]=H("driverFilter",""),[d,x]=H("brandFilter",""),[o,k]=H("paymentFilter",""),[C,T]=H("userFilter",""),[M,U]=H("pageFilter",""),[V,E]=H("costFilter",""),[I,G]=H("bankFilter",""),[q,oe]=H("productFilter",""),[le,K]=H("customerFilter",""),[me,ue]=c.useState(()=>{const P=Ke||[];return new Set(P.filter(R=>R.key!=="productInfo"&&R.key!=="print"&&R.key!=="check"&&R.key!=="fulfillment"&&R.key!=="note").map(R=>R.key))}),[J,fe]=c.useState([]),[pe,Me]=c.useState([]),[We,Se]=c.useState(!0),[$e,Ce]=c.useState(0),[Oe,je]=c.useState(null),[Ae,ge]=c.useState(!1),[De,Ie]=c.useState(!1),[ie,Ve]=c.useState(""),[Pe,ye]=c.useState(new Set),[_,Fe]=c.useState(()=>{const P=new URLSearchParams(window.location.search);return{datePreset:(a==null?void 0:a.datePreset)||P.get("dateFilter")||"this_month",startDate:(a==null?void 0:a.startDate)||P.get("startDate")||"",endDate:(a==null?void 0:a.endDate)||P.get("endDate")||"",team:(a==null?void 0:a.team)||P.get("teamFilter")||"",location:(a==null?void 0:a.location)||P.get("locationFilter")||"",fulfillmentStore:(a==null?void 0:a.fulfillmentStore)||P.get("storeFilter")||"",store:(a==null?void 0:a.store)||P.get("brandFilter")||"",shippingService:(a==null?void 0:a.shippingService)||P.get("shippingFilter")||"",driver:(a==null?void 0:a.driver)||P.get("driverFilter")||"",paymentStatus:(a==null?void 0:a.paymentStatus)||P.get("paymentFilter")||"",user:(a==null?void 0:a.user)||P.get("userFilter")||"",page:(a==null?void 0:a.page)||P.get("pageFilter")||"",internalCost:(a==null?void 0:a.internalCost)||P.get("costFilter")||"",bank:(a==null?void 0:a.bank)||P.get("bankFilter")||"",product:(a==null?void 0:a.product)||P.get("productFilter")||"",customerName:(a==null?void 0:a.customerName)||P.get("customerFilter")||""}});c.useEffect(()=>{_.team!==N&&p(_.team),_.datePreset!==j&&F(_.datePreset),_.location!==A&&L(_.location),_.fulfillmentStore!==v&&$(_.fulfillmentStore),_.startDate!==y&&O(_.startDate),_.endDate!==h&&l(_.endDate),_.shippingService!==u&&m(_.shippingService),_.driver!==t&&D(_.driver),_.store!==d&&x(_.store),_.paymentStatus!==o&&k(_.paymentStatus),_.user!==C&&T(_.user),_.page!==M&&U(_.page),_.internalCost!==V&&E(_.internalCost),_.bank!==I&&G(_.bank),_.product!==q&&oe(_.product),_.customerName!==le&&K(_.customerName)},[_,N,j,A,v,y,h,u,t,d,o,C,M,V,I,q,le]);const ze=c.useMemo(()=>{const P=new Date,R=new Date(P.getFullYear(),P.getMonth(),P.getDate());let z=null,W=new Date;switch(_.datePreset){case"today":z=R;break;case"yesterday":z=new Date(R),z.setDate(R.getDate()-1),W=new Date(R),W.setMilliseconds(-1);break;case"this_week":const X=P.getDay();z=new Date(R),z.setDate(R.getDate()-(X===0?6:X-1));break;case"last_week":z=new Date(R),z.setDate(R.getDate()-P.getDay()-6),W=new Date(z),W.setDate(z.getDate()+6),W.setHours(23,59,59);break;case"this_month":z=new Date(P.getFullYear(),P.getMonth(),1);break;case"last_month":z=new Date(P.getFullYear(),P.getMonth()-1,1),W=new Date(P.getFullYear(),P.getMonth(),0,23,59,59);break;case"this_year":z=new Date(P.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${_.startDate||"..."} to ${_.endDate||"..."}`}const ee=X=>{const Q=X.getFullYear(),Z=String(X.getMonth()+1).padStart(2,"0"),ce=String(X.getDate()).padStart(2,"0");return`${Q}-${Z}-${ce}`};return z?`${ee(z)} to ${ee(W)}`:"All time data stream"},[_.datePreset,_.startDate,_.endDate]),_e=P=>{ue(R=>{const z=new Set(R);return z.has(P)?z.size>1&&z.delete(P):z.add(P),z})},we=async P=>{let z=[];for(let W=0;W<P.length;W+=500){const X=P.slice(W,W+500).map(Q=>{let Z=[];try{Q["Products (JSON)"]&&(Z=JSON.parse(Q["Products (JSON)"]))}catch{}return{...Q,Products:Z,IsVerified:String(Q.IsVerified).toUpperCase()==="TRUE"}});z=[...z,...X],Ce(Math.round((W+500)/P.length*100)),await new Promise(Q=>setTimeout(Q,0))}return z},Ue=P=>{const R=P.Timestamp;if(!R)return 0;const z=R.match(/^(\d{4})-(\d{1,2})-(\d{1,2})\s(\d{1,2}):(\d{2})/);return z?new Date(parseInt(z[1]),parseInt(z[2])-1,parseInt(z[3]),parseInt(z[4]),parseInt(z[5])).getTime():new Date(R).getTime()},be=async()=>{Se(!0),Ce(0),je(null);try{const[P,R]=await Promise.all([fetch(`${ae}/api/admin/all-orders`),fetch(`${ae}/api/users`)]),z=await P.json(),W=await R.json();if(z.status==="success"){const ee=(z.data||[]).filter(Q=>Q!==null&&Q["Order ID"]!=="Opening Balance"&&Q["Order ID"]!=="Opening_Balance"),X=await we(ee);fe(X.sort((Q,Z)=>Ue(Z)-Ue(Q)))}else je(z.message||"Failed to load orders");W.status==="success"&&Me(W.data||[])}catch(P){console.error("Fetch Error:",P),je("áž˜áž·áž“áž¢áž¶áž…áž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™áž”áž¶áž“áž‘áŸáŸ” ážŸáž¼áž˜áž–áž·áž“áž·ážáŸ’áž™ Internet ážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€áŸ”")}finally{Se(!1)}};c.useEffect(()=>{be()},[f]);const S=c.useMemo(()=>J.map(P=>{var z;let R=(P.Team||"").trim();if(!R){const W=pe.find(ee=>ee.UserName===P.User);if(W!=null&&W.Team)R=W.Team.split(",")[0].trim();else{const ee=(z=i.pages)==null?void 0:z.find(X=>X.PageName===P.Page);ee!=null&&ee.Team&&(R=ee.Team)}}return{...P,Team:R||"Unassigned"}}),[J,pe,i.pages]),Y=c.useMemo(()=>S.filter(P=>{var z;if(_.datePreset!=="all"){const W=Ue(P),ee=new Date(W),X=new Date,Q=new Date(X.getFullYear(),X.getMonth(),X.getDate());let Z=null,ce=null;switch(_.datePreset){case"today":Z=Q;break;case"yesterday":Z=new Date(Q),Z.setDate(Q.getDate()-1),ce=new Date(Q),ce.setMilliseconds(-1);break;case"this_week":const Je=X.getDay();Z=new Date(Q),Z.setDate(Q.getDate()-(Je===0?6:Je-1));break;case"last_week":Z=new Date(Q),Z.setDate(Q.getDate()-X.getDay()-6),ce=new Date(Z),ce.setDate(Z.getDate()+6),ce.setHours(23,59,59);break;case"this_month":Z=new Date(X.getFullYear(),X.getMonth(),1);break;case"last_month":Z=new Date(X.getFullYear(),X.getMonth()-1,1),ce=new Date(X.getFullYear(),X.getMonth(),0,23,59,59);break;case"this_year":Z=new Date(X.getFullYear(),0,1);break;case"custom":_.startDate&&(Z=new Date(_.startDate+"T00:00:00")),_.endDate&&(ce=new Date(_.endDate+"T23:59:59"));break}if(Z&&ee<Z||ce&&ee>ce)return!1}const R=(W,ee)=>{if(!W)return!0;const X=W.split(",").map(Z=>Z.trim().toLowerCase()),Q=(ee||"").trim().toLowerCase();return X.includes(Q)};if(!R(_.fulfillmentStore,P["Fulfillment Store"]||"Unassigned"))return!1;if(_.store){const W=(z=i.pages)==null?void 0:z.find(Q=>Q.PageName===P.Page),ee=W?W.DefaultStore:null,X=_.store.split(",");if(!ee||!X.includes(ee))return!1}if(!R(_.team,P.Team)||!R(_.user,P.User||"")||!R(_.paymentStatus,P["Payment Status"])||!R(_.shippingService,P["Internal Shipping Method"])||!R(_.driver,P["Internal Shipping Details"])||!R(_.bank,P["Payment Info"])||!R(_.page,P.Page)||!R(_.location,P.Location)||!R(_.internalCost,String(P["Internal Cost"]))||!R(_.customerName,P["Customer Name"])||_.product&&!P.Products.some(W=>W.name===_.product))return!1;if(ie.trim()){const W=ie.toLowerCase();return P["Order ID"].toLowerCase().includes(W)||(P["Customer Name"]||"").toLowerCase().includes(W)||(P["Customer Phone"]||"").includes(W)}return!0}),[S,_,ie,i.pages]),B=P=>{ye(R=>{const z=new Set(R);return z.has(P)?z.delete(P):z.add(P),z})},ne=P=>{const R=P.length>0&&P.every(z=>Pe.has(z));ye(R?z=>{const W=new Set(z);return P.forEach(ee=>W.delete(ee)),W}:z=>new Set([...z,...P]))};if(We)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-5",children:[e.jsx(te,{size:"lg"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-500 uppercase tracking-[0.4em] animate-pulse",children:"Syncing Operational Logs..."}),$e>0&&e.jsx("div",{className:"w-48 h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${$e}%`}})})]})]});if(Oe)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-6 p-6 text-center bg-gray-900/50 rounded-[3rem] border border-red-500/20 m-6 animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-2xl flex items-center justify-center border border-red-500/30 shadow-xl",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight",children:"áž€áŸ†áž áž»ážŸáž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™"}),e.jsx("p",{className:"text-gray-500 font-bold max-w-md",children:Oe})]}),e.jsx("button",{onClick:be,className:"btn btn-primary px-10 py-4 shadow-lg shadow-blue-600/20",children:"áž–áŸ’áž™áž¶áž™áž¶áž˜áž˜áŸ’ážŠáž„áž‘áŸ€áž"})]});if(g){const P=S.find(R=>R["Order ID"]===g);return P?e.jsx(gt,{order:P,onSaveSuccess:()=>{n(""),be(),r()},onCancel:()=>n("")}):e.jsx("div",{className:"p-20 text-center text-gray-500 font-black uppercase italic tracking-widest",children:"ážšáž€áž˜áž·áž“ážƒáž¾áž‰ Order ID áž“áŸáŸ‡áž‘áŸ"})}return e.jsxs("div",{className:"w-full max-w-full mx-auto px-3 sm:px-6 lg:px-8 animate-fade-in relative pb-40 pt-6 overflow-x-hidden",children:[e.jsx("div",{className:"md:hidden",children:e.jsx(qt,{isOpen:Ae,onClose:()=>ge(!1),children:e.jsx(Ye,{filters:_,setFilters:Fe,orders:S,usersList:pe,appData:i,calculatedRange:ze})})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(he,{isOpen:Ae,onClose:()=>ge(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>ge(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"Ã—"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(Ye,{filters:_,setFilters:Fe,orders:S,usersList:pe,appData:i,calculatedRange:ze})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>ge(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end mb-10 gap-6 px-1",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden md:block text-3xl lg:text-5xl font-black text-white italic tracking-tighter leading-relaxed mb-3 py-1",children:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸ"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600/10 rounded-full border border-blue-500/20",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("span",{className:"text-[11px] font-black text-blue-400 uppercase tracking-widest",children:[Y.length," Entries Logged"]})]})})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:s,className:"hidden md:flex group items-center gap-3 px-8 py-4 bg-gray-800/40 backdrop-blur-xl border border-white/5 hover:border-blue-500/30 text-gray-500 hover:text-blue-400 font-black uppercase tracking-widest text-[12px] rounded-2xl transition-all shadow-xl active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Core"]})})]}),e.jsx("div",{className:"bg-gray-800/20 backdrop-blur-3xl border border-white/5 rounded-[2.5rem] p-5 sm:p-6 mb-8 shadow-2xl relative z-20 group transition-all hover:bg-gray-800/30",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"relative w-full lg:max-w-2xl group",children:[e.jsx("input",{type:"text",placeholder:"ážŸáŸ’ážœáŸ‚áž„ážšáž€ ID, ážˆáŸ’áž˜áŸ„áŸ‡, áž¬áž›áŸážáž‘áž¼ážšážŸáŸáž–áŸ’áž‘...",value:ie,onChange:P=>Ve(P.target.value),className:"form-input !pl-16 !py-5 bg-black/40 border-gray-800 rounded-[1.8rem] text-[15px] font-bold text-white placeholder:text-gray-700 focus:border-blue-500/50 focus:bg-black/60 transition-all shadow-inner"}),e.jsxs("div",{className:"absolute left-6 top-1/2 -translate-y-1/2 flex items-center gap-4 text-gray-700 group-focus-within:text-blue-500 transition-colors",children:[e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("div",{className:"h-6 w-px bg-gray-800"})]})]}),e.jsxs("div",{className:"flex items-stretch gap-3 w-full lg:w-auto h-16 sm:h-[68px]",children:[e.jsxs("button",{onClick:()=>ge(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]}),e.jsxs("button",{onClick:()=>Ie(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-red-600/10 border border-red-500/20 text-red-500 hover:bg-red-600 hover:text-white rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-red-950/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Export"]}),e.jsx("div",{className:"hidden lg:block h-full",children:e.jsx(Jt,{columns:Ke,visibleColumns:me,onToggle:_e})})]})]})}),e.jsx("div",{className:"relative z-10",children:e.jsx(bt,{orders:Y,onEdit:P=>n(P["Order ID"]),showActions:!0,visibleColumns:me,selectedIds:Pe,onToggleSelect:B,onToggleSelectAll:ne})}),e.jsx(Kt,{orders:S,selectedIds:Pe,onComplete:()=>{ye(new Set),be()},onClearSelection:()=>ye(new Set)}),De&&e.jsx(Ht,{isOpen:De,onClose:()=>Ie(!1),orders:Y})]})},Qt=(s,a)=>{const[i,r]=c.useState(null),f=c.useMemo(()=>{const w={Pending:[],Packing:[],Shipped:[]};return s.forEach(g=>{const n=g.FulfillmentStatus||"Pending";n!=="Cancelled"&&(w[n]?w[n].push(g):w.Pending.push(g))}),w},[s]),b=c.useCallback(async(w,g)=>{r(w);try{if(!(await fetch(`${ae}/api/admin/update-sheet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:"AllOrders",primaryKey:{"Order ID":w},newData:{FulfillmentStatus:g}})})).ok)throw new Error("Failed to update status");a&&a()}catch(n){console.error("Fulfillment update error:",n),alert("áž˜áž·áž“áž¢áž¶áž…áž’áŸ’ážœáž¾áž”áž…áŸ’áž…áž»áž”áŸ’áž”áž“áŸ’áž“áž—áž¶áž–ážŸáŸ’ážáž¶áž“áž—áž¶áž–áž”áž¶áž“áž‘áŸáŸ” ážŸáž¼áž˜áž–áŸ’áž™áž¶áž™áž¶áž˜áž˜áŸ’ážáž„áž‘áŸ€ážáŸ”")}finally{r(null)}},[a]);return{ordersByStatus:f,updateStatus:b,loadingId:i}},Zt=({order:s,onStatusChange:a,isLoading:i})=>{const r=s.FulfillmentStatus||"Pending";return e.jsxs("div",{className:"bg-gray-800/40 border border-gray-700 rounded-2xl p-5 space-y-4 hover:border-blue-500/50 transition-all shadow-lg animate-fade-in relative overflow-hidden group",children:[i&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm z-10 flex items-center justify-center",children:e.jsx(te,{size:"md"})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black uppercase text-sm tracking-tight",children:s["Order ID"].substring(0,8)}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase mt-0.5",children:[s.Page," (",s.Team,")"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-bold text-gray-300",children:s["Customer Name"]}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono",children:s["Customer Phone"]})]})]}),e.jsx("div",{className:"bg-black/20 rounded-xl p-3 border border-white/5 space-y-2",children:s.Products.map((f,b)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-900 rounded-lg border border-gray-700 overflow-hidden flex-shrink-0",children:e.jsx("img",{src:xe(f.image),className:"w-full h-full object-cover",alt:""})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-200 truncate leading-tight",children:f.name}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-blue-400 font-black",children:["Qty: ",f.quantity]}),f.colorInfo&&e.jsxs("span",{className:"text-[10px] text-purple-400 italic",children:["áž–ážŽáŸŒ: ",f.colorInfo]})]})]})]},b))}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[r==="Pending"&&e.jsx("button",{onClick:()=>a(s["Order ID"],"Packing"),className:"flex-1 btn bg-blue-600 hover:bg-blue-700 text-white text-[10px] font-black uppercase py-2 rounded-xl",children:"áž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜ážœáŸáž…ážáŸ’áž…áž”áŸ‹"}),r==="Packing"&&e.jsx("button",{onClick:()=>a(s["Order ID"],"Shipped"),className:"flex-1 btn bg-emerald-600 hover:bg-emerald-700 text-white text-[10px] font-black uppercase py-2 rounded-xl",children:"áž•áŸ’áž‰áž¾áž…áŸáž‰ážšáž½áž…ážšáž¶áž›áŸ‹"}),r==="Shipped"&&e.jsx("div",{className:"flex-1 text-center py-2 bg-gray-700/50 rounded-xl text-[10px] font-black text-gray-400 uppercase",children:"âœ… áž”áž¶áž“áž”áž‰áŸ’áž…áŸáž‰áž‘áŸ†áž“áž·áž‰"})]})]})},es=({orders:s})=>{const{refreshData:a,setMobilePageTitle:i}=c.useContext(re),{ordersByStatus:r,updateStatus:f,loadingId:b}=Qt(s,a),[w,g]=c.useState("Pending");c.useEffect(()=>(i("Fulfillment Store"),()=>i(null)),[i]);const n=c.useMemo(()=>w==="Pending"?r.Pending:w==="Packing"?r.Packing:r.Shipped,[w,r]);return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-800/20 p-5 rounded-[2rem] border border-white/5 backdrop-blur-md",children:[e.jsx("h1",{className:"hidden sm:block text-2xl font-black text-white uppercase tracking-tighter",children:"Fulfillment Store"}),e.jsx("div",{className:"flex bg-black/40 p-1 rounded-xl border border-white/5",children:["Pending","Packing","Shipped"].map(N=>e.jsxs("button",{onClick:()=>g(N),className:`px-6 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${w===N?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[N==="Pending"?"ážáŸ’ážšáž¼ážœážœáŸáž…ážáŸ’áž…áž”áŸ‹":N==="Packing"?"áž€áŸ†áž–áž»áž„ážœáŸáž…ážáŸ’áž…áž”áŸ‹":"áž”áž¶áž“áž•áŸ’áž‰áž¾áž…áŸáž‰",e.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-black/30 rounded-md text-[8px]",children:r[N].length})]},N))})]}),n.length===0?e.jsx("div",{className:"py-20 text-center bg-gray-800/10 rounded-[3rem] border-2 border-dashed border-gray-700/50",children:e.jsx("p",{className:"text-gray-500 font-black uppercase tracking-[0.2em] text-sm",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™áž€áŸ’áž“áž»áž„áž”áž‰áŸ’áž‡áž¸áž“áŸáŸ‡áž‘áŸ"})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:n.map(N=>e.jsx(Zt,{order:N,onStatusChange:f,isLoading:b===N["Order ID"]},N["Order ID"]))})]})},is=()=>{const{appData:s,currentUser:a,refreshTimestamp:i,isSidebarCollapsed:r}=c.useContext(re),[f,b]=H("tab","admin"),[w,g]=H("subview","dashboard"),[n,N]=H("reportType","overview"),[p,j]=c.useState(!1),[F,A]=c.useState(!1),[L,v]=c.useState(!1),[$,y]=c.useState(!1),[O,h]=c.useState(()=>{if(typeof window<"u"){const S=window.innerWidth;if(S<768)return"mobile";if(S<1280)return"tablet"}return"desktop"}),[l,u]=c.useState([]),m=c.useRef(!1),[t,D]=c.useState({preset:"today",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[d,x]=H("teamFilter",""),[o,k]=H("locationFilter",""),[C,T]=H("storeFilter",""),[M,U]=H("dateFilter","today"),[V,E]=H("startDate",""),[I,G]=H("endDate",""),[q,oe]=H("shippingFilter",""),[le,K]=H("driverFilter",""),[me,ue]=H("brandFilter",""),[J,fe]=H("paymentFilter",""),[pe,Me]=H("userFilter",""),[We,Se]=H("pageFilter",""),[$e,Ce]=H("costFilter",""),[Oe,je]=H("bankFilter",""),[Ae,ge]=H("productFilter","");c.useEffect(()=>{const S=()=>{const Y=window.innerWidth;Y<768?h("mobile"):Y<1280?h("tablet"):h("desktop")};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const De=async(S=!1)=>{if(!(S&&m.current)){(l.length===0||S)&&j(!0);try{const Y=S?`${ae}/api/admin/all-orders`:`${ae}/api/admin/all-orders?days=30`,B=await fetch(Y);if(B.ok){const ne=await B.json();if(ne.status==="success"){const R=(Array.isArray(ne.data)?ne.data:[]).filter(z=>z!==null&&z["Order ID"]!=="Opening_Balance"&&z["Order ID"]!=="Opening Balance").map(z=>{let W=[];try{z["Products (JSON)"]&&(W=JSON.parse(z["Products (JSON)"]))}catch{}return{...z,Products:W,IsVerified:String(z.IsVerified).toUpperCase()==="TRUE",FulfillmentStatus:z.FulfillmentStatus}});u(R),S&&(m.current=!0)}}}catch(Y){console.error(Y)}finally{j(!1)}}};c.useEffect(()=>{De()},[i]);const Ie=()=>{const S=new Date,Y=new Date(S.getFullYear(),S.getMonth(),S.getDate());return["this_year","last_year","all"].includes(t.preset)&&!m.current?(De(!0),[]):l.filter(ne=>{if(!ne.Timestamp)return!1;const P=new Date(ne.Timestamp);if(t.preset==="today")return P.toDateString()===S.toDateString();if(t.preset==="this_week"){const R=S.getDay(),z=new Date(Y);z.setDate(Y.getDate()-(R===0?6:R-1));const W=new Date(z);return W.setDate(z.getDate()+6),W.setHours(23,59,59,999),P>=z&&P<=W}else{if(t.preset==="this_month")return P.getMonth()===S.getMonth()&&P.getFullYear()===S.getFullYear();if(t.preset==="custom"){const R=t.start?new Date(t.start+"T00:00:00"):null,z=t.end?new Date(t.end+"T23:59:59"):null;return!(R&&P<R||z&&P>z)}}return P.toDateString()===S.toDateString()})},ie=c.useMemo(()=>Ie(),[l,t]),Ve=c.useMemo(()=>{const S={};return ie.forEach(Y=>{let B=Y.Team||"Unassigned";S[B]||(S[B]={name:B,revenue:0,orders:0}),S[B].revenue+=Number(Y["Grand Total"])||0,S[B].orders+=1}),Object.values(S).sort((Y,B)=>B.revenue-Y.revenue)},[ie]),Pe=c.useMemo(()=>{const S={};return ie.forEach(Y=>{let B=Y["Fulfillment Store"]||"Unassigned";S[B]||(S[B]={name:B,revenue:0,orders:0}),S[B].revenue+=Number(Y["Grand Total"])||0,S[B].orders+=1}),Object.values(S).sort((Y,B)=>B.revenue-Y.revenue)},[ie]),ye=c.useMemo(()=>{const S={};return ie.forEach(Y=>{var P;const B=(P=s.pages)==null?void 0:P.find(R=>R.PageName===Y.Page),ne=(B==null?void 0:B.DefaultStore)||"Unassigned";S[ne]||(S[ne]={name:ne,revenue:0,orders:0}),S[ne].revenue+=Number(Y["Grand Total"])||0,S[ne].orders+=1}),Object.values(S).sort((Y,B)=>B.revenue-Y.revenue)},[ie,s.pages]),_=c.useMemo(()=>{const S={};return ie.forEach(Y=>{const B=(Y.Location||"").split(/[,|\-|/]/)[0].trim();!B||B.toUpperCase()==="N/A"||(S[B]||(S[B]={name:B,revenue:0,orders:0}),S[B].revenue+=Number(Y["Grand Total"])||0,S[B].orders+=1)}),Object.values(S).sort((Y,B)=>B.revenue-Y.revenue)},[ie]),Fe=S=>{S==="reports"?A(!F):(["dashboard","performance"].includes(S)?(b("admin"),g(S)):b(S),A(!1))},ze=S=>{b("reports"),N(S)},_e=S=>{x(""),k(""),T(""),ue(""),oe(""),K(""),fe(""),Me(""),Se(""),Ce(""),je(""),ge(""),S.team&&x(S.team),S.location&&k(S.location),S.fulfillmentStore&&T(S.fulfillmentStore),S.store&&ue(S.store),S.shipping&&oe(S.shipping),S.driver&&K(S.driver),S.paymentStatus&&fe(S.paymentStatus),S.user&&Me(S.user),S.page&&Se(S.page),S.internalCost&&Ce(S.internalCost),S.bank&&je(S.bank),S.product&&ge(S.product),S.datePreset&&(U(S.datePreset),S.datePreset==="custom"&&S.startDate&&S.endDate?(E(S.startDate),G(S.endDate)):(E(""),G(""))),b("orders")},we=(S,Y)=>{const B={};S==="team"&&(B.team=Y),S==="location"&&(B.location=Y),S==="store"&&(B.fulfillmentStore=Y),S==="brand"&&(B.store=Y),B.datePreset=t.preset,t.preset==="custom"&&(B.startDate=t.start,B.endDate=t.end),_e(B)},be={activeDashboard:f,currentAdminView:w,isReportSubMenuOpen:F,setIsReportSubMenuOpen:A,isProfileSubMenuOpen:L,setIsProfileSubMenuOpen:v,onNavChange:Fe,onReportSubNav:ze,setEditProfileModalOpen:y,children:(()=>{if(p&&l.length===0)return e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx(te,{size:"lg"})});switch(f){case"admin":return w==="dashboard"?e.jsx(Dt,{currentUser:a,parsedOrders:l,dateFilter:t,setDateFilter:D,teamRevenueStats:Ve,provinceStats:_,storeStats:Pe,brandStats:ye,onTeamClick:S=>we("team",S),onProvinceClick:S=>we("location",S),onStoreClick:S=>we("store",S),onBrandClick:S=>we("brand",S)}):e.jsx(At,{orders:l,users:s.users||[],targets:s.targets||[]});case"orders":return e.jsx(Xt,{onBack:()=>b("admin"),initialFilters:{team:d,location:o,fulfillmentStore:C,store:me,datePreset:M,startDate:V,endDate:I,shippingService:q,driver:le,paymentStatus:J,user:pe,page:We,internalCost:$e,bank:Oe,product:Ae}});case"reports":return e.jsx(Ut,{activeReport:n,onBack:()=>b("admin"),onNavigate:_e});case"settings":return e.jsx(Vt,{onBack:()=>b("admin")});case"fulfillment":return e.jsx(es,{orders:l});default:return null}})()};return e.jsxs(e.Fragment,{children:[O==="mobile"?e.jsx(vt,{...be}):O==="tablet"?e.jsx(jt,{...be}):e.jsx(yt,{...be,isSidebarCollapsed:r}),$&&e.jsx(lt,{onClose:()=>y(!1)})]})};export{is as default};
