import{r as i,A as le,j as e,c as he,a as qe,S as se,R as ot,u as V,M as me,W as ne,i as it,f as ct}from"./index-B0BjhuxE.js";import{U as _e}from"./UserAvatar-Cjz0rggO.js";import{t as dt,E as xt}from"./EditProfileModal-BiM_vBGT.js";import{S as ae,a as mt,G as ut,b as ht,c as at,E as Be,d as pt,e as gt,f as bt,g as ft,h as yt,D as vt,i as jt,O as wt}from"./OrdersList-CDMwZLbW.js";import Nt from"./html2canvas.esm-QH1iLAAe.js";import"./imageCompressor-D5vYYzIg.js";const rt=({activeDashboard:t,currentAdminView:a,isReportSubMenuOpen:o,isProfileSubMenuOpen:r,onNavChange:j,onReportSubNav:h,setIsReportSubMenuOpen:f,setIsProfileSubMenuOpen:c,setEditProfileModalOpen:l,isMobile:b=!1})=>{const{currentUser:m,logout:y,refreshData:z,isSidebarCollapsed:k,setIsSidebarCollapsed:O,setAppState:w,setIsChatOpen:P,unreadCount:v,language:L,setLanguage:p}=i.useContext(le),[n,g]=i.useState(!1),x=dt[L],s=[{id:"overview",title:x.overview,icon:"ðŸ“Š"},{id:"sales_team",title:x.sales_team_report,icon:"ðŸ‘¥"},{id:"sales_page",title:x.sales_page_report,icon:"ðŸ“„"},{id:"performance",title:x.performance,icon:"ðŸ“ˆ"},{id:"profitability",title:x.profitability,icon:"ðŸ’°"},{id:"forecasting",title:x.forecasting,icon:"ðŸ”®"},{id:"shipping",title:x.shipping_report,icon:"ðŸšš"}],D=[{id:"dashboard",label:x.dashboard,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),component:"admin"},{id:"fulfillment",label:"Fulfillment",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",strokeWidth:2})}),component:"fulfillment"},{id:"orders",label:x.orders,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),component:"orders"},{id:"reports",label:x.reports,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),component:"reports"},{id:"settings",label:x.settings,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),component:"settings"}],d=(m==null?void 0:m.IsSystemAdmin)&&((m==null?void 0:m.Team)||"").split(",").map(C=>C.trim()).filter(Boolean).length>0,N=async()=>{g(!0);try{await z(),window.location.reload()}catch{g(!1)}},u=b?"w-full flex flex-col h-full bg-transparent":`fixed left-0 top-0 h-screen border-r border-white/5 z-50 transition-all duration-300 ease-in-out ${k?"w-20":"w-64"} bg-[#020617]/95 backdrop-blur-3xl flex flex-col shadow-2xl`;return e.jsxs("aside",{className:u,children:[!b&&e.jsxs("div",{className:"h-20 flex items-center gap-4 px-6 border-b border-white/5 overflow-hidden relative group shrink-0",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-600/20 flex-shrink-0 transition-all border border-white/10 z-10",children:e.jsx("img",{src:he(qe),alt:"Logo",className:"w-5 h-5 object-contain"})}),!k&&e.jsxs("div",{className:"flex flex-col z-10 animate-fade-in min-w-0",children:[e.jsx("h1",{className:"text-base font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em]",children:"Admin"})]})]}),!b&&e.jsx("button",{onClick:()=>O(!k),className:"absolute top-[4.5rem] -right-3 w-6 h-6 bg-[#0f172a] border border-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-white shadow-xl z-[60] transition-all hover:scale-110 hover:border-blue-500/50",children:e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 ${k?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:e.jsx("path",{d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-0 py-6 space-y-1",children:[b&&e.jsx("div",{className:"px-4 mb-6",children:e.jsxs("button",{onClick:()=>P(!0),className:"w-full flex items-center justify-between px-4 py-3.5 rounded-2xl bg-gradient-to-r from-blue-600/20 to-indigo-600/20 text-blue-300 border border-blue-500/30 active:scale-[0.98] transition-all shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative p-1.5 bg-blue-500/20 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),v>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-gray-900 animate-pulse"})]}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:x.chat_system})]}),v>0&&e.jsx("span",{className:"bg-red-500 text-white text-[9px] font-black px-2 py-0.5 rounded-full shadow-lg",children:v})]})}),D.map(C=>{const S=C.id==="reports",$=t===C.component&&(C.component!=="admin"||C.id===a),A=S&&o;return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>j(C.id),className:`
                                    w-full flex items-center justify-between px-6 py-4 transition-all duration-200 group relative
                                    ${$?"text-white bg-gradient-to-r from-blue-600/30 to-transparent border-l-4 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5 border-l-4 border-transparent"}
                                `,title:k&&!b?C.label:"",children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("span",{className:`transition-transform duration-300 ${$?"scale-110 text-blue-400":"group-hover:text-gray-200"}`,children:C.icon}),(b||!k)&&e.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${$?"text-white":""}`,children:C.label})]}),S&&(b||!k)&&e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 opacity-50 ${A?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-black/20 ${A&&(b||!k)?"max-h-[500px] opacity-100 py-2":"max-h-0 opacity-0"}`,children:s.map(F=>e.jsxs("button",{onClick:()=>h(F.id),className:"w-full flex items-center gap-3 px-6 pl-14 py-2.5 text-[10px] font-bold uppercase tracking-wider text-gray-500 hover:text-white hover:bg-white/5 transition-all relative group",children:[e.jsx("div",{className:"absolute left-10 w-1.5 h-1.5 rounded-full bg-gray-700 group-hover:bg-blue-500 transition-colors"}),e.jsx("span",{className:"truncate",children:F.title})]},F.id))})]},C.id)})]}),e.jsxs("div",{className:`p-4 shrink-0 ${b?"":"border-t border-white/5 bg-black/20"}`,children:[e.jsxs("button",{onClick:()=>c(!r),className:`
                        w-full flex items-center gap-3 p-2.5 rounded-2xl transition-all duration-300
                        ${r?"bg-gray-800":"hover:bg-white/5"}
                        ${!b&&k?"justify-center":""}
                    `,children:[e.jsx(_e,{avatarUrl:m==null?void 0:m.ProfilePictureURL,name:(m==null?void 0:m.FullName)||"",size:"md",className:"ring-2 ring-white/5 shadow-md flex-shrink-0"}),(b||!k)&&e.jsxs("div",{className:"min-w-0 flex-grow text-left",children:[e.jsx("p",{className:"text-xs font-black text-white truncate leading-tight",children:m==null?void 0:m.FullName}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-widest mt-0.5 truncate",children:m==null?void 0:m.Role})]}),(b||!k)&&e.jsx("svg",{className:`w-3 h-3 text-gray-500 transition-transform duration-300 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]}),e.jsx("div",{className:`
                    overflow-hidden transition-all duration-300 ease-in-out
                    ${r&&(b||!k)?"max-h-[300px] mt-4 opacity-100":"max-h-0 opacity-0"}
                `,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-900 rounded-xl p-1 flex border border-white/5",children:[e.jsx("button",{onClick:()=>p("en"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${L==="en"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"ENG"}),e.jsx("button",{onClick:()=>p("km"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${L==="km"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"KH"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>l(!0),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-blue-600/20 hover:border-blue-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400 mb-1.5 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Profile"})]}),e.jsxs("button",{onClick:N,disabled:n,className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-emerald-600/20 hover:border-emerald-500/30 transition-all group",children:[n?e.jsx(se,{size:"sm"}):e.jsx("svg",{className:"w-4 h-4 text-emerald-400 mb-1.5 group-hover:rotate-180 transition-transform duration-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Sync"})]}),d&&e.jsxs("button",{onClick:()=>w("role_selection"),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-yellow-600/20 hover:border-yellow-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-400 mb-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Switch"})]}),e.jsxs("button",{onClick:y,className:`flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-red-600/20 hover:border-red-500/30 transition-all group ${d?"":"col-span-2"}`,children:[e.jsx("svg",{className:"w-4 h-4 text-red-400 mb-1.5 group-hover:translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Logout"})]})]})]})})]})]})},kt=({children:t,activeDashboard:a,currentAdminView:o,isSidebarCollapsed:r,onNavChange:j,onReportSubNav:h,isReportSubMenuOpen:f,setIsReportSubMenuOpen:c,isProfileSubMenuOpen:l,setIsProfileSubMenuOpen:b,setEditProfileModalOpen:m})=>e.jsxs("div",{className:"flex min-h-screen bg-gray-950",children:[e.jsx(rt,{activeDashboard:a,currentAdminView:o,isReportSubMenuOpen:f,isProfileSubMenuOpen:l,onNavChange:j,onReportSubNav:h,setIsReportSubMenuOpen:c,setIsProfileSubMenuOpen:b,setEditProfileModalOpen:m}),e.jsxs("main",{className:`flex-1 transition-all duration-300 ease-in-out ${r?"pl-20":"pl-64"}`,children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-50 overflow-hidden",children:e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-600/5 rounded-full blur-[120px]"})}),e.jsx("div",{className:"p-4 md:p-6 lg:p-8 xl:p-10 2xl:p-12 max-w-[2400px] mx-auto min-h-screen relative z-10 transition-all duration-300",children:t})]})]}),nt=({activeDashboard:t,currentAdminView:a,onNavChange:o,onReportSubNav:r,isReportSubMenuOpen:j,setIsReportSubMenuOpen:h,isProfileSubMenuOpen:f,setIsProfileSubMenuOpen:c,setEditProfileModalOpen:l})=>{const{isMobileMenuOpen:b,setIsMobileMenuOpen:m}=i.useContext(le);return b?e.jsxs("div",{className:"fixed inset-0 z-[100] flex overflow-hidden",children:[e.jsx("style",{children:`
                @keyframes slide-right {
                    from { transform: translateX(-100%); }
                    to { transform: translateX(0); }
                }
                .animate-slide-right {
                    animation: slide-right 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
                }
            `}),e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md transition-opacity duration-300",onClick:()=>m(!1)}),e.jsxs("div",{className:"relative w-[85%] max-w-[320px] h-full bg-[#020617] shadow-2xl animate-slide-right flex flex-col border-r border-white/10",children:[e.jsxs("div",{className:"flex-shrink-0 px-6 pt-12 pb-6 flex items-center justify-between bg-gradient-to-b from-[#0f172a] to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/40 border border-white/10 overflow-hidden p-1.5",children:e.jsx("img",{src:he(qe),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"Core Access"})]})]}),e.jsx("button",{onClick:()=>m(!1),className:"w-9 h-9 rounded-full bg-white/5 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 border border-white/5 transition-all active:scale-90",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 18L18 6M6 6l12 12",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex-grow overflow-hidden relative z-10",children:e.jsx(rt,{isMobile:!0,activeDashboard:t,currentAdminView:a,isReportSubMenuOpen:j,isProfileSubMenuOpen:f,onNavChange:y=>{o(y),y!=="reports"&&m(!1)},onReportSubNav:y=>{r(y),m(!1)},setIsReportSubMenuOpen:h,setIsProfileSubMenuOpen:c,setEditProfileModalOpen:l})})]})]}):null},St=({children:t,activeDashboard:a,currentAdminView:o,onNavChange:r,onReportSubNav:j,isReportSubMenuOpen:h,setIsReportSubMenuOpen:f,isProfileSubMenuOpen:c,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:b})=>e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-5%] left-[-10%] w-[60%] h-[40%] bg-blue-600/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-5%] right-[-5%] w-[60%] h-[40%] bg-indigo-600/10 rounded-full blur-[120px]"})]}),e.jsx(nt,{activeDashboard:a,currentAdminView:o,onNavChange:r,onReportSubNav:j,isReportSubMenuOpen:h,setIsReportSubMenuOpen:f,isProfileSubMenuOpen:c,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:b}),e.jsx("main",{className:"flex-1 pb-12 px-3 overflow-x-hidden relative z-10",children:e.jsx("div",{className:"max-w-xl mx-auto",children:t})}),e.jsx("div",{className:"h-1 w-24 bg-white/5 rounded-full mx-auto mb-4"})]}),Ct=({children:t,activeDashboard:a,currentAdminView:o,onNavChange:r,onReportSubNav:j,isReportSubMenuOpen:h,setIsReportSubMenuOpen:f,isProfileSubMenuOpen:c,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:b})=>{const{setIsMobileMenuOpen:m,currentUser:y}=ot.useContext(le);return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-5%] w-[50%] h-[50%] bg-blue-900/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-5%] w-[50%] h-[50%] bg-purple-900/10 rounded-full blur-[120px]"})]}),e.jsxs("header",{className:"sticky top-0 z-40 bg-[#0f172a]/80 backdrop-blur-xl border-b border-white/5 px-6 py-4 flex justify-between items-center shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m(!0),className:"p-2.5 rounded-xl bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white transition-all border border-white/5 active:scale-95",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/20 p-1.5 border border-white/10",children:e.jsx("img",{src:he(qe),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[10px] text-blue-400 font-bold uppercase tracking-[0.2em]",children:"Tablet Admin"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-sm font-bold text-white leading-tight",children:y==null?void 0:y.FullName}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono uppercase",children:y==null?void 0:y.Role})]}),e.jsx(_e,{avatarUrl:y==null?void 0:y.ProfilePictureURL,name:(y==null?void 0:y.FullName)||"",size:"md",className:"ring-2 ring-white/10 shadow-md"})]})]}),e.jsx(nt,{activeDashboard:a,currentAdminView:o,onNavChange:r,onReportSubNav:j,isReportSubMenuOpen:h,setIsReportSubMenuOpen:f,isProfileSubMenuOpen:c,setIsProfileSubMenuOpen:l,setEditProfileModalOpen:b}),e.jsx("main",{className:"flex-1 p-6 relative z-10 overflow-x-hidden",children:e.jsx("div",{className:"w-full mx-auto",children:t})})]})},Dt=({stats:t,onStatClick:a})=>{const o=i.useMemo(()=>t.reduce((r,j)=>({revenue:r.revenue+j.revenue,orders:r.orders+j.orders}),{revenue:0,orders:0}),[t]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"}),e.jsx("path",{d:"M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"})]}),"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”ážáž¶áž˜áž€áŸ’ážšáž»áž˜"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"áž€áŸ’ážšáž»áž˜"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[t.map((r,j)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",j+1]}),e.jsx("span",{className:"group-hover:text-blue-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),t.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:o.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",o.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},Pt="/Order_System/",Lt=[`${Pt}cambodia-provinces.geojson`,"https://raw.githubusercontent.com/seanghai/cambodia-geojson/master/cambodia-provinces.geojson","https://raw.githubusercontent.com/romnea/cambodia-geojson/master/provinces.geojson","https://raw.githubusercontent.com/kheang-hong/cambodia-geojson/master/provinces.geojson"],Qe=["#1f2937","#1e3a8a","#2563eb","#3b82f6","#60a5fa","#93c5fd"],Ge=[0,500,1e3,5e3,1e4,2e4],et=t=>{if(!t)return"";const a=String(t).toLowerCase().replace(/\s/g,"").replace(/province|city|krong|khan|ážšáž¶áž‡áž’áž¶áž“áž¸|ážáŸážáŸ’áž|ážáŸážáŸ’ážŠ|áž€áŸ’ážšáž»áž„/g,"").trim();return{áž—áŸ’áž“áŸ†áž–áŸáž‰:"phnompenh",áž€ážŽáŸ’ážáž¶áž›:"kandal",áž€ážŽáŸ’ážŠáž¶áž›:"kandal",áž€áŸ†áž–áž„áŸ‹áž…áž¶áž˜:"kampongcham",áž€áŸ†áž–áž„áŸ‹áž†áŸ’áž“áž¶áŸ†áž„:"kampongchhnang",áž€áŸ†áž–áž„áŸ‹áž’áŸ†:"kampongthom",áž€áŸ†áž–áž„áŸ‹ážŸáŸ’áž–ážº:"kampongspeu",áž€áŸ†áž–áž:"kampot",áž€áŸ‚áž”:"kep",áž€áŸ„áŸ‡áž€áž»áž„:"kohkong",áž€áŸ’ážšáž…áŸáŸ‡:"kratie",ážáž¶áž€áŸ‚ážœ:"takeo",ážáŸ’áž”áž¼áž„ážƒáŸ’áž˜áž»áŸ†:"tbongkhmum",áž”áž“áŸ’áž‘áž¶áž™áž˜áž¶áž“áž‡áŸáž™:"banteymeanchey",áž”áž¶ážáŸ‹ážŠáŸ†áž”áž„:"battambang",áž”áŸ‰áŸƒáž›áž·áž“:"pailin",áž–áŸ„áž’áž·áŸážŸáž¶ážáŸ‹:"pursat",áž–áŸ’ážšáŸƒážœáŸ‚áž„:"preyveng",áž–áŸ’ážšáŸ‡ážœáž·áž áž¶ážš:"preahvihear",áž–áŸ’ážšáŸ‡ážŸáž¸áž áž“áž»:"preahsihanouk",áž˜ážŽáŸ’ážŒáž›áž‚áž·ážšáž¸:"mondulkiri",ážšážáž“áž‚áž·ážšáž¸:"ratanakiri",ážŸáŸ€áž˜ážšáž¶áž”:"siemreap",ážŸáŸ’áž‘áž¹áž„ážáŸ’ážšáŸ‚áž„:"stungtreng",ážŸáŸ’ážœáž¶áž™ážšáŸ€áž„:"svayrieng",áž§ážáŸ’ážážšáž˜áž¶áž“áž‡áŸáž™:"oddarmeanchey"}[a]||a},Mt=()=>{const[t,a]=i.useState(null),[o,r]=i.useState(null),[j,h]=i.useState(!0);return i.useEffect(()=>{let f=!0;return(async()=>{for(const l of Lt)try{const b=await fetch(l);if(b.ok){const m=await b.json();if(m&&m.type==="FeatureCollection"&&Array.isArray(m.features)){f&&(a(m),h(!1));return}else console.warn(`Fetched data from ${l} is not valid GeoJSON`)}}catch(b){console.warn(`Failed to load ${l}`,b)}f&&(r("áž˜áž·áž“áž¢áž¶áž…áž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™áž•áŸ‚áž“áž‘áž¸áž”áž¶áž“áž‘áŸ"),h(!1))})().catch(l=>{console.error("GeoJSON Fetch Fatal Error:",l),f&&(r("Error loading map data"),h(!1))}),()=>{f=!1}},[]),{geoJson:t,loading:j,error:o}},Tt=()=>e.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-900/90 backdrop-blur-md p-3 rounded-xl border border-white/10 z-10 shadow-xl pointer-events-none",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase mb-2",children:"Revenue Scale"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[Ge.map((t,a)=>{if(a===0)return null;const o=Qe[a],r=Ge[a-1];return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:o}}),e.jsxs("span",{className:"text-[9px] text-gray-300 font-mono",children:["$",r/1e3,"k - $",t/1e3,"k"]})]},a)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:Qe[5]}}),e.jsxs("span",{className:"text-[9px] text-gray-300 font-mono",children:["> $",Ge[5]/1e3,"k"]})]})]})]}),$t=t=>{const a=i.useRef(null),[o,r]=i.useState(!1),[j,h]=i.useState(null);return i.useEffect(()=>{let f=!0,c=null;return(async()=>{if(t.current&&!a.current)try{let b=0;for(;!window.maplibregl&&b<50;)await new Promise(y=>setTimeout(y,100)),b++;if(!f)return;const m=window.maplibregl;if(!m)throw new Error("MapLibre GL library not found.");c=new m.Map({container:t.current,style:{version:8,sources:{osm:{type:"raster",tiles:["https://a.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}@2x.png"],tileSize:256,attribution:"&copy; OpenStreetMap & CartoDB"}},layers:[{id:"background",type:"background",paint:{"background-color":"#020617"}},{id:"osm-layer",type:"raster",source:"osm",paint:{"raster-opacity":.3,"raster-saturation":-1,"raster-contrast":.1}}]},center:[104.916,12.5657],zoom:5.8,pitch:45,bearing:-10,minZoom:5,maxZoom:9}),c.addControl(new m.NavigationControl({showCompass:!0,visualizePitch:!0}),"top-right"),c.on("load",()=>{f&&(a.current=c,r(!0),console.log("Map Engine Ready in 3D Mode"))}),c.on("error",y=>{console.error("Map Internal Error:",y)})}catch(b){console.error("Map Engine Initialization Failed:",b),f&&h(b.message)}})().catch(b=>{console.error("Uncaught Map Engine Error:",b),f&&h("Failed to initialize map engine.")}),()=>{f=!1,c&&(c.remove(),a.current=null)}},[]),{map:a.current,isMapReady:o,mapError:j}},ke={levels:["#1f2937","#172554","#1e40af","#2563eb","#3b82f6","#60a5fa","#93c5fd"]},Oe=[0,100,500,1e3,5e3,1e4],tt=["interpolate",["linear"],["get","revenue"],0,0,100,2e3,1e3,1e4,1e4,3e4,5e4,6e4],Ot=["case",["!=",["get","revenue"],0],["step",["get","revenue"],ke.levels[0],Oe[1],ke.levels[1],Oe[2],ke.levels[2],Oe[3],ke.levels[3],Oe[4],ke.levels[4],Oe[5],ke.levels[5]],"rgba(255,255,255,0.02)"],At=({data:t})=>{const a=i.useRef(null),o=i.useRef(null),r=i.useRef(null),{geoJson:j,loading:h,error:f}=Mt(),{map:c,isMapReady:l,mapError:b}=$t(a),m=i.useMemo(()=>{const y={};return Array.isArray(t)&&t.forEach(z=>{if(!z||!z.name)return;const k=et(z.name);k&&(y[k]?(y[k].revenue+=Number(z.revenue)||0,y[k].orders+=Number(z.orders)||0):y[k]={...z})}),y},[t]);return i.useEffect(()=>{if(!(!l||!c||!j))try{const y=window.maplibregl,k={type:"FeatureCollection",features:j.features.map(w=>{const P=w.properties||{},v=[P.name_kh,P.Name_KH,P.name_en,P.Name_EN,P.name,P.shapeName];let L=0,p=0,n=P.name_en||P.shapeName||"Province";for(const g of v){if(!g)continue;const x=et(String(g));if(m[x]){L=m[x].revenue,p=m[x].orders,n=g;break}}return{...w,properties:{...P,revenue:L,orders:p,displayName:n}}})},O=c.getSource("cambodia-3d-source");O?O.setData(k):(c.addSource("cambodia-3d-source",{type:"geojson",data:k,generateId:!0}),c.addLayer({id:"province-3d",type:"fill-extrusion",source:"cambodia-3d-source",paint:{"fill-extrusion-color":Ot,"fill-extrusion-height":tt,"fill-extrusion-base":0,"fill-extrusion-opacity":.9,"fill-extrusion-vertical-gradient":!0}}),c.addLayer({id:"province-outlines",type:"line",source:"cambodia-3d-source",paint:{"line-color":"#94a3b8","line-width":1,"line-opacity":.3}}),c.addLayer({id:"province-highlight",type:"fill-extrusion",source:"cambodia-3d-source",paint:{"fill-extrusion-color":"#fbbf24","fill-extrusion-height":["+",tt,5e3],"fill-extrusion-opacity":["case",["boolean",["feature-state","hover"],!1],1,0]}}),o.current=new y.Popup({closeButton:!1,closeOnClick:!1,className:"custom-map-popup",offset:20}),c.on("mousemove","province-3d",w=>{if(w.features.length>0){c.getCanvas().style.cursor="pointer";const P=w.features[0];r.current!==null&&c.setFeatureState({source:"cambodia-3d-source",id:r.current},{hover:!1}),r.current=P.id,c.setFeatureState({source:"cambodia-3d-source",id:P.id},{hover:!0});const{displayName:v,revenue:L,orders:p}=P.properties;o.current.setLngLat(w.lngLat).setHTML(`
                                <div class="px-4 py-3 text-gray-900 min-w-[160px]">
                                    <h4 class="font-black text-sm uppercase text-gray-800 border-b border-gray-200 pb-1 mb-1">${v}</h4>
                                    <div class="flex justify-between text-xs mb-1"><span class="text-gray-500 font-bold">Revenue:</span><span class="font-black text-blue-600">$${L.toLocaleString()}</span></div>
                                    <div class="flex justify-between text-xs"><span class="text-gray-500 font-bold">Orders:</span><span class="font-black text-gray-800">${p}</span></div>
                                </div>
                            `).addTo(c)}}),c.on("mouseleave","province-3d",()=>{c.getCanvas().style.cursor="",r.current!==null&&c.setFeatureState({source:"cambodia-3d-source",id:r.current},{hover:!1}),r.current=null,o.current.remove()}))}catch(y){console.error("Layer Update Error:",y)}},[l,j,m]),f||b?e.jsx("div",{className:"w-full h-[500px] flex items-center justify-center bg-gray-900/50 rounded-3xl border border-red-500/20 text-red-400",children:e.jsxs("p",{children:["Map Error: ",f||b]})}):e.jsxs("div",{className:"relative w-full h-[500px] lg:h-[600px] bg-[#020617] rounded-[2.5rem] border border-white/5 shadow-2xl overflow-hidden group",children:[e.jsx("div",{ref:a,className:"w-full h-full"}),(!l||h)&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[#020617] z-20",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] animate-pulse",children:"Initializing 3D Engine..."})]}),e.jsx(Tt,{}),e.jsx("style",{children:`
                .maplibregl-popup-content {
                    background: rgba(255, 255, 255, 0.95) !important;
                    backdrop-filter: blur(12px) !important;
                    border-radius: 16px !important;
                    padding: 0 !important;
                    box-shadow: 0 20px 40px rgba(0,0,0,0.4) !important;
                    border: 1px solid rgba(255,255,255,0.5) !important;
                    overflow: hidden !important;
                }
                .maplibregl-popup-tip { border-top-color: rgba(255, 255, 255, 0.95) !important; }
                .maplibregl-ctrl-group { background: rgba(15, 23, 42, 0.8) !important; border: 1px solid rgba(255, 255, 255, 0.1) !important; backdrop-filter: blur(8px) !important; }
                .maplibregl-ctrl button { border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important; }
                .maplibregl-ctrl-icon { filter: invert(1) !important; }
            `})]})},It=({stats:t,onProvinceClick:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),"ážŸáž„áŸ’ážáŸáž”ážáž¶áž˜ážáŸážáŸ’áž/ážšáž¶áž‡áž’áž¶áž“áž¸"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl h-[450px] lg:h-[550px] xl:h-[600px]",children:e.jsx("div",{className:"overflow-y-auto h-full custom-scrollbar",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4",children:"ážáŸážáŸ’áž/ážšáž¶áž‡áž’áž¶áž“áž¸"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[t.map((o,r)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors cursor-pointer group",onClick:()=>a==null?void 0:a(o.name),children:[e.jsx("td",{className:"px-4 py-3 font-bold text-gray-200 group-hover:text-blue-300 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-gray-700 text-[9px] text-gray-500 flex items-center justify-center border border-gray-600",children:r+1}),e.jsx("span",{className:"truncate max-w-[150px]",children:o.name})]})}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsxs("span",{className:"text-blue-400 font-black block group-hover:text-blue-300",children:["$",o.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsxs("span",{className:"text-[9px] text-gray-500 uppercase tracking-tighter group-hover:text-gray-400",children:[o.orders," orders"]})]})]},o.name)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]})]})})})]}),_t=({dateRange:t,onRangeChange:a,customStart:o,onCustomStartChange:r,customEnd:j,onCustomEndChange:h})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx("div",{className:"flex items-center gap-1 bg-gray-800/80 p-1 rounded-xl border border-gray-700 shadow-inner",children:["today","this_week","this_month","custom"].map(f=>e.jsx("button",{onClick:()=>a(f),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${t===f?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:f==="today"?"ážáŸ’áž„áŸƒáž“áŸáŸ‡":f==="this_week"?"ážŸáž”áŸ’ážáž¶áž áŸáž“áŸáŸ‡":f==="this_month"?"ážáŸ‚áž“áŸáŸ‡":"áž€áŸ†ážŽážáŸ‹"},f))})}),t==="custom"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-gray-900/40 rounded-2xl border border-gray-800 animate-fade-in-down",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"áž…áž¶áž”áŸ‹áž–áž¸"}),e.jsx("input",{type:"date",value:o,onChange:f=>r(f.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"ážŠáž›áŸ‹"}),e.jsx("input",{type:"date",value:j,onChange:f=>h(f.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]})]})]}),zt=({stats:t,onStatClick:a})=>{const o=i.useMemo(()=>t.reduce((r,j)=>({revenue:r.revenue+j.revenue,orders:r.orders+j.orders}),{revenue:0,orders:0}),[t]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-orange-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"ážƒáŸ’áž›áž¶áŸ†áž„áž”áž‰áŸ’áž…áŸáž‰áž‘áŸ†áž“áž·áž‰ (Stock)"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"ážˆáŸ’áž˜áŸ„áŸ‡ážƒáŸ’áž›áž¶áŸ†áž„ (Store)"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž…áŸ†áž“áž½áž“ Orders"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[t.map((r,j)=>e.jsxs("tr",{className:"hover:bg-orange-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",j+1]}),e.jsx("span",{className:"group-hover:text-orange-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),t.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:o.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",o.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},Ft=({currentUser:t,parsedOrders:a,dateFilter:o,setDateFilter:r,teamRevenueStats:j,provinceStats:h,storeStats:f,onTeamClick:c,onProvinceClick:l,onStoreClick:b})=>{const m=k=>new Date(k.Timestamp),y=a.filter(k=>{if(!k.Timestamp)return!1;const O=m(k),w=new Date,P=new Date(w.getFullYear(),w.getMonth(),w.getDate());if(o.preset==="today")return O.toDateString()===w.toDateString();if(o.preset==="this_week"){const v=w.getDay(),L=new Date(P);L.setDate(P.getDate()-(v===0?6:v-1));const p=new Date(L);return p.setDate(L.getDate()+6),p.setHours(23,59,59),O>=L&&O<=p}else{if(o.preset==="this_month")return O.getMonth()===w.getMonth()&&O.getFullYear()===w.getFullYear();if(o.preset==="custom"){const v=o.start?new Date(o.start+"T00:00:00"):null,L=o.end?new Date(o.end+"T23:59:59"):null;return!(v&&O<v||L&&O>L)}}return!0}),z={revenue:y.reduce((k,O)=>k+(Number(O["Grand Total"])||0),0),orders:y.length,unpaid:y.filter(k=>k["Payment Status"]==="Unpaid").length};return e.jsxs("div",{className:"space-y-6 lg:space-y-8 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-800/10 p-5 rounded-[2rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl lg:text-2xl 2xl:text-3xl font-black text-white leading-tight",children:["ážŸáž½ážŸáŸ’ážáž¸, ",t==null?void 0:t.FullName," ðŸ‘‹"]}),e.jsx("p",{className:"text-gray-500 text-xs lg:text-sm font-bold uppercase tracking-widest mt-1.5",children:new Date().toLocaleDateString("km-KH",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsx("div",{className:"w-full md:w-auto",children:e.jsx(_t,{dateRange:o.preset,onRangeChange:k=>r({...o,preset:k}),customStart:o.start,onCustomStartChange:k=>r({...o,start:k}),customEnd:o.end,onCustomEndChange:k=>r({...o,end:k})})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6",children:[e.jsx(ae,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”",value:`$${z.revenue.toLocaleString(void 0,{minimumFractionDigits:2})}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-blue-400"}),e.jsx(ae,{label:"áž…áŸ†áž“áž½áž“áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹",value:z.orders,icon:"ðŸ“¦",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(ae,{label:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž‘áž¼áž‘áž¶ážáŸ‹",value:z.unpaid,icon:"â³",colorClass:"from-orange-500 to-yellow-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-6 lg:gap-8",children:[e.jsx("div",{className:"xl:col-span-6",children:e.jsx(Dt,{stats:j,onStatClick:c})}),e.jsx("div",{className:"xl:col-span-6",children:e.jsx(zt,{stats:f,onStatClick:b})}),e.jsx("div",{className:"xl:col-span-8",children:e.jsx(At,{data:h})}),e.jsx("div",{className:"xl:col-span-4",children:e.jsx(It,{stats:h,onProvinceClick:l})})]})]})},He=t=>{const a=t["Grand Total"]||0,o=t["Total Product Cost ($)"]||0,r=t["Internal Cost"]||0;return a-o-r},Et=t=>{try{if(!t)return new Date().toISOString().slice(0,7);const a=new Date(t);return isNaN(a.getTime())?new Date().toISOString().slice(0,7):a.toISOString().slice(0,7)}catch{return new Date().toISOString().slice(0,7)}},Rt=(t,a,o)=>i.useMemo(()=>{const r=Array.isArray(a)?a.filter(v=>v&&v.UserName):[],j=Array.isArray(t)?t.filter(v=>v&&v["Grand Total"]!==void 0):[],h=Array.isArray(o)?o:[],f=j.reduce((v,L)=>v+(L["Grand Total"]||0),0),c=j.reduce((v,L)=>v+He(L),0),l=j.length,b=new Date().toISOString().slice(0,7),m=r.map(v=>{const L=j.filter(d=>d.User===v.UserName),p=L.reduce((d,N)=>d+(N["Grand Total"]||0),0),n=L.reduce((d,N)=>d+He(N),0),g=L.length,x=h.find(d=>d.UserName===v.UserName&&d.Month===b),s=(x==null?void 0:x.TargetAmount)||0,D=s>0?p/s*100:0;return{userName:v.UserName,fullName:v.FullName,profilePictureURL:v.ProfilePictureURL,team:v.Team,revenue:p,profit:n,orderCount:g,target:s,achievement:D}}),z=Array.from(new Set(r.map(v=>v.Team).filter(Boolean))).map(v=>{const L=m.filter(D=>D.team===v),p=L.reduce((D,d)=>D+d.revenue,0),n=L.reduce((D,d)=>D+d.profit,0),g=L.reduce((D,d)=>D+d.orderCount,0),x=L.reduce((D,d)=>D+d.target,0),s=x>0?p/x*100:0;return{teamName:v,revenue:p,profit:n,orderCount:g,target:x,achievement:s}}),k=z.reduce((v,L)=>v+L.target,0),O=k>0?f/k*100:0,w={};j.forEach(v=>{const L=Et(v.Timestamp);w[L]||(w[L]={revenue:0,profit:0,orders:0}),w[L].revenue+=v["Grand Total"]||0,w[L].profit+=He(v),w[L].orders+=1});const P=Object.entries(w).sort(([v],[L])=>v.localeCompare(L)).map(([v,L])=>({label:v,value:L.revenue,...L}));return{summary:{totalRevenue:f,totalProfit:c,totalOrders:l,overallTarget:k,overallAchievement:O},byUser:m,byTeam:z,monthlyTrend:P,hasData:r.length>0}},[t,a,o]),Ut=({value:t,label:a})=>{const o=Math.max(0,t),r=Math.min(o/100,1),j=80,h=14,f=j-h/2,l=2*Math.PI*f*.75,b=l*(1-r),y=o<50?"#ef4444":o<90?"#f59e0b":"#10b981";return e.jsx("div",{className:"relative flex items-center justify-center w-full max-w-[280px] mx-auto h-[220px]",children:e.jsxs("svg",{viewBox:"0 0 200 160",className:"w-full h-full transform transition-all duration-700",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gaugeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),e.jsx("stop",{offset:"50%",stopColor:"#f59e0b"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981"})]}),e.jsxs("filter",{id:"gaugeGlow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"4",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})]}),e.jsx("path",{d:`M 35 130 A ${f} ${f} 0 1 1 165 130`,fill:"none",stroke:"#1f2937",strokeWidth:h,strokeLinecap:"round",className:"opacity-40"}),e.jsx("path",{d:`M 35 130 A ${f} ${f} 0 1 1 165 130`,fill:"none",stroke:y,strokeWidth:h,strokeLinecap:"round",strokeDasharray:l,strokeDashoffset:b,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)",filter:o>0?"url(#gaugeGlow)":"none"}}),e.jsxs("g",{className:"text-center select-none",children:[e.jsx("text",{x:"100",y:"95",textAnchor:"middle",className:"text-5xl font-black fill-white tracking-tighter",children:`${Math.round(o)}%`}),a&&e.jsx("text",{x:"100",y:"122",textAnchor:"middle",className:"text-[8px] font-black uppercase tracking-[0.2em] fill-gray-500",children:a})]})]})})},lt=({data:t,title:a})=>{const[o,r]=i.useState(null);if(!t||t.length===0)return e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 min-h-[300px]",children:"No data available for chart."});const j=300,h=500,l={top:20,right:20,bottom:40,left:50},b=Math.max(...t.map(v=>v.value),0),m=b===0?0:(j-l.top-l.bottom)/b,y=(h-l.left-l.right)/(t.length-1||1),z=()=>{if(t.length<2)return"";let v=`M ${l.left},${j-l.bottom-t[0].value*m}`;return t.slice(1).forEach((L,p)=>{const n=l.left+(p+1)*y,g=j-l.bottom-L.value*m;v+=` L ${n},${g}`}),v},k=(v,L)=>{const p=v.currentTarget.getBoundingClientRect(),n=`${L.label}: $${L.value.toLocaleString(void 0,{maximumFractionDigits:2})}`;r({visible:!0,x:p.left+window.scrollX,y:p.top+window.scrollY,content:n})},O=()=>{r(null)},P=(v=>{if(v===0)return[0];const L=5,p=Math.ceil(v/L/10)*10;return p===0?[0,v]:Array.from({length:L+1},(n,g)=>g*p).filter(n=>n<=v*1.1)})(b);return e.jsxs("div",{className:"relative",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-white text-center",children:a}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("svg",{viewBox:`0 0 ${h} ${j}`,className:"min-w-[500px]",preserveAspectRatio:"xMinYMin meet",children:[e.jsx("g",{className:"y-axis",children:P.map(v=>e.jsxs("g",{transform:`translate(0, ${j-l.bottom-v*m})`,children:[e.jsx("line",{x1:l.left-5,y1:"0",x2:h-l.right,y2:"0",stroke:"#374151"}),e.jsx("text",{x:l.left-10,y:"3",textAnchor:"end",fill:"#9ca3af",fontSize:"12",children:v>=1e3?`${(v/1e3).toFixed(0)}k`:v})]},v))}),e.jsx("g",{className:"x-axis",children:t.map((v,L)=>e.jsx("text",{x:l.left+L*y,y:j-l.bottom+20,textAnchor:"middle",fill:"#9ca3af",fontSize:"12",children:v.label},L))}),e.jsx("path",{d:z(),fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),t.map((v,L)=>e.jsx("circle",{cx:l.left+L*y,cy:j-l.bottom-v.value*m,r:"4",fill:"#3b82f6",stroke:"#111827",strokeWidth:"2",onMouseOver:p=>k(p,v),onMouseOut:O,className:"cursor-pointer"},L))]})}),o&&e.jsx("div",{className:"fixed p-2 text-xs text-white bg-gray-900 border border-gray-600 rounded-md shadow-lg z-50",style:{left:o.x,top:o.y-35,pointerEvents:"none",transform:"translateX(-50%)"},children:o.content})]})},Bt=({summary:t,monthlyTrend:a})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 animate-fade-in",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ae,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Revenue)",value:`$${t.totalRevenue.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"})}),colorClass:"from-blue-600 to-blue-400"}),e.jsx(ae,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Profit)",value:`$${t.totalProfit.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),colorClass:"from-emerald-600 to-green-400"}),e.jsx(ae,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹ážŸážšáž»áž” (Orders)",value:t.totalOrders,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),colorClass:"from-purple-600 to-pink-400"}),e.jsx(ae,{label:"áž‚áŸ„áž›ážŠáŸ…ážŸážšáž»áž” (Overall Target)",value:t.overallTarget>0?`$${t.overallTarget.toLocaleString()}`:"N/A",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),colorClass:"from-orange-500 to-yellow-400"})]}),e.jsx("div",{className:"glass-card p-6 rounded-2xl shadow-xl border border-gray-700/50",children:e.jsx(lt,{data:a,title:"áž“áž·áž“áŸ’áž“áž¶áž€áž¶ážšáž…áŸ†ážŽáž¼áž› (Revenue Trend)"})})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"glass-card p-8 rounded-2xl shadow-xl flex flex-col items-center justify-center h-full min-h-[400px]",children:[e.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em] mb-8",children:"ážœážŒáŸ’ážáž“áž—áž¶áž–áž‚áŸ„áž›ážŠáŸ…ážšáž½áž˜"}),e.jsx(Ut,{value:t.overallAchievement,label:"Overall Achievement"}),e.jsx("div",{className:"mt-10 grid grid-cols-1 gap-4 w-full",children:e.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase mb-1",children:"áž“áŸ…ážáŸ’ážœáŸ‡ (To Target)"}),e.jsxs("p",{className:"text-2xl font-black text-white",children:["$",Math.max(0,t.overallTarget-t.totalRevenue).toLocaleString()]})]})})]})})]}),st=({rank:t})=>{const a={1:{emoji:"ðŸ¥‡",bg:"bg-yellow-500/20",border:"border-yellow-500/50",text:"text-yellow-500",glow:"shadow-[0_0_15px_rgba(234,179,8,0.4)]"},2:{emoji:"ðŸ¥ˆ",bg:"bg-gray-300/20",border:"border-gray-300/50",text:"text-gray-300",glow:"shadow-[0_0_15px_rgba(209,213,219,0.3)]"},3:{emoji:"ðŸ¥‰",bg:"bg-orange-600/20",border:"border-orange-600/50",text:"text-orange-600",glow:"shadow-[0_0_15px_rgba(234,88,12,0.3)]"}}[t];return a?e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${a.bg} ${a.border} ${a.text} ${a.glow} border-2 animate-bounce-slow`,children:e.jsx("span",{className:"text-xl",children:a.emoji})}):e.jsxs("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-gray-800 border border-gray-700 text-gray-500 font-black text-sm italic",children:["#",t]})},Wt=({data:t,metric:a,onMetricChange:o,datePreset:r,previewImage:j})=>{const h=c=>c>=100?"text-emerald-400":c>=70?"text-yellow-400":"text-red-400",f=c=>c>=100?"bg-emerald-500":c>=70?"bg-yellow-500":"bg-red-500";return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white tracking-tight",children:"ážáž¶ážšáž¶áž„áž…áŸ†ážŽáž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹áž¢áŸ’áž“áž€áž›áž€áŸ‹áž†áŸ’áž“áž¾áž˜"}),e.jsxs("p",{className:"text-gray-500 text-xs mt-1 uppercase tracking-wider font-bold",children:["áž•áŸ’áž¢áŸ‚áž€áž›áž¾: ",r.replace("_"," ")]})]}),e.jsx("div",{className:"flex bg-gray-900/50 p-1 rounded-xl border border-gray-800",children:["revenue","orderCount","achievement"].map(c=>e.jsx("button",{onClick:()=>o(c),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${a===c?"bg-gray-700 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:c==="revenue"?"áž…áŸ†ážŽáž¼áž›":c==="orderCount"?"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹":"% ážŸáž˜áŸ’ážšáŸáž…"},c))})]}),e.jsxs("div",{className:"glass-card rounded-3xl shadow-2xl overflow-hidden border border-gray-700/50",children:[e.jsx("div",{className:"block md:hidden divide-y divide-gray-800",children:t.map((c,l)=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(st,{rank:l+1}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_e,{avatarUrl:c.profilePictureURL,name:c.fullName,size:"sm",className:"ring-2 ring-blue-500/20"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white leading-none",children:c.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1 font-bold",children:c.team})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-black text-blue-400",children:["$",c.revenue.toLocaleString()]}),e.jsxs("p",{className:`text-[10px] font-bold ${h(c.achievement)}`,children:[c.achievement.toFixed(1),"%"]})]})]},c.userName))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-800",children:[e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center w-24",children:"Rank"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"áž¢áŸ’áž“áž€áž›áž€áŸ‹"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center",children:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"áž€áž¶ážšážŸáž˜áŸ’ážšáŸáž…áž‚áŸ„áž›ážŠáŸ… (%)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800/50",children:t.map((c,l)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-all group",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(st,{rank:l+1})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_e,{avatarUrl:c.profilePictureURL,name:c.fullName,size:"md",className:"border border-gray-700 shadow-md group-hover:scale-110 transition-transform",onClick:()=>j(he(c.profilePictureURL))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white group-hover:text-blue-300 transition-colors",children:c.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black tracking-tighter",children:c.team})]})]})}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-blue-400 font-black text-lg",children:["$",c.revenue.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-center font-black text-gray-300",children:c.orderCount}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`text-xs font-black mb-1.5 ${h(c.achievement)}`,children:[c.achievement.toFixed(1),"%"]}),e.jsx("div",{className:"w-32 h-1.5 bg-gray-800 rounded-full overflow-hidden border border-gray-700 shadow-inner",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out progress-glow ${f(c.achievement)}`,style:{width:`${Math.min(c.achievement,100)}%`}})})]})})]},c.userName))})]})})]})]})},Vt=({data:t})=>{const a=r=>r>=100?"text-emerald-400":r>=70?"text-yellow-400":"text-red-400",o=r=>r>=100?"bg-emerald-500":r>=70?"bg-yellow-500":"bg-red-500";return e.jsx("div",{className:"animate-fade-in grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:t.map(r=>e.jsxs("div",{className:"glass-card p-6 rounded-3xl shadow-xl hover:border-blue-500/50 transition-all group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_e,{avatarUrl:r.profilePictureURL,name:r.fullName,size:"md",className:"ring-4 ring-blue-500/10 group-hover:ring-blue-500/20 transition-all"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black leading-none mb-1 group-hover:text-blue-300 transition-colors",children:r.fullName}),e.jsx("span",{className:"text-[9px] bg-blue-900/40 text-blue-300 px-2.5 py-0.5 rounded-full font-black uppercase tracking-wider border border-blue-500/20",children:r.team||"No Team"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest mb-1",children:"áž‚áŸ„áž›ážŠáŸ…ážáŸ‚áž“áŸáŸ‡"}),e.jsxs("p",{className:"text-blue-400 font-black text-lg tracking-tight",children:["$",r.target.toLocaleString()]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"ážœážŒáŸ’ážáž“áž—áž¶áž–ážŸáž˜áŸ’ážšáŸáž…áž”áž¶áž“"}),e.jsxs("span",{className:`text-sm font-black ${a(r.achievement)}`,children:[r.achievement.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full h-3.5 bg-gray-900 rounded-full overflow-hidden border border-gray-800 shadow-inner p-0.5",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out shadow-[0_0_8px_rgba(0,0,0,0.5)] ${o(r.achievement)}`,style:{width:`${Math.min(r.achievement,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-800/50",children:[e.jsxs("div",{className:"bg-gray-900/30 p-3 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"áž›áž€áŸ‹áž”áž¶áž“"}),e.jsxs("p",{className:"text-white font-black",children:["$",r.revenue.toLocaleString()]})]}),e.jsxs("div",{className:`p-3 rounded-xl border ${r.achievement>=100?"bg-emerald-900/10 border-emerald-900/30":"bg-red-900/10 border-red-900/30"}`,children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"áž“áŸ…ážŸáž›áŸ‹"}),e.jsx("p",{className:`font-black ${r.achievement>=100?"text-emerald-400":"text-red-400"}`,children:r.achievement>=100?"SUCCESS ðŸ†":`$${Math.max(0,r.target-r.revenue).toLocaleString()}`})]})]})]})]},r.userName))})},Gt=({orders:t,users:a,targets:o})=>{const{previewImage:r,setMobilePageTitle:j}=i.useContext(le),[h,f]=i.useState("overview"),[c,l]=i.useState({datePreset:"this_month",team:"",store:""}),[b,m]=i.useState("revenue");i.useEffect(()=>(j("PERFORMANCE"),()=>j(null)),[j]);const y=i.useMemo(()=>{const n=new Set;return t.forEach(g=>{g["Fulfillment Store"]&&n.add(g["Fulfillment Store"])}),Array.from(n).sort()},[t]),z=i.useMemo(()=>{const n=new Set;return t.forEach(g=>{g.Team&&n.add(g.Team)}),Array.from(n).sort()},[t]),k=i.useMemo(()=>{const n=new Date;let g=null,x=new Date;switch(c.datePreset){case"this_month":g=new Date(n.getFullYear(),n.getMonth(),1);break;case"last_month":g=new Date(n.getFullYear(),n.getMonth()-1,1),x=new Date(n.getFullYear(),n.getMonth(),0,23,59,59);break;case"quarter":const s=Math.floor(n.getMonth()/3);g=new Date(n.getFullYear(),s*3,1);break;case"year":g=new Date(n.getFullYear(),0,1);break;case"all":g=null,x=null;break}return t.filter(s=>{if(!s.Timestamp)return!1;const D=new Date(s.Timestamp),d=(!g||D>=g)&&(!x||D<=x),N=!c.team||s.Team===c.team,u=!c.store||s["Fulfillment Store"]===c.store;return d&&N&&u})},[t,c]),O=Rt(k,a,o),w=i.useMemo(()=>O?[...O.byUser].sort((n,g)=>g[b]-n[b]):[],[O,b]);if(!O.hasData&&a.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500 page-card",children:[e.jsx("svg",{className:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.jsx("p",{className:"text-lg font-bold",children:"ážšáž€áž˜áž·áž“ážƒáž¾áž‰áž‘áž·áž“áŸ’áž“áž“áŸáž™áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹"}),e.jsx("p",{className:"text-sm",children:"ážŸáž¼áž˜áž”áŸ’ážšáž¶áž€ážŠážáž¶áž¢áŸ’áž“áž€áž”áž¶áž“áž”áž„áŸ’áž€áž¾ážáž‚ážŽáž“áž¸áž¢áŸ’áž“áž€áž›áž€áŸ‹áž€áŸ’áž“áž»áž„áž”áŸ’ážšáž–áŸáž“áŸ’áž’áŸ”"})]});const{summary:P,byUser:v,monthlyTrend:L}=O,p=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center bg-gray-800/20 border-2 border-dashed border-gray-700 rounded-3xl animate-fade-in",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‡áž˜áŸ’ážšáž¾ážŸáž“áŸáŸ‡"}),e.jsx("p",{className:"text-gray-400 max-w-xs mx-auto mb-6 text-sm",children:'ážŸáž¼áž˜ážŸáž¶áž€áž›áŸ’áž”áž„áž”áŸ’ážáž¼ážš "áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘" áž¬ "áž€áŸ’ážšáž»áž˜/Store" ážŠáž¾áž˜áŸ’áž”áž¸áž˜áž¾áž›áž‘áž·áž“áŸ’áž“áž“áŸáž™áž•áŸ’ážŸáŸáž„áž‘áŸ€ážáŸ”'}),e.jsx("button",{onClick:()=>l({...c,datePreset:"all",team:"",store:""}),className:"btn btn-secondary text-xs",children:"áž”áž„áŸ’áž áž¶áž‰áž‘áž·áž“áŸ’áž“áž“áŸáž™áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Time)"})]});return e.jsxs("div",{className:"space-y-6 animate-fade-in px-2 sm:px-0 pb-12",children:[e.jsx("style",{children:`
                @keyframes bounce-slow { 0%, 100% { transform: translateY(-5%); } 50% { transform: translateY(0); } }
                .animate-bounce-slow { animation: bounce-slow 3s infinite ease-in-out; }
                .glass-card { background: rgba(31, 41, 55, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(75, 85, 99, 0.3); }
                .progress-glow { filter: drop-shadow(0 0 4px currentColor); }
            `}),e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsx("div",{className:"flex bg-gray-800/80 p-1.5 rounded-2xl border border-gray-700 backdrop-blur-md shadow-inner",children:["overview","leaderboard","targets"].map(n=>e.jsx("button",{onClick:()=>f(n),className:`px-5 py-2.5 text-xs font-black rounded-xl transition-all duration-300 ${h===n?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:n==="overview"?"áž‘áž·áž“áŸ’áž“áž“áŸáž™ážŸáž„áŸ’ážáŸáž”":n==="leaderboard"?"áž…áŸ†ážŽáž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹":"áž‚áŸ„áž›ážŠáŸ…"},n))}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full lg:w-auto",children:[e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-blue-400 cursor-pointer w-full sm:w-auto",value:c.datePreset,onChange:n=>l({...c,datePreset:n.target.value}),children:[e.jsx("option",{value:"this_month",children:"ážáŸ‚áž“áŸáŸ‡"}),e.jsx("option",{value:"last_month",children:"ážáŸ‚áž˜áž»áž“"}),e.jsx("option",{value:"quarter",children:"ážáŸ’ážšáž¸áž˜áž¶ážŸáž“áŸáŸ‡"}),e.jsx("option",{value:"year",children:"áž†áŸ’áž“áž¶áŸ†áž“áŸáŸ‡"}),e.jsx("option",{value:"all",children:"áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹"})]})]}),e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"Store:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-emerald-400 cursor-pointer w-full sm:w-auto",value:c.store,onChange:n=>l({...c,store:n.target.value}),children:[e.jsx("option",{value:"",children:"All Stores"}),y.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"Team:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-purple-400 cursor-pointer w-full sm:w-auto",value:c.team,onChange:n=>l({...c,team:n.target.value}),children:[e.jsx("option",{value:"",children:"All Teams"}),z.map(n=>e.jsx("option",{value:n,children:n},n))]})]})]})]}),h==="overview"&&(P.totalRevenue===0?e.jsx(p,{}):e.jsx(Bt,{summary:P,monthlyTrend:L})),h==="leaderboard"&&e.jsx(Wt,{data:w,metric:b,onMetricChange:m,datePreset:c.datePreset,previewImage:r}),h==="targets"&&(v.length===0?e.jsx("div",{className:"col-span-full py-12 text-center text-gray-500",children:"áž˜áž·áž“áž˜áž¶áž“áž–áŸážáŸŒáž˜áž¶áž“áž‚áŸ„áž›ážŠáŸ…áž¢áŸ’áž“áž€áž›áž€áŸ‹ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‡áž˜áŸ’ážšáž¾ážŸáž“áŸáŸ‡"}):e.jsx(Vt,{data:v}))]})},Ae=({orders:t,reportType:a,dateFilter:o,startDate:r,endDate:j,onNavigate:h,contextFilters:f})=>{const{appData:c}=i.useContext(le),[l,b]=i.useState(""),[m,y]=i.useState(!1);if(a==="shipping")return e.jsx(mt,{orders:t,appData:c,dateFilter:o,startDate:r,endDate:j,onNavigate:h,contextFilters:f});const z=i.useMemo(()=>{const O=t.reduce((p,n)=>p+(Number(n["Grand Total"])||0),0),w=t.reduce((p,n)=>p+(Number(n["Total Product Cost ($)"])||0),0),P=t.reduce((p,n)=>p+(Number(n["Internal Cost"])||0),0),v=O-w-P,L=O>0?v/O*100:0;return{revenue:O,totalOrders:t.length,totalProfit:v,margin:L,shippingCost:P}},[t]),k=async()=>{y(!0);try{const w=await ht(z,{reportType:a});b(w)}catch{b("AI Analysis error.")}finally{y(!1)}};return e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ae,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”",value:`$${z.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-blue-400"}),e.jsx(ae,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹",value:z.totalOrders,icon:"ðŸ“¦",colorClass:"from-indigo-600 to-indigo-400"}),e.jsx(ae,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰",value:`$${z.totalProfit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(ae,{label:"Margin (%)",value:`${z.margin.toFixed(1)}%`,icon:"âš–ï¸",colorClass:"from-amber-500 to-orange-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-8 bg-gray-900/40 border-white/5 h-full min-h-[400px]",children:e.jsx(lt,{data:[],title:"áž“áž·áž“áŸ’áž“áž¶áž€áž¶ážšáž…áŸ†ážŽáž¼áž› (Revenue Over Time)"})})}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"page-card !p-8 bg-gray-900/40 border-white/5 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h3",{className:"text-sm font-black text-white uppercase tracking-widest",children:"AI Insights"}),e.jsx(ut,{onClick:k,isLoading:m,children:"Analyze"})]}),e.jsx("div",{className:"flex-grow bg-black/40 rounded-3xl p-6 border border-white/5 overflow-y-auto",children:l?e.jsx("div",{className:"text-sm text-gray-300",children:l}):e.jsx("p",{className:"text-[10px] opacity-20 text-center uppercase font-black",children:"Ready for Analysis"})})]})})]})]})},Se=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ht=({orders:t,onBack:a})=>{const{appData:o}=i.useContext(le),[r,j]=i.useState(!0),[h,f]=i.useState(!1),[c,l]=i.useState(!0),[b,m]=i.useState("revenue"),[y,z]=i.useState({key:"revenue",direction:"desc"}),[k,O]=i.useState(!1),w=x=>{z(s=>({key:x,direction:s.key===x&&s.direction==="desc"?"asc":"desc"}))},P=i.useMemo(()=>{const x={};return t.forEach(s=>{var u,C,S;let D=s.Team||s.User&&((S=(C=(u=o.users)==null?void 0:u.find($=>$.UserName===s.User))==null?void 0:C.Team)==null?void 0:S.split(",")[0].trim())||"Unassigned";x[D]||(x[D]={name:D,revenue:0,profit:0,orders:0,members:new Set},Se.forEach($=>{x[D][`rev_${$}`]=0,x[D][`prof_${$}`]=0}));const d=Number(s["Grand Total"])||0,N=(Number(s["Total Product Cost ($)"])||0)+(Number(s["Internal Cost"])||0);if(x[D].revenue+=d,x[D].profit+=d-N,x[D].orders+=1,s.User&&x[D].members.add(s.User),s.Timestamp){const $=new Date(s.Timestamp),A=Se[$.getMonth()];x[D][`rev_${A}`]+=d,x[D][`prof_${A}`]+=d-N}}),Object.values(x).sort((s,D)=>{const d=y.direction==="asc"?1:-1,N=s[y.key],u=D[y.key];return typeof N=="string"?N.localeCompare(u)*d:(N-u)*d})},[t,y,o.users]),v=i.useMemo(()=>{const x={revenue:0,profit:0,orders:0};return Se.forEach(s=>{x[`rev_${s}`]=0,x[`prof_${s}`]=0}),P.forEach(s=>{x.revenue+=s.revenue,x.profit+=s.profit,x.orders+=s.orders,Se.forEach(D=>{x[`rev_${D}`]+=s[`rev_${D}`],x[`prof_${D}`]+=s[`prof_${D}`]})}),x},[P]),L=()=>{O(!0),setTimeout(()=>{try{const x=new Be({orientation:"landscape"}),s=x.internal.pageSize.width;x.setFontSize(18),x.text("Sales Report by Team",s/2,15,{align:"center"}),x.save(`Team_Sales_Report_${Date.now()}.pdf`)}catch(x){console.error(x)}finally{O(!1)}},100)},p=i.useMemo(()=>P.slice(0,10).map(x=>({label:x.name,value:x.revenue})),[P]),n=(x,s)=>{const d=[{key:"index",label:"#"},{key:"teamName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜ (Team)",sortable:!0,sortKey:"name"},{key:`total${x}`,label:`ážŸážšáž»áž” (${x})`,sortable:!0,sortKey:x.toLowerCase()},...Se.map(N=>({key:`${s}_${N}`,label:N}))];return e.jsxs("div",{className:"hidden md:flex page-card flex-col mb-8 !p-6 border-gray-700/50 shadow-xl overflow-hidden bg-gray-900/40",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:`text-xl font-black flex items-center gap-2 ${x==="Revenue"?"text-blue-300":"text-green-400"}`,children:[e.jsx("span",{className:`w-2 h-6 rounded-full ${x==="Revenue"?"bg-blue-600":"bg-green-600"}`}),"ážáž¶ážšáž¶áž„",x==="Revenue"?"áž…áŸ†ážŽáž¼áž›":"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰","ážáž¶áž˜áž€áŸ’ážšáž»áž˜"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x==="Revenue"&&e.jsxs("button",{onClick:L,disabled:k,className:"btn !py-1 !px-4 text-[10px] font-black bg-red-600/20 border border-red-500/30 text-red-400 hover:bg-red-600 hover:text-white transition-all flex items-center gap-2",children:[k?e.jsx(se,{size:"sm"}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"EXPORT PDF"]}),e.jsx("button",{onClick:()=>l(!c),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${c?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"COLOR"}),e.jsx("button",{onClick:()=>f(!h),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${h?"bg-blue-600 border-blue-500 text-white shadow-lg":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"FREEZE"}),e.jsx("button",{onClick:()=>j(!r),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${r?"bg-gray-700 border-gray-600 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"BORDER"})]})]}),e.jsx("div",{className:`overflow-x-auto custom-scrollbar pb-2 ${r?"border-2 border-white/10 rounded-2xl shadow-[0_0_30px_rgba(0,0,0,0.5)]":""}`,children:e.jsxs("table",{className:`report-table w-full border-separate border-spacing-0 text-sm ${r?"border-collapse":""}`,children:[e.jsx("thead",{className:"bg-[#0f172a] backdrop-blur-md",children:e.jsx("tr",{className:"border-b-2 border-white/20",children:d.map(N=>{let u="",C={};h&&(N.key==="index"?(u="sticky left-0 z-30 bg-[#0f172a]",C={width:"45px",minWidth:"45px"}):N.key==="teamName"?(u="sticky left-[45px] z-30 bg-[#0f172a] border-r border-white/10 shadow-md",C={width:"140px",minWidth:"140px"}):N.key.includes("total")&&(u="sticky left-[185px] z-30 bg-[#0f172a] border-r border-white/10 shadow-lg",C={width:"100px",minWidth:"100px"}));const S=N.key.includes("total")?x==="Revenue"?"bg-blue-900/80":"bg-green-900/80":"";return e.jsx("th",{onClick:()=>N.sortable&&w(N.sortKey),className:`px-4 py-5 whitespace-nowrap text-left font-black uppercase tracking-wider border-b-2 border-white/20 ${r?"border-x border-white/5":""} ${u} ${S} ${N.sortable?"cursor-pointer hover:bg-gray-700":""}`,style:C,children:e.jsxs("div",{className:"flex items-center gap-1",children:[N.label," ",N.sortable&&y.key===N.sortKey&&e.jsx("span",{children:y.direction==="asc"?"â†‘":"â†“"})]})},N.key)})})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:P.map((N,u)=>{const C=Array.from(String(N.name)).reduce((A,F)=>A+F.charCodeAt(0),0)%5,$=c?["bg-blue-500/5","bg-purple-500/5","bg-emerald-500/5","bg-orange-500/5","bg-pink-500/5"][C]:"hover:bg-blue-500/5";return e.jsx("tr",{className:`${$} transition-colors group border-b border-white/5`,children:d.map(A=>{const F=`px-4 py-4 lg:py-5 whitespace-nowrap border-white/5 ${r?"border-x border-white/5":""}`;let W="",U={};if(h&&(A.key==="index"?(W="sticky left-0 z-10 bg-[#020617]",U={width:"45px",minWidth:"45px"}):A.key==="teamName"?(W="sticky left-[45px] z-10 bg-[#020617] border-r border-white/5 shadow-md",U={width:"140px",minWidth:"140px"}):A.key.includes("total")&&(W="sticky left-[185px] z-10 bg-[#020617] border-r border-white/5 shadow-lg",U={width:"100px",minWidth:"100px"})),A.key==="index")return e.jsx("td",{className:`${F} text-center font-bold text-gray-500 ${W}`,style:U,children:u+1},A.key);if(A.key==="teamName")return e.jsx("td",{className:`${F} font-black text-white ${W}`,style:U,children:N.name},A.key);if(A.key.includes("total"))return e.jsxs("td",{className:`${F} text-right font-black ${W} ${x==="Revenue"?"text-blue-200 bg-blue-600/10":"text-green-200 bg-green-600/10"}`,style:U,children:["$",(x==="Revenue"?N.revenue:N.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},A.key);if(A.key.startsWith(s)){const I=N[A.key]||0,Y=x==="Profit"?I>0?"text-green-400":I<0?"text-red-400":"text-gray-500":I>0?"text-blue-300":"text-gray-500";return e.jsx("td",{className:`${F} text-right font-bold font-mono ${Y}`,children:I!==0?`$${I.toLocaleString(void 0,{minimumFractionDigits:2})}`:"-"},A.key)}return e.jsx("td",{className:F,children:"-"},A.key)})},N.name)})}),e.jsx("tfoot",{className:"bg-[#0f172a] font-black border-t-2 border-white/20",children:e.jsx("tr",{className:"border-t-2 border-white/20",children:d.map((N,u)=>{const C=`px-4 py-5 whitespace-nowrap border-t-2 border-white/20 ${r?"border-x border-white/5":""}`;let S="",$={};return h&&(N.key==="index"?(S="sticky left-0 z-30 bg-[#0f172a]",$={width:"45px",minWidth:"45px"}):N.key==="teamName"?(S="sticky left-[45px] z-30 bg-[#0f172a] shadow-md",$={width:"140px",minWidth:"140px"}):N.key.includes("total")&&(S="sticky left-[185px] z-30 bg-[#0f172a] shadow-lg",$={width:"100px",minWidth:"100px"})),u===0?e.jsx("td",{className:`${C} uppercase tracking-widest text-white font-black ${S}`,style:$,colSpan:2,children:"ážŸážšáž»áž”ážšáž½áž˜ (GRAND TOTAL)"},N.key):N.key==="teamName"?null:N.key.includes("total")?e.jsxs("td",{className:`${C} text-right ${S} ${x==="Revenue"?"text-blue-400 bg-blue-600/10":"text-green-400 bg-green-600/10"}`,style:$,children:["$",(x==="Revenue"?v.revenue:v.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},N.key):N.key.startsWith(s)?e.jsxs("td",{className:`${C} text-right text-gray-300 font-mono`,children:["$",v[N.key].toLocaleString(void 0,{minimumFractionDigits:2})]},N.key):e.jsx("td",{className:C},N.key)})})})]})})]})},g=()=>e.jsxs("div",{className:"md:hidden space-y-6 pb-12 px-1",children:[e.jsxs("div",{className:"flex bg-gray-900/60 p-1 rounded-2xl border border-white/10 shadow-inner",children:[e.jsx("button",{onClick:()=>m("revenue"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${b==="revenue"?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-gray-500"}`,children:"áž…áŸ†ážŽáž¼áž› (Revenue)"}),e.jsx("button",{onClick:()=>m("profit"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${b==="profit"?"bg-emerald-600 text-white shadow-lg shadow-emerald-600/20":"text-gray-500"}`,children:"áž…áŸ†ážŽáŸáž‰ (Profit)"})]}),e.jsx("div",{className:"space-y-4",children:P.map((x,s)=>{const D=b==="revenue"?x.revenue:x.profit,d=b==="revenue"?v.revenue:v.profit,N=D/(d||1)*100;return e.jsxs("div",{className:"bg-gray-800/40 border border-white/10 rounded-[2.5rem] p-6 shadow-xl space-y-5 animate-fade-in-up group relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start border-b border-white/5 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-10 h-10 bg-gray-950 rounded-2xl flex items-center justify-center border border-gray-700 text-gray-500 font-black text-xs shadow-inner",children:["#",s+1]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-black text-white uppercase tracking-tight",children:x.name}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest mt-0.5",children:[x.orders," Orders Total"]})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest ${b==="revenue"?"bg-blue-600/10 text-blue-400":"bg-emerald-600/10 text-emerald-400"}`,children:b==="revenue"?"Revenue Node":"Profit Node"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"ážŸážšáž»áž”áž”áŸ’ážšáž…áž¶áŸ†ážáŸ‚"}),e.jsxs("p",{className:`text-xl font-black ${b==="revenue"?"text-blue-400":"text-emerald-400"}`,children:["$",D.toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5 flex flex-col justify-center",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"áž…áŸ†ážŽáŸ‚áž€áž‘áž¸áž•áŸ’ážŸáž¶ážš"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-white font-black text-sm",children:[N.toFixed(1),"%"]}),e.jsx("div",{className:"flex-grow h-1 bg-gray-900 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${b==="revenue"?"bg-blue-500":"bg-emerald-500"}`,style:{width:`${Math.min(100,N)}%`}})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"Monthly Breakdown (Recent 3)"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Se.slice(-3).map(u=>e.jsxs("div",{className:"bg-gray-900/50 p-2 rounded-xl border border-white/5 text-center",children:[e.jsx("p",{className:"text-[8px] text-gray-600 font-bold uppercase mb-0.5",children:u}),e.jsxs("p",{className:"text-[10px] text-gray-300 font-black",children:["$",(x[`${b==="revenue"?"rev":"prof"}_${u}`]||0).toLocaleString(void 0,{maximumFractionDigits:0})]})]},u))})]}),e.jsx("div",{className:`absolute -right-10 -bottom-10 w-32 h-32 rounded-full blur-[50px] opacity-10 transition-colors ${b==="revenue"?"bg-blue-600":"bg-emerald-600"}`})]},x.name)})})]});return e.jsxs("div",{className:"w-full space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(ae,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Revenue)",value:`$${v.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(ae,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Profit)",value:`$${v.profit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-teal-500"}),e.jsx(ae,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹ážŸážšáž»áž” (Orders)",value:v.orders,icon:"ðŸ“¦",colorClass:"from-purple-600 to-pink-500"})]}),e.jsxs("div",{className:"hidden md:block space-y-8",children:[n("Revenue","rev"),n("Profit","prof")]}),e.jsx(g,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pb-10",children:[e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(at,{data:p,title:"áž…áŸ†ážŽáž¼áž›ážáž¶áž˜áž€áŸ’ážšáž»áž˜ (Top Teams Revenue)"})}),e.jsxs("div",{className:"page-card !p-6 bg-gray-800/40 border-gray-700/50 flex flex-col justify-center",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-blue-500 rounded-full"})," ážŸáŸ’ážáž·ážáž·áž€áŸ’ážšáž»áž˜áž›áž€áŸ‹"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž…áŸ†áž“áž½áž“áž€áŸ’ážšáž»áž˜ážŸáž€áž˜áŸ’áž˜:"}),e.jsx("span",{className:"text-white font-black text-lg",children:P.length})]}),e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚áž…áŸ†ážŽáž¼áž›/áž€áŸ’ážšáž»áž˜:"}),e.jsxs("span",{className:"text-blue-400 font-black text-lg",children:["$",(v.revenue/(P.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚áž…áŸ†ážŽáŸáž‰/áž€áŸ’ážšáž»áž˜:"}),e.jsxs("span",{className:"text-emerald-400 font-black text-lg",children:["$",(v.profit/(P.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},Ie=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Yt=({orders:t,onBack:a,onNavigate:o,contextFilters:r,dateFilter:j,startDate:h,endDate:f})=>{const{appData:c,previewImage:l}=i.useContext(le),[b,m]=i.useState(!0),[y,z]=i.useState(!1),[k,O]=i.useState({key:"teamName",direction:"asc"}),w=s=>{O(D=>({key:s,direction:D.key===s&&D.direction==="desc"?"asc":"desc"}))},P=()=>{const s={};return r&&(r.team&&(s.team=r.team),r.store&&(s.store=r.store),r.paymentStatus&&(s.paymentStatus=r.paymentStatus),r.user&&(s.user=r.user),r.fulfillmentStore&&(s.fulfillmentStore=r.fulfillmentStore),r.location&&(s.location=r.location),r.shippingService&&(s.shipping=r.shippingService),r.driver&&(s.driver=r.driver),r.bank&&(s.bank=r.bank),r.product&&(s.product=r.product),r.internalCost&&(s.internalCost=r.internalCost)),s},v=(s,D)=>{if(o){const d=P();s==="page"&&(d.page=D),s==="team"&&(d.team=D),d.datePreset=j,d.startDate=h,d.endDate=f,o(d)}},L=(s,D)=>{if(o){const d=P(),N=new Date().getFullYear(),u=j==="last_year"?N-1:N,C=new Date(u,D,1),S=new Date(u,D+1,0,23,59,59),$=A=>{const F=A.getFullYear(),W=String(A.getMonth()+1).padStart(2,"0"),U=String(A.getDate()).padStart(2,"0");return`${F}-${W}-${U}`};d.page=s,d.datePreset="custom",d.startDate=$(C),d.endDate=$(S),o(d)}},p=i.useMemo(()=>{const s={};c.pages&&c.pages.forEach(d=>{s[d.PageName]={pageName:d.PageName,teamName:d.Team||"Unassigned",logoUrl:d.PageLogoURL||"",revenue:0,profit:0,orderCount:0},Ie.forEach(N=>{s[d.PageName][`rev_${N}`]=0,s[d.PageName][`prof_${N}`]=0})}),t.forEach(d=>{var S;const N=d.Page||"Unknown";if(!s[N]){const $=(S=c.pages)==null?void 0:S.find(A=>A.PageName===N);s[N]={pageName:N,teamName:d.Team||"Unassigned",logoUrl:($==null?void 0:$.PageLogoURL)||"",revenue:0,profit:0,orderCount:0},Ie.forEach(A=>{s[N][`rev_${A}`]=0,s[N][`prof_${A}`]=0})}const u=Number(d["Grand Total"])||0,C=(Number(d["Total Product Cost ($)"])||0)+(Number(d["Internal Cost"])||0);if(s[N].revenue+=u,s[N].profit+=u-C,s[N].orderCount+=1,d.Timestamp){const $=new Date(d.Timestamp),A=Ie[$.getMonth()];s[N][`rev_${A}`]+=u,s[N][`prof_${A}`]+=u-C}});let D=Object.values(s);return b||(D=D.filter(d=>d.revenue>0)),D.sort((d,N)=>{const u=k.direction==="asc"?1:-1,C=d[k.key],S=N[k.key];return typeof C=="string"?C.localeCompare(S)*u:(C-S)*u})},[t,k,c.pages,b]),n=i.useMemo(()=>{const s={revenue:0,profit:0,pagesCount:p.length};return Ie.forEach(D=>{s[`rev_${D}`]=0,s[`prof_${D}`]=0}),p.forEach(D=>{s.revenue+=D.revenue,s.profit+=D.profit,Ie.forEach(d=>{s[`rev_${d}`]+=D[`rev_${d}`],s[`prof_${d}`]+=D[`prof_${d}`]})}),s},[p]),g=()=>{z(!0),setTimeout(()=>{try{const s=new Be({orientation:"landscape"}),D=s.internal.pageSize.width;s.setFontSize(18),s.text("Sales Report by Page",D/2,15,{align:"center"}),s.save(`Page_Sales_Report_${Date.now()}.pdf`)}catch(s){console.error(s),alert("Export failed")}finally{z(!1)}},100)},x=i.useMemo(()=>[...p].sort((s,D)=>D.revenue-s.revenue).slice(0,5).map(s=>({label:s.pageName,value:s.revenue,imageUrl:s.logoUrl})),[p]);return e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ae,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Total Rev)",value:`$${n.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(ae,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Total Profit)",value:`$${n.profit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-green-500"})]}),e.jsx(pt,{data:p,grandTotals:n,sortConfig:k,onToggleSort:w,showAllPages:b,setShowAllPages:m,onExportPDF:g,isExporting:y,onPreviewImage:l,onNavigate:v,onMonthClick:L}),e.jsx(gt,{data:p,grandTotals:n,onPreviewImage:l,onNavigate:v,onMonthClick:L}),e.jsx(bt,{data:p,onPreviewImage:l,onNavigate:v,onMonthClick:L}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 pb-10",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(at,{data:x,title:"Page ážŠáŸ‚áž›áž˜áž¶áž“áž…áŸ†ážŽáž¼áž›ážáŸ’áž–ážŸáŸ‹áž”áŸ†áž•áž»áž (Top 5 Pages Revenue)"})})}),e.jsxs("div",{className:"lg:col-span-4 flex flex-col justify-center page-card !p-5 bg-gray-800/30 border-gray-700/50",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-6",children:[e.jsx("span",{className:"w-1.5 h-4 bg-indigo-500 rounded-full"}),"ážŸáž„áŸ’ážáŸáž”"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"áž…áŸ†áž“áž½áž“ Page ážŸáž€áž˜áŸ’áž˜:"}),e.jsx("span",{className:"text-white font-black text-sm",children:n.pagesCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚/Page:"}),e.jsxs("span",{className:"text-blue-400 font-black text-sm",children:["$",(n.revenue/(n.pagesCount||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},Kt=[{label:"áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Time)",value:"all"},{label:"ážáŸ’áž„áŸƒáž“áŸáŸ‡ (Today)",value:"today"},{label:"áž˜áŸ’ážŸáž·áž›áž˜áž·áž‰ (Yesterday)",value:"yesterday"},{label:"ážŸáž”áŸ’ážáž¶áž áŸáž“áŸáŸ‡ (This Week)",value:"this_week"},{label:"ážŸáž”áŸ’ážáž¶áž áŸáž˜áž»áž“ (Last Week)",value:"last_week"},{label:"ážáŸ‚áž“áŸáŸ‡ (This Month)",value:"this_month"},{label:"ážáŸ‚áž˜áž»áž“ (Last Month)",value:"last_month"},{label:"áž†áŸ’áž“áž¶áŸ†áž“áŸáŸ‡ (This Year)",value:"this_year"},{label:"áž†áŸ’áž“áž¶áŸ†áž˜áž»áž“ (Last Year)",value:"last_year"},{label:"áž€áŸ†ážŽážáŸ‹ážáŸ’áž›áž½áž“áž¯áž„ (Custom)",value:"custom"}],Jt=({datePreset:t,setDatePreset:a,startDate:o,setStartDate:r,endDate:j,setEndDate:h,calculatedRange:f})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 p-5 rounded-[1.8rem] border border-white/5 shadow-inner",children:[e.jsx("label",{className:"text-[10px] font-black text-blue-500 mb-3 block uppercase tracking-[0.2em] ml-2",children:"Temporal Window"}),e.jsx("select",{value:t,onChange:c=>a(c.target.value),className:"form-select !bg-gray-900 border-gray-800 !py-3.5 !px-5 rounded-2xl font-bold text-gray-200 focus:border-blue-500/50",children:Kt.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),e.jsx("div",{className:"mt-3 bg-black/40 p-3 rounded-xl text-center text-[10px] font-mono text-gray-500 border border-white/5 uppercase tracking-widest",children:f})]}),t==="custom"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 animate-fade-in px-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"From"}),e.jsx("input",{type:"date",value:o,onChange:c=>r(c.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"To"}),e.jsx("input",{type:"date",value:j,onChange:c=>h(c.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]})]})]}),de=({label:t,value:a,onChange:o,options:r,placeholder:j="All",variant:h="default",multiple:f=!1,searchable:c=!0})=>{const[l,b]=i.useState(!1),[m,y]=i.useState(""),z=i.useRef(null),k=i.useRef(null);i.useEffect(()=>{const s=D=>{z.current&&!z.current.contains(D.target)&&(b(!1),y(""))};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),i.useEffect(()=>{l&&c&&k.current&&setTimeout(()=>{var s;return(s=k.current)==null?void 0:s.focus()},100)},[l,c]);const O=a?a.split(","):[],w=s=>typeof s=="string"?s:s.label,P=s=>typeof s=="string"?s:s.value,v=i.useMemo(()=>{if(!m)return r;const s=m.toLowerCase();return r.filter(D=>{const d=w(D).toLowerCase(),N=P(D).toLowerCase();return d.includes(s)||N.includes(s)})},[r,m]),L=s=>{if(f){let D;O.includes(s)?D=O.filter(d=>d!==s):D=[...O,s],o(D.join(","))}else o(s),b(!1),y("")},p=s=>{s.stopPropagation(),o(""),f||b(!1)};let n=j;if(O.length>0)if(O.length===1){const s=r.find(D=>P(D)===O[0]);n=s?w(s):O[0]}else n=`${O.length} Selected`;let g="relative w-full cursor-pointer bg-gray-900 border border-gray-800 py-3.5 px-4 rounded-2xl font-bold transition-all focus:border-blue-500/50 flex justify-between items-center",x="text-gray-400";return h==="payment"?O.includes("Paid")?(g+=" border-emerald-500/30 shadow-[0_0_15px_rgba(16,185,129,0.1)]",x="text-emerald-400"):O.includes("Unpaid")&&(g+=" border-red-500/30 shadow-[0_0_15px_rgba(239,68,68,0.1)]",x="text-red-400"):O.length>0&&(x="text-white",g+=" border-blue-500/30"),e.jsxs("div",{className:"w-full",ref:z,children:[e.jsxs("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:[t," ",f&&e.jsx("span",{className:"text-[9px] text-blue-500 bg-blue-500/10 px-1.5 py-0.5 rounded ml-1",children:"MULTI"})]}),e.jsxs("div",{className:g,onClick:()=>b(!l),children:[e.jsx("span",{className:`truncate mr-2 text-sm ${x}`,children:n}),e.jsxs("div",{className:"flex items-center gap-2",children:[O.length>0&&e.jsx("button",{onClick:p,className:"p-1 hover:bg-gray-700 rounded-full text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${l?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),l&&e.jsxs("div",{className:"absolute top-full left-0 w-full mt-2 bg-[#1a2235] border border-white/10 rounded-2xl shadow-2xl z-50 overflow-hidden animate-fade-in-down max-h-72 flex flex-col",children:[c&&e.jsx("div",{className:"p-2 border-b border-white/5 sticky top-0 bg-[#1a2235] z-10",children:e.jsx("input",{ref:k,type:"text",className:"w-full bg-gray-900 border border-gray-700 rounded-xl px-3 py-2 text-sm text-white focus:border-blue-500 focus:outline-none placeholder-gray-600",placeholder:"Search...",value:m,onChange:s=>y(s.target.value),onClick:s=>s.stopPropagation()})}),e.jsx("div",{className:"overflow-y-auto custom-scrollbar flex-grow",children:v.length>0?v.map((s,D)=>{const d=P(s),N=w(s),u=O.includes(d);return e.jsxs("div",{onClick:C=>{C.stopPropagation(),L(d)},className:`
                                                px-4 py-3 flex items-center justify-between cursor-pointer border-b border-white/5 last:border-none transition-colors
                                                ${u?"bg-blue-600/10":"hover:bg-white/5"}
                                            `,children:[e.jsx("span",{className:`text-sm font-bold truncate ${u?"text-blue-400":"text-gray-300"}`,children:N}),u&&e.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),!u&&f&&e.jsx("div",{className:"w-5 h-5 rounded border-2 border-gray-600 flex-shrink-0 ml-2"})]},`${d}-${D}`)}):e.jsx("div",{className:"p-4 text-center text-xs text-gray-500 font-bold uppercase",children:"No Matches Found"})})]})]})]})},Ke=({filters:t,setFilters:a,orders:o,usersList:r,appData:j,calculatedRange:h})=>{var b;const f=i.useMemo(()=>{const m=new Set,y=new Set,z=new Set,k=new Set,O=new Set,w=new Set,P=new Set,v=new Set,L=new Map;o.forEach(n=>{n.Page&&m.add(n.Page),n.Location&&y.add(n.Location),n["Internal Shipping Method"]&&z.add(n["Internal Shipping Method"]),n["Internal Shipping Details"]&&k.add(n["Internal Shipping Details"]),n["Fulfillment Store"]&&O.add(n["Fulfillment Store"]),n["Payment Info"]&&w.add(n["Payment Info"]),n["Internal Cost"]!==void 0&&P.add(String(n["Internal Cost"])),n.Team&&v.add(n.Team),n["Customer Name"]&&L.set(n["Customer Name"],n["Customer Phone"]||"")});const p=Array.from(L.entries()).sort((n,g)=>n[0].localeCompare(g[0])).map(([n,g])=>({label:`${n} ${g?`(${g})`:""}`,value:n}));return{pages:Array.from(m).sort(),locations:Array.from(y).sort(),shippingMethods:Array.from(z).sort(),drivers:Array.from(k).sort(),fulfillmentStores:Array.from(O).sort(),banks:Array.from(w).sort(),costs:Array.from(P).sort((n,g)=>Number(n)-Number(g)),teams:Array.from(v).sort(),customerOptions:p}},[o]),c=()=>{a({datePreset:"this_month",startDate:"",endDate:"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:"",customerName:""})},l=(m,y)=>{a({...t,[m]:y})};return e.jsxs("div",{className:"space-y-8",children:[e.jsx(Jt,{datePreset:t.datePreset,setDatePreset:m=>a({...t,datePreset:m}),startDate:t.startDate,setStartDate:m=>l("startDate",m),endDate:t.endDate,setEndDate:m=>l("endDate",m),calculatedRange:h}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-x-6 gap-y-6 px-1",children:[e.jsx(de,{label:"Customer Name (ážˆáŸ’áž˜áŸ„áŸ‡áž¢ážáž·ážáž·áž‡áž“)",value:t.customerName,onChange:m=>l("customerName",m),options:f.customerOptions,placeholder:"Search by Name or Phone...",multiple:!0,searchable:!0}),e.jsx(de,{label:"Payment Status",value:t.paymentStatus,onChange:m=>l("paymentStatus",m),options:[{label:"Paid (ážšáž½áž…ážšáž¶áž›áŸ‹)",value:"Paid"},{label:"Unpaid (COD)",value:"Unpaid"}],placeholder:"All Statuses",variant:"payment",multiple:!0}),e.jsx(de,{label:"Store (Brand/Sales)",value:t.store,onChange:m=>l("store",m),options:((b=j.stores)==null?void 0:b.map(m=>m.StoreName))||[],placeholder:"All Stores (Brands)",multiple:!0}),e.jsx(de,{label:"Team Allocation",value:t.team,onChange:m=>l("team",m),options:f.teams,placeholder:"All Operational Teams",multiple:!0}),e.jsx(de,{label:"Source Page",value:t.page,onChange:m=>l("page",m),options:f.pages,placeholder:"All Pages",multiple:!0}),e.jsx(de,{label:"Fulfillment Store (Stock)",value:t.fulfillmentStore,onChange:m=>l("fulfillmentStore",m),options:f.fulfillmentStores,placeholder:"All Fulfillment Centers",multiple:!0}),e.jsx(de,{label:"Geography (Location)",value:t.location,onChange:m=>l("location",m),options:f.locations,placeholder:"All Regions",multiple:!0}),e.jsx(de,{label:"Logistics Method",value:t.shippingService,onChange:m=>l("shippingService",m),options:f.shippingMethods,placeholder:"All Shipping Methods",multiple:!0}),e.jsx(de,{label:"Logistics Driver",value:t.driver,onChange:m=>l("driver",m),options:f.drivers,placeholder:"All Drivers / Details",multiple:!0}),e.jsx(de,{label:"Merchant Node (User)",value:t.user,onChange:m=>l("user",m),options:r.map(m=>({label:m.FullName,value:m.UserName})),placeholder:"All Registered Users",multiple:!0}),e.jsx(de,{label:"Exp. Cost (Internal)",value:t.internalCost,onChange:m=>l("internalCost",m),options:f.costs.map(m=>({label:`$${m}`,value:m})),placeholder:"All Costs",multiple:!0}),e.jsx(de,{label:"áž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš (Bank)",value:t.bank,onChange:m=>l("bank",m),options:f.banks,placeholder:"All Bank Accounts",multiple:!0}),e.jsxs("div",{className:"sm:col-span-2 xl:col-span-3",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:"Asset Selection (Product)"}),e.jsx(ft,{products:j.products,selectedProductName:t.product,onSelect:m=>l("product",m),showTagEditor:!1})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:c,className:"w-full py-4 text-[11px] font-black text-gray-500 uppercase tracking-widest hover:text-white border border-dashed border-gray-800 rounded-2xl transition-all active:scale-95 hover:border-red-500/30 hover:bg-red-500/10",children:"Reset All Configurations"})})]})},qt=({activeReport:t,onBack:a,onNavigate:o})=>{const{appData:r,refreshTimestamp:j,setMobilePageTitle:h}=i.useContext(le),[f,c]=i.useState(!0),[l,b]=i.useState([]),[m,y]=i.useState([]),[z,k]=i.useState(!1),O={overview:"OVERVIEW",sales_team:"SALES TEAM REPORT",sales_page:"SALES PAGE REPORT",performance:"PERFORMANCE",profitability:"PROFITABILITY",shipping:"SHIPPING COST",forecasting:"FORECASTING"};i.useEffect(()=>(h(O[t]),()=>h(null)),[t,h]);const[w,P]=V("dateFilter","this_month"),[v,L]=V("startDate",""),[p,n]=V("endDate",""),[g,x]=V("customerFilter",""),[s,D]=i.useState({datePreset:w||"this_month",startDate:v||"",endDate:p||"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:"",customerName:g||""});i.useEffect(()=>{s.datePreset!==w&&P(s.datePreset),s.startDate!==v&&L(s.startDate),s.endDate!==p&&n(s.endDate),s.customerName!==g&&x(s.customerName)},[s.datePreset,s.startDate,s.endDate,s.customerName,w,v,p,g,P,L,n,x]);const d=async()=>{c(!0);try{const[S,$]=await Promise.all([fetch(`${ne}/api/admin/all-orders`),fetch(`${ne}/api/users`)]),A=await S.json(),F=await $.json();if(A.status==="success"){const W=(A.data||[]).filter(U=>U!==null&&U["Order ID"]!=="Opening_Balance"&&U["Order ID"]!=="Opening Balance").map(U=>{let I=[];try{U["Products (JSON)"]&&(I=JSON.parse(U["Products (JSON)"]))}catch{}return{...U,Products:I}});b(W)}F.status==="success"&&y(F.data||[])}catch(S){console.error(S)}finally{c(!1)}};i.useEffect(()=>{d()},[j]);const N=i.useMemo(()=>{const S=new Date,$=new Date(S.getFullYear(),S.getMonth(),S.getDate());let A=null,F=new Date;switch(s.datePreset){case"today":A=$;break;case"yesterday":A=new Date($),A.setDate($.getDate()-1),F=new Date($),F.setMilliseconds(-1);break;case"this_week":const U=S.getDay();A=new Date($),A.setDate($.getDate()-(U===0?6:U-1));break;case"last_week":A=new Date($),A.setDate($.getDate()-S.getDay()-6),F=new Date(A),F.setDate(A.getDate()+6),F.setHours(23,59,59);break;case"this_month":A=new Date(S.getFullYear(),S.getMonth(),1);break;case"last_month":A=new Date(S.getFullYear(),S.getMonth()-1,1),F=new Date(S.getFullYear(),S.getMonth(),0,23,59,59);break;case"this_year":A=new Date(S.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${s.startDate||"..."} to ${s.endDate||"..."}`}const W=U=>{const I=U.getFullYear(),Y=String(U.getMonth()+1).padStart(2,"0"),q=String(U.getDate()).padStart(2,"0");return`${I}-${Y}-${q}`};return A?`${W(A)} to ${W(F)}`:"All time data stream"},[s.datePreset,s.startDate,s.endDate]),u=i.useMemo(()=>l.filter(S=>{var A;if(s.datePreset!=="all"){const F=new Date(S.Timestamp),W=new Date,U=new Date(W.getFullYear(),W.getMonth(),W.getDate());let I=null,Y=new Date;switch(s.datePreset){case"today":I=U;break;case"yesterday":I=new Date(U),I.setDate(U.getDate()-1),Y=new Date(U),Y.setMilliseconds(-1);break;case"this_week":const q=W.getDay();I=new Date(U),I.setDate(U.getDate()-(q===0?6:q-1));break;case"last_week":I=new Date(U),I.setDate(U.getDate()-W.getDay()-6),Y=new Date(I),Y.setDate(I.getDate()+6),Y.setHours(23,59,59);break;case"this_month":I=new Date(W.getFullYear(),W.getMonth(),1);break;case"last_month":I=new Date(W.getFullYear(),W.getMonth()-1,1),Y=new Date(W.getFullYear(),W.getMonth(),0,23,59,59);break;case"this_year":I=new Date(W.getFullYear(),0,1);break;case"custom":s.startDate&&(I=new Date(s.startDate+"T00:00:00")),s.endDate&&(Y=new Date(s.endDate+"T23:59:59"));break}if(I&&F<I||Y&&F>Y)return!1}const $=(F,W)=>{if(!F)return!0;const U=F.split(",").map(Y=>Y.trim().toLowerCase()),I=(W||"").trim().toLowerCase();return U.includes(I)};if(!$(s.team,S.Team)||!$(s.user,S.User||"")||!$(s.paymentStatus,S["Payment Status"])||!$(s.shippingService,S["Internal Shipping Method"])||!$(s.driver,S["Internal Shipping Details"])||!$(s.bank,S["Payment Info"])||!$(s.fulfillmentStore,S["Fulfillment Store"])||!$(s.page,S.Page)||!$(s.location,S.Location)||!$(s.internalCost,String(S["Internal Cost"]))||s.product&&!S.Products.some(F=>F.name===s.product))return!1;if(s.store){const F=(A=r.pages)==null?void 0:A.find(I=>I.PageName===S.Page),W=F?F.DefaultStore:null,U=s.store.split(",");if(!W||!U.includes(W))return!1}return!!$(s.customerName,S["Customer Name"])}),[l,s,r.pages]);if(f)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-950",children:e.jsx(se,{size:"lg"})});const C=Object.values(s).filter(S=>S!==""&&S!=="this_month"&&S!=="all").length;return e.jsxs("div",{className:"animate-fade-in space-y-8 pb-20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-gray-800/20 p-6 rounded-[2.5rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden sm:block text-2xl font-black text-white uppercase tracking-tight italic",children:O[t]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("p",{className:"text-[10px] text-blue-400 font-black uppercase tracking-widest",children:[N," ",C>0&&` â€¢ ${C} Active Filters`]})]})]}),e.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:e.jsxs("button",{onClick:()=>k(!0),className:"relative flex-1 sm:flex-none btn btn-secondary !py-2.5 !px-6 rounded-2xl border border-gray-700 flex items-center justify-center gap-3 transition-all hover:bg-gray-700 active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter Engine",C>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-600 text-white text-[10px] font-black rounded-full flex items-center justify-center border-2 border-gray-900",children:C})]})})]}),e.jsxs("div",{className:"min-h-[500px]",children:[t==="overview"&&e.jsx(Ae,{orders:u,reportType:"overview",allOrders:l,dateFilter:s.datePreset}),t==="sales_team"&&e.jsx(Ht,{orders:u,onBack:a}),t==="sales_page"&&e.jsx(Yt,{orders:u,onBack:a,onNavigate:o,contextFilters:s,dateFilter:s.datePreset,startDate:s.startDate,endDate:s.endDate}),t==="shipping"&&e.jsx(Ae,{orders:u,reportType:"shipping",allOrders:l,dateFilter:s.datePreset,startDate:s.startDate,endDate:s.endDate,onNavigate:o,contextFilters:s}),t==="profitability"&&e.jsx(Ae,{orders:u,reportType:"profitability",allOrders:l,dateFilter:s.datePreset}),t==="performance"&&e.jsx(Ae,{orders:u,reportType:"performance",allOrders:l,dateFilter:s.datePreset}),t==="forecasting"&&e.jsx(Ae,{orders:l,reportType:"forecasting",allOrders:l,dateFilter:s.datePreset})]}),e.jsx(me,{isOpen:z,onClose:()=>k(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>k(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"Ã—"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(Ke,{filters:s,setFilters:D,orders:l,usersList:m,appData:r,calculatedRange:N})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>k(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})]})},Xt=({storesHierarchy:t,selectedPageNames:a,teamsPerRow:o,columns:r,imageMap:j})=>{const h=a.size,c=i.useCallback(()=>h>60?.45:h>45?.6:h>30?.75:h>=20?.85:1,[h])(),l=b=>Math.round(b*c);return e.jsxs("div",{id:"png-export-layer",style:{display:"none",width:"2560px",minHeight:"1440px",height:"auto",position:"relative",backgroundColor:"#020617",fontFamily:"'Kantumruy Pro', sans-serif",WebkitFontSmoothing:"antialiased",paddingBottom:l(100)},className:"flex flex-col items-center",children:[e.jsx("style",{children:`
                #png-export-layer * {
                    box-sizing: border-box;
                    line-height: 1.6 !important;
                }
                .khmer-text {
                    font-family: 'Kantumruy Pro', sans-serif !important;
                    padding-bottom: 2px;
                }
                .item-container {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }
                .team-badge-gradient {
                    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
                    border: ${l(2)}px solid rgba(59, 130, 246, 0.5);
                }
            `}),e.jsx("div",{className:"absolute inset-0 opacity-[0.12] pointer-events-none",style:{backgroundImage:"radial-gradient(#3b82f6 1.2px, transparent 1.2px)",backgroundSize:"40px 40px",height:"100%"}}),e.jsx("div",{className:"w-full h-full flex flex-col p-[50px] relative z-10 justify-center",children:e.jsx("div",{className:"w-full",children:Object.entries(t).map(([b,m],y)=>Object.values(m).some(k=>k.some(O=>a.has(O.PageName)))?e.jsxs("div",{className:"w-full item-container flex flex-col mb-[70px] last:mb-0 items-center",children:[e.jsxs("div",{className:"flex items-center gap-[30px] mb-[60px] justify-center",children:[e.jsx("div",{style:{width:l(100),height:l(100),borderRadius:l(28),fontSize:l(50)},className:"bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center font-black shadow-[0_0_40px_rgba(59,130,246,0.3)] border border-white/20 flex-shrink-0",children:(y+1).toString().padStart(2,"0")}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("h2",{style:{fontSize:l(100)},className:"font-black text-white uppercase tracking-tighter leading-none khmer-text drop-shadow-2xl",children:b})})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${o}, minmax(0, 1fr))`,gap:l(60),width:"100%",maxWidth:"95%",direction:"ltr"},children:Object.entries(m).map(([k,O])=>{const w=O.filter(P=>a.has(P.PageName));return w.length===0?null:e.jsxs("div",{style:{borderRadius:l(45),padding:l(40),paddingTop:l(65)},className:"bg-gray-900/40 border border-white/10 shadow-2xl flex flex-col relative backdrop-blur-xl",children:[e.jsx("div",{style:{top:l(-42),left:"50%",transform:"translateX(-50%)",borderRadius:l(20),padding:`${l(14)}px ${l(50)}px`,fontSize:l(34),minWidth:l(220),display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 ${l(15)}px ${l(35)}px rgba(0,0,0,0.8), inset 0 0 ${l(10)}px rgba(59, 130, 246, 0.2)`},className:"absolute team-badge-gradient font-black uppercase tracking-widest text-blue-400 khmer-text whitespace-nowrap z-20",children:k}),e.jsx("div",{className:"space-y-[20px] flex-grow",children:w.map(P=>e.jsxs("div",{style:{borderRadius:l(28),padding:l(18)},className:"flex items-center gap-[20px] bg-black/40 border border-white/5 shadow-inner hover:border-blue-500/30 transition-all",children:[r.logoImage&&j[P.PageName]&&e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:j[P.PageName],style:{width:l(85),height:l(85),borderRadius:l(22)},className:"object-cover border-[3px] border-gray-700 shadow-lg",alt:""})}),e.jsxs("div",{className:"flex-grow min-w-0 text-left",style:{marginTop:l(-25)},children:[e.jsx("span",{style:{fontSize:l(36)},className:"font-black block text-white uppercase tracking-tight khmer-text leading-tight break-words",children:P.PageName}),r.telegramValue&&e.jsxs("div",{style:{marginTop:l(8)},className:"flex items-center gap-2",children:[e.jsx("svg",{style:{width:l(20),height:l(20)},className:"text-blue-500 opacity-80",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h-2v-6h2v6zm-1-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})}),e.jsxs("span",{style:{fontSize:l(24)},className:"text-blue-400/70 font-mono font-bold tracking-wider leading-none",children:["@",P.TelegramValue]})]})]})]},P.PageName))})]},k)})})})]},b):null)})})]})},Zt=({isOpen:t,onClose:a,pages:o})=>{const[r,j]=i.useState(3),[h,f]=i.useState(!1),[c,l]=i.useState(0),[b,m]=i.useState(null),[y,z]=i.useState({pageName:!0,telegramValue:!0,logoImage:!0}),[k,O]=i.useState(new Set),[w,P]=i.useState({});i.useEffect(()=>{t&&o&&o.length>0&&k.size===0&&O(new Set(o.map(u=>u.PageName))),t||m(null)},[t,o]);const v=i.useMemo(()=>{const u={};return o&&o.forEach(C=>{const S=C.DefaultStore||"No Store",$=C.Team||"No Team";u[S]||(u[S]={}),u[S][$]||(u[S][$]=[]),u[S][$].push(C)}),u},[o]),L=u=>{z(C=>({...C,[u]:!C[u]}))},p=u=>{O(C=>{const S=new Set(C);return S.has(u)?S.delete(u):S.add(u),S})},n=u=>{const C=u.every(S=>k.has(S.PageName));O(S=>{const $=new Set(S);return u.forEach(A=>{C?$.delete(A.PageName):$.add(A.PageName)}),$})},g=u=>{const C=Object.values(u).flat(),S=C.every($=>k.has($.PageName));O($=>{const A=new Set($);return C.forEach(F=>{S?A.delete(F.PageName):A.add(F.PageName)}),A})},x=u=>{O(u?new Set(o.map(C=>C.PageName)):new Set)},s=async u=>{const C={...w};let S=0;for(const $ of u){if($.PageLogoURL&&!C[$.PageName])try{const A=await it($.PageLogoURL);A&&(C[$.PageName]=`data:image/png;base64,${A}`)}catch{console.warn(`Failed to load logo for ${$.PageName}`)}S++,l(Math.round(S/u.length*100))}return P(C),C},D=async()=>{if(k.size===0)return;f(!0),l(0);const u=document.getElementById("png-export-layer");if(!u){f(!1);return}const C=u.getAttribute("style")||"";try{const S=o.filter(I=>k.has(I.PageName));await s(S),await document.fonts.ready;const $=2560;u.style.display="flex",u.style.width=`${$}px`,u.style.height="auto",u.style.position="fixed",u.style.top="0",u.style.left="-10000px",u.style.zIndex="-100",await new Promise(I=>setTimeout(I,1e3));const A=u.scrollHeight,F=Math.max(1440,A),U=(await Nt(u,{backgroundColor:"#020617",scale:1.5,useCORS:!0,logging:!1,width:$,height:F,windowWidth:$,windowHeight:F,allowTaint:!0,imageTimeout:15e3})).toDataURL("image/png",.9);m(U)}catch(S){console.error("Preview Generation Error:",S),alert("áž€áž¶ážšáž”áž„áŸ’áž€áž¾áž Preview áž”ážšáž¶áž‡áŸáž™áŸ”")}finally{u.setAttribute("style",C),f(!1)}},d=()=>{if(b)try{const u=new Be({orientation:"landscape",unit:"mm",format:"a4"}),C=u.getImageProperties(b),S=u.internal.pageSize.getWidth(),$=C.height*S/C.width;u.deletePage(1),u.addPage([S,$]),u.addImage(b,"PNG",0,0,S,$),u.save(`Organization_Chart_${new Date().getTime()}.pdf`),a()}catch(u){console.error(u),alert("Export PDF Error")}},N=()=>{if(!b)return;const u=document.createElement("a");u.href=b,u.download=`Organization_Chart_${new Date().getTime()}.png`,document.body.appendChild(u),u.click(),document.body.removeChild(u)};return e.jsxs(me,{isOpen:t,onClose:a,maxWidth:"max-w-7xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-white/5 pb-6",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-3xl font-black text-white flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-600/20 rounded-2xl flex items-center justify-center border border-red-500/30",children:e.jsx("svg",{className:"w-7 h-7 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),"Premium HD Export"]})}),e.jsx("button",{onClick:a,className:"p-3 bg-gray-800 text-gray-400 hover:text-white rounded-2xl active:scale-95 transition-all",children:"Ã—"})]}),b?e.jsxs("div",{className:"flex flex-col h-[70vh]",children:[e.jsx("div",{className:"flex-grow overflow-auto bg-gray-950/50 rounded-3xl border border-white/10 p-4 flex items-center justify-center relative",children:e.jsx("img",{src:b,className:"max-w-full h-auto shadow-2xl rounded-lg",alt:"Preview"})}),e.jsxs("div",{className:"mt-6 flex flex-wrap justify-between items-center border-t border-white/5 pt-6 gap-4",children:[e.jsxs("button",{onClick:()=>m(null),className:"px-8 py-4 text-sm font-black text-gray-400 hover:text-white uppercase flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})}),"Back to Settings"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:N,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16l4 4m0 0l4-4m-4 4V4"})}),"Download PNG"]}),e.jsxs("button",{onClick:d,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-emerald-600 text-white hover:bg-emerald-700 shadow-emerald-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download PDF"]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 h-[70vh]",children:[e.jsx("div",{className:"lg:col-span-3 space-y-8 overflow-y-auto pr-4 custom-scrollbar",children:e.jsxs("div",{className:"bg-black/40 p-6 rounded-[2.5rem] border border-white/5 space-y-8 shadow-inner",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Density Control"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-900/50 p-1.5 rounded-2xl border border-gray-800",children:[1,2,3,4,5,6].map(u=>e.jsx("button",{onClick:()=>j(u),className:`py-2.5 rounded-xl text-xs font-black transition-all ${r===u?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:u},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Display Fields"}),e.jsx("div",{className:"space-y-2",children:Object.keys(y).map(u=>e.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-2xl border border-gray-800 cursor-pointer hover:bg-blue-600/5 transition-colors group",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-gray-200 capitalize",children:u.replace(/([A-Z])/g," $1")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:y[u],onChange:()=>L(u),className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]},u))})]})]})}),e.jsxs("div",{className:"lg:col-span-9 flex flex-col bg-gray-950/40 rounded-[3rem] border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 bg-white/5 flex justify-between items-center backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsxs("p",{className:"text-xs font-black text-white uppercase tracking-widest",children:[k.size," Nodes Linked"]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("button",{onClick:()=>x(!0),className:"text-[10px] font-black text-blue-400 hover:text-blue-300 transition-colors uppercase tracking-widest",children:"Select All"}),e.jsx("button",{onClick:()=>x(!1),className:"text-[10px] font-black text-gray-500 hover:text-white transition-colors uppercase tracking-widest",children:"Clear"})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-8 space-y-12 custom-scrollbar",children:Object.entries(v).map(([u,C])=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 group",children:[e.jsx("input",{type:"checkbox",onChange:()=>g(C),className:"w-6 h-6 rounded-lg border-gray-700 bg-gray-900 text-blue-600 focus:ring-blue-500/20 cursor-pointer"}),e.jsxs("h4",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-4 group-hover:text-blue-400 transition-colors",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),u]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pl-10",children:Object.entries(C).map(([S,$])=>{const A=$.every(F=>k.has(F.PageName));return e.jsxs("div",{className:"bg-gray-900/40 rounded-3xl border border-white/5 p-6 shadow-xl",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-6 cursor-pointer border-b border-white/5 pb-4",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:()=>n($),className:"w-5 h-5 rounded-md border-gray-700 bg-gray-800 text-blue-500"}),e.jsx("span",{className:"text-xs font-black text-gray-400 uppercase tracking-[0.15em]",children:S})]}),e.jsx("div",{className:"space-y-3",children:$.map(F=>e.jsxs("label",{className:`flex items-center gap-4 p-3 rounded-2xl border transition-all cursor-pointer ${k.has(F.PageName)?"bg-blue-600/10 border-blue-500/30":"bg-black/20 border-transparent hover:bg-white/5"}`,children:[e.jsx("input",{type:"checkbox",checked:k.has(F.PageName),onChange:()=>p(F.PageName),className:"w-4 h-4 rounded-md border-gray-700 bg-gray-900 text-blue-600"}),e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("img",{src:he(F.PageLogoURL),className:"w-7 h-7 rounded-full object-cover border border-white/10",alt:""}),e.jsx("span",{className:"text-xs font-bold text-gray-300 truncate",children:F.PageName})]})]},F.PageName))})]},S)})})]},u))}),e.jsxs("div",{className:"p-8 border-t border-white/5 bg-gray-900/80 backdrop-blur-xl flex justify-between items-center",children:[e.jsx("div",{className:"flex flex-col",children:h&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{size:"sm"}),e.jsxs("p",{className:"text-xs font-black text-red-400 uppercase tracking-[0.2em] animate-pulse",children:["Processing Preview: ",c,"%"]})]}),e.jsx("div",{className:"w-64 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-600 transition-all duration-300",style:{width:`${c}%`}})})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"px-8 py-4 text-sm font-black text-gray-500 hover:text-white uppercase",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:h||k.size===0,className:`px-12 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 ${h||k.size===0?"bg-gray-800 text-gray-600":"bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20"}`,children:h?"Rendering...":"Preview Export"})]})]})]})]}),e.jsx(Xt,{storesHierarchy:v,selectedPageNames:k,teamsPerRow:r,columns:y,imageMap:w})]})},Ye=[{id:"users",title:"áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž‚ážŽáž“áž¸áž”áž»áž‚áŸ’áž‚áž›áž·áž€ áž“áž·áž„ážŸáž·áž‘áŸ’áž’áž·áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹",icon:"ðŸ‘¤",dataKey:"users",sheetName:"Users",primaryKeyField:"UserName",fields:[{name:"FullName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž–áŸáž‰",type:"text"},{name:"UserName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž‚ážŽáž“áž¸ (Login)",type:"text"},{name:"Password",label:"áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹",type:"password"},{name:"Role",label:"ážáž½áž“áž¶áž‘áž¸ (Role)",type:"text"},{name:"Team",label:"áž€áŸ’ážšáž»áž˜ (Team)",type:"text"},{name:"ProfilePictureURL",label:"URL ážšáž¼áž”áž—áž¶áž–",type:"image_url"},{name:"IsSystemAdmin",label:"System Admin?",type:"checkbox"}],displayField:"FullName"},{id:"products",title:"áž•áž›áž·ážáž•áž›",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áž‰áŸ’áž‡áž¸áž‘áŸ†áž“áž·áž‰ ážáž˜áŸ’áž›áŸƒ áž“áž·áž„ Barcode",icon:"ðŸ›ï¸",dataKey:"products",sheetName:"Products",primaryKeyField:"ProductName",fields:[{name:"ProductName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž•áž›áž·ážáž•áž›",type:"text"},{name:"Barcode",label:"Barcode",type:"text"},{name:"Price",label:"ážáž˜áŸ’áž›áŸƒ ($)",type:"number"},{name:"Cost",label:"ážáž˜áŸ’áž›áŸƒážŠáž¾áž˜ ($)",type:"number"},{name:"ImageURL",label:"URL ážšáž¼áž”áž—áž¶áž–",type:"image_url"},{name:"Tags",label:"Tags (comma separated)",type:"text"}],displayField:"ProductName"},{id:"pages",title:"áž€áŸ’ážšáž»áž˜ & Page",description:"áž€áŸ†ážŽážáŸ‹ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜ áž“áž·áž„áž‘áž·áž“áŸ’áž“áž“áŸáž™ Facebook Page",icon:"ðŸ‘¥",dataKey:"pages",sheetName:"TeamsPages",primaryKeyField:"PageName",fields:[{name:"PageName",label:"ážˆáŸ’áž˜áŸ„áŸ‡ Page",type:"text"},{name:"Team",label:"áž€áŸ’ážšáž»áž˜",type:"text"},{name:"TelegramValue",label:"Telegram Value",type:"text"},{name:"PageLogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"PageName"},{id:"shippingMethods",title:"ážŸáŸážœáž¶ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“",description:"áž€áŸ†ážŽážáŸ‹áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“ áž“áž·áž„áž›áž€áŸ’ážážážŽáŸ’ážŒážŠáž¹áž€",icon:"ðŸšš",dataKey:"shippingMethods",sheetName:"ShippingMethods",primaryKeyField:"MethodName",fields:[{name:"MethodName",label:"ážˆáŸ’áž˜áŸ„áŸ‡ážŸáŸážœáž¶",type:"text"},{name:"RequireDriverSelection",label:"ážáŸ’ážšáž¼ážœáž€áž¶ážšáž¢áŸ’áž“áž€ážŠáž¹áž€?",type:"checkbox"},{name:"LogosURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"MethodName"},{id:"drivers",title:"áž¢áŸ’áž“áž€ážŠáž¹áž€",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž–áŸážáŸŒáž˜áž¶áž“áž¢áŸ’áž“áž€ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“áž•áŸ’áž‘áž¶áž›áŸ‹ážáŸ’áž›áž½áž“",icon:"ðŸ›µ",dataKey:"drivers",sheetName:"Drivers",primaryKeyField:"DriverName",fields:[{name:"DriverName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž¢áŸ’áž“áž€ážŠáž¹áž€",type:"text"},{name:"ImageURL",label:"URL ážšáž¼áž”ážáž",type:"image_url"}],displayField:"DriverName"},{id:"bankAccounts",title:"áž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áž‰áŸ’áž‡áž¸áž’áž“áž¶áž‚áž¶ážšážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‘áž‘áž½áž›áž”áŸ’ážšáž¶áž€áŸ‹",icon:"ðŸ¦",dataKey:"bankAccounts",sheetName:"BankAccounts",primaryKeyField:"BankName",fields:[{name:"BankName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž’áž“áž¶áž‚áž¶ážš",type:"text"},{name:"LogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"BankName"},{id:"phoneCarriers",title:"áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“áž‘áž¼ážšážŸáŸáž–áŸ’áž‘",description:"áž€áŸ†ážŽážáŸ‹ Prefixes ážšáž”ážŸáŸ‹áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“áž‘áž¼ážšážŸáŸáž–áŸ’áž‘",icon:"ðŸ“±",dataKey:"phoneCarriers",sheetName:"PhoneCarriers",primaryKeyField:"CarrierName",fields:[{name:"CarrierName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“",type:"text"},{name:"Prefixes",label:"Prefixes (áž”áŸ†áž”áŸ‚áž€ážŠáŸ„áž™áž€áŸ’áž”áŸ€ážŸ)",type:"text"},{name:"CarrierLogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"CarrierName"}],ve=(t,a)=>{if(!t||typeof t!="object"||!a)return;if(t[a]!==void 0)return t[a];const o=a.toLowerCase(),r=Object.keys(t).find(j=>j.toLowerCase()===o||j.toLowerCase().replace(/_/g,"")===o.replace(/_/g,""));return r?t[r]:void 0},Ue=(t,a)=>{if(!t||typeof t!="object")return[];if(Array.isArray(t[a]))return t[a];const o=a.toLowerCase(),r=Object.keys(t).find(j=>j.toLowerCase()===o);if(r&&Array.isArray(t[r]))return t[r];if(a==="pages"){const j=Object.keys(t).find(h=>h.toLowerCase().includes("teampage")||h.toLowerCase().includes("page"));if(j&&Array.isArray(t[j]))return t[j]}return[]},Qt=({section:t,item:a,onClose:o,onSave:r})=>{const{refreshData:j}=i.useContext(le),[h,f]=i.useState({}),[c,l]=i.useState({}),[b,m]=i.useState(!1),[y,z]=i.useState(""),k=i.useRef({}),[O,w]=i.useState({});i.useEffect(()=>{if(a){const p={};t.fields.forEach(n=>{let g=ve(a,n.name);g==null&&(g=n.type==="checkbox"?!1:n.type==="number"?0:""),p[n.name]=g}),t.id==="users"&&(p.Password=""),f(p)}else{const p=t.fields.reduce((n,g)=>(n[g.name]=g.type==="checkbox"?!1:g.type==="number"?0:"",n),{});f(p)}},[a,t]);const P=p=>{const{name:n,value:g,type:x,checked:s}=p.target;f(D=>({...D,[n]:x==="checkbox"?s:g}))},v=async(p,n)=>{if(n){l(g=>({...g,[p]:!0}));try{const g=await ct(n),x=await fetch(`${ne}/api/upload-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileData:g,fileName:n.name,mimeType:n.type})}),s=await x.json();if(!x.ok||s.status!=="success")throw new Error(s.message||"Upload failed");f(D=>({...D,[p]:s.url}))}catch(g){z(g.message)}finally{l(g=>({...g,[p]:!1}))}}},L=async()=>{z("");for(const p of t.fields)if(p.type!=="checkbox"&&(h[p.name]===void 0||h[p.name]==="")&&p.name!=="Password"&&!a){z(`ážŸáž¼áž˜áž”áŸ†áž–áŸáž‰áž…áž“áŸ’áž›áŸ„áŸ‡ "${p.label}"`);return}m(!0);try{const p=a?"/api/admin/update-sheet":"/api/admin/add-row",n={...h};t.fields.forEach(s=>{s.type==="number"&&(n[s.name]=Number(n[s.name]))}),a&&t.id==="users"&&!n.Password&&delete n.Password;const g={sheetName:t.sheetName,newData:n};if(a&&(g.primaryKey={[t.primaryKeyField]:ve(a,t.primaryKeyField)}),!(await fetch(`${ne}${p}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)})).ok)throw new Error("Save failed");await j(),r(h)}catch(p){z(p.message)}finally{m(!1)}};return e.jsxs(me,{isOpen:!0,onClose:o,maxWidth:"max-w-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-black text-white",children:[a?"áž€áŸ‚ážŸáž˜áŸ’ážšáž½áž›":"áž”áž“áŸ’ážáŸ‚áž˜"," ",t.title]}),e.jsx("button",{onClick:o,className:"p-2 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"space-y-5 max-h-[65vh] overflow-y-auto pr-2 custom-scrollbar",children:t.fields.map(p=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-xs font-black text-gray-500 uppercase tracking-widest",children:p.label}),p.type==="checkbox"?e.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-3 rounded-xl border border-gray-700",children:[e.jsx("input",{type:"checkbox",name:p.name,checked:!!h[p.name],onChange:P,className:"h-6 w-6 rounded-lg border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"áž”áž¾áž€ážŠáŸ†ážŽáž¾ážšáž€áž¶ážšáž˜áž»ážáž„áž¶ážšáž“áŸáŸ‡"})]}):p.type==="image_url"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",name:p.name,value:h[p.name]||"",onChange:P,placeholder:"áž”áž·áž‘áž—áŸ’áž‡áž¶áž”áŸ‹ Link áž¬ Upload ážšáž¼áž”áž—áž¶áž–",className:"form-input flex-grow !py-2.5"}),e.jsx("input",{type:"file",accept:"image/*",ref:n=>{k.current[p.name]=n},onChange:n=>n.target.files&&v(p.name,n.target.files[0]),className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>{var n;return(n=k.current[p.name])==null?void 0:n.click()},className:"p-2.5 bg-blue-600/10 text-blue-400 rounded-xl border border-blue-500/20 hover:bg-blue-600 hover:text-white transition-all",disabled:c[p.name],children:c[p.name]?e.jsx(se,{size:"sm"}):e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h14a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),h[p.name]&&e.jsx("div",{className:"relative w-32 h-32 bg-gray-900 rounded-2xl border border-gray-700 p-2 overflow-hidden shadow-inner mx-auto sm:mx-0",children:e.jsx("img",{src:he(h[p.name]),className:"w-full h-full object-contain",alt:"preview"})})]}):p.type==="password"?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:O[p.name]?"text":"password",name:p.name,value:h[p.name]||"",onChange:P,className:"form-input !py-2.5 pr-12",placeholder:a?"áž‘áž»áž€áž‘áž‘áŸáž”áž¾áž˜áž·áž“áž…áž„áŸ‹áž”áŸ’ážáž¼ážš":"áž”áž‰áŸ’áž…áž¼áž›áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹"}),e.jsx("button",{type:"button",onClick:()=>w(n=>({...n,[p.name]:!n[p.name]})),className:"absolute inset-y-0 right-0 px-4 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:O[p.name]?"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7 1.274-4.057 5.064-7 9.542-7 .847 0 1.67 .126 2.454 .364m-3.033 2.446a3 3 0 11-4.243 4.243m4.242-4.242l4.243 4.243M3 3l18 18":"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})})})]}):e.jsx("input",{type:p.type,name:p.name,value:h[p.name]||"",onChange:P,className:"form-input !py-2.5",readOnly:a&&p.name===t.primaryKeyField})]},p.name))}),y&&e.jsx("div",{className:"mt-4 p-3 bg-red-500/10 text-red-400 border border-red-500/20 rounded-xl text-sm font-bold",children:y}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-700/50",children:[e.jsx("button",{type:"button",onClick:o,className:"px-6 py-2.5 text-gray-400 hover:text-white font-bold transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{type:"button",onClick:L,className:"btn btn-primary px-8 shadow-lg shadow-blue-600/20 active:scale-95",disabled:b,children:b?e.jsx(se,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})},es=({isOpen:t,onClose:a,onConfirm:o,isProcessing:r})=>t?e.jsx(me,{isOpen:t,onClose:a,maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20 animate-pulse",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-xl font-black text-white mb-2 uppercase tracking-tight",children:"System Update"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-8 leading-relaxed",children:["ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž“áŸáŸ‡áž“áž¹áž„ážáž˜áŸ’ážšáž¼ážœáž±áŸ’áž™áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Users) áž…áž¶áž€áž…áŸáž‰áž–áž¸áž”áŸ’ážšáž–áŸáž“áŸ’áž’ (Log Out) ážŠáž¾áž˜áŸ’áž”áž¸áž’áŸ’ážœáž¾áž”áž…áŸ’áž…áž»áž”áŸ’áž”áž“áŸ’áž“áž—áž¶áž–áŸ”",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"text-red-400 font-bold bg-red-900/20 px-2 py-1 rounded",children:"ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸ?"})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:a,className:"px-6 py-3 rounded-xl bg-gray-800 text-gray-400 font-bold hover:bg-gray-700 transition-all border border-gray-700",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:o,disabled:r,className:"px-6 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-500 transition-all flex items-center gap-2 shadow-lg shadow-red-900/20 active:scale-95 disabled:opacity-50",children:r?e.jsx(se,{size:"sm"}):"Confirm Update"})]})]})}):null,ts=({onBack:t,initialSection:a})=>{const{appData:o,refreshData:r,logout:j,setMobilePageTitle:h}=i.useContext(le),[f,c]=i.useState(a||"users"),[l,b]=i.useState(a||null),[m,y]=i.useState({isOpen:!1,sectionId:"",item:null}),[z,k]=i.useState([]),[O,w]=i.useState(!1),[P,v]=i.useState(!1),[L,p]=i.useState(!1),n=window.innerWidth<768?l:f,g=Ye.find(d=>d.id===n);i.useEffect(()=>{const d=g?g.title:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹";return h(d),()=>h(null)},[g,h]),i.useEffect(()=>{n==="users"&&(async()=>{if(Ue(o,"users").length===0){const C=await(await fetch(`${ne}/api/users`)).json();C.status==="success"&&k(C.data||[])}})()},[n,o]);const x=i.useMemo(()=>{if(!g)return[];if(g.id==="users"){const d=Ue(o,"users");return d.length>0?d:z}return Ue(o,g.dataKey)},[g,o,z]),s=async(d,N)=>{if(window.confirm(`ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸážáž¶áž…áž„áŸ‹áž›áž»áž” "${ve(N,d.displayField)}"?`))try{await fetch(`${ne}/api/admin/delete-row`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:d.sheetName,primaryKey:{[d.primaryKeyField]:ve(N,d.primaryKeyField)}})}),await r()}catch{alert("Delete failed")}},D=async()=>{p(!0);try{await fetch(`${ne}/api/admin/update-sheet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:"Settings",primaryKey:{Key:"SystemVersion"},newData:{Value:Date.now().toString(),Action:"ForceLogout"}})}),await new Promise(d=>setTimeout(d,2e3)),j(),window.location.reload()}catch(d){console.error(d),p(!1),alert("Update command failed. Check connection.")}};return n?e.jsxs("div",{className:"w-full max-w-[100rem] mx-auto p-4 lg:p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{window.innerWidth<768?b(null):t()},className:"md:hidden p-2 bg-gray-800 text-white rounded-xl border border-gray-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"hidden sm:flex text-2xl lg:text-3xl font-black text-white items-center gap-3",children:[e.jsx("span",{className:"hidden md:inline",children:g==null?void 0:g.icon}),g==null?void 0:g.title]}),e.jsx("p",{className:"text-xs lg:text-sm text-gray-500 font-bold uppercase tracking-[0.2em] mt-1",children:g==null?void 0:g.description})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>v(!0),className:"flex-1 sm:flex-none btn bg-gray-800 border border-gray-700 hover:border-red-500/50 hover:bg-red-900/10 hover:text-red-400 text-gray-400 px-4 transition-all flex items-center justify-center gap-2",title:"Update Version & Force Logout",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"hidden xl:inline text-xs font-bold uppercase tracking-wider",children:"Update Version"})]}),n==="pages"&&e.jsx("button",{onClick:()=>w(!0),className:"flex-1 sm:flex-none btn btn-secondary px-6",children:"PDF Export"}),e.jsx("button",{onClick:()=>y({isOpen:!0,sectionId:n,item:null}),className:"flex-1 sm:flex-none btn btn-primary px-10 shadow-lg shadow-blue-600/20 font-black",children:"+ áž”áž“áŸ’ážáŸ‚áž˜ážáŸ’áž˜áž¸"}),e.jsx("button",{onClick:t,className:"hidden md:flex btn btn-secondary px-6",children:"ážáŸ’ážšáž¡áž”áŸ‹"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("aside",{className:"hidden md:flex flex-col gap-2 w-72 flex-shrink-0",children:Ye.map(d=>e.jsxs("button",{onClick:()=>c(d.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all ${f===d.id?"bg-blue-600 text-white shadow-xl shadow-blue-600/20":"text-gray-400 hover:bg-gray-800 hover:text-gray-200"}`,children:[e.jsx("span",{className:"text-xl",children:d.icon}),e.jsx("span",{className:"font-black text-sm uppercase tracking-wider",children:d.title})]},d.id))}),e.jsx("main",{className:"flex-grow min-w-0",children:e.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-3xl overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"admin-table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-700",children:[e.jsx("th",{className:"w-12 text-center",children:"#"}),g==null?void 0:g.fields.map(d=>e.jsx("th",{children:d.label},d.name)),e.jsx("th",{className:"w-32 text-center uppercase tracking-widest text-[10px]",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/30",children:x.length>0?x.map((d,N)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group",children:[e.jsx("td",{className:"text-center text-gray-500 font-bold text-xs",children:N+1}),g==null?void 0:g.fields.map(u=>{const C=ve(d,u.name);return e.jsx("td",{className:"py-4",children:u.type==="image_url"&&C?e.jsx("img",{src:he(String(C)),className:"w-10 h-10 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1",alt:"logo"}):e.jsx("span",{className:`text-sm font-bold ${u.type==="password"?"text-gray-600":"text-gray-200"}`,children:u.type==="password"?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":typeof C=="boolean"?C?"âœ… Active":"âŒ Inactive":String(C||"-")})},u.name)}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>y({isOpen:!0,sectionId:n,item:d}),className:"p-2 bg-amber-500/10 text-amber-400 rounded-lg hover:bg-amber-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>s(g,d),className:"p-2 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},N)):e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"py-20 text-center text-gray-500 font-bold",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™ážáŸ’ážšáž¼ážœáž”áž¶áž“ážšáž€ážƒáž¾áž‰áž‘áŸ"})})})]})}),e.jsx("div",{className:"md:hidden divide-y divide-gray-700/50",children:x.length>0?x.map((d,N)=>{const u=ve(d,(g==null?void 0:g.displayField)||""),C=g==null?void 0:g.fields.find($=>$.type==="image_url"),S=C?ve(d,C.name):null;return e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[S&&e.jsx("img",{src:he(S),className:"w-12 h-12 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1 flex-shrink-0",alt:"logo"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-sm font-black text-white truncate",children:String(u||"-")}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase mt-0.5",children:["Item #",N+1]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y({isOpen:!0,sectionId:n,item:d}),className:"p-2.5 bg-gray-800 text-blue-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>s(g,d),className:"p-2.5 bg-gray-800 text-red-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},N)}):e.jsx("div",{className:"py-20 text-center text-gray-500 font-bold",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]})})]}),e.jsx("button",{onClick:()=>y({isOpen:!0,sectionId:n,item:null}),className:"md:hidden fixed bottom-24 right-6 w-16 h-16 bg-blue-600 text-white rounded-full shadow-2xl flex items-center justify-center active:scale-90 transition-transform z-40 border-4 border-gray-900",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})}),m.isOpen&&g&&e.jsx(Qt,{section:g,item:m.item,onClose:()=>y({...m,isOpen:!1}),onSave:()=>{y({...m,isOpen:!1}),r()}}),e.jsx(es,{isOpen:P,onClose:()=>v(!1),onConfirm:D,isProcessing:L}),O&&e.jsx(Zt,{isOpen:O,onClose:()=>w(!1),pages:Ue(o,"pages")})]}):e.jsxs("div",{className:"p-4 md:hidden animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden text-2xl font-black text-white",children:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹"}),e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest mt-1",children:"Settings & Management"})]}),e.jsx("button",{onClick:t,className:"p-2 bg-gray-800 text-gray-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:Ye.map(d=>e.jsxs("button",{onClick:()=>b(d.id),className:"flex items-center gap-4 bg-gray-800/40 border border-gray-700/50 p-4 rounded-2xl hover:bg-gray-700/40 active:scale-[0.98] transition-all text-left",children:[e.jsx("span",{className:"text-3xl bg-gray-800 p-3 rounded-xl shadow-inner border border-gray-700",children:d.icon}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-base font-black text-white leading-tight",children:d.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-1",children:d.description})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 5l7 7-7 7"})})]},d.id))})]})},ss=({isOpen:t,onClose:a,orders:o})=>{const[r,j]=i.useState("Page"),[h,f]=i.useState("a4"),[c,l]=i.useState("landscape"),[b,m]=i.useState(!1),[y,z]=i.useState({orderId:{label:"Order ID",visible:!0,width:25},date:{label:"Date",visible:!0,width:25},customer:{label:"Customer",visible:!0,width:35},phone:{label:"Phone",visible:!0,width:25},location:{label:"Location/Address",visible:!0,width:45},items:{label:"Items",visible:!0,width:50},total:{label:"Total ($)",visible:!0,width:20},status:{label:"Status",visible:!0,width:20},note:{label:"Note",visible:!1,width:30}}),k=w=>{z(P=>({...P,[w]:{...P[w],visible:!P[w].visible}}))},O=()=>{b||(m(!0),setTimeout(()=>{try{const w=new Be({orientation:c,unit:"mm",format:h}),P=w.internal.pageSize.width;w.setFontSize(18),w.setTextColor(40,40,40),w.text("Orders Report",P/2,15,{align:"center"}),w.setFontSize(10),w.setTextColor(100,100,100),w.text(`Generated on: ${new Date().toLocaleString()}`,P/2,22,{align:"center"}),w.text(`Total Orders: ${o.length}`,P/2,27,{align:"center"});const v={};r==="None"?v["All Orders"]=o:o.forEach(g=>{const x=g[r]||"Unassigned";v[x]||(v[x]=[]),v[x].push(g)});const L=[Object.entries(y).filter(([g,x])=>x.visible).map(([g,x])=>x.label)];let p=35;if(Object.entries(v).sort().forEach(([g,x])=>{p>w.internal.pageSize.height-30&&(w.addPage(),p=20),r!=="None"&&(w.setFontSize(12),w.setTextColor(30,64,175),w.setFillColor(240,240,255),w.rect(14,p,P-28,8,"F"),w.text(`${r}: ${g} (${x.length} orders)`,16,p+5.5),p+=10);const s=x.map(d=>{const N=[];if(y.orderId.visible&&N.push(d["Order ID"]),y.date.visible&&N.push(new Date(d.Timestamp).toLocaleDateString()),y.customer.visible&&N.push(d["Customer Name"]),y.phone.visible&&N.push(d["Customer Phone"]),y.location.visible&&N.push(`${d.Location||""} - ${d["Address Details"]||""}`),y.items.visible){const u=d.Products.map(C=>`${C.quantity}x ${C.name}`).join(", ");N.push(u)}return y.total.visible&&N.push(`$${d["Grand Total"].toFixed(2)}`),y.status.visible&&N.push(d["Payment Status"]),y.note.visible&&N.push(d.Note||""),N}),D=x.reduce((d,N)=>d+N["Grand Total"],0);w.autoTable({startY:p,head:L,body:s,theme:"striped",headStyles:{fillColor:[43,53,72],textColor:[255,255,255]},styles:{fontSize:8,cellPadding:2,overflow:"linebreak"},margin:{top:20}}),p=w.lastAutoTable.finalY+2,r!=="None"?(w.setFontSize(10),w.setTextColor(80,80,80),w.text(`Subtotal: $${D.toFixed(2)}`,P-15,p+5,{align:"right"}),p+=12):p+=5}),r==="None"){const g=o.reduce((x,s)=>x+s["Grand Total"],0);w.setFontSize(12),w.setTextColor(0,0,0),w.text(`GRAND TOTAL: $${g.toFixed(2)}`,P-15,p+5,{align:"right"})}const n=w.internal.pages.length-1;for(let g=1;g<=n;g++)w.setPage(g),w.setFontSize(8),w.setTextColor(150),w.text(`Page ${g} of ${n}`,P/2,w.internal.pageSize.height-10,{align:"center"});w.save(`Orders_Report_${new Date().toISOString().slice(0,10)}.pdf`),m(!1),a()}catch(w){console.error("PDF Generation Error:",w),alert("Failed to generate PDF. Check console for details."),m(!1)}},100))};return e.jsxs(me,{isOpen:t,onClose:a,maxWidth:"max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"áž‘áž¶áž‰áž™áž€áž‡áž¶ PDF (Export PDF)"]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white text-2xl",children:"Ã—"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹áž‘áž¼áž‘áŸ… (General)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"áž‘áŸ†áž áŸ† (Size)"}),e.jsxs("select",{value:h,onChange:w=>f(w.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"a4",children:"A4"}),e.jsx("option",{value:"a3",children:"A3"}),e.jsx("option",{value:"letter",children:"Letter"}),e.jsx("option",{value:"legal",children:"Legal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"áž‘áž·ážŸážŠáŸ…"}),e.jsxs("select",{value:c,onChange:w=>l(w.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"portrait",children:"áž”áž‰áŸ’ážˆážš (Portrait)"}),e.jsx("option",{value:"landscape",children:"áž”áŸ’ážŠáŸáž€ (Landscape)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Group By"}),e.jsxs("select",{value:r,onChange:w=>j(w.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"Page",children:"Page"}),e.jsx("option",{value:"Team",children:"Team"}),e.jsx("option",{value:"None",children:"None"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Columns"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Object.keys(y).map(w=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:y[w].visible,onChange:()=>k(w),className:"h-5 w-5 text-blue-600 rounded border-gray-500 bg-gray-900"}),e.jsx("span",{className:"text-sm text-gray-200",children:y[w].label})]},w))})]}),e.jsxs("div",{className:"flex justify-end pt-4 space-x-3 border-t border-gray-700",children:[e.jsx("button",{onClick:a,className:"btn btn-secondary",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:O,className:"btn btn-primary flex items-center shadow-lg",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"áž€áŸ†áž–áž»áž„ážŠáŸ†ážŽáž¾ážšáž€áž¶ážš..."})]}):e.jsx(e.Fragment,{children:"áž‘áž¶áž‰áž™áž€ PDF"})})]})]})]})},as=({selectedCount:t,isSidebarCollapsed:a,isProcessing:o,onVerify:r,onUnverify:j,onOpenModal:h,onClearSelection:f})=>{const c=a?"64px":"208px";return e.jsx("div",{className:"hidden md:flex fixed bottom-10 left-0 w-full z-[90] justify-center pointer-events-none transition-all duration-500",style:{paddingLeft:c},children:e.jsxs("div",{className:"relative bg-[#0f172a]/95 backdrop-blur-3xl border border-white/10 rounded-[3rem] shadow-[0_30px_70px_rgba(0,0,0,0.8)] p-3 flex items-center gap-6 overflow-hidden ring-1 ring-white/10 pointer-events-auto animate-fade-in-up",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3/4 h-full bg-blue-500/5 blur-[80px] pointer-events-none"}),e.jsxs("div",{className:"flex items-center gap-3.5 pl-5 relative z-10",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-black text-lg shadow-[0_0_25px_rgba(37,99,235,0.4)] animate-pulse-subtle border-2 border-white/10",children:t}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[13px] font-black text-white leading-none tracking-tight",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸ"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"ACTIVE NODE"})]})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsxs("div",{className:"flex items-center bg-[#242f41] p-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsxs("button",{onClick:r,className:"px-6 py-2.5 bg-[#10b981] hover:bg-[#059669] text-white rounded-[1.4rem] text-[11px] font-black uppercase tracking-wider transition-all flex items-center gap-2 shadow-lg active:scale-95 disabled:opacity-50",disabled:o,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:4,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"VERIFY"]}),e.jsx("button",{onClick:j,className:"px-5 py-2.5 text-gray-400 hover:text-white text-[11px] font-black uppercase tracking-wider transition-all active:scale-95 disabled:opacity-50",disabled:o,children:"UNVERIFY"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-6 py-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsx("button",{onClick:()=>h("date"),className:"px-3.5 py-3 hover:text-white text-cyan-400 text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"DATE"}),e.jsx("button",{onClick:()=>h("cost"),className:"px-3.5 py-3 hover:text-white text-[#f6ad55] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"COST"}),e.jsx("button",{onClick:()=>h("payment"),className:"px-3.5 py-3 hover:text-white text-[#4299e1] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"PAY"}),e.jsx("button",{onClick:()=>h("shipping"),className:"px-3.5 py-3 hover:text-white text-[#9f7aea] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"SHIP"})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsx("div",{className:"pr-5 relative z-10",children:e.jsx("button",{onClick:()=>h("delete"),className:"px-6 py-3.5 bg-red-600/10 hover:bg-red-600 text-red-500 hover:text-white border border-red-500/20 rounded-[1.6rem] text-[12px] font-black transition-all active:scale-95 shadow-lg hover:shadow-red-900/20",children:"áž›áž»áž”áž…áŸ„áž›"})}),e.jsx("button",{onClick:f,className:"absolute -top-12 left-1/2 -translate-x-1/2 px-4 py-1.5 bg-gray-800/80 backdrop-blur-md border border-white/10 rounded-full text-[9px] font-black text-gray-400 uppercase tracking-widest hover:text-white transition-all shadow-xl",children:"Clear Selection"})]})})},rs=({selectedCount:t,isProcessing:a,onVerify:o,onUnverify:r,onOpenModal:j,onClearSelection:h})=>e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 w-full z-[100] animate-slide-up",children:[e.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-xl border-t border-white/10 p-3 flex justify-between items-center shadow-2xl relative z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-black text-white text-sm shadow-lg shadow-blue-600/30",children:t}),e.jsx("span",{className:"text-xs font-bold text-gray-300",children:"items selected"})]}),e.jsx("button",{onClick:h,className:"text-[10px] font-black text-gray-500 uppercase tracking-widest bg-gray-800 px-3 py-1.5 rounded-lg border border-gray-700 active:scale-95",children:"Clear"})]}),e.jsx("div",{className:"bg-[#0f172a] p-3 pb-safe-bottom overflow-x-auto custom-scrollbar border-t border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-max",children:[e.jsxs("div",{className:"flex items-center bg-gray-800/50 p-1 rounded-xl border border-white/5",children:[e.jsxs("button",{onClick:o,disabled:a,className:"px-4 py-3 bg-emerald-600 text-white rounded-lg font-black text-[10px] uppercase tracking-wider flex items-center gap-1.5 active:scale-95 disabled:opacity-50",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"Verify"]}),e.jsx("button",{onClick:r,disabled:a,className:"px-4 py-3 text-gray-400 font-bold text-[10px] uppercase tracking-wider active:scale-95 disabled:opacity-50",children:"Unverify"})]}),e.jsxs("button",{onClick:()=>j("date"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ“…"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Date"})]}),e.jsxs("button",{onClick:()=>j("cost"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’°"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Cost"})]}),e.jsxs("button",{onClick:()=>j("payment"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’³"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Pay"})]}),e.jsxs("button",{onClick:()=>j("shipping"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸšš"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Ship"})]}),e.jsx("button",{onClick:()=>j("delete"),className:"px-4 py-3 bg-red-600/10 border border-red-500/20 text-red-500 rounded-xl font-black text-[10px] uppercase tracking-widest active:bg-red-600 active:text-white transition-colors",children:"Delete"})]})}),e.jsx("style",{children:`
                @keyframes slide-up {
                    from { transform: translateY(100%); }
                    to { transform: translateY(0); }
                }
                .animate-slide-up { animation: slide-up 0.3s ease-out forwards; }
                .pb-safe-bottom { padding-bottom: max(12px, env(safe-area-inset-bottom)); }
            `})]}),ns=({orders:t,selectedIds:a,onComplete:o,onClearSelection:r})=>{var W,U;const{appData:j,currentUser:h,refreshData:f,isSidebarCollapsed:c}=i.useContext(le),[l,b]=i.useState(!1),[m,y]=i.useState(null),[z,k]=i.useState(""),[O,w]=i.useState(""),[P,v]=i.useState("Paid"),[L,p]=i.useState(""),[n,g]=i.useState(""),[x,s]=i.useState(""),[D,d]=i.useState(""),[N,u]=i.useState(""),C=async(I,Y)=>{if(a.size!==0&&!(Y&&!window.confirm(Y))){b(!0);try{const q=Array.from(a);for(const ue of q){const xe=t.find(be=>be["Order ID"]===ue);if(!xe)continue;const H={...xe,...I},oe={Timestamp:H.Timestamp,"Order ID":H["Order ID"],User:H.User,Page:H.Page,TelegramValue:H.TelegramValue,"Customer Name":H["Customer Name"],"Customer Phone":H["Customer Phone"],Location:H.Location,"Address Details":H["Address Details"],Note:H.Note||"","Shipping Fee (Customer)":H["Shipping Fee (Customer)"],Subtotal:H.Subtotal,"Grand Total":H["Grand Total"],"Internal Shipping Method":H["Internal Shipping Method"],"Internal Shipping Details":H["Internal Shipping Details"],"Internal Cost":Number(H["Internal Cost"])||0,"Payment Status":H["Payment Status"],"Payment Info":H["Payment Info"]||"","Discount ($)":H["Discount ($)"],"Total Product Cost ($)":H["Total Product Cost ($)"],"Fulfillment Store":H["Fulfillment Store"],Team:H.Team,"Scheduled Time":H["Scheduled Time"]||"",IsVerified:H.IsVerified};oe["Products (JSON)"]=JSON.stringify(H.Products),await fetch(`${ne}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:ue,team:H.Team,userName:h==null?void 0:h.UserName,newData:oe})})}await f(),y(null),o()}catch(q){console.error("Bulk update failed:",q),alert("áž€áž¶ážšáž€áŸ‚ážŸáž˜áŸ’ážšáž½áž›áž”ážšáž¶áž‡áŸáž™!")}finally{b(!1)}}},S=async()=>{if(!(a.size===0||!O)){b(!0);try{const I=Array.from(a),[Y,q,ue]=O.split("-").map(Number);for(const xe of I){const H=t.find(pe=>pe["Order ID"]===xe);if(!H)continue;const oe=new Date(H.Timestamp),be=new Date(Y,q-1,ue,oe.getHours(),oe.getMinutes(),oe.getSeconds()),J={...H,Timestamp:be.toISOString()},je={Timestamp:J.Timestamp,"Order ID":J["Order ID"],User:J.User,Page:J.Page,TelegramValue:J.TelegramValue,"Customer Name":J["Customer Name"],"Customer Phone":J["Customer Phone"],Location:J.Location,"Address Details":J["Address Details"],Note:J.Note||"","Shipping Fee (Customer)":J["Shipping Fee (Customer)"],Subtotal:J.Subtotal,"Grand Total":J["Grand Total"],"Internal Shipping Method":J["Internal Shipping Method"],"Internal Shipping Details":J["Internal Shipping Details"],"Internal Cost":Number(J["Internal Cost"])||0,"Payment Status":J["Payment Status"],"Payment Info":J["Payment Info"]||"","Discount ($)":J["Discount ($)"],"Total Product Cost ($)":J["Total Product Cost ($)"],"Fulfillment Store":J["Fulfillment Store"],Team:J.Team,"Scheduled Time":J["Scheduled Time"]||"",IsVerified:J.IsVerified};je["Products (JSON)"]=JSON.stringify(J.Products),await fetch(`${ne}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:xe,team:J.Team,userName:h==null?void 0:h.UserName,newData:je})})}await f(),y(null),w(""),o()}catch(I){console.error("Bulk date update failed:",I),alert("áž€áž¶ážšáž€áŸ‚áž”áŸ’ážšáŸ‚áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘áž”ážšáž¶áž‡áŸáž™!")}finally{b(!1)}}},$=async()=>{if(a.size!==0){if(N!==(h==null?void 0:h.Password)){alert("áž›áŸážážŸáž˜áŸ’áž„áž¶ážáŸ‹áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœ!");return}b(!0);try{const I=Array.from(a);for(const Y of I){const q=t.find(ue=>ue["Order ID"]===Y);await fetch(`${ne}/api/admin/delete-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:Y,team:q==null?void 0:q.Team,userName:h==null?void 0:h.UserName,telegramMessageId1:q==null?void 0:q["Telegram Message ID 1"],telegramMessageId2:q==null?void 0:q["Telegram Message ID 2"],telegramChatId:q==null?void 0:q.TelegramValue})})}await f(),y(null),u(""),o()}catch{alert("áž€áž¶ážšáž›áž»áž”áž”ážšáž¶áž‡áŸáž™!")}finally{b(!1)}}},A=(W=j.shippingMethods)==null?void 0:W.find(I=>I.MethodName===n),F=A==null?void 0:A.RequireDriverSelection;return a.size===0?null:e.jsxs(e.Fragment,{children:[!m&&e.jsxs(e.Fragment,{children:[e.jsx(as,{selectedCount:a.size,isSidebarCollapsed:c,isProcessing:l,onVerify:()=>C({IsVerified:!0},`áž”áž‰áŸ’áž‡áž¶áž€áŸ‹áž›áž¾áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ${a.size} áž“áŸáŸ‡?`),onUnverify:()=>C({IsVerified:!1}),onOpenModal:y,onClearSelection:r}),e.jsx(rs,{selectedCount:a.size,isProcessing:l,onVerify:()=>C({IsVerified:!0},`áž”áž‰áŸ’áž‡áž¶áž€áŸ‹áž›áž¾áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ${a.size} áž“áŸáŸ‡?`),onUnverify:()=>C({IsVerified:!1}),onOpenModal:y,onClearSelection:r})]}),e.jsx(me,{isOpen:m==="date",onClose:()=>y(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-cyan-500/20 text-cyan-400 rounded-full flex items-center justify-center mx-auto mb-6 border border-cyan-500/30",children:e.jsx("span",{className:"text-3xl",children:"ðŸ“…"})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-2 uppercase tracking-tight",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold text-center mb-6 uppercase tracking-widest",children:"áž˜áŸ‰áŸ„áž„áž“áž¹áž„ážšáž€áŸ’ážŸáž¶áž‘áž»áž€ážŠáž¼áž…ážŠáž¾áž˜ (Time Unchanged)"}),e.jsx("div",{className:"relative mb-8",children:e.jsx("input",{type:"date",value:O,onChange:I=>w(I.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 text-white font-bold text-center rounded-[2rem] focus:ring-4 focus:ring-cyan-500/10 transition-all w-full"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>y(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:S,className:"py-4 bg-cyan-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-cyan-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:l||!O,children:l?e.jsx(se,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(me,{isOpen:m==="cost",onClose:()=>y(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("h3",{className:"text-xl font-black text-white text-center mb-8 uppercase tracking-tight",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážáŸ’áž›áŸƒážŠáž¹áž€ážŠáž¾áž˜ (Cost)"}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("input",{type:"number",step:"0.01",value:z,onChange:I=>k(I.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-6 text-blue-400 font-black text-4xl text-center rounded-[2rem] focus:ring-4 focus:ring-blue-500/10 transition-all",placeholder:"0.00",autoFocus:!0}),e.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 text-gray-600 font-black text-2xl",children:"$"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>y(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>C({"Internal Cost":Number(z)}),className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-blue-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:l||!z,children:l?e.jsx(se,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(me,{isOpen:m==="payment",onClose:()=>y(null),maxWidth:"max-w-lg",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 overflow-hidden flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600/20 rounded-xl flex items-center justify-center border border-blue-500/30",children:e.jsx("span",{className:"text-xl",children:"ðŸ’³"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážŸáŸ’ážáž¶áž“áž—áž¶áž–áž‘áž¼áž‘áž¶ážáŸ‹"})]}),e.jsxs("div",{className:"flex p-1.5 bg-black/40 rounded-2xl border border-gray-700 mb-6",children:[e.jsxs("button",{onClick:()=>{v("Paid")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${P==="Paid"?"bg-emerald-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"PAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(áž‘áž¼áž‘áž¶ážáŸ‹ážšáž½áž…ážšáž¶áž›áŸ‹)"})]}),e.jsxs("button",{onClick:()=>{v("Unpaid"),p("")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${P==="Unpaid"?"bg-red-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"UNPAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(áž˜áž·áž“áž‘áž¶áž“áŸ‹áž‘áž¼áž‘áž¶ážáŸ‹ - COD)"})]})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-1",children:P==="Paid"?e.jsxs("div",{className:"space-y-4 animate-fade-in-down pb-4",children:[e.jsxs("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:(U=j.bankAccounts)==null?void 0:U.map(I=>{const Y=L===I.BankName;return e.jsxs("button",{onClick:()=>p(I.BankName),className:`flex items-center gap-4 p-4 rounded-2xl border transition-all duration-200 group ${Y?"bg-blue-600/20 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.2)]":"bg-gray-800/40 border-white/5 hover:bg-gray-800 hover:border-white/20"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${Y?"bg-black/40":"bg-black/20"}`,children:e.jsx("img",{src:he(I.LogoURL),className:"w-7 h-7 object-contain",alt:""})}),e.jsx("span",{className:`text-xs font-black w-full text-left whitespace-normal leading-tight ${Y?"text-white":"text-gray-400 group-hover:text-gray-200"}`,children:I.BankName}),Y&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 shadow-[0_0_8px_#3b82f6]"})]},I.BankName)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center opacity-50 space-y-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-900/20 flex items-center justify-center border border-red-500/20",children:e.jsx("span",{className:"text-3xl grayscale",children:"ðŸ“¦"})}),e.jsx("p",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"áž€áž¶ážšáž‘áž¼áž‘áž¶ážáŸ‹áž“áž¹áž„ážáŸ’ážšáž¼ážœáž’áŸ’ážœáž¾áž¡áž¾áž„áž–áŸáž›ážŠáž¹áž€ážŠáž›áŸ‹"})]})}),e.jsxs("div",{className:"flex-shrink-0 grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/10",children:[e.jsx("button",{onClick:()=>y(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors bg-gray-800/50 rounded-2xl hover:bg-gray-800",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>C({"Payment Status":P,"Payment Info":P==="Paid"?L:""}),className:"py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2",disabled:l||P==="Paid"&&!L,children:l?e.jsx(se,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€áž€áž¶ážšáž•áŸ’áž›áž¶ážŸáŸ‹áž”áŸ’ážáž¼ážš"})]})]})}),e.jsx(me,{isOpen:m==="shipping",onClose:()=>y(null),maxWidth:"max-w-xl",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 max-h-[85vh] flex flex-col",children:[e.jsx("h3",{className:"text-lg font-black text-white text-center mb-6 uppercase tracking-tight flex-shrink-0",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“"}),e.jsxs("div",{className:"space-y-6 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸážŸáŸážœáž¶ážŠáž¹áž€"}),e.jsx(yt,{methods:j.shippingMethods||[],selectedMethodName:n,onSelect:I=>{g(I.MethodName),s("")}})]}),F&&e.jsxs("div",{className:"space-y-3 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("div",{className:"h-4 w-1 bg-blue-500 rounded-full"}),e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž¢áŸ’áž“áž€ážŠáž¹áž€ (DriverSelection)*"})]}),e.jsx(vt,{drivers:j.drivers||[],selectedDriverName:x,onSelect:s}),!x&&e.jsx("p",{className:"text-center text-[9px] text-gray-500 italic",children:"ážŸáž¼áž˜áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž¢áŸ’áž“áž€ážŠáž¹áž€áž˜áŸ’áž“áž¶áž€áŸ‹"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážáŸ’áž›áŸƒážŠáž¹áž€ážŠáž¾áž˜ (Internal Cost)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",value:D,onChange:I=>d(I.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 pl-4 pr-10 rounded-2xl font-black text-white focus:border-blue-500",placeholder:"áž”áž‰áŸ’áž…áž¼áž›ážáŸ’áž›áŸƒážŠáž¹áž€ážáŸ’áž˜áž¸ (áž”áž¾áž˜áž¶áž“)"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"})]}),e.jsx("div",{className:"flex gap-2",children:[0,1.25,1.5,2].map(I=>e.jsxs("button",{onClick:()=>d(String(I)),className:"flex-1 py-2 bg-gray-800 border border-gray-700 rounded-xl text-[10px] font-bold text-gray-400 hover:text-white hover:bg-gray-700 transition-all",children:["$",I]},I))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6 pt-4 border-t border-white/5 flex-shrink-0",children:[e.jsx("button",{onClick:()=>y(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>{const I={"Internal Shipping Method":n};F?I["Internal Shipping Details"]=x:I["Internal Shipping Details"]=n,D&&(I["Internal Cost"]=Number(D)),C(I)},className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l||!n||F&&!x,children:l?e.jsx(se,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(me,{isOpen:m==="delete",onClose:()=>y(null),maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-4 uppercase tracking-tight",children:"áž›áž»áž”áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸážŸážšáž»áž”"}),e.jsxs("p",{className:"text-center text-gray-500 text-sm mb-8",children:["ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸážáž¶áž…áž„áŸ‹áž›áž»áž”áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ",e.jsx("strong",{children:a.size})," áž“áŸáŸ‡? ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž“áŸáŸ‡áž˜áž·áž“áž¢áž¶áž…ážáŸ’ážšáž¡áž”áŸ‹áž€áŸ’ážšáŸ„áž™áž”áž¶áž“áž‘áŸáŸ”"]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-600 uppercase tracking-widest ml-1",children:"áž”áž‰áŸ’áž…áž¼áž›áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹ážŠáž¾áž˜áŸ’áž”áž¸áž”áž‰áŸ’áž‡áž¶áž€áŸ‹"}),e.jsx("input",{type:"password",value:N,onChange:I=>u(I.target.value),className:"form-input !bg-red-500/5 !border-red-500/20 !py-4 text-center text-white font-black tracking-widest",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>y(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:$,className:"py-4 bg-red-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-red-900/40 active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:l||!N,children:l?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:"sm"}),e.jsx("span",{children:"áž€áŸ†áž–áž»áž„áž›áž»áž”..."})]}):"áž”áž¶áž‘, áž›áž»áž”áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹"})]})]})}),e.jsx("style",{children:`
                @keyframes pulse-subtle {
                    0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(37,99,235,0.2); }
                    50% { transform: scale(1.05); box-shadow: 0 0 35px rgba(37,99,235,0.4); }
                }
                .animate-pulse-subtle {
                    animation: pulse-subtle 2s infinite ease-in-out;
                }
            `})]})},Je=[{key:"index",label:"#"},{key:"orderId",label:"ID"},{key:"customerName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž¢ážáž·ážáž·áž‡áž“"},{key:"productInfo",label:"áž–áŸážáŸŒáž˜áž¶áž“ Product"},{key:"location",label:"áž‘áž¸ážáž¶áŸ†áž„"},{key:"pageInfo",label:"Page"},{key:"fulfillment",label:"ážƒáŸ’áž›áž¶áŸ†áž„ (Fulfillment)"},{key:"total",label:"ážŸážšáž»áž”"},{key:"shippingService",label:"ážŸáŸážœáž¶ážŠáž¹áž€"},{key:"shippingCost",label:"(Cost) ážŸáŸážœáž¶ážŠáž¹áž€"},{key:"status",label:"ážŸáŸ’ážáž¶áž“áž—áž¶áž–"},{key:"date",label:"áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘ & áž˜áŸ‰áŸ„áž„"},{key:"print",label:"áž–áŸ’ážšáž¸áž“"},{key:"actions",label:"ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–"},{key:"check",label:"Check"}],ls=({visibleColumns:t,onToggle:a,columns:o=Je})=>{const[r,j]=i.useState(!1),h=i.useRef(null);return i.useEffect(()=>{const f=c=>{h.current&&!h.current.contains(c.target)&&j(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),e.jsxs("div",{className:"relative inline-block text-left h-full",ref:h,children:[e.jsxs("button",{onClick:()=>j(!r),className:"flex h-full items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M5 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM9 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM13 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM17 4a1 1 0 00-2 0v12a1 1 0 002 0V4z"})}),"Columns",e.jsx("svg",{className:`h-3.5 w-3.5 ml-1 transition-transform duration-500 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 9l-7 7-7-7",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})]}),r&&e.jsx("div",{className:"absolute right-0 mt-3 w-64 bg-[#1a2235]/95 border border-white/10 rounded-[1.8rem] shadow-[0_30px_70px_rgba(0,0,0,0.7)] z-[100] origin-top-right overflow-hidden backdrop-blur-3xl p-3 animate-fade-in-scale",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-[0.2em] px-3 py-2 mb-1",children:"áž€áŸ†ážŽážáŸ‹áž€áž¶ážšáž”áž„áŸ’áž áž¶áž‰"}),o.map(f=>e.jsxs("label",{className:"flex items-center px-3 py-2 text-xs text-gray-300 hover:bg-white/5 rounded-xl cursor-pointer transition-colors group",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded-md border-gray-600 bg-gray-900 text-blue-500 focus:ring-blue-500/20",checked:t.has(f.key),onChange:()=>a(f.key)}),e.jsx("span",{className:"ml-3 font-bold group-hover:text-white transition-colors",children:f.label})]},f.key))]})})]})},os=({isOpen:t,onClose:a,children:o})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`filter-panel-overlay fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] transition-opacity duration-500 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),e.jsxs("div",{className:`filter-panel fixed right-0 top-0 h-full w-[85%] max-w-md bg-[#0f172a] z-[80] shadow-2xl border-l border-white/5 transition-transform duration-500 flex flex-col ${t?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-black/20",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter italic",children:"Filter Engine"}),e.jsx("button",{onClick:a,className:"p-2 bg-white/5 rounded-xl text-gray-400 hover:text-white transition-all",children:"Ã—"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow custom-scrollbar space-y-8",children:o}),e.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20",children:e.jsx("button",{onClick:a,className:"btn btn-primary w-full py-4 text-sm font-black uppercase tracking-[0.2em] shadow-xl shadow-blue-900/20 rounded-2xl active:scale-95 transition-transform",children:"Apply Configuration"})})]})]}),is=({onBack:t,initialFilters:a})=>{const{appData:o,refreshData:r,refreshTimestamp:j,currentUser:h,setMobilePageTitle:f}=i.useContext(le),[c,l]=V("editOrder","");i.useEffect(()=>(f("áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸ"),()=>f(null)),[f]);const[b,m]=V("teamFilter",""),[y,z]=V("dateFilter","this_month"),[k,O]=V("locationFilter",""),[w,P]=V("storeFilter",""),[v,L]=V("startDate",""),[p,n]=V("endDate",""),[g,x]=V("shippingFilter",""),[s,D]=V("driverFilter",""),[d,N]=V("brandFilter",""),[u,C]=V("paymentFilter",""),[S,$]=V("userFilter",""),[A,F]=V("pageFilter",""),[W,U]=V("costFilter",""),[I,Y]=V("bankFilter",""),[q,ue]=V("productFilter",""),[xe,H]=V("customerFilter",""),[oe,be]=i.useState(()=>{const M=Je||[];return new Set(M.filter(R=>R.key!=="productInfo"&&R.key!=="print"&&R.key!=="check"&&R.key!=="fulfillment").map(R=>R.key))}),[J,je]=i.useState([]),[pe,We]=i.useState([]),[ze,Fe]=i.useState(!0),[Ce,Ee]=i.useState(0),[De,Pe]=i.useState(null),[Le,fe]=i.useState(!1),[Re,ge]=i.useState(!1),[we,Ve]=i.useState(""),[Me,ye]=i.useState(new Set),[_,Te]=i.useState(()=>{const M=new URLSearchParams(window.location.search);return{datePreset:(a==null?void 0:a.datePreset)||M.get("dateFilter")||"this_month",startDate:(a==null?void 0:a.startDate)||M.get("startDate")||"",endDate:(a==null?void 0:a.endDate)||M.get("endDate")||"",team:(a==null?void 0:a.team)||M.get("teamFilter")||"",location:(a==null?void 0:a.location)||M.get("locationFilter")||"",fulfillmentStore:(a==null?void 0:a.fulfillmentStore)||M.get("storeFilter")||"",store:(a==null?void 0:a.store)||M.get("brandFilter")||"",shippingService:(a==null?void 0:a.shippingService)||M.get("shippingFilter")||"",driver:(a==null?void 0:a.driver)||M.get("driverFilter")||"",paymentStatus:(a==null?void 0:a.paymentStatus)||M.get("paymentFilter")||"",user:(a==null?void 0:a.user)||M.get("userFilter")||"",page:(a==null?void 0:a.page)||M.get("pageFilter")||"",internalCost:(a==null?void 0:a.internalCost)||M.get("costFilter")||"",bank:(a==null?void 0:a.bank)||M.get("bankFilter")||"",product:(a==null?void 0:a.product)||M.get("productFilter")||"",customerName:(a==null?void 0:a.customerName)||M.get("customerFilter")||""}});i.useEffect(()=>{_.team!==b&&m(_.team),_.datePreset!==y&&z(_.datePreset),_.location!==k&&O(_.location),_.fulfillmentStore!==w&&P(_.fulfillmentStore),_.startDate!==v&&L(_.startDate),_.endDate!==p&&n(_.endDate),_.shippingService!==g&&x(_.shippingService),_.driver!==s&&D(_.driver),_.store!==d&&N(_.store),_.paymentStatus!==u&&C(_.paymentStatus),_.user!==S&&$(_.user),_.page!==A&&F(_.page),_.internalCost!==W&&U(_.internalCost),_.bank!==I&&Y(_.bank),_.product!==q&&ue(_.product),_.customerName!==xe&&H(_.customerName)},[_,b,y,k,w,v,p,g,s,d,u,S,A,W,I,q,xe]);const Ne=i.useMemo(()=>{const M=new Date,R=new Date(M.getFullYear(),M.getMonth(),M.getDate());let E=null,G=new Date;switch(_.datePreset){case"today":E=R;break;case"yesterday":E=new Date(R),E.setDate(R.getDate()-1),G=new Date(R),G.setMilliseconds(-1);break;case"this_week":const X=M.getDay();E=new Date(R),E.setDate(R.getDate()-(X===0?6:X-1));break;case"last_week":E=new Date(R),E.setDate(R.getDate()-M.getDay()-6),G=new Date(E),G.setDate(E.getDate()+6),G.setHours(23,59,59);break;case"this_month":E=new Date(M.getFullYear(),M.getMonth(),1);break;case"last_month":E=new Date(M.getFullYear(),M.getMonth()-1,1),G=new Date(M.getFullYear(),M.getMonth(),0,23,59,59);break;case"this_year":E=new Date(M.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${_.startDate||"..."} to ${_.endDate||"..."}`}const ee=X=>{const Z=X.getFullYear(),Q=String(X.getMonth()+1).padStart(2,"0"),ce=String(X.getDate()).padStart(2,"0");return`${Z}-${Q}-${ce}`};return E?`${ee(E)} to ${ee(G)}`:"All time data stream"},[_.datePreset,_.startDate,_.endDate]),Xe=M=>{be(R=>{const E=new Set(R);return E.has(M)?E.size>1&&E.delete(M):E.add(M),E})},$e=async M=>{let E=[];for(let G=0;G<M.length;G+=500){const X=M.slice(G,G+500).map(Z=>{let Q=[];try{Z["Products (JSON)"]&&(Q=JSON.parse(Z["Products (JSON)"]))}catch{}return{...Z,Products:Q,IsVerified:String(Z.IsVerified).toUpperCase()==="TRUE"}});E=[...E,...X],Ee(Math.round((G+500)/M.length*100)),await new Promise(Z=>setTimeout(Z,0))}return E},T=M=>{const R=M.Timestamp;if(!R)return 0;const E=R.match(/^(\d{4})-(\d{1,2})-(\d{1,2})\s(\d{1,2}):(\d{2})/);return E?new Date(parseInt(E[1]),parseInt(E[2])-1,parseInt(E[3]),parseInt(E[4]),parseInt(E[5])).getTime():new Date(R).getTime()},K=async()=>{Fe(!0),Ee(0),Pe(null);try{const[M,R]=await Promise.all([fetch(`${ne}/api/admin/all-orders`),fetch(`${ne}/api/users`)]),E=await M.json(),G=await R.json();if(E.status==="success"){const ee=(E.data||[]).filter(Z=>Z!==null&&Z["Order ID"]!=="Opening Balance"&&Z["Order ID"]!=="Opening_Balance"),X=await $e(ee);je(X.sort((Z,Q)=>T(Q)-T(Z)))}else Pe(E.message||"Failed to load orders");G.status==="success"&&We(G.data||[])}catch(M){console.error("Fetch Error:",M),Pe("áž˜áž·áž“áž¢áž¶áž…áž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™áž”áž¶áž“áž‘áŸáŸ” ážŸáž¼áž˜áž–áž·áž“áž·ážáŸ’áž™ Internet ážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€áŸ”")}finally{Fe(!1)}};i.useEffect(()=>{K()},[j]);const B=i.useMemo(()=>J.map(M=>{var E;let R=(M.Team||"").trim();if(!R){const G=pe.find(ee=>ee.UserName===M.User);if(G!=null&&G.Team)R=G.Team.split(",")[0].trim();else{const ee=(E=o.pages)==null?void 0:E.find(X=>X.PageName===M.Page);ee!=null&&ee.Team&&(R=ee.Team)}}return{...M,Team:R||"Unassigned"}}),[J,pe,o.pages]),re=i.useMemo(()=>B.filter(M=>{var E;if(_.datePreset!=="all"){const G=T(M),ee=new Date(G),X=new Date,Z=new Date(X.getFullYear(),X.getMonth(),X.getDate());let Q=null,ce=null;switch(_.datePreset){case"today":Q=Z;break;case"yesterday":Q=new Date(Z),Q.setDate(Z.getDate()-1),ce=new Date(Z),ce.setMilliseconds(-1);break;case"this_week":const Ze=X.getDay();Q=new Date(Z),Q.setDate(Z.getDate()-(Ze===0?6:Ze-1));break;case"last_week":Q=new Date(Z),Q.setDate(Z.getDate()-X.getDay()-6),ce=new Date(Q),ce.setDate(Q.getDate()+6),ce.setHours(23,59,59);break;case"this_month":Q=new Date(X.getFullYear(),X.getMonth(),1);break;case"last_month":Q=new Date(X.getFullYear(),X.getMonth()-1,1),ce=new Date(X.getFullYear(),X.getMonth(),0,23,59,59);break;case"this_year":Q=new Date(X.getFullYear(),0,1);break;case"custom":_.startDate&&(Q=new Date(_.startDate+"T00:00:00")),_.endDate&&(ce=new Date(_.endDate+"T23:59:59"));break}if(Q&&ee<Q||ce&&ee>ce)return!1}const R=(G,ee)=>{if(!G)return!0;const X=G.split(",").map(Q=>Q.trim().toLowerCase()),Z=(ee||"").trim().toLowerCase();return X.includes(Z)};if(!R(_.fulfillmentStore,M["Fulfillment Store"]||"Unassigned"))return!1;if(_.store){const G=(E=o.pages)==null?void 0:E.find(Z=>Z.PageName===M.Page),ee=G?G.DefaultStore:null,X=_.store.split(",");if(!ee||!X.includes(ee))return!1}if(!R(_.team,M.Team)||!R(_.user,M.User||"")||!R(_.paymentStatus,M["Payment Status"])||!R(_.shippingService,M["Internal Shipping Method"])||!R(_.driver,M["Internal Shipping Details"])||!R(_.bank,M["Payment Info"])||!R(_.page,M.Page)||!R(_.location,M.Location)||!R(_.internalCost,String(M["Internal Cost"]))||!R(_.customerName,M["Customer Name"])||_.product&&!M.Products.some(G=>G.name===_.product))return!1;if(we.trim()){const G=we.toLowerCase();return M["Order ID"].toLowerCase().includes(G)||(M["Customer Name"]||"").toLowerCase().includes(G)||(M["Customer Phone"]||"").includes(G)}return!0}),[B,_,we,o.pages]),te=M=>{ye(R=>{const E=new Set(R);return E.has(M)?E.delete(M):E.add(M),E})},ie=M=>{const R=M.length>0&&M.every(E=>Me.has(E));ye(R?E=>{const G=new Set(E);return M.forEach(ee=>G.delete(ee)),G}:E=>new Set([...E,...M]))};if(ze)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-5",children:[e.jsx(se,{size:"lg"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-500 uppercase tracking-[0.4em] animate-pulse",children:"Syncing Operational Logs..."}),Ce>0&&e.jsx("div",{className:"w-48 h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${Ce}%`}})})]})]});if(De)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-6 p-6 text-center bg-gray-900/50 rounded-[3rem] border border-red-500/20 m-6 animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-2xl flex items-center justify-center border border-red-500/30 shadow-xl",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight",children:"áž€áŸ†áž áž»ážŸáž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™"}),e.jsx("p",{className:"text-gray-500 font-bold max-w-md",children:De})]}),e.jsx("button",{onClick:K,className:"btn btn-primary px-10 py-4 shadow-lg shadow-blue-600/20",children:"áž–áŸ’áž™áž¶áž™áž¶áž˜áž˜áŸ’ážŠáž„áž‘áŸ€áž"})]});if(c){const M=B.find(R=>R["Order ID"]===c);return M?e.jsx(jt,{order:M,onSaveSuccess:()=>{l(""),K(),r()},onCancel:()=>l("")}):e.jsx("div",{className:"p-20 text-center text-gray-500 font-black uppercase italic tracking-widest",children:"ážšáž€áž˜áž·áž“ážƒáž¾áž‰ Order ID áž“áŸáŸ‡áž‘áŸ"})}return e.jsxs("div",{className:"w-full max-w-full mx-auto px-3 sm:px-6 lg:px-8 animate-fade-in relative pb-40 pt-6 overflow-x-hidden",children:[e.jsx("div",{className:"md:hidden",children:e.jsx(os,{isOpen:Le,onClose:()=>fe(!1),children:e.jsx(Ke,{filters:_,setFilters:Te,orders:B,usersList:pe,appData:o,calculatedRange:Ne})})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(me,{isOpen:Le,onClose:()=>fe(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>fe(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"Ã—"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(Ke,{filters:_,setFilters:Te,orders:B,usersList:pe,appData:o,calculatedRange:Ne})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>fe(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end mb-10 gap-6 px-1",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"hidden md:block text-3xl lg:text-5xl font-black text-white italic tracking-tighter leading-relaxed mb-3 py-1",children:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸ"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600/10 rounded-full border border-blue-500/20",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("span",{className:"text-[11px] font-black text-blue-400 uppercase tracking-widest",children:[re.length," Entries Logged"]})]})})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:t,className:"hidden md:flex group items-center gap-3 px-8 py-4 bg-gray-800/40 backdrop-blur-xl border border-white/5 hover:border-blue-500/30 text-gray-500 hover:text-blue-400 font-black uppercase tracking-widest text-[12px] rounded-2xl transition-all shadow-xl active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Core"]})})]}),e.jsx("div",{className:"bg-gray-800/20 backdrop-blur-3xl border border-white/5 rounded-[2.5rem] p-5 sm:p-6 mb-8 shadow-2xl relative z-20 group transition-all hover:bg-gray-800/30",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"relative w-full lg:max-w-2xl group",children:[e.jsx("input",{type:"text",placeholder:"ážŸáŸ’ážœáŸ‚áž„ážšáž€ ID, ážˆáŸ’áž˜áŸ„áŸ‡, áž¬áž›áŸážáž‘áž¼ážšážŸáŸáž–áŸ’áž‘...",value:we,onChange:M=>Ve(M.target.value),className:"form-input !pl-16 !py-5 bg-black/40 border-gray-800 rounded-[1.8rem] text-[15px] font-bold text-white placeholder:text-gray-700 focus:border-blue-500/50 focus:bg-black/60 transition-all shadow-inner"}),e.jsxs("div",{className:"absolute left-6 top-1/2 -translate-y-1/2 flex items-center gap-4 text-gray-700 group-focus-within:text-blue-500 transition-colors",children:[e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("div",{className:"h-6 w-px bg-gray-800"})]})]}),e.jsxs("div",{className:"flex items-stretch gap-3 w-full lg:w-auto h-16 sm:h-[68px]",children:[e.jsxs("button",{onClick:()=>fe(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]}),e.jsxs("button",{onClick:()=>ge(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-red-600/10 border border-red-500/20 text-red-500 hover:bg-red-600 hover:text-white rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-red-950/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Export"]}),e.jsx("div",{className:"hidden lg:block h-full",children:e.jsx(ls,{columns:Je,visibleColumns:oe,onToggle:Xe})})]})]})}),e.jsx("div",{className:"relative z-10",children:e.jsx(wt,{orders:re,onEdit:M=>l(M["Order ID"]),showActions:!0,visibleColumns:oe,selectedIds:Me,onToggleSelect:te,onToggleSelectAll:ie})}),e.jsx(ns,{orders:B,selectedIds:Me,onComplete:()=>{ye(new Set),K()},onClearSelection:()=>ye(new Set)}),Re&&e.jsx(ss,{isOpen:Re,onClose:()=>ge(!1),orders:re})]})},cs=(t,a)=>{const[o,r]=i.useState(null),j=i.useMemo(()=>{const f={Pending:[],Packing:[],Shipped:[]};return t.forEach(c=>{const l=c.FulfillmentStatus||"Pending";l!=="Cancelled"&&(f[l]?f[l].push(c):f.Pending.push(c))}),f},[t]),h=i.useCallback(async(f,c)=>{r(f);try{if(!(await fetch(`${ne}/api/admin/update-sheet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:"AllOrders",primaryKey:{"Order ID":f},newData:{FulfillmentStatus:c}})})).ok)throw new Error("Failed to update status");a&&a()}catch(l){console.error("Fulfillment update error:",l),alert("áž˜áž·áž“áž¢áž¶áž…áž’áŸ’ážœáž¾áž”áž…áŸ’áž…áž»áž”áŸ’áž”áž“áŸ’áž“áž—áž¶áž–ážŸáŸ’ážáž¶áž“áž—áž¶áž–áž”áž¶áž“áž‘áŸáŸ” ážŸáž¼áž˜áž–áŸ’áž™áž¶áž™áž¶áž˜áž˜áŸ’ážáž„áž‘áŸ€ážáŸ”")}finally{r(null)}},[a]);return{ordersByStatus:j,updateStatus:h,loadingId:o}},ds=({order:t,onStatusChange:a,isLoading:o})=>{const r=t.FulfillmentStatus||"Pending";return e.jsxs("div",{className:"bg-gray-800/40 border border-gray-700 rounded-2xl p-5 space-y-4 hover:border-blue-500/50 transition-all shadow-lg animate-fade-in relative overflow-hidden group",children:[o&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm z-10 flex items-center justify-center",children:e.jsx(se,{size:"md"})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black uppercase text-sm tracking-tight",children:t["Order ID"].substring(0,8)}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase mt-0.5",children:[t.Page," (",t.Team,")"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-bold text-gray-300",children:t["Customer Name"]}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono",children:t["Customer Phone"]})]})]}),e.jsx("div",{className:"bg-black/20 rounded-xl p-3 border border-white/5 space-y-2",children:t.Products.map((j,h)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-900 rounded-lg border border-gray-700 overflow-hidden flex-shrink-0",children:e.jsx("img",{src:he(j.image),className:"w-full h-full object-cover",alt:""})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-200 truncate leading-tight",children:j.name}),e.jsxs("div",{className:"flex justify-between mt-0.5",children:[e.jsxs("span",{className:"text-[10px] text-blue-400 font-black",children:["Qty: ",j.quantity]}),j.colorInfo&&e.jsxs("span",{className:"text-[10px] text-purple-400 italic",children:["áž–ážŽáŸŒ: ",j.colorInfo]})]})]})]},h))}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[r==="Pending"&&e.jsx("button",{onClick:()=>a(t["Order ID"],"Packing"),className:"flex-1 btn bg-blue-600 hover:bg-blue-700 text-white text-[10px] font-black uppercase py-2 rounded-xl",children:"áž…áž¶áž”áŸ‹áž•áŸ’ážáž¾áž˜ážœáŸáž…ážáŸ’áž…áž”áŸ‹"}),r==="Packing"&&e.jsx("button",{onClick:()=>a(t["Order ID"],"Shipped"),className:"flex-1 btn bg-emerald-600 hover:bg-emerald-700 text-white text-[10px] font-black uppercase py-2 rounded-xl",children:"áž•áŸ’áž‰áž¾áž…áŸáž‰ážšáž½áž…ážšáž¶áž›áŸ‹"}),r==="Shipped"&&e.jsx("div",{className:"flex-1 text-center py-2 bg-gray-700/50 rounded-xl text-[10px] font-black text-gray-400 uppercase",children:"âœ… áž”áž¶áž“áž”áž‰áŸ’áž…áŸáž‰áž‘áŸ†áž“áž·áž‰"})]})]})},xs=({orders:t})=>{const{refreshData:a,setMobilePageTitle:o}=i.useContext(le),{ordersByStatus:r,updateStatus:j,loadingId:h}=cs(t,a),[f,c]=i.useState("Pending");i.useEffect(()=>(o("Fulfillment Store"),()=>o(null)),[o]);const l=i.useMemo(()=>f==="Pending"?r.Pending:f==="Packing"?r.Packing:r.Shipped,[f,r]);return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-800/20 p-5 rounded-[2rem] border border-white/5 backdrop-blur-md",children:[e.jsx("h1",{className:"hidden sm:block text-2xl font-black text-white uppercase tracking-tighter",children:"Fulfillment Store"}),e.jsx("div",{className:"flex bg-black/40 p-1 rounded-xl border border-white/5",children:["Pending","Packing","Shipped"].map(b=>e.jsxs("button",{onClick:()=>c(b),className:`px-6 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${f===b?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-white"}`,children:[b==="Pending"?"ážáŸ’ážšáž¼ážœážœáŸáž…ážáŸ’áž…áž”áŸ‹":b==="Packing"?"áž€áŸ†áž–áž»áž„ážœáŸáž…ážáŸ’áž…áž”áŸ‹":"áž”áž¶áž“áž•áŸ’áž‰áž¾áž…áŸáž‰",e.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-black/30 rounded-md text-[8px]",children:r[b].length})]},b))})]}),l.length===0?e.jsx("div",{className:"py-20 text-center bg-gray-800/10 rounded-[3rem] border-2 border-dashed border-gray-700/50",children:e.jsx("p",{className:"text-gray-500 font-black uppercase tracking-[0.2em] text-sm",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™áž€áŸ’áž“áž»áž„áž”áž‰áŸ’áž‡áž¸áž“áŸáŸ‡áž‘áŸ"})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:l.map(b=>e.jsx(ds,{order:b,onStatusChange:j,isLoading:h===b["Order ID"]},b["Order ID"]))})]})},fs=()=>{const{appData:t,currentUser:a,refreshTimestamp:o,isSidebarCollapsed:r}=i.useContext(le),[j,h]=V("tab","admin"),[f,c]=V("subview","dashboard"),[l,b]=V("reportType","overview"),[m,y]=i.useState(!1),[z,k]=i.useState(!1),[O,w]=i.useState(!1),[P,v]=i.useState(!1),[L,p]=i.useState("desktop"),[n,g]=i.useState([]),[x,s]=i.useState({preset:"today",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[D,d]=V("teamFilter",""),[N,u]=V("locationFilter",""),[C,S]=V("storeFilter",""),[$,A]=V("dateFilter","today"),[F,W]=V("startDate",""),[U,I]=V("endDate",""),[Y,q]=V("shippingFilter",""),[ue,xe]=V("driverFilter",""),[H,oe]=V("brandFilter",""),[be,J]=V("paymentFilter",""),[je,pe]=V("userFilter",""),[We,ze]=V("pageFilter",""),[Fe,Ce]=V("costFilter",""),[Ee,De]=V("bankFilter",""),[Pe,Le]=V("productFilter","");i.useEffect(()=>{const T=()=>{const K=window.innerWidth;K<768?p("mobile"):K<1280?p("tablet"):p("desktop")};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]);const fe=async()=>{n.length===0&&y(!0);try{const T=await fetch(`${ne}/api/admin/all-orders`);if(T.ok){const K=await T.json();if(K.status==="success"){const re=(Array.isArray(K.data)?K.data.filter(te=>te!==null&&te["Order ID"]!=="Opening_Balance"&&te["Order ID"]!=="Opening Balance"):[]).map(te=>{let ie=[];try{te["Products (JSON)"]&&(ie=JSON.parse(te["Products (JSON)"]))}catch{}return{...te,Products:ie,IsVerified:String(te.IsVerified).toUpperCase()==="TRUE",FulfillmentStatus:te.FulfillmentStatus}});g(re)}}}catch(T){console.error(T)}finally{y(!1)}};i.useEffect(()=>{fe()},[o]);const Re=()=>{const T=new Date,K=new Date(T.getFullYear(),T.getMonth(),T.getDate());return n.filter(B=>{if(!B.Timestamp)return!1;const re=new Date(B.Timestamp);if(x.preset==="today")return re.toDateString()===T.toDateString();if(x.preset==="this_week"){const te=T.getDay(),ie=new Date(K);ie.setDate(K.getDate()-(te===0?6:te-1));const M=new Date(ie);return M.setDate(ie.getDate()+6),M.setHours(23,59,59,999),re>=ie&&re<=M}else{if(x.preset==="this_month")return re.getMonth()===T.getMonth()&&re.getFullYear()===T.getFullYear();if(x.preset==="custom"){const te=x.start?new Date(x.start+"T00:00:00"):null,ie=x.end?new Date(x.end+"T23:59:59"):null;return!(te&&re<te||ie&&re>ie)}}return re.toDateString()===T.toDateString()})},ge=i.useMemo(()=>Re(),[n,x]),we=i.useMemo(()=>{const T={};return ge.forEach(K=>{let B=K.Team||"Unassigned";T[B]||(T[B]={name:B,revenue:0,orders:0}),T[B].revenue+=Number(K["Grand Total"])||0,T[B].orders+=1}),Object.values(T).sort((K,B)=>B.revenue-K.revenue)},[ge]),Ve=i.useMemo(()=>{const T={};return ge.forEach(K=>{let B=K["Fulfillment Store"]||"Unassigned";T[B]||(T[B]={name:B,revenue:0,orders:0}),T[B].revenue+=Number(K["Grand Total"])||0,T[B].orders+=1}),Object.values(T).sort((K,B)=>B.revenue-K.revenue)},[ge]),Me=i.useMemo(()=>{const T={};return ge.forEach(K=>{const B=(K.Location||"").split(/[,|\-|/]/)[0].trim();!B||B.toUpperCase()==="N/A"||(T[B]||(T[B]={name:B,revenue:0,orders:0}),T[B].revenue+=Number(K["Grand Total"])||0,T[B].orders+=1)}),Object.values(T).sort((K,B)=>B.revenue-K.revenue)},[ge]),ye=T=>{T==="reports"?k(!z):(["dashboard","performance"].includes(T)?(h("admin"),c(T)):h(T),k(!1))},_=T=>{h("reports"),b(T)},Te=T=>{d(""),u(""),S(""),oe(""),q(""),xe(""),J(""),pe(""),ze(""),Ce(""),De(""),Le(""),T.team&&d(T.team),T.location&&u(T.location),T.fulfillmentStore&&S(T.fulfillmentStore),T.store&&oe(T.store),T.shipping&&q(T.shipping),T.driver&&xe(T.driver),T.paymentStatus&&J(T.paymentStatus),T.user&&pe(T.user),T.page&&ze(T.page),T.internalCost&&Ce(T.internalCost),T.bank&&De(T.bank),T.product&&Le(T.product),T.datePreset&&(A(T.datePreset),T.datePreset==="custom"&&T.startDate&&T.endDate?(W(T.startDate),I(T.endDate)):(W(""),I(""))),h("orders")},Ne=(T,K)=>{const B={};T==="team"&&(B.team=K),T==="location"&&(B.location=K),T==="store"&&(B.fulfillmentStore=K),B.datePreset=x.preset,x.preset==="custom"&&(B.startDate=x.start,B.endDate=x.end),Te(B)},$e={activeDashboard:j,currentAdminView:f,isReportSubMenuOpen:z,setIsReportSubMenuOpen:k,isProfileSubMenuOpen:O,setIsProfileSubMenuOpen:w,onNavChange:ye,onReportSubNav:_,setEditProfileModalOpen:v,children:(()=>{if(m&&n.length===0)return e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx(se,{size:"lg"})});switch(j){case"admin":return f==="dashboard"?e.jsx(Ft,{currentUser:a,parsedOrders:n,dateFilter:x,setDateFilter:s,teamRevenueStats:we,provinceStats:Me,storeStats:Ve,onTeamClick:T=>Ne("team",T),onProvinceClick:T=>Ne("location",T),onStoreClick:T=>Ne("store",T)}):e.jsx(Gt,{orders:n,users:t.users||[],targets:t.targets||[]});case"orders":return e.jsx(is,{onBack:()=>h("admin"),initialFilters:{team:D,location:N,fulfillmentStore:C,store:H,datePreset:$,startDate:F,endDate:U,shippingService:Y,driver:ue,paymentStatus:be,user:je,page:We,internalCost:Fe,bank:Ee,product:Pe}});case"reports":return e.jsx(qt,{activeReport:l,onBack:()=>h("admin"),onNavigate:Te});case"settings":return e.jsx(ts,{onBack:()=>h("admin")});case"fulfillment":return e.jsx(xs,{orders:n});default:return null}})()};return e.jsxs(e.Fragment,{children:[L==="mobile"?e.jsx(St,{...$e}):L==="tablet"?e.jsx(Ct,{...$e}):e.jsx(kt,{...$e,isSidebarCollapsed:r}),P&&e.jsx(xt,{onClose:()=>v(!1)})]})};export{fs as default};
