import{r as m,A as re,j as e,c as he,a as Ye,S as te,R as et,u as E,M as ie,W as ae,i as tt,f as st}from"./index-BlX76rUu.js";import{U as Le}from"./UserAvatar-v9fKQDJR.js";import{t as at,E as rt}from"./EditProfileModal-B5HmO1PS.js";import{S as ee,a as lt,G as nt,b as ot,c as qe,E as Fe,d as it,e as ct,f as dt,g as xt,h as mt,D as ht,i as ut,O as pt}from"./OrdersList-BCyQWLCN.js";import gt from"./html2canvas.esm-QH1iLAAe.js";import"./imageCompressor-D5vYYzIg.js";const Xe=({activeDashboard:s,currentAdminView:a,isReportSubMenuOpen:l,isProfileSubMenuOpen:r,onNavChange:v,onReportSubNav:b,setIsReportSubMenuOpen:N,setIsProfileSubMenuOpen:p,setEditProfileModalOpen:d,isMobile:S=!1})=>{const{currentUser:u,logout:w,refreshData:F,isSidebarCollapsed:P,setIsSidebarCollapsed:I,setAppState:k,setIsChatOpen:O,unreadCount:h,language:y,setLanguage:t}=m.useContext(re),[o,M]=m.useState(!1),x=at[y],c=[{id:"overview",title:x.overview,icon:"ðŸ“Š"},{id:"sales_team",title:x.sales_team_report,icon:"ðŸ‘¥"},{id:"sales_page",title:x.sales_page_report,icon:"ðŸ“„"},{id:"performance",title:x.performance,icon:"ðŸ“ˆ"},{id:"profitability",title:x.profitability,icon:"ðŸ’°"},{id:"forecasting",title:x.forecasting,icon:"ðŸ”®"},{id:"shipping",title:x.shipping_report,icon:"ðŸšš"}],g=[{id:"dashboard",label:x.dashboard,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),component:"admin"},{id:"fulfillment",label:"Fulfillment",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",strokeWidth:2})}),component:"fulfillment"},{id:"orders",label:x.orders,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),component:"orders"},{id:"reports",label:x.reports,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),component:"reports"},{id:"settings",label:x.settings,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),component:"settings"}],j=(u==null?void 0:u.IsSystemAdmin)&&((u==null?void 0:u.Team)||"").split(",").map(f=>f.trim()).filter(Boolean).length>0,n=async()=>{M(!0);try{await F(),window.location.reload()}catch{M(!1)}},i=S?"w-full flex flex-col h-full bg-transparent":`fixed left-0 top-0 h-screen border-r border-white/5 z-50 transition-all duration-300 ease-in-out ${P?"w-20":"w-64"} bg-[#020617]/95 backdrop-blur-3xl flex flex-col shadow-2xl`;return e.jsxs("aside",{className:i,children:[!S&&e.jsxs("div",{className:"h-20 flex items-center gap-4 px-6 border-b border-white/5 overflow-hidden relative group shrink-0",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-600/20 flex-shrink-0 transition-all border border-white/10 z-10",children:e.jsx("img",{src:he(Ye),alt:"Logo",className:"w-5 h-5 object-contain"})}),!P&&e.jsxs("div",{className:"flex flex-col z-10 animate-fade-in min-w-0",children:[e.jsx("h1",{className:"text-base font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em]",children:"Admin"})]})]}),!S&&e.jsx("button",{onClick:()=>I(!P),className:"absolute top-[4.5rem] -right-3 w-6 h-6 bg-[#0f172a] border border-gray-700 rounded-full flex items-center justify-center text-gray-400 hover:text-white shadow-xl z-[60] transition-all hover:scale-110 hover:border-blue-500/50",children:e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 ${P?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:e.jsx("path",{d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-0 py-6 space-y-1",children:[S&&e.jsx("div",{className:"px-4 mb-6",children:e.jsxs("button",{onClick:()=>O(!0),className:"w-full flex items-center justify-between px-4 py-3.5 rounded-2xl bg-gradient-to-r from-blue-600/20 to-indigo-600/20 text-blue-300 border border-blue-500/30 active:scale-[0.98] transition-all shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative p-1.5 bg-blue-500/20 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),h>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-gray-900 animate-pulse"})]}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:x.chat_system})]}),h>0&&e.jsx("span",{className:"bg-red-500 text-white text-[9px] font-black px-2 py-0.5 rounded-full shadow-lg",children:h})]})}),g.map(f=>{const L=f.id==="reports",$=s===f.component&&(f.component!=="admin"||f.id===a),C=L&&l;return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>v(f.id),className:`
                                    w-full flex items-center justify-between px-6 py-4 transition-all duration-200 group relative
                                    ${$?"text-white bg-gradient-to-r from-blue-600/30 to-transparent border-l-4 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.1)]":"text-gray-400 hover:text-white hover:bg-white/5 border-l-4 border-transparent"}
                                `,title:P&&!S?f.label:"",children:[e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("span",{className:`transition-transform duration-300 ${$?"scale-110 text-blue-400":"group-hover:text-gray-200"}`,children:f.icon}),(S||!P)&&e.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${$?"text-white":""}`,children:f.label})]}),L&&(S||!P)&&e.jsx("svg",{className:`w-3 h-3 transition-transform duration-300 opacity-50 ${C?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out bg-black/20 ${C&&(S||!P)?"max-h-[500px] opacity-100 py-2":"max-h-0 opacity-0"}`,children:c.map(z=>e.jsxs("button",{onClick:()=>b(z.id),className:"w-full flex items-center gap-3 px-6 pl-14 py-2.5 text-[10px] font-bold uppercase tracking-wider text-gray-500 hover:text-white hover:bg-white/5 transition-all relative group",children:[e.jsx("div",{className:"absolute left-10 w-1.5 h-1.5 rounded-full bg-gray-700 group-hover:bg-blue-500 transition-colors"}),e.jsx("span",{className:"truncate",children:z.title})]},z.id))})]},f.id)})]}),e.jsxs("div",{className:`p-4 shrink-0 ${S?"":"border-t border-white/5 bg-black/20"}`,children:[e.jsxs("button",{onClick:()=>p(!r),className:`
                        w-full flex items-center gap-3 p-2.5 rounded-2xl transition-all duration-300
                        ${r?"bg-gray-800":"hover:bg-white/5"}
                        ${!S&&P?"justify-center":""}
                    `,children:[e.jsx(Le,{avatarUrl:u==null?void 0:u.ProfilePictureURL,name:(u==null?void 0:u.FullName)||"",size:"md",className:"ring-2 ring-white/5 shadow-md flex-shrink-0"}),(S||!P)&&e.jsxs("div",{className:"min-w-0 flex-grow text-left",children:[e.jsx("p",{className:"text-xs font-black text-white truncate leading-tight",children:u==null?void 0:u.FullName}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-widest mt-0.5 truncate",children:u==null?void 0:u.Role})]}),(S||!P)&&e.jsx("svg",{className:`w-3 h-3 text-gray-500 transition-transform duration-300 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]}),e.jsx("div",{className:`
                    overflow-hidden transition-all duration-300 ease-in-out
                    ${r&&(S||!P)?"max-h-[300px] mt-4 opacity-100":"max-h-0 opacity-0"}
                `,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-gray-900 rounded-xl p-1 flex border border-white/5",children:[e.jsx("button",{onClick:()=>t("en"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${y==="en"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"ENG"}),e.jsx("button",{onClick:()=>t("km"),className:`flex-1 py-1.5 text-[9px] font-black uppercase rounded-lg transition-all ${y==="km"?"bg-blue-600 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:"KH"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>d(!0),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-blue-600/20 hover:border-blue-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400 mb-1.5 group-hover:scale-110 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Profile"})]}),e.jsxs("button",{onClick:n,disabled:o,className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-emerald-600/20 hover:border-emerald-500/30 transition-all group",children:[o?e.jsx(te,{size:"sm"}):e.jsx("svg",{className:"w-4 h-4 text-emerald-400 mb-1.5 group-hover:rotate-180 transition-transform duration-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Sync"})]}),j&&e.jsxs("button",{onClick:()=>k("role_selection"),className:"flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-yellow-600/20 hover:border-yellow-500/30 transition-all group",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-400 mb-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Switch"})]}),e.jsxs("button",{onClick:w,className:`flex flex-col items-center justify-center p-3 bg-gray-800/50 rounded-2xl border border-white/5 hover:bg-red-600/20 hover:border-red-500/30 transition-all group ${j?"":"col-span-2"}`,children:[e.jsx("svg",{className:"w-4 h-4 text-red-400 mb-1.5 group-hover:translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 group-hover:text-white",children:"Logout"})]})]})]})})]})]})},bt=({children:s,activeDashboard:a,currentAdminView:l,isSidebarCollapsed:r,onNavChange:v,onReportSubNav:b,isReportSubMenuOpen:N,setIsReportSubMenuOpen:p,isProfileSubMenuOpen:d,setIsProfileSubMenuOpen:S,setEditProfileModalOpen:u})=>e.jsxs("div",{className:"flex min-h-screen bg-gray-950",children:[e.jsx(Xe,{activeDashboard:a,currentAdminView:l,isReportSubMenuOpen:N,isProfileSubMenuOpen:d,onNavChange:v,onReportSubNav:b,setIsReportSubMenuOpen:p,setIsProfileSubMenuOpen:S,setEditProfileModalOpen:u}),e.jsxs("main",{className:`flex-1 transition-all duration-300 ease-in-out ${r?"pl-20":"pl-64"}`,children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-50 overflow-hidden",children:e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-600/5 rounded-full blur-[120px]"})}),e.jsx("div",{className:"p-4 md:p-6 lg:p-8 xl:p-10 2xl:p-12 max-w-[2400px] mx-auto min-h-screen relative z-10 transition-all duration-300",children:s})]})]}),Ze=({activeDashboard:s,currentAdminView:a,onNavChange:l,onReportSubNav:r,isReportSubMenuOpen:v,setIsReportSubMenuOpen:b,isProfileSubMenuOpen:N,setIsProfileSubMenuOpen:p,setEditProfileModalOpen:d})=>{const{isMobileMenuOpen:S,setIsMobileMenuOpen:u}=m.useContext(re);return S?e.jsxs("div",{className:"fixed inset-0 z-[100] flex overflow-hidden",children:[e.jsx("style",{children:`
                @keyframes slide-right {
                    from { transform: translateX(-100%); }
                    to { transform: translateX(0); }
                }
                .animate-slide-right {
                    animation: slide-right 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
                }
            `}),e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md transition-opacity duration-300",onClick:()=>u(!1)}),e.jsxs("div",{className:"relative w-[85%] max-w-[320px] h-full bg-[#020617] shadow-2xl animate-slide-right flex flex-col border-r border-white/10",children:[e.jsxs("div",{className:"flex-shrink-0 px-6 pt-12 pb-6 flex items-center justify-between bg-gradient-to-b from-[#0f172a] to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/40 border border-white/10 overflow-hidden p-1.5",children:e.jsx("img",{src:he(Ye),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("p",{className:"text-[9px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"Core Access"})]})]}),e.jsx("button",{onClick:()=>u(!1),className:"w-9 h-9 rounded-full bg-white/5 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 border border-white/5 transition-all active:scale-90",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 18L18 6M6 6l12 12",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:"flex-grow overflow-hidden relative z-10",children:e.jsx(Xe,{isMobile:!0,activeDashboard:s,currentAdminView:a,isReportSubMenuOpen:v,isProfileSubMenuOpen:N,onNavChange:w=>{l(w),w!=="reports"&&u(!1)},onReportSubNav:w=>{r(w),u(!1)},setIsReportSubMenuOpen:b,setIsProfileSubMenuOpen:p,setEditProfileModalOpen:d})})]})]}):null},ft=({children:s,activeDashboard:a,currentAdminView:l,onNavChange:r,onReportSubNav:v,isReportSubMenuOpen:b,setIsReportSubMenuOpen:N,isProfileSubMenuOpen:p,setIsProfileSubMenuOpen:d,setEditProfileModalOpen:S})=>e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-5%] left-[-10%] w-[60%] h-[40%] bg-blue-600/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-5%] right-[-5%] w-[60%] h-[40%] bg-indigo-600/10 rounded-full blur-[120px]"})]}),e.jsx(Ze,{activeDashboard:a,currentAdminView:l,onNavChange:r,onReportSubNav:v,isReportSubMenuOpen:b,setIsReportSubMenuOpen:N,isProfileSubMenuOpen:p,setIsProfileSubMenuOpen:d,setEditProfileModalOpen:S}),e.jsx("main",{className:"flex-1 pb-12 px-3 overflow-x-hidden relative z-10",children:e.jsx("div",{className:"max-w-xl mx-auto",children:s})}),e.jsx("div",{className:"h-1 w-24 bg-white/5 rounded-full mx-auto mb-4"})]}),yt=({children:s,activeDashboard:a,currentAdminView:l,onNavChange:r,onReportSubNav:v,isReportSubMenuOpen:b,setIsReportSubMenuOpen:N,isProfileSubMenuOpen:p,setIsProfileSubMenuOpen:d,setEditProfileModalOpen:S})=>{const{setIsMobileMenuOpen:u,currentUser:w}=et.useContext(re);return e.jsxs("div",{className:"min-h-screen bg-gray-950 flex flex-col selection:bg-blue-500/30",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-5%] w-[50%] h-[50%] bg-blue-900/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-5%] w-[50%] h-[50%] bg-purple-900/10 rounded-full blur-[120px]"})]}),e.jsxs("header",{className:"sticky top-0 z-40 bg-[#0f172a]/80 backdrop-blur-xl border-b border-white/5 px-6 py-4 flex justify-between items-center shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u(!0),className:"p-2.5 rounded-xl bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white transition-all border border-white/5 active:scale-95",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/20 p-1.5 border border-white/10",children:e.jsx("img",{src:he(Ye),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-black text-white italic uppercase tracking-tighter leading-none",children:"O-System"}),e.jsx("span",{className:"text-[10px] text-blue-400 font-bold uppercase tracking-[0.2em]",children:"Tablet Admin"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-sm font-bold text-white leading-tight",children:w==null?void 0:w.FullName}),e.jsx("p",{className:"text-[10px] text-gray-500 font-mono uppercase",children:w==null?void 0:w.Role})]}),e.jsx(Le,{avatarUrl:w==null?void 0:w.ProfilePictureURL,name:(w==null?void 0:w.FullName)||"",size:"md",className:"ring-2 ring-white/10 shadow-md"})]})]}),e.jsx(Ze,{activeDashboard:a,currentAdminView:l,onNavChange:r,onReportSubNav:v,isReportSubMenuOpen:b,setIsReportSubMenuOpen:N,isProfileSubMenuOpen:p,setIsProfileSubMenuOpen:d,setEditProfileModalOpen:S}),e.jsx("main",{className:"flex-1 p-6 relative z-10 overflow-x-hidden",children:e.jsx("div",{className:"w-full mx-auto",children:s})})]})},vt=({stats:s,onStatClick:a})=>{const l=m.useMemo(()=>s.reduce((r,v)=>({revenue:r.revenue+v.revenue,orders:r.orders+v.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z"}),e.jsx("path",{d:"M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z"})]}),"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”ážáž¶áž˜áž€áŸ’ážšáž»áž˜"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"áž€áŸ’ážšáž»áž˜"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,v)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",v+1]}),e.jsx("span",{className:"group-hover:text-blue-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:l.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",l.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},jt="https://raw.githubusercontent.com/seanghai/cambodia-geojson/master/geojson/provinces.json",we={minLng:102.3,maxLng:107.6,minLat:10.4,maxLat:14.7},Ee=["#1f2937","#1e3a8a","#2563eb","#3b82f6","#60a5fa","#93c5fd"],Ke=[0,500,1e3,5e3,1e4,2e4],wt=({data:s})=>{var y;const[a,l]=m.useState(null),[r,v]=m.useState(!0),[b,N]=m.useState(null),[p,d]=m.useState(null),[S,u]=m.useState({x:0,y:0}),w=m.useRef(null),F=t=>t?String(t).toLowerCase().replace(/\s/g,"").replace(/province|city|ážšáž¶áž‡áž’áž¶áž“áž¸|ážáŸážáŸ’áž/g,"").trim():"",P=m.useMemo(()=>{const t={};return s.forEach(o=>{const M=F(o.name);M&&(t[M]?(t[M].revenue+=o.revenue,t[M].orders+=o.orders):t[M]={...o})}),t},[s]),I=async()=>{v(!0),N(null);try{const t=await fetch(jt);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const o=await t.json();l(o),v(!1)}catch(t){console.error("Map Fetch Error:",t),N("áž˜áž·áž“áž¢áž¶áž…áž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™áž•áŸ‚áž“áž‘áž¸áž”áž¶áž“áž‘áŸáŸ” ážŸáž¼áž˜áž–áž·áž“áž·ážáŸ’áž™ Internet áž¬áž‘áž¶áž€áŸ‹áž‘áž„áž¢áŸ’áž“áž€áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áŸ”"),v(!1)}};m.useEffect(()=>{I()},[]);const k=(t,o)=>{const c=(t-we.minLng)/(we.maxLng-we.minLng)*1e3,g=1e3-(o-we.minLat)/(we.maxLat-we.minLat)*1e3;return[c,g]},O=t=>{if(t===0)return Ee[0];for(let o=Ke.length-1;o>=0;o--)if(t>=Ke[o])return Ee[o];return Ee[0]},h=m.useMemo(()=>a?a.features.map((t,o)=>{const M=t.properties||{},x=[M.name_kh,M.Name_KH,M.name_en,M.name,M.HRNAME_KH];let c={revenue:0,orders:0},g=M.name_kh||M.name_en||"áž˜áž·áž“ážŸáŸ’áž‚áž¶áž›áŸ‹";for(const C of x){const z=F(String(C));if(C&&P[z]){c=P[z];break}}const j=t.geometry.type,n=t.geometry.coordinates,i=C=>"M "+C.map(z=>{const[J,X]=k(z[0],z[1]);return`${J.toFixed(2)},${X.toFixed(2)}`}).join(" L ")+" Z";let f="";j==="Polygon"?f=n.map(C=>i(C)).join(" "):j==="MultiPolygon"&&(f=n.map(C=>C.map(z=>i(z)).join(" ")).join(" "));const L=O(c.revenue),$=(p==null?void 0:p.name)===g;return e.jsx("path",{d:f,fill:L,stroke:$?"#ffffff":"rgba(255,255,255,0.1)",strokeWidth:$?"2.5":"0.5",onMouseEnter:C=>{var J;d({...c,name:g});const z=(J=w.current)==null?void 0:J.getBoundingClientRect();z&&u({x:C.clientX-z.left,y:C.clientY-z.top})},onMouseLeave:()=>d(null),className:"cursor-pointer transition-all duration-200 outline-none hover:brightness-125"},o)}):null,[a,P,p]);return e.jsxs("div",{ref:w,className:"relative w-full h-[500px] lg:h-[600px] bg-gray-950/20 rounded-3xl border border-gray-800 shadow-2xl overflow-hidden group",children:[r?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900/50 backdrop-blur-sm z-10",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-xs font-bold text-gray-500 animate-pulse",children:"áž€áŸ†áž–áž»áž„áž‘áž¶áž‰áž™áž€áž•áŸ‚áž“áž‘áž¸..."})]}):b?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-6 text-center z-10",children:[e.jsx("p",{className:"text-red-400 font-bold mb-4",children:b}),e.jsx("button",{onClick:I,className:"btn btn-primary text-xs px-8",children:"ážŸáž¶áž€áž›áŸ’áž”áž„áž˜áŸ’ážŠáž„áž‘áŸ€áž"})]}):e.jsx("svg",{viewBox:"0 0 1000 1000",className:"w-full h-full p-4 sm:p-12 drop-shadow-2xl",preserveAspectRatio:"xMidYMid meet",children:e.jsx("g",{className:"map-layer",children:h})}),p&&e.jsxs("div",{className:"absolute pointer-events-none z-50 p-4 bg-gray-900/90 backdrop-blur-xl text-white rounded-2xl border border-gray-700/50 shadow-2xl min-w-[180px] animate-fade-in-scale",style:{left:`${Math.min(S.x+15,(((y=w.current)==null?void 0:y.clientWidth)||0)-200)}px`,top:`${S.y-100}px`},children:[e.jsx("p",{className:"font-black text-xs uppercase tracking-widest text-blue-400 mb-2",children:p.name}),e.jsxs("div",{className:"space-y-1 text-[10px]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"áž…áŸ†ážŽáž¼áž›:"}),e.jsxs("span",{className:"font-black text-white",children:["$",p.revenue.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"áž€áž¶ážšáž€áž»áž˜áŸ’áž˜áŸ‰áž„áŸ‹:"}),e.jsx("span",{className:"font-bold",children:p.orders})]})]})]})]})},Nt=({stats:s,onProvinceClick:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),"ážŸáž„áŸ’ážáŸáž”ážáž¶áž˜ážáŸážáŸ’áž/ážšáž¶áž‡áž’áž¶áž“áž¸"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl h-[450px] lg:h-[550px] xl:h-[600px]",children:e.jsx("div",{className:"overflow-y-auto h-full custom-scrollbar",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4",children:"ážáŸážáŸ’áž/ážšáž¶áž‡áž’áž¶áž“áž¸"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((l,r)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors cursor-pointer group",onClick:()=>a==null?void 0:a(l.name),children:[e.jsx("td",{className:"px-4 py-3 font-bold text-gray-200 group-hover:text-blue-300 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-gray-700 text-[9px] text-gray-500 flex items-center justify-center border border-gray-600",children:r+1}),e.jsx("span",{className:"truncate max-w-[150px]",children:l.name})]})}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsxs("span",{className:"text-blue-400 font-black block group-hover:text-blue-300",children:["$",l.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsxs("span",{className:"text-[9px] text-gray-500 uppercase tracking-tighter group-hover:text-gray-400",children:[l.orders," orders"]})]})]},l.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]})]})})})]}),kt=({dateRange:s,onRangeChange:a,customStart:l,onCustomStartChange:r,customEnd:v,onCustomEndChange:b})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx("div",{className:"flex items-center gap-1 bg-gray-800/80 p-1 rounded-xl border border-gray-700 shadow-inner",children:["today","this_week","this_month","custom"].map(N=>e.jsx("button",{onClick:()=>a(N),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${s===N?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:N==="today"?"ážáŸ’áž„áŸƒáž“áŸáŸ‡":N==="this_week"?"ážŸáž”áŸ’ážáž¶áž áŸáž“áŸáŸ‡":N==="this_month"?"ážáŸ‚áž“áŸáŸ‡":"áž€áŸ†ážŽážáŸ‹"},N))})}),s==="custom"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-gray-900/40 rounded-2xl border border-gray-800 animate-fade-in-down",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"áž…áž¶áž”áŸ‹áž–áž¸"}),e.jsx("input",{type:"date",value:l,onChange:N=>r(N.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"ážŠáž›áŸ‹"}),e.jsx("input",{type:"date",value:v,onChange:N=>b(N.target.value),className:"form-input !py-1.5 !px-3 bg-gray-800 border-gray-700 text-xs rounded-xl focus:ring-blue-500/20"})]})]})]}),St=({stats:s,onStatClick:a})=>{const l=m.useMemo(()=>s.reduce((r,v)=>({revenue:r.revenue+v.revenue,orders:r.orders+v.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-orange-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"ážƒáŸ’áž›áž¶áŸ†áž„áž”áž‰áŸ’áž…áŸáž‰áž‘áŸ†áž“áž·áž‰ (Stock)"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"ážˆáŸ’áž˜áŸ„áŸ‡ážƒáŸ’áž›áž¶áŸ†áž„ (Store)"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž…áŸ†áž“áž½áž“ Orders"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,v)=>e.jsxs("tr",{className:"hover:bg-orange-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",v+1]}),e.jsx("span",{className:"group-hover:text-orange-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:l.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",l.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},Ct=({currentUser:s,parsedOrders:a,dateFilter:l,setDateFilter:r,teamRevenueStats:v,provinceStats:b,storeStats:N,onTeamClick:p,onProvinceClick:d,onStoreClick:S})=>{const u=P=>new Date(P.Timestamp),w=a.filter(P=>{if(!P.Timestamp)return!1;const I=u(P),k=new Date,O=new Date(k.getFullYear(),k.getMonth(),k.getDate());if(l.preset==="today")return I.toDateString()===k.toDateString();if(l.preset==="this_week"){const h=k.getDay(),y=new Date(O);y.setDate(O.getDate()-(h===0?6:h-1));const t=new Date(y);return t.setDate(y.getDate()+6),t.setHours(23,59,59),I>=y&&I<=t}else{if(l.preset==="this_month")return I.getMonth()===k.getMonth()&&I.getFullYear()===k.getFullYear();if(l.preset==="custom"){const h=l.start?new Date(l.start+"T00:00:00"):null,y=l.end?new Date(l.end+"T23:59:59"):null;return!(h&&I<h||y&&I>y)}}return!0}),F={revenue:w.reduce((P,I)=>P+(Number(I["Grand Total"])||0),0),orders:w.length,unpaid:w.filter(P=>P["Payment Status"]==="Unpaid").length};return e.jsxs("div",{className:"space-y-6 lg:space-y-8 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-800/10 p-5 rounded-[2rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl lg:text-2xl 2xl:text-3xl font-black text-white leading-tight",children:["ážŸáž½ážŸáŸ’ážáž¸, ",s==null?void 0:s.FullName," ðŸ‘‹"]}),e.jsx("p",{className:"text-gray-500 text-xs lg:text-sm font-bold uppercase tracking-widest mt-1.5",children:new Date().toLocaleDateString("km-KH",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsx("div",{className:"w-full md:w-auto",children:e.jsx(kt,{dateRange:l.preset,onRangeChange:P=>r({...l,preset:P}),customStart:l.start,onCustomStartChange:P=>r({...l,start:P}),customEnd:l.end,onCustomEndChange:P=>r({...l,end:P})})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6",children:[e.jsx(ee,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”",value:`$${F.revenue.toLocaleString(void 0,{minimumFractionDigits:2})}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-blue-400"}),e.jsx(ee,{label:"áž…áŸ†áž“áž½áž“áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹",value:F.orders,icon:"ðŸ“¦",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(ee,{label:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž‘áž¼áž‘áž¶ážáŸ‹",value:F.unpaid,icon:"â³",colorClass:"from-orange-500 to-yellow-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-6 lg:gap-8",children:[e.jsx("div",{className:"xl:col-span-6",children:e.jsx(vt,{stats:v,onStatClick:p})}),e.jsx("div",{className:"xl:col-span-6",children:e.jsx(St,{stats:N,onStatClick:S})}),e.jsx("div",{className:"xl:col-span-8",children:e.jsx(wt,{data:b})}),e.jsx("div",{className:"xl:col-span-4",children:e.jsx(Nt,{stats:b,onProvinceClick:d})})]})]})},We=s=>{const a=s["Grand Total"]||0,l=s["Total Product Cost ($)"]||0,r=s["Internal Cost"]||0;return a-l-r},Dt=s=>{try{if(!s)return new Date().toISOString().slice(0,7);const a=new Date(s);return isNaN(a.getTime())?new Date().toISOString().slice(0,7):a.toISOString().slice(0,7)}catch{return new Date().toISOString().slice(0,7)}},Pt=(s,a,l)=>m.useMemo(()=>{const r=Array.isArray(a)?a.filter(h=>h&&h.UserName):[],v=Array.isArray(s)?s.filter(h=>h&&h["Grand Total"]!==void 0):[],b=Array.isArray(l)?l:[],N=v.reduce((h,y)=>h+(y["Grand Total"]||0),0),p=v.reduce((h,y)=>h+We(y),0),d=v.length,S=new Date().toISOString().slice(0,7),u=r.map(h=>{const y=v.filter(j=>j.User===h.UserName),t=y.reduce((j,n)=>j+(n["Grand Total"]||0),0),o=y.reduce((j,n)=>j+We(n),0),M=y.length,x=b.find(j=>j.UserName===h.UserName&&j.Month===S),c=(x==null?void 0:x.TargetAmount)||0,g=c>0?t/c*100:0;return{userName:h.UserName,fullName:h.FullName,profilePictureURL:h.ProfilePictureURL,team:h.Team,revenue:t,profit:o,orderCount:M,target:c,achievement:g}}),F=Array.from(new Set(r.map(h=>h.Team).filter(Boolean))).map(h=>{const y=u.filter(g=>g.team===h),t=y.reduce((g,j)=>g+j.revenue,0),o=y.reduce((g,j)=>g+j.profit,0),M=y.reduce((g,j)=>g+j.orderCount,0),x=y.reduce((g,j)=>g+j.target,0),c=x>0?t/x*100:0;return{teamName:h,revenue:t,profit:o,orderCount:M,target:x,achievement:c}}),P=F.reduce((h,y)=>h+y.target,0),I=P>0?N/P*100:0,k={};v.forEach(h=>{const y=Dt(h.Timestamp);k[y]||(k[y]={revenue:0,profit:0,orders:0}),k[y].revenue+=h["Grand Total"]||0,k[y].profit+=We(h),k[y].orders+=1});const O=Object.entries(k).sort(([h],[y])=>h.localeCompare(y)).map(([h,y])=>({label:h,value:y.revenue,...y}));return{summary:{totalRevenue:N,totalProfit:p,totalOrders:d,overallTarget:P,overallAchievement:I},byUser:u,byTeam:F,monthlyTrend:O,hasData:r.length>0}},[s,a,l]),Lt=({value:s,label:a})=>{const l=Math.max(0,s),r=Math.min(l/100,1),v=80,b=14,N=v-b/2,d=2*Math.PI*N*.75,S=d*(1-r),w=l<50?"#ef4444":l<90?"#f59e0b":"#10b981";return e.jsx("div",{className:"relative flex items-center justify-center w-full max-w-[280px] mx-auto h-[220px]",children:e.jsxs("svg",{viewBox:"0 0 200 160",className:"w-full h-full transform transition-all duration-700",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gaugeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),e.jsx("stop",{offset:"50%",stopColor:"#f59e0b"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981"})]}),e.jsxs("filter",{id:"gaugeGlow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"4",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})]}),e.jsx("path",{d:`M 35 130 A ${N} ${N} 0 1 1 165 130`,fill:"none",stroke:"#1f2937",strokeWidth:b,strokeLinecap:"round",className:"opacity-40"}),e.jsx("path",{d:`M 35 130 A ${N} ${N} 0 1 1 165 130`,fill:"none",stroke:w,strokeWidth:b,strokeLinecap:"round",strokeDasharray:d,strokeDashoffset:S,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)",filter:l>0?"url(#gaugeGlow)":"none"}}),e.jsxs("g",{className:"text-center select-none",children:[e.jsx("text",{x:"100",y:"95",textAnchor:"middle",className:"text-5xl font-black fill-white tracking-tighter",children:`${Math.round(l)}%`}),a&&e.jsx("text",{x:"100",y:"122",textAnchor:"middle",className:"text-[8px] font-black uppercase tracking-[0.2em] fill-gray-500",children:a})]})]})})},Qe=({data:s,title:a})=>{const[l,r]=m.useState(null);if(!s||s.length===0)return e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 min-h-[300px]",children:"No data available for chart."});const v=300,b=500,d={top:20,right:20,bottom:40,left:50},S=Math.max(...s.map(h=>h.value),0),u=S===0?0:(v-d.top-d.bottom)/S,w=(b-d.left-d.right)/(s.length-1||1),F=()=>{if(s.length<2)return"";let h=`M ${d.left},${v-d.bottom-s[0].value*u}`;return s.slice(1).forEach((y,t)=>{const o=d.left+(t+1)*w,M=v-d.bottom-y.value*u;h+=` L ${o},${M}`}),h},P=(h,y)=>{const t=h.currentTarget.getBoundingClientRect(),o=`${y.label}: $${y.value.toLocaleString(void 0,{maximumFractionDigits:2})}`;r({visible:!0,x:t.left+window.scrollX,y:t.top+window.scrollY,content:o})},I=()=>{r(null)},O=(h=>{if(h===0)return[0];const y=5,t=Math.ceil(h/y/10)*10;return t===0?[0,h]:Array.from({length:y+1},(o,M)=>M*t).filter(o=>o<=h*1.1)})(S);return e.jsxs("div",{className:"relative",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-white text-center",children:a}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("svg",{viewBox:`0 0 ${b} ${v}`,className:"min-w-[500px]",preserveAspectRatio:"xMinYMin meet",children:[e.jsx("g",{className:"y-axis",children:O.map(h=>e.jsxs("g",{transform:`translate(0, ${v-d.bottom-h*u})`,children:[e.jsx("line",{x1:d.left-5,y1:"0",x2:b-d.right,y2:"0",stroke:"#374151"}),e.jsx("text",{x:d.left-10,y:"3",textAnchor:"end",fill:"#9ca3af",fontSize:"12",children:h>=1e3?`${(h/1e3).toFixed(0)}k`:h})]},h))}),e.jsx("g",{className:"x-axis",children:s.map((h,y)=>e.jsx("text",{x:d.left+y*w,y:v-d.bottom+20,textAnchor:"middle",fill:"#9ca3af",fontSize:"12",children:h.label},y))}),e.jsx("path",{d:F(),fill:"none",stroke:"#3b82f6",strokeWidth:"2"}),s.map((h,y)=>e.jsx("circle",{cx:d.left+y*w,cy:v-d.bottom-h.value*u,r:"4",fill:"#3b82f6",stroke:"#111827",strokeWidth:"2",onMouseOver:t=>P(t,h),onMouseOut:I,className:"cursor-pointer"},y))]})}),l&&e.jsx("div",{className:"fixed p-2 text-xs text-white bg-gray-900 border border-gray-600 rounded-md shadow-lg z-50",style:{left:l.x,top:l.y-35,pointerEvents:"none",transform:"translateX(-50%)"},children:l.content})]})},Tt=({summary:s,monthlyTrend:a})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 animate-fade-in",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ee,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Revenue)",value:`$${s.totalRevenue.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"})}),colorClass:"from-blue-600 to-blue-400"}),e.jsx(ee,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Profit)",value:`$${s.totalProfit.toLocaleString()}`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),colorClass:"from-emerald-600 to-green-400"}),e.jsx(ee,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹ážŸážšáž»áž” (Orders)",value:s.totalOrders,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),colorClass:"from-purple-600 to-pink-400"}),e.jsx(ee,{label:"áž‚áŸ„áž›ážŠáŸ…ážŸážšáž»áž” (Overall Target)",value:s.overallTarget>0?`$${s.overallTarget.toLocaleString()}`:"N/A",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),colorClass:"from-orange-500 to-yellow-400"})]}),e.jsx("div",{className:"glass-card p-6 rounded-2xl shadow-xl border border-gray-700/50",children:e.jsx(Qe,{data:a,title:"áž“áž·áž“áŸ’áž“áž¶áž€áž¶ážšáž…áŸ†ážŽáž¼áž› (Revenue Trend)"})})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"glass-card p-8 rounded-2xl shadow-xl flex flex-col items-center justify-center h-full min-h-[400px]",children:[e.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.2em] mb-8",children:"ážœážŒáŸ’ážáž“áž—áž¶áž–áž‚áŸ„áž›ážŠáŸ…ážšáž½áž˜"}),e.jsx(Lt,{value:s.overallAchievement,label:"Overall Achievement"}),e.jsx("div",{className:"mt-10 grid grid-cols-1 gap-4 w-full",children:e.jsxs("div",{className:"bg-gray-900/50 rounded-xl p-4 border border-gray-800 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase mb-1",children:"áž“áŸ…ážáŸ’ážœáŸ‡ (To Target)"}),e.jsxs("p",{className:"text-2xl font-black text-white",children:["$",Math.max(0,s.overallTarget-s.totalRevenue).toLocaleString()]})]})})]})})]}),Je=({rank:s})=>{const a={1:{emoji:"ðŸ¥‡",bg:"bg-yellow-500/20",border:"border-yellow-500/50",text:"text-yellow-500",glow:"shadow-[0_0_15px_rgba(234,179,8,0.4)]"},2:{emoji:"ðŸ¥ˆ",bg:"bg-gray-300/20",border:"border-gray-300/50",text:"text-gray-300",glow:"shadow-[0_0_15px_rgba(209,213,219,0.3)]"},3:{emoji:"ðŸ¥‰",bg:"bg-orange-600/20",border:"border-orange-600/50",text:"text-orange-600",glow:"shadow-[0_0_15px_rgba(234,88,12,0.3)]"}}[s];return a?e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${a.bg} ${a.border} ${a.text} ${a.glow} border-2 animate-bounce-slow`,children:e.jsx("span",{className:"text-xl",children:a.emoji})}):e.jsxs("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-gray-800 border border-gray-700 text-gray-500 font-black text-sm italic",children:["#",s]})},Mt=({data:s,metric:a,onMetricChange:l,datePreset:r,previewImage:v})=>{const b=p=>p>=100?"text-emerald-400":p>=70?"text-yellow-400":"text-red-400",N=p=>p>=100?"bg-emerald-500":p>=70?"bg-yellow-500":"bg-red-500";return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white tracking-tight",children:"ážáž¶ážšáž¶áž„áž…áŸ†ážŽáž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹áž¢áŸ’áž“áž€áž›áž€áŸ‹áž†áŸ’áž“áž¾áž˜"}),e.jsxs("p",{className:"text-gray-500 text-xs mt-1 uppercase tracking-wider font-bold",children:["áž•áŸ’áž¢áŸ‚áž€áž›áž¾: ",r.replace("_"," ")]})]}),e.jsx("div",{className:"flex bg-gray-900/50 p-1 rounded-xl border border-gray-800",children:["revenue","orderCount","achievement"].map(p=>e.jsx("button",{onClick:()=>l(p),className:`px-4 py-2 text-[10px] font-black uppercase rounded-lg transition-all ${a===p?"bg-gray-700 text-white shadow-md":"text-gray-500 hover:text-gray-300"}`,children:p==="revenue"?"áž…áŸ†ážŽáž¼áž›":p==="orderCount"?"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹":"% ážŸáž˜áŸ’ážšáŸáž…"},p))})]}),e.jsxs("div",{className:"glass-card rounded-3xl shadow-2xl overflow-hidden border border-gray-700/50",children:[e.jsx("div",{className:"block md:hidden divide-y divide-gray-800",children:s.map((p,d)=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Je,{rank:d+1}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Le,{avatarUrl:p.profilePictureURL,name:p.fullName,size:"sm",className:"ring-2 ring-blue-500/20"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white leading-none",children:p.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1 font-bold",children:p.team})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-black text-blue-400",children:["$",p.revenue.toLocaleString()]}),e.jsxs("p",{className:`text-[10px] font-bold ${b(p.achievement)}`,children:[p.achievement.toFixed(1),"%"]})]})]},p.userName))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-800",children:[e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center w-24",children:"Rank"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"áž¢áŸ’áž“áž€áž›áž€áŸ‹"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-center",children:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹"}),e.jsx("th",{className:"px-6 py-5 text-[10px] font-black text-gray-500 uppercase tracking-widest text-right",children:"áž€áž¶ážšážŸáž˜áŸ’ážšáŸáž…áž‚áŸ„áž›ážŠáŸ… (%)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800/50",children:s.map((p,d)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-all group",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(Je,{rank:d+1})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Le,{avatarUrl:p.profilePictureURL,name:p.fullName,size:"md",className:"border border-gray-700 shadow-md group-hover:scale-110 transition-transform",onClick:()=>v(he(p.profilePictureURL))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white group-hover:text-blue-300 transition-colors",children:p.fullName}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black tracking-tighter",children:p.team})]})]})}),e.jsxs("td",{className:"px-6 py-4 text-right font-mono text-blue-400 font-black text-lg",children:["$",p.revenue.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-center font-black text-gray-300",children:p.orderCount}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`text-xs font-black mb-1.5 ${b(p.achievement)}`,children:[p.achievement.toFixed(1),"%"]}),e.jsx("div",{className:"w-32 h-1.5 bg-gray-800 rounded-full overflow-hidden border border-gray-700 shadow-inner",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out progress-glow ${N(p.achievement)}`,style:{width:`${Math.min(p.achievement,100)}%`}})})]})})]},p.userName))})]})})]})]})},$t=({data:s})=>{const a=r=>r>=100?"text-emerald-400":r>=70?"text-yellow-400":"text-red-400",l=r=>r>=100?"bg-emerald-500":r>=70?"bg-yellow-500":"bg-red-500";return e.jsx("div",{className:"animate-fade-in grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:s.map(r=>e.jsxs("div",{className:"glass-card p-6 rounded-3xl shadow-xl hover:border-blue-500/50 transition-all group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Le,{avatarUrl:r.profilePictureURL,name:r.fullName,size:"md",className:"ring-4 ring-blue-500/10 group-hover:ring-blue-500/20 transition-all"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black leading-none mb-1 group-hover:text-blue-300 transition-colors",children:r.fullName}),e.jsx("span",{className:"text-[9px] bg-blue-900/40 text-blue-300 px-2.5 py-0.5 rounded-full font-black uppercase tracking-wider border border-blue-500/20",children:r.team||"No Team"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest mb-1",children:"áž‚áŸ„áž›ážŠáŸ…ážáŸ‚áž“áŸáŸ‡"}),e.jsxs("p",{className:"text-blue-400 font-black text-lg tracking-tight",children:["$",r.target.toLocaleString()]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"ážœážŒáŸ’ážáž“áž—áž¶áž–ážŸáž˜áŸ’ážšáŸáž…áž”áž¶áž“"}),e.jsxs("span",{className:`text-sm font-black ${a(r.achievement)}`,children:[r.achievement.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full h-3.5 bg-gray-900 rounded-full overflow-hidden border border-gray-800 shadow-inner p-0.5",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ease-out shadow-[0_0_8px_rgba(0,0,0,0.5)] ${l(r.achievement)}`,style:{width:`${Math.min(r.achievement,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4 border-t border-gray-800/50",children:[e.jsxs("div",{className:"bg-gray-900/30 p-3 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"áž›áž€áŸ‹áž”áž¶áž“"}),e.jsxs("p",{className:"text-white font-black",children:["$",r.revenue.toLocaleString()]})]}),e.jsxs("div",{className:`p-3 rounded-xl border ${r.achievement>=100?"bg-emerald-900/10 border-emerald-900/30":"bg-red-900/10 border-red-900/30"}`,children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-black uppercase mb-1",children:"áž“áŸ…ážŸáž›áŸ‹"}),e.jsx("p",{className:`font-black ${r.achievement>=100?"text-emerald-400":"text-red-400"}`,children:r.achievement>=100?"SUCCESS ðŸ†":`$${Math.max(0,r.target-r.revenue).toLocaleString()}`})]})]})]})]},r.userName))})},Ot=({orders:s,users:a,targets:l})=>{const{previewImage:r}=m.useContext(re),[v,b]=m.useState("overview"),[N,p]=m.useState({datePreset:"this_month",team:""}),[d,S]=m.useState("revenue"),u=m.useMemo(()=>{const h=new Date;let y=null,t=new Date;switch(N.datePreset){case"this_month":y=new Date(h.getFullYear(),h.getMonth(),1);break;case"last_month":y=new Date(h.getFullYear(),h.getMonth()-1,1),t=new Date(h.getFullYear(),h.getMonth(),0,23,59,59);break;case"quarter":const o=Math.floor(h.getMonth()/3);y=new Date(h.getFullYear(),o*3,1);break;case"year":y=new Date(h.getFullYear(),0,1);break;case"all":y=null,t=null;break}return s.filter(o=>{if(!o.Timestamp)return!1;const M=new Date(o.Timestamp),x=(!y||M>=y)&&(!t||M<=t),c=!N.team||o.Team===N.team;return x&&c})},[s,N]),w=Pt(u,a,l),F=m.useMemo(()=>w?[...w.byUser].sort((h,y)=>y[d]-h[d]):[],[w,d]);if(!w.hasData&&a.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500 page-card",children:[e.jsx("svg",{className:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.jsx("p",{className:"text-lg font-bold",children:"ážšáž€áž˜áž·áž“ážƒáž¾áž‰áž‘áž·áž“áŸ’áž“áž“áŸáž™áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹"}),e.jsx("p",{className:"text-sm",children:"ážŸáž¼áž˜áž”áŸ’ážšáž¶áž€ážŠážáž¶áž¢áŸ’áž“áž€áž”áž¶áž“áž”áž„áŸ’áž€áž¾ážáž‚ážŽáž“áž¸áž¢áŸ’áž“áž€áž›áž€áŸ‹áž€áŸ’áž“áž»áž„áž”áŸ’ážšáž–áŸáž“áŸ’áž’áŸ”"})]});const{summary:P,byUser:I,monthlyTrend:k}=w,O=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center bg-gray-800/20 border-2 border-dashed border-gray-700 rounded-3xl animate-fade-in",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‡áž˜áŸ’ážšáž¾ážŸáž“áŸáŸ‡"}),e.jsx("p",{className:"text-gray-400 max-w-xs mx-auto mb-6 text-sm",children:'ážŸáž¼áž˜ážŸáž¶áž€áž›áŸ’áž”áž„áž”áŸ’ážáž¼ážš "áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘" áž¬ "áž€áŸ’ážšáž»áž˜" ážŠáž¾áž˜áŸ’áž”áž¸áž˜áž¾áž›áž‘áž·áž“áŸ’áž“áž“áŸáž™áž•áŸ’ážŸáŸáž„áž‘áŸ€ážáŸ”'}),e.jsx("button",{onClick:()=>p({...N,datePreset:"all"}),className:"btn btn-secondary text-xs",children:"áž”áž„áŸ’áž áž¶áž‰áž‘áž·áž“áŸ’áž“áž“áŸáž™áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Time)"})]});return e.jsxs("div",{className:"space-y-6 animate-fade-in px-2 sm:px-0 pb-12",children:[e.jsx("style",{children:`
                @keyframes bounce-slow { 0%, 100% { transform: translateY(-5%); } 50% { transform: translateY(0); } }
                .animate-bounce-slow { animation: bounce-slow 3s infinite ease-in-out; }
                .glass-card { background: rgba(31, 41, 55, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(75, 85, 99, 0.3); }
                .progress-glow { filter: drop-shadow(0 0 4px currentColor); }
            `}),e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsx("div",{className:"flex bg-gray-800/80 p-1.5 rounded-2xl border border-gray-700 backdrop-blur-md shadow-inner",children:["overview","leaderboard","targets"].map(h=>e.jsx("button",{onClick:()=>b(h),className:`px-5 py-2.5 text-xs font-black rounded-xl transition-all duration-300 ${v===h?"bg-blue-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:h==="overview"?"áž‘áž·áž“áŸ’áž“áž“áŸáž™ážŸáž„áŸ’ážáŸáž”":h==="leaderboard"?"áž…áŸ†ážŽáž¶ážáŸ‹ážáŸ’áž“áž¶áž€áŸ‹":"áž‚áŸ„áž›ážŠáŸ…"},h))}),e.jsx("div",{className:"flex flex-wrap items-center gap-2 w-full lg:w-auto",children:e.jsxs("div",{className:"flex items-center bg-gray-800/50 rounded-xl px-3 py-1.5 border border-gray-700 flex-1 sm:flex-none",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-bold uppercase mr-2",children:"áž‡áž˜áŸ’ážšáž¾ážŸ:"}),e.jsxs("select",{className:"bg-transparent border-none focus:ring-0 text-xs font-bold text-blue-400 cursor-pointer w-full sm:w-auto",value:N.datePreset,onChange:h=>p({...N,datePreset:h.target.value}),children:[e.jsx("option",{value:"this_month",children:"ážáŸ‚áž“áŸáŸ‡"}),e.jsx("option",{value:"last_month",children:"ážáŸ‚áž˜áž»áž“"}),e.jsx("option",{value:"quarter",children:"ážáŸ’ážšáž¸áž˜áž¶ážŸáž“áŸáŸ‡"}),e.jsx("option",{value:"year",children:"áž†áŸ’áž“áž¶áŸ†áž“áŸáŸ‡"}),e.jsx("option",{value:"all",children:"áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹"})]})]})})]}),v==="overview"&&(P.totalRevenue===0?e.jsx(O,{}):e.jsx(Tt,{summary:P,monthlyTrend:k})),v==="leaderboard"&&e.jsx(Mt,{data:F,metric:d,onMetricChange:S,datePreset:N.datePreset,previewImage:r}),v==="targets"&&(I.length===0?e.jsx("div",{className:"col-span-full py-12 text-center text-gray-500",children:"áž˜áž·áž“áž˜áž¶áž“áž–áŸážáŸŒáž˜áž¶áž“áž‚áŸ„áž›ážŠáŸ…áž¢áŸ’áž“áž€áž›áž€áŸ‹ážŸáž˜áŸ’ážšáž¶áž”áŸ‹ážáŸ‚áž“áŸáŸ‡"}):e.jsx($t,{data:I}))]})},De=({orders:s,reportType:a,dateFilter:l,startDate:r,endDate:v,onNavigate:b,contextFilters:N})=>{const{appData:p}=m.useContext(re),[d,S]=m.useState(""),[u,w]=m.useState(!1);if(a==="shipping")return e.jsx(lt,{orders:s,appData:p,dateFilter:l,startDate:r,endDate:v,onNavigate:b,contextFilters:N});const F=m.useMemo(()=>{const I=s.reduce((t,o)=>t+(Number(o["Grand Total"])||0),0),k=s.reduce((t,o)=>t+(Number(o["Total Product Cost ($)"])||0),0),O=s.reduce((t,o)=>t+(Number(o["Internal Cost"])||0),0),h=I-k-O,y=I>0?h/I*100:0;return{revenue:I,totalOrders:s.length,totalProfit:h,margin:y,shippingCost:O}},[s]),P=async()=>{w(!0);try{const k=await ot(F,{reportType:a});S(k)}catch{S("AI Analysis error.")}finally{w(!1)}};return e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ee,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž”",value:`$${F.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-blue-400"}),e.jsx(ee,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹",value:F.totalOrders,icon:"ðŸ“¦",colorClass:"from-indigo-600 to-indigo-400"}),e.jsx(ee,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰",value:`$${F.totalProfit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-emerald-400"}),e.jsx(ee,{label:"Margin (%)",value:`${F.margin.toFixed(1)}%`,icon:"âš–ï¸",colorClass:"from-amber-500 to-orange-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-8 bg-gray-900/40 border-white/5 h-full min-h-[400px]",children:e.jsx(Qe,{data:[],title:"áž“áž·áž“áŸ’áž“áž¶áž€áž¶ážšáž…áŸ†ážŽáž¼áž› (Revenue Over Time)"})})}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"page-card !p-8 bg-gray-900/40 border-white/5 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h3",{className:"text-sm font-black text-white uppercase tracking-widest",children:"AI Insights"}),e.jsx(nt,{onClick:P,isLoading:u,children:"Analyze"})]}),e.jsx("div",{className:"flex-grow bg-black/40 rounded-3xl p-6 border border-white/5 overflow-y-auto",children:d?e.jsx("div",{className:"text-sm text-gray-300",children:d}):e.jsx("p",{className:"text-[10px] opacity-20 text-center uppercase font-black",children:"Ready for Analysis"})})]})})]})]})},Ne=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],At=({orders:s,onBack:a})=>{const{appData:l}=m.useContext(re),[r,v]=m.useState(!0),[b,N]=m.useState(!1),[p,d]=m.useState(!0),[S,u]=m.useState("revenue"),[w,F]=m.useState({key:"revenue",direction:"desc"}),[P,I]=m.useState(!1),k=x=>{F(c=>({key:x,direction:c.key===x&&c.direction==="desc"?"asc":"desc"}))},O=m.useMemo(()=>{const x={};return s.forEach(c=>{var i,f,L;let g=c.Team||c.User&&((L=(f=(i=l.users)==null?void 0:i.find($=>$.UserName===c.User))==null?void 0:f.Team)==null?void 0:L.split(",")[0].trim())||"Unassigned";x[g]||(x[g]={name:g,revenue:0,profit:0,orders:0,members:new Set},Ne.forEach($=>{x[g][`rev_${$}`]=0,x[g][`prof_${$}`]=0}));const j=Number(c["Grand Total"])||0,n=(Number(c["Total Product Cost ($)"])||0)+(Number(c["Internal Cost"])||0);if(x[g].revenue+=j,x[g].profit+=j-n,x[g].orders+=1,c.User&&x[g].members.add(c.User),c.Timestamp){const $=new Date(c.Timestamp),C=Ne[$.getMonth()];x[g][`rev_${C}`]+=j,x[g][`prof_${C}`]+=j-n}}),Object.values(x).sort((c,g)=>{const j=w.direction==="asc"?1:-1,n=c[w.key],i=g[w.key];return typeof n=="string"?n.localeCompare(i)*j:(n-i)*j})},[s,w,l.users]),h=m.useMemo(()=>{const x={revenue:0,profit:0,orders:0};return Ne.forEach(c=>{x[`rev_${c}`]=0,x[`prof_${c}`]=0}),O.forEach(c=>{x.revenue+=c.revenue,x.profit+=c.profit,x.orders+=c.orders,Ne.forEach(g=>{x[`rev_${g}`]+=c[`rev_${g}`],x[`prof_${g}`]+=c[`prof_${g}`]})}),x},[O]),y=()=>{I(!0),setTimeout(()=>{try{const x=new Fe({orientation:"landscape"}),c=x.internal.pageSize.width;x.setFontSize(18),x.text("Sales Report by Team",c/2,15,{align:"center"}),x.save(`Team_Sales_Report_${Date.now()}.pdf`)}catch(x){console.error(x)}finally{I(!1)}},100)},t=m.useMemo(()=>O.slice(0,10).map(x=>({label:x.name,value:x.revenue})),[O]),o=(x,c)=>{const j=[{key:"index",label:"#"},{key:"teamName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜ (Team)",sortable:!0,sortKey:"name"},{key:`total${x}`,label:`ážŸážšáž»áž” (${x})`,sortable:!0,sortKey:x.toLowerCase()},...Ne.map(n=>({key:`${c}_${n}`,label:n}))];return e.jsxs("div",{className:"hidden md:flex page-card flex-col mb-8 !p-6 border-gray-700/50 shadow-xl overflow-hidden bg-gray-900/40",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:`text-xl font-black flex items-center gap-2 ${x==="Revenue"?"text-blue-300":"text-green-400"}`,children:[e.jsx("span",{className:`w-2 h-6 rounded-full ${x==="Revenue"?"bg-blue-600":"bg-green-600"}`}),"ážáž¶ážšáž¶áž„",x==="Revenue"?"áž…áŸ†ážŽáž¼áž›":"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰","ážáž¶áž˜áž€áŸ’ážšáž»áž˜"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x==="Revenue"&&e.jsxs("button",{onClick:y,disabled:P,className:"btn !py-1 !px-4 text-[10px] font-black bg-red-600/20 border border-red-500/30 text-red-400 hover:bg-red-600 hover:text-white transition-all flex items-center gap-2",children:[P?e.jsx(te,{size:"sm"}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"EXPORT PDF"]}),e.jsx("button",{onClick:()=>d(!p),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${p?"bg-indigo-600 border-indigo-500 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"COLOR"}),e.jsx("button",{onClick:()=>N(!b),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${b?"bg-blue-600 border-blue-500 text-white shadow-lg":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"FREEZE"}),e.jsx("button",{onClick:()=>v(!r),className:`btn !py-1 !px-3 text-[10px] font-black border transition-all ${r?"bg-gray-700 border-gray-600 text-white":"bg-gray-800 border-gray-700 text-gray-400"}`,children:"BORDER"})]})]}),e.jsx("div",{className:`overflow-x-auto custom-scrollbar pb-2 ${r?"border-2 border-white/10 rounded-2xl shadow-[0_0_30px_rgba(0,0,0,0.5)]":""}`,children:e.jsxs("table",{className:`report-table w-full border-separate border-spacing-0 text-sm ${r?"border-collapse":""}`,children:[e.jsx("thead",{className:"bg-[#0f172a] backdrop-blur-md",children:e.jsx("tr",{className:"border-b-2 border-white/20",children:j.map(n=>{let i="",f={};b&&(n.key==="index"?(i="sticky left-0 z-30 bg-[#0f172a]",f={width:"45px",minWidth:"45px"}):n.key==="teamName"?(i="sticky left-[45px] z-30 bg-[#0f172a] border-r border-white/10 shadow-md",f={width:"140px",minWidth:"140px"}):n.key.includes("total")&&(i="sticky left-[185px] z-30 bg-[#0f172a] border-r border-white/10 shadow-lg",f={width:"100px",minWidth:"100px"}));const L=n.key.includes("total")?x==="Revenue"?"bg-blue-900/80":"bg-green-900/80":"";return e.jsx("th",{onClick:()=>n.sortable&&k(n.sortKey),className:`px-4 py-5 whitespace-nowrap text-left font-black uppercase tracking-wider border-b-2 border-white/20 ${r?"border-x border-white/5":""} ${i} ${L} ${n.sortable?"cursor-pointer hover:bg-gray-700":""}`,style:f,children:e.jsxs("div",{className:"flex items-center gap-1",children:[n.label," ",n.sortable&&w.key===n.sortKey&&e.jsx("span",{children:w.direction==="asc"?"â†‘":"â†“"})]})},n.key)})})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:O.map((n,i)=>{const f=Array.from(String(n.name)).reduce((C,z)=>C+z.charCodeAt(0),0)%5,$=p?["bg-blue-500/5","bg-purple-500/5","bg-emerald-500/5","bg-orange-500/5","bg-pink-500/5"][f]:"hover:bg-blue-500/5";return e.jsx("tr",{className:`${$} transition-colors group border-b border-white/5`,children:j.map(C=>{const z=`px-4 py-4 lg:py-5 whitespace-nowrap border-white/5 ${r?"border-x border-white/5":""}`;let J="",X={};if(b&&(C.key==="index"?(J="sticky left-0 z-10 bg-[#020617]",X={width:"45px",minWidth:"45px"}):C.key==="teamName"?(J="sticky left-[45px] z-10 bg-[#020617] border-r border-white/5 shadow-md",X={width:"140px",minWidth:"140px"}):C.key.includes("total")&&(J="sticky left-[185px] z-10 bg-[#020617] border-r border-white/5 shadow-lg",X={width:"100px",minWidth:"100px"})),C.key==="index")return e.jsx("td",{className:`${z} text-center font-bold text-gray-500 ${J}`,style:X,children:i+1},C.key);if(C.key==="teamName")return e.jsx("td",{className:`${z} font-black text-white ${J}`,style:X,children:n.name},C.key);if(C.key.includes("total"))return e.jsxs("td",{className:`${z} text-right font-black ${J} ${x==="Revenue"?"text-blue-200 bg-blue-600/10":"text-green-200 bg-green-600/10"}`,style:X,children:["$",(x==="Revenue"?n.revenue:n.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},C.key);if(C.key.startsWith(c)){const U=n[C.key]||0,Z=x==="Profit"?U>0?"text-green-400":U<0?"text-red-400":"text-gray-500":U>0?"text-blue-300":"text-gray-500";return e.jsx("td",{className:`${z} text-right font-bold font-mono ${Z}`,children:U!==0?`$${U.toLocaleString(void 0,{minimumFractionDigits:2})}`:"-"},C.key)}return e.jsx("td",{className:z,children:"-"},C.key)})},n.name)})}),e.jsx("tfoot",{className:"bg-[#0f172a] font-black border-t-2 border-white/20",children:e.jsx("tr",{className:"border-t-2 border-white/20",children:j.map((n,i)=>{const f=`px-4 py-5 whitespace-nowrap border-t-2 border-white/20 ${r?"border-x border-white/5":""}`;let L="",$={};return b&&(n.key==="index"?(L="sticky left-0 z-30 bg-[#0f172a]",$={width:"45px",minWidth:"45px"}):n.key==="teamName"?(L="sticky left-[45px] z-30 bg-[#0f172a] shadow-md",$={width:"140px",minWidth:"140px"}):n.key.includes("total")&&(L="sticky left-[185px] z-30 bg-[#0f172a] shadow-lg",$={width:"100px",minWidth:"100px"})),i===0?e.jsx("td",{className:`${f} uppercase tracking-widest text-white font-black ${L}`,style:$,colSpan:2,children:"ážŸážšáž»áž”ážšáž½áž˜ (GRAND TOTAL)"},n.key):n.key==="teamName"?null:n.key.includes("total")?e.jsxs("td",{className:`${f} text-right ${L} ${x==="Revenue"?"text-blue-400 bg-blue-600/10":"text-green-400 bg-green-600/10"}`,style:$,children:["$",(x==="Revenue"?h.revenue:h.profit).toLocaleString(void 0,{minimumFractionDigits:2})]},n.key):n.key.startsWith(c)?e.jsxs("td",{className:`${f} text-right text-gray-300 font-mono`,children:["$",h[n.key].toLocaleString(void 0,{minimumFractionDigits:2})]},n.key):e.jsx("td",{className:f},n.key)})})})]})})]})},M=()=>e.jsxs("div",{className:"md:hidden space-y-6 pb-12 px-1",children:[e.jsxs("div",{className:"flex bg-gray-900/60 p-1 rounded-2xl border border-white/10 shadow-inner",children:[e.jsx("button",{onClick:()=>u("revenue"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${S==="revenue"?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-gray-500"}`,children:"áž…áŸ†ážŽáž¼áž› (Revenue)"}),e.jsx("button",{onClick:()=>u("profit"),className:`flex-1 py-3 text-[11px] font-black uppercase rounded-xl transition-all ${S==="profit"?"bg-emerald-600 text-white shadow-lg shadow-emerald-600/20":"text-gray-500"}`,children:"áž…áŸ†ážŽáŸáž‰ (Profit)"})]}),e.jsx("div",{className:"space-y-4",children:O.map((x,c)=>{const g=S==="revenue"?x.revenue:x.profit,j=S==="revenue"?h.revenue:h.profit,n=g/(j||1)*100;return e.jsxs("div",{className:"bg-gray-800/40 border border-white/10 rounded-[2.5rem] p-6 shadow-xl space-y-5 animate-fade-in-up group relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start border-b border-white/5 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-10 h-10 bg-gray-950 rounded-2xl flex items-center justify-center border border-gray-700 text-gray-500 font-black text-xs shadow-inner",children:["#",c+1]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-black text-white uppercase tracking-tight",children:x.name}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest mt-0.5",children:[x.orders," Orders Total"]})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest ${S==="revenue"?"bg-blue-600/10 text-blue-400":"bg-emerald-600/10 text-emerald-400"}`,children:S==="revenue"?"Revenue Node":"Profit Node"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"ážŸážšáž»áž”áž”áŸ’ážšáž…áž¶áŸ†ážáŸ‚"}),e.jsxs("p",{className:`text-xl font-black ${S==="revenue"?"text-blue-400":"text-emerald-400"}`,children:["$",g.toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-black/20 rounded-2xl border border-white/5 flex flex-col justify-center",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest mb-1.5",children:"áž…áŸ†ážŽáŸ‚áž€áž‘áž¸áž•áŸ’ážŸáž¶ážš"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-white font-black text-sm",children:[n.toFixed(1),"%"]}),e.jsx("div",{className:"flex-grow h-1 bg-gray-900 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${S==="revenue"?"bg-blue-500":"bg-emerald-500"}`,style:{width:`${Math.min(100,n)}%`}})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"Monthly Breakdown (Recent 3)"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ne.slice(-3).map(i=>e.jsxs("div",{className:"bg-gray-900/50 p-2 rounded-xl border border-white/5 text-center",children:[e.jsx("p",{className:"text-[8px] text-gray-600 font-bold uppercase mb-0.5",children:i}),e.jsxs("p",{className:"text-[10px] text-gray-300 font-black",children:["$",(x[`${S==="revenue"?"rev":"prof"}_${i}`]||0).toLocaleString(void 0,{maximumFractionDigits:0})]})]},i))})]}),e.jsx("div",{className:`absolute -right-10 -bottom-10 w-32 h-32 rounded-full blur-[50px] opacity-10 transition-colors ${S==="revenue"?"bg-blue-600":"bg-emerald-600"}`})]},x.name)})})]});return e.jsxs("div",{className:"w-full space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(ee,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Revenue)",value:`$${h.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(ee,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Profit)",value:`$${h.profit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-teal-500"}),e.jsx(ee,{label:"áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹ážŸážšáž»áž” (Orders)",value:h.orders,icon:"ðŸ“¦",colorClass:"from-purple-600 to-pink-500"})]}),e.jsxs("div",{className:"hidden md:block space-y-8",children:[o("Revenue","rev"),o("Profit","prof")]}),e.jsx(M,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pb-10",children:[e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(qe,{data:t,title:"áž…áŸ†ážŽáž¼áž›ážáž¶áž˜áž€áŸ’ážšáž»áž˜ (Top Teams Revenue)"})}),e.jsxs("div",{className:"page-card !p-6 bg-gray-800/40 border-gray-700/50 flex flex-col justify-center",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-blue-500 rounded-full"})," ážŸáŸ’ážáž·ážáž·áž€áŸ’ážšáž»áž˜áž›áž€áŸ‹"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž…áŸ†áž“áž½áž“áž€áŸ’ážšáž»áž˜ážŸáž€áž˜áŸ’áž˜:"}),e.jsx("span",{className:"text-white font-black text-lg",children:O.length})]}),e.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-3",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚áž…áŸ†ážŽáž¼áž›/áž€áŸ’ážšáž»áž˜:"}),e.jsxs("span",{className:"text-blue-400 font-black text-lg",children:["$",(h.revenue/(O.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold uppercase",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚áž…áŸ†ážŽáŸáž‰/áž€áŸ’ážšáž»áž˜:"}),e.jsxs("span",{className:"text-emerald-400 font-black text-lg",children:["$",(h.profit/(O.length||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},Pe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_t=({orders:s,onBack:a,onNavigate:l,contextFilters:r,dateFilter:v,startDate:b,endDate:N})=>{const{appData:p,previewImage:d}=m.useContext(re),[S,u]=m.useState(!0),[w,F]=m.useState(!1),[P,I]=m.useState({key:"teamName",direction:"asc"}),k=c=>{I(g=>({key:c,direction:g.key===c&&g.direction==="desc"?"asc":"desc"}))},O=()=>{const c={};return r&&(r.team&&(c.team=r.team),r.store&&(c.store=r.store),r.paymentStatus&&(c.paymentStatus=r.paymentStatus),r.user&&(c.user=r.user),r.fulfillmentStore&&(c.fulfillmentStore=r.fulfillmentStore),r.location&&(c.location=r.location),r.shippingService&&(c.shipping=r.shippingService),r.driver&&(c.driver=r.driver),r.bank&&(c.bank=r.bank),r.product&&(c.product=r.product),r.internalCost&&(c.internalCost=r.internalCost)),c},h=(c,g)=>{if(l){const j=O();c==="page"&&(j.page=g),c==="team"&&(j.team=g),j.datePreset=v,j.startDate=b,j.endDate=N,l(j)}},y=(c,g)=>{if(l){const j=O(),n=new Date().getFullYear(),i=v==="last_year"?n-1:n,f=new Date(i,g,1),L=new Date(i,g+1,0,23,59,59),$=C=>{const z=C.getFullYear(),J=String(C.getMonth()+1).padStart(2,"0"),X=String(C.getDate()).padStart(2,"0");return`${z}-${J}-${X}`};j.page=c,j.datePreset="custom",j.startDate=$(f),j.endDate=$(L),l(j)}},t=m.useMemo(()=>{const c={};p.pages&&p.pages.forEach(j=>{c[j.PageName]={pageName:j.PageName,teamName:j.Team||"Unassigned",logoUrl:j.PageLogoURL||"",revenue:0,profit:0,orderCount:0},Pe.forEach(n=>{c[j.PageName][`rev_${n}`]=0,c[j.PageName][`prof_${n}`]=0})}),s.forEach(j=>{var L;const n=j.Page||"Unknown";if(!c[n]){const $=(L=p.pages)==null?void 0:L.find(C=>C.PageName===n);c[n]={pageName:n,teamName:j.Team||"Unassigned",logoUrl:($==null?void 0:$.PageLogoURL)||"",revenue:0,profit:0,orderCount:0},Pe.forEach(C=>{c[n][`rev_${C}`]=0,c[n][`prof_${C}`]=0})}const i=Number(j["Grand Total"])||0,f=(Number(j["Total Product Cost ($)"])||0)+(Number(j["Internal Cost"])||0);if(c[n].revenue+=i,c[n].profit+=i-f,c[n].orderCount+=1,j.Timestamp){const $=new Date(j.Timestamp),C=Pe[$.getMonth()];c[n][`rev_${C}`]+=i,c[n][`prof_${C}`]+=i-f}});let g=Object.values(c);return S||(g=g.filter(j=>j.revenue>0)),g.sort((j,n)=>{const i=P.direction==="asc"?1:-1,f=j[P.key],L=n[P.key];return typeof f=="string"?f.localeCompare(L)*i:(f-L)*i})},[s,P,p.pages,S]),o=m.useMemo(()=>{const c={revenue:0,profit:0,pagesCount:t.length};return Pe.forEach(g=>{c[`rev_${g}`]=0,c[`prof_${g}`]=0}),t.forEach(g=>{c.revenue+=g.revenue,c.profit+=g.profit,Pe.forEach(j=>{c[`rev_${j}`]+=g[`rev_${j}`],c[`prof_${j}`]+=g[`prof_${j}`]})}),c},[t]),M=()=>{F(!0),setTimeout(()=>{try{const c=new Fe({orientation:"landscape"}),g=c.internal.pageSize.width;c.setFontSize(18),c.text("Sales Report by Page",g/2,15,{align:"center"}),c.save(`Page_Sales_Report_${Date.now()}.pdf`)}catch(c){console.error(c),alert("Export failed")}finally{F(!1)}},100)},x=m.useMemo(()=>[...t].sort((c,g)=>g.revenue-c.revenue).slice(0,5).map(c=>({label:c.pageName,value:c.revenue,imageUrl:c.logoUrl})),[t]);return e.jsxs("div",{className:"w-full space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ee,{label:"áž…áŸ†ážŽáž¼áž›ážŸážšáž»áž” (Total Rev)",value:`$${o.revenue.toLocaleString()}`,icon:"ðŸ’°",colorClass:"from-blue-600 to-indigo-500"}),e.jsx(ee,{label:"áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰ (Total Profit)",value:`$${o.profit.toLocaleString()}`,icon:"ðŸ“ˆ",colorClass:"from-emerald-600 to-green-500"})]}),e.jsx(it,{data:t,grandTotals:o,sortConfig:P,onToggleSort:k,showAllPages:S,setShowAllPages:u,onExportPDF:M,isExporting:w,onPreviewImage:d,onNavigate:h,onMonthClick:y}),e.jsx(ct,{data:t,grandTotals:o,onPreviewImage:d,onNavigate:h,onMonthClick:y}),e.jsx(dt,{data:t,onPreviewImage:d,onNavigate:h,onMonthClick:y}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 pb-10",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx("div",{className:"page-card !p-4 bg-gray-800/40 border-gray-700/50",children:e.jsx(qe,{data:x,title:"Page ážŠáŸ‚áž›áž˜áž¶áž“áž…áŸ†ážŽáž¼áž›ážáŸ’áž–ážŸáŸ‹áž”áŸ†áž•áž»áž (Top 5 Pages Revenue)"})})}),e.jsxs("div",{className:"lg:col-span-4 flex flex-col justify-center page-card !p-5 bg-gray-800/30 border-gray-700/50",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-6",children:[e.jsx("span",{className:"w-1.5 h-4 bg-indigo-500 rounded-full"}),"ážŸáž„áŸ’ážáŸáž”"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between border-b border-white/5 pb-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"áž…áŸ†áž“áž½áž“ Page ážŸáž€áž˜áŸ’áž˜:"}),e.jsx("span",{className:"text-white font-black text-sm",children:o.pagesCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"áž˜áž’áŸ’áž™áž˜áž—áž¶áž‚/Page:"}),e.jsxs("span",{className:"text-blue-400 font-black text-sm",children:["$",(o.revenue/(o.pagesCount||1)).toLocaleString(void 0,{maximumFractionDigits:0})]})]})]})]})]})]})},It=[{label:"áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Time)",value:"all"},{label:"ážáŸ’áž„áŸƒáž“áŸáŸ‡ (Today)",value:"today"},{label:"áž˜áŸ’ážŸáž·áž›áž˜áž·áž‰ (Yesterday)",value:"yesterday"},{label:"ážŸáž”áŸ’ážáž¶áž áŸáž“áŸáŸ‡ (This Week)",value:"this_week"},{label:"ážŸáž”áŸ’ážáž¶áž áŸáž˜áž»áž“ (Last Week)",value:"last_week"},{label:"ážáŸ‚áž“áŸáŸ‡ (This Month)",value:"this_month"},{label:"ážáŸ‚áž˜áž»áž“ (Last Month)",value:"last_month"},{label:"áž†áŸ’áž“áž¶áŸ†áž“áŸáŸ‡ (This Year)",value:"this_year"},{label:"áž†áŸ’áž“áž¶áŸ†áž˜áž»áž“ (Last Year)",value:"last_year"},{label:"áž€áŸ†ážŽážáŸ‹ážáŸ’áž›áž½áž“áž¯áž„ (Custom)",value:"custom"}],zt=({datePreset:s,setDatePreset:a,startDate:l,setStartDate:r,endDate:v,setEndDate:b,calculatedRange:N})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/5 p-5 rounded-[1.8rem] border border-white/5 shadow-inner",children:[e.jsx("label",{className:"text-[10px] font-black text-blue-500 mb-3 block uppercase tracking-[0.2em] ml-2",children:"Temporal Window"}),e.jsx("select",{value:s,onChange:p=>a(p.target.value),className:"form-select !bg-gray-900 border-gray-800 !py-3.5 !px-5 rounded-2xl font-bold text-gray-200 focus:border-blue-500/50",children:It.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))}),e.jsx("div",{className:"mt-3 bg-black/40 p-3 rounded-xl text-center text-[10px] font-mono text-gray-500 border border-white/5 uppercase tracking-widest",children:N})]}),s==="custom"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 animate-fade-in px-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"From"}),e.jsx("input",{type:"date",value:l,onChange:p=>r(p.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-gray-600 mb-1.5 ml-2 uppercase",children:"To"}),e.jsx("input",{type:"date",value:v,onChange:p=>b(p.target.value),className:"form-input !bg-gray-900 border-gray-800 rounded-xl !py-3"})]})]})]}),oe=({label:s,value:a,onChange:l,options:r,placeholder:v="All",variant:b="default"})=>{let N="form-select !bg-gray-900 border-gray-800 !py-3.5 rounded-2xl font-bold w-full transition-all focus:border-blue-500/50";return b==="payment"?a==="Paid"?N+=" text-emerald-400 border-emerald-500/30 shadow-[0_0_15px_rgba(16,185,129,0.1)]":a==="Unpaid"?N+=" text-red-400 border-red-500/30 shadow-[0_0_15px_rgba(239,68,68,0.1)]":N+=" text-gray-200":N+=a?" text-white border-blue-500/30":" text-gray-400",e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:s}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:a,onChange:p=>l(p.target.value),className:N,children:[e.jsx("option",{value:"",children:v}),r.map((p,d)=>{const S=typeof p=="string"?p:p.value,u=typeof p=="string"?p:p.label;return e.jsx("option",{value:S,children:u},d)})]}),b==="payment"&&e.jsxs("div",{className:"absolute right-10 top-1/2 -translate-y-1/2 pointer-events-none",children:[a==="Paid"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_#10b981] animate-pulse"}),a==="Unpaid"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 shadow-[0_0_8px_#ef4444] animate-pulse"})]})]})]})},He=({filters:s,setFilters:a,orders:l,usersList:r,appData:v,calculatedRange:b})=>{var S;const N=m.useMemo(()=>{const u=new Set,w=new Set,F=new Set,P=new Set,I=new Set,k=new Set,O=new Set,h=new Set;return l.forEach(y=>{y.Page&&u.add(y.Page),y.Location&&w.add(y.Location),y["Internal Shipping Method"]&&F.add(y["Internal Shipping Method"]),y["Internal Shipping Details"]&&P.add(y["Internal Shipping Details"]),y["Fulfillment Store"]&&I.add(y["Fulfillment Store"]),y["Payment Info"]&&k.add(y["Payment Info"]),y["Internal Cost"]!==void 0&&O.add(String(y["Internal Cost"])),y.Team&&h.add(y.Team)}),{pages:Array.from(u).sort(),locations:Array.from(w).sort(),shippingMethods:Array.from(F).sort(),drivers:Array.from(P).sort(),fulfillmentStores:Array.from(I).sort(),banks:Array.from(k).sort(),costs:Array.from(O).sort((y,t)=>Number(y)-Number(t)),teams:Array.from(h).sort()}},[l]),p=()=>{a({datePreset:"this_month",startDate:"",endDate:"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:""})},d=(u,w)=>{a({...s,[u]:w})};return e.jsxs("div",{className:"space-y-8",children:[e.jsx(zt,{datePreset:s.datePreset,setDatePreset:u=>a({...s,datePreset:u}),startDate:s.startDate,setStartDate:u=>d("startDate",u),endDate:s.endDate,setEndDate:u=>d("endDate",u),calculatedRange:b}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-x-6 gap-y-6 px-1",children:[e.jsx(oe,{label:"Payment Status",value:s.paymentStatus,onChange:u=>d("paymentStatus",u),options:[{label:"Paid (ážšáž½áž…ážšáž¶áž›áŸ‹)",value:"Paid"},{label:"Unpaid (COD)",value:"Unpaid"}],placeholder:"All Statuses",variant:"payment"}),e.jsx(oe,{label:"Store (Brand/Sales)",value:s.store,onChange:u=>d("store",u),options:((S=v.stores)==null?void 0:S.map(u=>u.StoreName))||[],placeholder:"All Stores (Brands)"}),e.jsx(oe,{label:"Team Allocation",value:s.team,onChange:u=>d("team",u),options:N.teams,placeholder:"All Operational Teams"}),e.jsx(oe,{label:"Source Page",value:s.page,onChange:u=>d("page",u),options:N.pages,placeholder:"All Pages"}),e.jsx(oe,{label:"Fulfillment Store (Stock)",value:s.fulfillmentStore,onChange:u=>d("fulfillmentStore",u),options:N.fulfillmentStores,placeholder:"All Fulfillment Centers"}),e.jsx(oe,{label:"Geography (Location)",value:s.location,onChange:u=>d("location",u),options:N.locations,placeholder:"All Regions"}),e.jsx(oe,{label:"Logistics Method",value:s.shippingService,onChange:u=>d("shippingService",u),options:N.shippingMethods,placeholder:"All Shipping Methods"}),e.jsx(oe,{label:"Logistics Driver",value:s.driver,onChange:u=>d("driver",u),options:N.drivers,placeholder:"All Drivers / Details"}),e.jsx(oe,{label:"Merchant Node (User)",value:s.user,onChange:u=>d("user",u),options:r.map(u=>({label:u.FullName,value:u.UserName})),placeholder:"All Registered Users"}),e.jsx(oe,{label:"Exp. Cost (Internal)",value:s.internalCost,onChange:u=>d("internalCost",u),options:N.costs.map(u=>({label:`$${u}`,value:u})),placeholder:"All Costs"}),e.jsx(oe,{label:"áž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš (Bank)",value:s.bank,onChange:u=>d("bank",u),options:N.banks,placeholder:"All Bank Accounts"}),e.jsxs("div",{className:"sm:col-span-2 xl:col-span-3",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 mb-2 block uppercase tracking-widest ml-2",children:"Asset Selection (Product)"}),e.jsx(xt,{products:v.products,selectedProductName:s.product,onSelect:u=>d("product",u),showTagEditor:!1})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:p,className:"w-full py-4 text-[11px] font-black text-gray-500 uppercase tracking-widest hover:text-white border border-dashed border-gray-800 rounded-2xl transition-all active:scale-95 hover:border-red-500/30 hover:bg-red-500/10",children:"Reset All Configurations"})})]})},Ft=({activeReport:s,onBack:a,onNavigate:l})=>{const{appData:r,refreshTimestamp:v}=m.useContext(re),[b,N]=m.useState(!0),[p,d]=m.useState([]),[S,u]=m.useState([]),[w,F]=m.useState(!1),[P,I]=E("dateFilter","this_month"),[k,O]=E("startDate",""),[h,y]=E("endDate",""),[t,o]=m.useState({datePreset:P||"this_month",startDate:k||"",endDate:h||"",team:"",user:"",paymentStatus:"",shippingService:"",driver:"",product:"",bank:"",fulfillmentStore:"",store:"",page:"",location:"",internalCost:""});m.useEffect(()=>{t.datePreset!==P&&I(t.datePreset),t.startDate!==k&&O(t.startDate),t.endDate!==h&&y(t.endDate)},[t.datePreset,t.startDate,t.endDate,P,k,h,I,O,y]);const M=async()=>{N(!0);try{const[n,i]=await Promise.all([fetch(`${ae}/api/admin/all-orders`),fetch(`${ae}/api/users`)]),f=await n.json(),L=await i.json();if(f.status==="success"){const $=(f.data||[]).filter(C=>C!==null&&C["Order ID"]!=="Opening_Balance"&&C["Order ID"]!=="Opening Balance").map(C=>{let z=[];try{C["Products (JSON)"]&&(z=JSON.parse(C["Products (JSON)"]))}catch{}return{...C,Products:z}});d($)}L.status==="success"&&u(L.data||[])}catch(n){console.error(n)}finally{N(!1)}};m.useEffect(()=>{M()},[v]);const x=m.useMemo(()=>{const n=new Date,i=new Date(n.getFullYear(),n.getMonth(),n.getDate());let f=null,L=new Date;switch(t.datePreset){case"today":f=i;break;case"yesterday":f=new Date(i),f.setDate(i.getDate()-1),L=new Date(i),L.setMilliseconds(-1);break;case"this_week":const C=n.getDay();f=new Date(i),f.setDate(i.getDate()-(C===0?6:C-1));break;case"last_week":f=new Date(i),f.setDate(i.getDate()-n.getDay()-6),L=new Date(f),L.setDate(f.getDate()+6),L.setHours(23,59,59);break;case"this_month":f=new Date(n.getFullYear(),n.getMonth(),1);break;case"last_month":f=new Date(n.getFullYear(),n.getMonth()-1,1),L=new Date(n.getFullYear(),n.getMonth(),0,23,59,59);break;case"this_year":f=new Date(n.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${t.startDate||"..."} to ${t.endDate||"..."}`}const $=C=>C.toISOString().split("T")[0];return f?`${$(f)} to ${$(L)}`:"All time data stream"},[t.datePreset,t.startDate,t.endDate]),c=m.useMemo(()=>p.filter(n=>{var i;if(t.datePreset!=="all"){const f=new Date(n.Timestamp),L=new Date,$=new Date(L.getFullYear(),L.getMonth(),L.getDate());let C=null,z=new Date;switch(t.datePreset){case"today":C=$;break;case"yesterday":C=new Date($),C.setDate($.getDate()-1),z=new Date($),z.setMilliseconds(-1);break;case"this_week":const J=L.getDay();C=new Date($),C.setDate($.getDate()-(J===0?6:J-1));break;case"last_week":C=new Date($),C.setDate($.getDate()-L.getDay()-6),z=new Date(C),z.setDate(C.getDate()+6),z.setHours(23,59,59);break;case"this_month":C=new Date(L.getFullYear(),L.getMonth(),1);break;case"last_month":C=new Date(L.getFullYear(),L.getMonth()-1,1),z=new Date(L.getFullYear(),L.getMonth(),0,23,59,59);break;case"this_year":C=new Date(L.getFullYear(),0,1);break;case"custom":t.startDate&&(C=new Date(t.startDate+"T00:00:00")),t.endDate&&(z=new Date(t.endDate+"T23:59:59"));break}if(C&&f<C||z&&f>z)return!1}if(t.team&&n.Team!==t.team||t.user&&(n.User||"").trim().toLowerCase()!==t.user.trim().toLowerCase()||t.paymentStatus&&n["Payment Status"]!==t.paymentStatus||t.shippingService&&n["Internal Shipping Method"]!==t.shippingService||t.driver&&n["Internal Shipping Details"]!==t.driver||t.bank&&n["Payment Info"]!==t.bank||t.product&&!n.Products.some(f=>f.name===t.product)||t.fulfillmentStore&&n["Fulfillment Store"]!==t.fulfillmentStore||t.page&&n.Page!==t.page||t.location&&n.Location!==t.location||t.internalCost&&String(n["Internal Cost"])!==t.internalCost)return!1;if(t.store){const f=(i=r.pages)==null?void 0:i.find(L=>L.PageName===n.Page);if(!f||f.DefaultStore!==t.store)return!1}return!0}),[p,t,r.pages]),g={overview:"ážŸáž„áŸ’ážáŸáž”áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážš",sales_team:"ážšáž”áž¶áž™áž€áž¶ážšážŽáŸáž€áŸ’ážšáž»áž˜",sales_page:"ážšáž”áž¶áž™áž€áž¶ážšážŽáŸ Page",performance:"áž€áž¶ážšáž¢áž“áž»ážœážáŸ’áž (KPI)",profitability:"ážœáž·áž—áž¶áž‚áž”áŸ’ážšáž¶áž€áŸ‹áž…áŸ†ážŽáŸáž‰",shipping:"áž…áŸ†ážŽáž¶áž™ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“",forecasting:"áž€áž¶ážšáž–áŸ’áž™áž¶áž€ážšážŽáŸ AI"};if(b)return e.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-950",children:e.jsx(te,{size:"lg"})});const j=Object.values(t).filter(n=>n!==""&&n!=="this_month"&&n!=="all").length;return e.jsxs("div",{className:"animate-fade-in space-y-8 pb-20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-gray-800/20 p-6 rounded-[2.5rem] border border-white/5 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-white uppercase tracking-tight italic",children:g[s]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("p",{className:"text-[10px] text-blue-400 font-black uppercase tracking-widest",children:[x," ",j>0&&` â€¢ ${j} Active Filters`]})]})]}),e.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:e.jsxs("button",{onClick:()=>F(!0),className:"relative flex-1 sm:flex-none btn btn-secondary !py-2.5 !px-6 rounded-2xl border border-gray-700 flex items-center justify-center gap-3 transition-all hover:bg-gray-700 active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filter Engine",j>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-600 text-white text-[10px] font-black rounded-full flex items-center justify-center border-2 border-gray-900",children:j})]})})]}),e.jsxs("div",{className:"min-h-[500px]",children:[s==="overview"&&e.jsx(De,{orders:c,reportType:"overview",allOrders:p,dateFilter:t.datePreset}),s==="sales_team"&&e.jsx(At,{orders:c,onBack:a}),s==="sales_page"&&e.jsx(_t,{orders:c,onBack:a,onNavigate:l,contextFilters:t,dateFilter:t.datePreset,startDate:t.startDate,endDate:t.endDate}),s==="shipping"&&e.jsx(De,{orders:c,reportType:"shipping",allOrders:p,dateFilter:t.datePreset,startDate:t.startDate,endDate:t.endDate,onNavigate:l,contextFilters:t}),s==="profitability"&&e.jsx(De,{orders:c,reportType:"profitability",allOrders:p,dateFilter:t.datePreset}),s==="performance"&&e.jsx(De,{orders:c,reportType:"performance",allOrders:p,dateFilter:t.datePreset}),s==="forecasting"&&e.jsx(De,{orders:p,reportType:"forecasting",allOrders:p,dateFilter:t.datePreset})]}),e.jsx(ie,{isOpen:w,onClose:()=>F(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>F(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"Ã—"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(He,{filters:t,setFilters:o,orders:p,usersList:S,appData:r,calculatedRange:x})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>F(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})]})},Rt=({storesHierarchy:s,selectedPageNames:a,teamsPerRow:l,columns:r,imageMap:v})=>{const b=a.size,p=m.useCallback(()=>b>60?.45:b>45?.6:b>30?.75:b>=20?.85:1,[b])(),d=S=>Math.round(S*p);return e.jsxs("div",{id:"png-export-layer",style:{display:"none",width:"2560px",minHeight:"1440px",height:"auto",position:"relative",backgroundColor:"#020617",fontFamily:"'Kantumruy Pro', sans-serif",WebkitFontSmoothing:"antialiased",paddingBottom:d(100)},className:"flex flex-col items-center",children:[e.jsx("style",{children:`
                #png-export-layer * {
                    box-sizing: border-box;
                    line-height: 1.6 !important;
                }
                .khmer-text {
                    font-family: 'Kantumruy Pro', sans-serif !important;
                    padding-bottom: 2px;
                }
                .item-container {
                    page-break-inside: avoid;
                    break-inside: avoid;
                }
                .team-badge-gradient {
                    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
                    border: ${d(2)}px solid rgba(59, 130, 246, 0.5);
                }
            `}),e.jsx("div",{className:"absolute inset-0 opacity-[0.12] pointer-events-none",style:{backgroundImage:"radial-gradient(#3b82f6 1.2px, transparent 1.2px)",backgroundSize:"40px 40px",height:"100%"}}),e.jsx("div",{className:"w-full h-full flex flex-col p-[50px] relative z-10 justify-center",children:e.jsx("div",{className:"w-full",children:Object.entries(s).map(([S,u],w)=>Object.values(u).some(P=>P.some(I=>a.has(I.PageName)))?e.jsxs("div",{className:"w-full item-container flex flex-col mb-[70px] last:mb-0 items-center",children:[e.jsxs("div",{className:"flex items-center gap-[30px] mb-[60px] justify-center",children:[e.jsx("div",{style:{width:d(100),height:d(100),borderRadius:d(28),fontSize:d(50)},className:"bg-gradient-to-br from-blue-500 to-indigo-600 text-white flex items-center justify-center font-black shadow-[0_0_40px_rgba(59,130,246,0.3)] border border-white/20 flex-shrink-0",children:(w+1).toString().padStart(2,"0")}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("h2",{style:{fontSize:d(100)},className:"font-black text-white uppercase tracking-tighter leading-none khmer-text drop-shadow-2xl",children:S})})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`,gap:d(60),width:"100%",maxWidth:"95%",direction:"ltr"},children:Object.entries(u).map(([P,I])=>{const k=I.filter(O=>a.has(O.PageName));return k.length===0?null:e.jsxs("div",{style:{borderRadius:d(45),padding:d(40),paddingTop:d(65)},className:"bg-gray-900/40 border border-white/10 shadow-2xl flex flex-col relative backdrop-blur-xl",children:[e.jsx("div",{style:{top:d(-42),left:"50%",transform:"translateX(-50%)",borderRadius:d(20),padding:`${d(14)}px ${d(50)}px`,fontSize:d(34),minWidth:d(220),display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 ${d(15)}px ${d(35)}px rgba(0,0,0,0.8), inset 0 0 ${d(10)}px rgba(59, 130, 246, 0.2)`},className:"absolute team-badge-gradient font-black uppercase tracking-widest text-blue-400 khmer-text whitespace-nowrap z-20",children:P}),e.jsx("div",{className:"space-y-[20px] flex-grow",children:k.map(O=>e.jsxs("div",{style:{borderRadius:d(28),padding:d(18)},className:"flex items-center gap-[20px] bg-black/40 border border-white/5 shadow-inner hover:border-blue-500/30 transition-all",children:[r.logoImage&&v[O.PageName]&&e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:v[O.PageName],style:{width:d(85),height:d(85),borderRadius:d(22)},className:"object-cover border-[3px] border-gray-700 shadow-lg",alt:""})}),e.jsxs("div",{className:"flex-grow min-w-0 text-left",style:{marginTop:d(-25)},children:[e.jsx("span",{style:{fontSize:d(36)},className:"font-black block text-white uppercase tracking-tight khmer-text leading-tight break-words",children:O.PageName}),r.telegramValue&&e.jsxs("div",{style:{marginTop:d(8)},className:"flex items-center gap-2",children:[e.jsx("svg",{style:{width:d(20),height:d(20)},className:"text-blue-500 opacity-80",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h-2v-6h2v6zm-1-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})}),e.jsxs("span",{style:{fontSize:d(24)},className:"text-blue-400/70 font-mono font-bold tracking-wider leading-none",children:["@",O.TelegramValue]})]})]})]},O.PageName))})]},P)})})})]},S):null)})})]})},Ut=({isOpen:s,onClose:a,pages:l})=>{const[r,v]=m.useState(3),[b,N]=m.useState(!1),[p,d]=m.useState(0),[S,u]=m.useState(null),[w,F]=m.useState({pageName:!0,telegramValue:!0,logoImage:!0}),[P,I]=m.useState(new Set),[k,O]=m.useState({});m.useEffect(()=>{s&&l&&l.length>0&&P.size===0&&I(new Set(l.map(i=>i.PageName))),s||u(null)},[s,l]);const h=m.useMemo(()=>{const i={};return l&&l.forEach(f=>{const L=f.DefaultStore||"No Store",$=f.Team||"No Team";i[L]||(i[L]={}),i[L][$]||(i[L][$]=[]),i[L][$].push(f)}),i},[l]),y=i=>{F(f=>({...f,[i]:!f[i]}))},t=i=>{I(f=>{const L=new Set(f);return L.has(i)?L.delete(i):L.add(i),L})},o=i=>{const f=i.every(L=>P.has(L.PageName));I(L=>{const $=new Set(L);return i.forEach(C=>{f?$.delete(C.PageName):$.add(C.PageName)}),$})},M=i=>{const f=Object.values(i).flat(),L=f.every($=>P.has($.PageName));I($=>{const C=new Set($);return f.forEach(z=>{L?C.delete(z.PageName):C.add(z.PageName)}),C})},x=i=>{I(i?new Set(l.map(f=>f.PageName)):new Set)},c=async i=>{const f={...k};let L=0;for(const $ of i){if($.PageLogoURL&&!f[$.PageName])try{const C=await tt($.PageLogoURL);C&&(f[$.PageName]=`data:image/png;base64,${C}`)}catch{console.warn(`Failed to load logo for ${$.PageName}`)}L++,d(Math.round(L/i.length*100))}return O(f),f},g=async()=>{if(P.size===0)return;N(!0),d(0);const i=document.getElementById("png-export-layer");if(!i){N(!1);return}const f=i.getAttribute("style")||"";try{const L=l.filter(U=>P.has(U.PageName));await c(L),await document.fonts.ready;const $=2560;i.style.display="flex",i.style.width=`${$}px`,i.style.height="auto",i.style.position="fixed",i.style.top="0",i.style.left="-10000px",i.style.zIndex="-100",await new Promise(U=>setTimeout(U,1e3));const C=i.scrollHeight,z=Math.max(1440,C),X=(await gt(i,{backgroundColor:"#020617",scale:1.5,useCORS:!0,logging:!1,width:$,height:z,windowWidth:$,windowHeight:z,allowTaint:!0,imageTimeout:15e3})).toDataURL("image/png",.9);u(X)}catch(L){console.error("Preview Generation Error:",L),alert("áž€áž¶ážšáž”áž„áŸ’áž€áž¾áž Preview áž”ážšáž¶áž‡áŸáž™áŸ”")}finally{i.setAttribute("style",f),N(!1)}},j=()=>{if(S)try{const i=new Fe({orientation:"landscape",unit:"mm",format:"a4"}),f=i.getImageProperties(S),L=i.internal.pageSize.getWidth(),$=f.height*L/f.width;i.deletePage(1),i.addPage([L,$]),i.addImage(S,"PNG",0,0,L,$),i.save(`Organization_Chart_${new Date().getTime()}.pdf`),a()}catch(i){console.error(i),alert("Export PDF Error")}},n=()=>{if(!S)return;const i=document.createElement("a");i.href=S,i.download=`Organization_Chart_${new Date().getTime()}.png`,document.body.appendChild(i),i.click(),document.body.removeChild(i)};return e.jsxs(ie,{isOpen:s,onClose:a,maxWidth:"max-w-7xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-white/5 pb-6",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-3xl font-black text-white flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-600/20 rounded-2xl flex items-center justify-center border border-red-500/30",children:e.jsx("svg",{className:"w-7 h-7 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),"Premium HD Export"]})}),e.jsx("button",{onClick:a,className:"p-3 bg-gray-800 text-gray-400 hover:text-white rounded-2xl active:scale-95 transition-all",children:"Ã—"})]}),S?e.jsxs("div",{className:"flex flex-col h-[70vh]",children:[e.jsx("div",{className:"flex-grow overflow-auto bg-gray-950/50 rounded-3xl border border-white/10 p-4 flex items-center justify-center relative",children:e.jsx("img",{src:S,className:"max-w-full h-auto shadow-2xl rounded-lg",alt:"Preview"})}),e.jsxs("div",{className:"mt-6 flex flex-wrap justify-between items-center border-t border-white/5 pt-6 gap-4",children:[e.jsxs("button",{onClick:()=>u(null),className:"px-8 py-4 text-sm font-black text-gray-400 hover:text-white uppercase flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})}),"Back to Settings"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:n,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16l4 4m0 0l4-4m-4 4V4"})}),"Download PNG"]}),e.jsxs("button",{onClick:j,className:"px-8 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 bg-emerald-600 text-white hover:bg-emerald-700 shadow-emerald-600/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download PDF"]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 h-[70vh]",children:[e.jsx("div",{className:"lg:col-span-3 space-y-8 overflow-y-auto pr-4 custom-scrollbar",children:e.jsxs("div",{className:"bg-black/40 p-6 rounded-[2.5rem] border border-white/5 space-y-8 shadow-inner",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Density Control"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 bg-gray-900/50 p-1.5 rounded-2xl border border-gray-800",children:[1,2,3,4,5,6].map(i=>e.jsx("button",{onClick:()=>v(i),className:`py-2.5 rounded-xl text-xs font-black transition-all ${r===i?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] block mb-4",children:"Display Fields"}),e.jsx("div",{className:"space-y-2",children:Object.keys(w).map(i=>e.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-900/50 rounded-2xl border border-gray-800 cursor-pointer hover:bg-blue-600/5 transition-colors group",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-gray-200 capitalize",children:i.replace(/([A-Z])/g," $1")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:w[i],onChange:()=>y(i),className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]},i))})]})]})}),e.jsxs("div",{className:"lg:col-span-9 flex flex-col bg-gray-950/40 rounded-[3rem] border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 bg-white/5 flex justify-between items-center backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsxs("p",{className:"text-xs font-black text-white uppercase tracking-widest",children:[P.size," Nodes Linked"]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("button",{onClick:()=>x(!0),className:"text-[10px] font-black text-blue-400 hover:text-blue-300 transition-colors uppercase tracking-widest",children:"Select All"}),e.jsx("button",{onClick:()=>x(!1),className:"text-[10px] font-black text-gray-500 hover:text-white transition-colors uppercase tracking-widest",children:"Clear"})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-8 space-y-12 custom-scrollbar",children:Object.entries(h).map(([i,f])=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 group",children:[e.jsx("input",{type:"checkbox",onChange:()=>M(f),className:"w-6 h-6 rounded-lg border-gray-700 bg-gray-900 text-blue-600 focus:ring-blue-500/20 cursor-pointer"}),e.jsxs("h4",{className:"text-2xl font-black text-white uppercase tracking-tighter flex items-center gap-4 group-hover:text-blue-400 transition-colors",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),i]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pl-10",children:Object.entries(f).map(([L,$])=>{const C=$.every(z=>P.has(z.PageName));return e.jsxs("div",{className:"bg-gray-900/40 rounded-3xl border border-white/5 p-6 shadow-xl",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-6 cursor-pointer border-b border-white/5 pb-4",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:()=>o($),className:"w-5 h-5 rounded-md border-gray-700 bg-gray-800 text-blue-500"}),e.jsx("span",{className:"text-xs font-black text-gray-400 uppercase tracking-[0.15em]",children:L})]}),e.jsx("div",{className:"space-y-3",children:$.map(z=>e.jsxs("label",{className:`flex items-center gap-4 p-3 rounded-2xl border transition-all cursor-pointer ${P.has(z.PageName)?"bg-blue-600/10 border-blue-500/30":"bg-black/20 border-transparent hover:bg-white/5"}`,children:[e.jsx("input",{type:"checkbox",checked:P.has(z.PageName),onChange:()=>t(z.PageName),className:"w-4 h-4 rounded-md border-gray-700 bg-gray-900 text-blue-600"}),e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("img",{src:he(z.PageLogoURL),className:"w-7 h-7 rounded-full object-cover border border-white/10",alt:""}),e.jsx("span",{className:"text-xs font-bold text-gray-300 truncate",children:z.PageName})]})]},z.PageName))})]},L)})})]},i))}),e.jsxs("div",{className:"p-8 border-t border-white/5 bg-gray-900/80 backdrop-blur-xl flex justify-between items-center",children:[e.jsx("div",{className:"flex flex-col",children:b&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{size:"sm"}),e.jsxs("p",{className:"text-xs font-black text-red-400 uppercase tracking-[0.2em] animate-pulse",children:["Processing Preview: ",p,"%"]})]}),e.jsx("div",{className:"w-64 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-600 transition-all duration-300",style:{width:`${p}%`}})})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"px-8 py-4 text-sm font-black text-gray-500 hover:text-white uppercase",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:b||P.size===0,className:`px-12 py-5 rounded-2xl text-sm font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 flex items-center gap-4 ${b||P.size===0?"bg-gray-800 text-gray-600":"bg-blue-600 text-white hover:bg-blue-700 shadow-blue-600/20"}`,children:b?"Rendering...":"Preview Export"})]})]})]})]}),e.jsx(Rt,{storesHierarchy:h,selectedPageNames:P,teamsPerRow:r,columns:w,imageMap:k})]})},Ve=[{id:"users",title:"áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž‚ážŽáž“áž¸áž”áž»áž‚áŸ’áž‚áž›áž·áž€ áž“áž·áž„ážŸáž·áž‘áŸ’áž’áž·áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹",icon:"ðŸ‘¤",dataKey:"users",sheetName:"Users",primaryKeyField:"UserName",fields:[{name:"FullName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž–áŸáž‰",type:"text"},{name:"UserName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž‚ážŽáž“áž¸ (Login)",type:"text"},{name:"Password",label:"áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹",type:"password"},{name:"Role",label:"ážáž½áž“áž¶áž‘áž¸ (Role)",type:"text"},{name:"Team",label:"áž€áŸ’ážšáž»áž˜ (Team)",type:"text"},{name:"ProfilePictureURL",label:"URL ážšáž¼áž”áž—áž¶áž–",type:"image_url"},{name:"IsSystemAdmin",label:"System Admin?",type:"checkbox"}],displayField:"FullName"},{id:"products",title:"áž•áž›áž·ážáž•áž›",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áž‰áŸ’áž‡áž¸áž‘áŸ†áž“áž·áž‰ ážáž˜áŸ’áž›áŸƒ áž“áž·áž„ Barcode",icon:"ðŸ›ï¸",dataKey:"products",sheetName:"Products",primaryKeyField:"ProductName",fields:[{name:"ProductName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž•áž›áž·ážáž•áž›",type:"text"},{name:"Barcode",label:"Barcode",type:"text"},{name:"Price",label:"ážáž˜áŸ’áž›áŸƒ ($)",type:"number"},{name:"Cost",label:"ážáž˜áŸ’áž›áŸƒážŠáž¾áž˜ ($)",type:"number"},{name:"ImageURL",label:"URL ážšáž¼áž”áž—áž¶áž–",type:"image_url"},{name:"Tags",label:"Tags (comma separated)",type:"text"}],displayField:"ProductName"},{id:"pages",title:"áž€áŸ’ážšáž»áž˜ & Page",description:"áž€áŸ†ážŽážáŸ‹ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜ áž“áž·áž„áž‘áž·áž“áŸ’áž“áž“áŸáž™ Facebook Page",icon:"ðŸ‘¥",dataKey:"pages",sheetName:"TeamsPages",primaryKeyField:"PageName",fields:[{name:"PageName",label:"ážˆáŸ’áž˜áŸ„áŸ‡ Page",type:"text"},{name:"Team",label:"áž€áŸ’ážšáž»áž˜",type:"text"},{name:"TelegramValue",label:"Telegram Value",type:"text"},{name:"PageLogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"PageName"},{id:"shippingMethods",title:"ážŸáŸážœáž¶ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“",description:"áž€áŸ†ážŽážáŸ‹áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“ áž“áž·áž„áž›áž€áŸ’ážážážŽáŸ’ážŒážŠáž¹áž€",icon:"ðŸšš",dataKey:"shippingMethods",sheetName:"ShippingMethods",primaryKeyField:"MethodName",fields:[{name:"MethodName",label:"ážˆáŸ’áž˜áŸ„áŸ‡ážŸáŸážœáž¶",type:"text"},{name:"RequireDriverSelection",label:"ážáŸ’ážšáž¼ážœáž€áž¶ážšáž¢áŸ’áž“áž€ážŠáž¹áž€?",type:"checkbox"},{name:"LogosURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"MethodName"},{id:"drivers",title:"áž¢áŸ’áž“áž€ážŠáž¹áž€",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž–áŸážáŸŒáž˜áž¶áž“áž¢áŸ’áž“áž€ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“áž•áŸ’áž‘áž¶áž›áŸ‹ážáŸ’áž›áž½áž“",icon:"ðŸ›µ",dataKey:"drivers",sheetName:"Drivers",primaryKeyField:"DriverName",fields:[{name:"DriverName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž¢áŸ’áž“áž€ážŠáž¹áž€",type:"text"},{name:"ImageURL",label:"URL ážšáž¼áž”ážáž",type:"image_url"}],displayField:"DriverName"},{id:"bankAccounts",title:"áž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš",description:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áž‰áŸ’áž‡áž¸áž’áž“áž¶áž‚áž¶ážšážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‘áž‘áž½áž›áž”áŸ’ážšáž¶áž€áŸ‹",icon:"ðŸ¦",dataKey:"bankAccounts",sheetName:"BankAccounts",primaryKeyField:"BankName",fields:[{name:"BankName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž’áž“áž¶áž‚áž¶ážš",type:"text"},{name:"LogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"BankName"},{id:"phoneCarriers",title:"áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“áž‘áž¼ážšážŸáŸáž–áŸ’áž‘",description:"áž€áŸ†ážŽážáŸ‹ Prefixes ážšáž”ážŸáŸ‹áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“áž‘áž¼ážšážŸáŸáž–áŸ’áž‘",icon:"ðŸ“±",dataKey:"phoneCarriers",sheetName:"PhoneCarriers",primaryKeyField:"CarrierName",fields:[{name:"CarrierName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“",type:"text"},{name:"Prefixes",label:"Prefixes (áž”áŸ†áž”áŸ‚áž€ážŠáŸ„áž™áž€áŸ’áž”áŸ€ážŸ)",type:"text"},{name:"CarrierLogoURL",label:"URL áž¡áž¼áž áŸ’áž‚áŸ„",type:"image_url"}],displayField:"CarrierName"}],fe=(s,a)=>{if(!s||typeof s!="object"||!a)return;if(s[a]!==void 0)return s[a];const l=a.toLowerCase(),r=Object.keys(s).find(v=>v.toLowerCase()===l||v.toLowerCase().replace(/_/g,"")===l.replace(/_/g,""));return r?s[r]:void 0},ze=(s,a)=>{if(!s||typeof s!="object")return[];if(Array.isArray(s[a]))return s[a];const l=a.toLowerCase(),r=Object.keys(s).find(v=>v.toLowerCase()===l);if(r&&Array.isArray(s[r]))return s[r];if(a==="pages"){const v=Object.keys(s).find(b=>b.toLowerCase().includes("teampage")||b.toLowerCase().includes("page"));if(v&&Array.isArray(s[v]))return s[v]}return[]},Bt=({section:s,item:a,onClose:l,onSave:r})=>{const{refreshData:v}=m.useContext(re),[b,N]=m.useState({}),[p,d]=m.useState({}),[S,u]=m.useState(!1),[w,F]=m.useState(""),P=m.useRef({}),[I,k]=m.useState({});m.useEffect(()=>{if(a){const t={};s.fields.forEach(o=>{let M=fe(a,o.name);M==null&&(M=o.type==="checkbox"?!1:o.type==="number"?0:""),t[o.name]=M}),s.id==="users"&&(t.Password=""),N(t)}else{const t=s.fields.reduce((o,M)=>(o[M.name]=M.type==="checkbox"?!1:M.type==="number"?0:"",o),{});N(t)}},[a,s]);const O=t=>{const{name:o,value:M,type:x,checked:c}=t.target;N(g=>({...g,[o]:x==="checkbox"?c:M}))},h=async(t,o)=>{if(o){d(M=>({...M,[t]:!0}));try{const M=await st(o),x=await fetch(`${ae}/api/upload-image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileData:M,fileName:o.name,mimeType:o.type})}),c=await x.json();if(!x.ok||c.status!=="success")throw new Error(c.message||"Upload failed");N(g=>({...g,[t]:c.url}))}catch(M){F(M.message)}finally{d(M=>({...M,[t]:!1}))}}},y=async()=>{F("");for(const t of s.fields)if(t.type!=="checkbox"&&(b[t.name]===void 0||b[t.name]==="")&&t.name!=="Password"&&!a){F(`ážŸáž¼áž˜áž”áŸ†áž–áŸáž‰áž…áž“áŸ’áž›áŸ„áŸ‡ "${t.label}"`);return}u(!0);try{const t=a?"/api/admin/update-sheet":"/api/admin/add-row",o={...b};s.fields.forEach(c=>{c.type==="number"&&(o[c.name]=Number(o[c.name]))}),a&&s.id==="users"&&!o.Password&&delete o.Password;const M={sheetName:s.sheetName,newData:o};if(a&&(M.primaryKey={[s.primaryKeyField]:fe(a,s.primaryKeyField)}),!(await fetch(`${ae}${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok)throw new Error("Save failed");await v(),r(b)}catch(t){F(t.message)}finally{u(!1)}};return e.jsxs(ie,{isOpen:!0,onClose:l,maxWidth:"max-w-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-black text-white",children:[a?"áž€áŸ‚ážŸáž˜áŸ’ážšáž½áž›":"áž”áž“áŸ’ážáŸ‚áž˜"," ",s.title]}),e.jsx("button",{onClick:l,className:"p-2 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"space-y-5 max-h-[65vh] overflow-y-auto pr-2 custom-scrollbar",children:s.fields.map(t=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-xs font-black text-gray-500 uppercase tracking-widest",children:t.label}),t.type==="checkbox"?e.jsxs("div",{className:"flex items-center gap-3 bg-gray-900/50 p-3 rounded-xl border border-gray-700",children:[e.jsx("input",{type:"checkbox",name:t.name,checked:!!b[t.name],onChange:O,className:"h-6 w-6 rounded-lg border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"áž”áž¾áž€ážŠáŸ†ážŽáž¾ážšáž€áž¶ážšáž˜áž»ážáž„áž¶ážšáž“áŸáŸ‡"})]}):t.type==="image_url"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",name:t.name,value:b[t.name]||"",onChange:O,placeholder:"áž”áž·áž‘áž—áŸ’áž‡áž¶áž”áŸ‹ Link áž¬ Upload ážšáž¼áž”áž—áž¶áž–",className:"form-input flex-grow !py-2.5"}),e.jsx("input",{type:"file",accept:"image/*",ref:o=>{P.current[t.name]=o},onChange:o=>o.target.files&&h(t.name,o.target.files[0]),className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>{var o;return(o=P.current[t.name])==null?void 0:o.click()},className:"p-2.5 bg-blue-600/10 text-blue-400 rounded-xl border border-blue-500/20 hover:bg-blue-600 hover:text-white transition-all",disabled:p[t.name],children:p[t.name]?e.jsx(te,{size:"sm"}):e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h14a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),b[t.name]&&e.jsx("div",{className:"relative w-32 h-32 bg-gray-900 rounded-2xl border border-gray-700 p-2 overflow-hidden shadow-inner mx-auto sm:mx-0",children:e.jsx("img",{src:he(b[t.name]),className:"w-full h-full object-contain",alt:"preview"})})]}):t.type==="password"?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:I[t.name]?"text":"password",name:t.name,value:b[t.name]||"",onChange:O,className:"form-input !py-2.5 pr-12",placeholder:a?"áž‘áž»áž€áž‘áž‘áŸáž”áž¾áž˜áž·áž“áž…áž„áŸ‹áž”áŸ’ážáž¼ážš":"áž”áž‰áŸ’áž…áž¼áž›áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹"}),e.jsx("button",{type:"button",onClick:()=>k(o=>({...o,[t.name]:!o[t.name]})),className:"absolute inset-y-0 right-0 px-4 text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:I[t.name]?"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7 1.274-4.057 5.064-7 9.542-7 .847 0 1.67 .126 2.454 .364m-3.033 2.446a3 3 0 11-4.243 4.243m4.242-4.242l4.243 4.243M3 3l18 18":"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})})})]}):e.jsx("input",{type:t.type,name:t.name,value:b[t.name]||"",onChange:O,className:"form-input !py-2.5",readOnly:a&&t.name===s.primaryKeyField})]},t.name))}),w&&e.jsx("div",{className:"mt-4 p-3 bg-red-500/10 text-red-400 border border-red-500/20 rounded-xl text-sm font-bold",children:w}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-700/50",children:[e.jsx("button",{type:"button",onClick:l,className:"px-6 py-2.5 text-gray-400 hover:text-white font-bold transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{type:"button",onClick:y,className:"btn btn-primary px-8 shadow-lg shadow-blue-600/20 active:scale-95",disabled:S,children:S?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})},Et=({isOpen:s,onClose:a,onConfirm:l,isProcessing:r})=>s?e.jsx(ie,{isOpen:s,onClose:a,maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20 animate-pulse",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("h3",{className:"text-xl font-black text-white mb-2 uppercase tracking-tight",children:"System Update"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-8 leading-relaxed",children:["ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž“áŸáŸ‡áž“áž¹áž„ážáž˜áŸ’ážšáž¼ážœáž±áŸ’áž™áž¢áŸ’áž“áž€áž”áŸ’ážšáž¾áž”áŸ’ážšáž¶ážŸáŸ‹áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹ (All Users) áž…áž¶áž€áž…áŸáž‰áž–áž¸áž”áŸ’ážšáž–áŸáž“áŸ’áž’ (Log Out) ážŠáž¾áž˜áŸ’áž”áž¸áž’áŸ’ážœáž¾áž”áž…áŸ’áž…áž»áž”áŸ’áž”áž“áŸ’áž“áž—áž¶áž–áŸ”",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"text-red-400 font-bold bg-red-900/20 px-2 py-1 rounded",children:"ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸ?"})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:a,className:"px-6 py-3 rounded-xl bg-gray-800 text-gray-400 font-bold hover:bg-gray-700 transition-all border border-gray-700",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:l,disabled:r,className:"px-6 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-500 transition-all flex items-center gap-2 shadow-lg shadow-red-900/20 active:scale-95 disabled:opacity-50",children:r?e.jsx(te,{size:"sm"}):"Confirm Update"})]})]})}):null,Wt=({onBack:s,initialSection:a})=>{const{appData:l,refreshData:r,logout:v}=m.useContext(re),[b,N]=m.useState(a||"users"),[p,d]=m.useState(a||null),[S,u]=m.useState({isOpen:!1,sectionId:"",item:null}),[w,F]=m.useState([]),[P,I]=m.useState(!1),[k,O]=m.useState(!1),[h,y]=m.useState(!1),t=window.innerWidth<768?p:b,o=Ve.find(g=>g.id===t);m.useEffect(()=>{t==="users"&&(async()=>{if(ze(l,"users").length===0){const i=await(await fetch(`${ae}/api/users`)).json();i.status==="success"&&F(i.data||[])}})()},[t,l]);const M=m.useMemo(()=>{if(!o)return[];if(o.id==="users"){const g=ze(l,"users");return g.length>0?g:w}return ze(l,o.dataKey)},[o,l,w]),x=async(g,j)=>{if(window.confirm(`ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸážáž¶áž…áž„áŸ‹áž›áž»áž” "${fe(j,g.displayField)}"?`))try{await fetch(`${ae}/api/admin/delete-row`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:g.sheetName,primaryKey:{[g.primaryKeyField]:fe(j,g.primaryKeyField)}})}),await r()}catch{alert("Delete failed")}},c=async()=>{y(!0);try{await fetch(`${ae}/api/admin/update-sheet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetName:"Settings",primaryKey:{Key:"SystemVersion"},newData:{Value:Date.now().toString(),Action:"ForceLogout"}})}),await new Promise(g=>setTimeout(g,2e3)),v(),window.location.reload()}catch(g){console.error(g),y(!1),alert("Update command failed. Check connection.")}};return t?e.jsxs("div",{className:"w-full max-w-[100rem] mx-auto p-4 lg:p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{window.innerWidth<768?d(null):s()},className:"md:hidden p-2 bg-gray-800 text-white rounded-xl border border-gray-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl lg:text-3xl font-black text-white flex items-center gap-3",children:[e.jsx("span",{className:"hidden md:inline",children:o==null?void 0:o.icon}),o==null?void 0:o.title]}),e.jsx("p",{className:"text-xs lg:text-sm text-gray-500 font-bold uppercase tracking-[0.2em] mt-1",children:o==null?void 0:o.description})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>O(!0),className:"flex-1 sm:flex-none btn bg-gray-800 border border-gray-700 hover:border-red-500/50 hover:bg-red-900/10 hover:text-red-400 text-gray-400 px-4 transition-all flex items-center justify-center gap-2",title:"Update Version & Force Logout",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{className:"hidden xl:inline text-xs font-bold uppercase tracking-wider",children:"Update Version"})]}),t==="pages"&&e.jsx("button",{onClick:()=>I(!0),className:"flex-1 sm:flex-none btn btn-secondary px-6",children:"PDF Export"}),e.jsx("button",{onClick:()=>u({isOpen:!0,sectionId:t,item:null}),className:"flex-1 sm:flex-none btn btn-primary px-10 shadow-lg shadow-blue-600/20 font-black",children:"+ áž”áž“áŸ’ážáŸ‚áž˜ážáŸ’áž˜áž¸"}),e.jsx("button",{onClick:s,className:"hidden md:flex btn btn-secondary px-6",children:"ážáŸ’ážšáž¡áž”áŸ‹"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("aside",{className:"hidden md:flex flex-col gap-2 w-72 flex-shrink-0",children:Ve.map(g=>e.jsxs("button",{onClick:()=>N(g.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all ${b===g.id?"bg-blue-600 text-white shadow-xl shadow-blue-600/20":"text-gray-400 hover:bg-gray-800 hover:text-gray-200"}`,children:[e.jsx("span",{className:"text-xl",children:g.icon}),e.jsx("span",{className:"font-black text-sm uppercase tracking-wider",children:g.title})]},g.id))}),e.jsx("main",{className:"flex-grow min-w-0",children:e.jsxs("div",{className:"bg-gray-800/30 border border-gray-700/50 rounded-3xl overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"admin-table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900/50 border-b border-gray-700",children:[e.jsx("th",{className:"w-12 text-center",children:"#"}),o==null?void 0:o.fields.map(g=>e.jsx("th",{children:g.label},g.name)),e.jsx("th",{className:"w-32 text-center uppercase tracking-widest text-[10px]",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/30",children:M.length>0?M.map((g,j)=>e.jsxs("tr",{className:"hover:bg-blue-600/5 transition-colors group",children:[e.jsx("td",{className:"text-center text-gray-500 font-bold text-xs",children:j+1}),o==null?void 0:o.fields.map(n=>{const i=fe(g,n.name);return e.jsx("td",{className:"py-4",children:n.type==="image_url"&&i?e.jsx("img",{src:he(String(i)),className:"w-10 h-10 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1",alt:"logo"}):e.jsx("span",{className:`text-sm font-bold ${n.type==="password"?"text-gray-600":"text-gray-200"}`,children:n.type==="password"?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":typeof i=="boolean"?i?"âœ… Active":"âŒ Inactive":String(i||"-")})},n.name)}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>u({isOpen:!0,sectionId:t,item:g}),className:"p-2 bg-amber-500/10 text-amber-400 rounded-lg hover:bg-amber-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>x(o,g),className:"p-2 bg-red-500/10 text-red-400 rounded-lg hover:bg-red-500 hover:text-white transition-all",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},j)):e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"py-20 text-center text-gray-500 font-bold",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™ážáŸ’ážšáž¼ážœáž”áž¶áž“ážšáž€ážƒáž¾áž‰áž‘áŸ"})})})]})}),e.jsx("div",{className:"md:hidden divide-y divide-gray-700/50",children:M.length>0?M.map((g,j)=>{const n=fe(g,(o==null?void 0:o.displayField)||""),i=o==null?void 0:o.fields.find(L=>L.type==="image_url"),f=i?fe(g,i.name):null;return e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[f&&e.jsx("img",{src:he(f),className:"w-12 h-12 rounded-xl object-contain bg-gray-900 border border-gray-700 p-1 flex-shrink-0",alt:"logo"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-sm font-black text-white truncate",children:String(n||"-")}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-bold uppercase mt-0.5",children:["Item #",j+1]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u({isOpen:!0,sectionId:t,item:g}),className:"p-2.5 bg-gray-800 text-blue-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>x(o,g),className:"p-2.5 bg-gray-800 text-red-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},j)}):e.jsx("div",{className:"py-20 text-center text-gray-500 font-bold",children:"áž˜áž·áž“áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]})})]}),e.jsx("button",{onClick:()=>u({isOpen:!0,sectionId:t,item:null}),className:"md:hidden fixed bottom-24 right-6 w-16 h-16 bg-blue-600 text-white rounded-full shadow-2xl flex items-center justify-center active:scale-90 transition-transform z-40 border-4 border-gray-900",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 4v16m8-8H4"})})}),S.isOpen&&o&&e.jsx(Bt,{section:o,item:S.item,onClose:()=>u({...S,isOpen:!1}),onSave:()=>{u({...S,isOpen:!1}),r()}}),e.jsx(Et,{isOpen:k,onClose:()=>O(!1),onConfirm:c,isProcessing:h}),P&&e.jsx(Ut,{isOpen:P,onClose:()=>I(!1),pages:ze(l,"pages")})]}):e.jsxs("div",{className:"p-4 md:hidden animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-white",children:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹"}),e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest mt-1",children:"Settings & Management"})]}),e.jsx("button",{onClick:s,className:"p-2 bg-gray-800 text-gray-400 rounded-xl border border-gray-700 active:scale-95 transition-all",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:Ve.map(g=>e.jsxs("button",{onClick:()=>d(g.id),className:"flex items-center gap-4 bg-gray-800/40 border border-gray-700/50 p-4 rounded-2xl hover:bg-gray-700/40 active:scale-[0.98] transition-all text-left",children:[e.jsx("span",{className:"text-3xl bg-gray-800 p-3 rounded-xl shadow-inner border border-gray-700",children:g.icon}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-base font-black text-white leading-tight",children:g.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-1",children:g.description})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 5l7 7-7 7"})})]},g.id))})]})},Vt=({isOpen:s,onClose:a,orders:l})=>{const[r,v]=m.useState("Page"),[b,N]=m.useState("a4"),[p,d]=m.useState("landscape"),[S,u]=m.useState(!1),[w,F]=m.useState({orderId:{label:"Order ID",visible:!0,width:25},date:{label:"Date",visible:!0,width:25},customer:{label:"Customer",visible:!0,width:35},phone:{label:"Phone",visible:!0,width:25},location:{label:"Location/Address",visible:!0,width:45},items:{label:"Items",visible:!0,width:50},total:{label:"Total ($)",visible:!0,width:20},status:{label:"Status",visible:!0,width:20},note:{label:"Note",visible:!1,width:30}}),P=k=>{F(O=>({...O,[k]:{...O[k],visible:!O[k].visible}}))},I=()=>{S||(u(!0),setTimeout(()=>{try{const k=new Fe({orientation:p,unit:"mm",format:b}),O=k.internal.pageSize.width;k.setFontSize(18),k.setTextColor(40,40,40),k.text("Orders Report",O/2,15,{align:"center"}),k.setFontSize(10),k.setTextColor(100,100,100),k.text(`Generated on: ${new Date().toLocaleString()}`,O/2,22,{align:"center"}),k.text(`Total Orders: ${l.length}`,O/2,27,{align:"center"});const h={};r==="None"?h["All Orders"]=l:l.forEach(M=>{const x=M[r]||"Unassigned";h[x]||(h[x]=[]),h[x].push(M)});const y=[Object.entries(w).filter(([M,x])=>x.visible).map(([M,x])=>x.label)];let t=35;if(Object.entries(h).sort().forEach(([M,x])=>{t>k.internal.pageSize.height-30&&(k.addPage(),t=20),r!=="None"&&(k.setFontSize(12),k.setTextColor(30,64,175),k.setFillColor(240,240,255),k.rect(14,t,O-28,8,"F"),k.text(`${r}: ${M} (${x.length} orders)`,16,t+5.5),t+=10);const c=x.map(j=>{const n=[];if(w.orderId.visible&&n.push(j["Order ID"]),w.date.visible&&n.push(new Date(j.Timestamp).toLocaleDateString()),w.customer.visible&&n.push(j["Customer Name"]),w.phone.visible&&n.push(j["Customer Phone"]),w.location.visible&&n.push(`${j.Location||""} - ${j["Address Details"]||""}`),w.items.visible){const i=j.Products.map(f=>`${f.quantity}x ${f.name}`).join(", ");n.push(i)}return w.total.visible&&n.push(`$${j["Grand Total"].toFixed(2)}`),w.status.visible&&n.push(j["Payment Status"]),w.note.visible&&n.push(j.Note||""),n}),g=x.reduce((j,n)=>j+n["Grand Total"],0);k.autoTable({startY:t,head:y,body:c,theme:"striped",headStyles:{fillColor:[43,53,72],textColor:[255,255,255]},styles:{fontSize:8,cellPadding:2,overflow:"linebreak"},margin:{top:20}}),t=k.lastAutoTable.finalY+2,r!=="None"?(k.setFontSize(10),k.setTextColor(80,80,80),k.text(`Subtotal: $${g.toFixed(2)}`,O-15,t+5,{align:"right"}),t+=12):t+=5}),r==="None"){const M=l.reduce((x,c)=>x+c["Grand Total"],0);k.setFontSize(12),k.setTextColor(0,0,0),k.text(`GRAND TOTAL: $${M.toFixed(2)}`,O-15,t+5,{align:"right"})}const o=k.internal.pages.length-1;for(let M=1;M<=o;M++)k.setPage(M),k.setFontSize(8),k.setTextColor(150),k.text(`Page ${M} of ${o}`,O/2,k.internal.pageSize.height-10,{align:"center"});k.save(`Orders_Report_${new Date().toISOString().slice(0,10)}.pdf`),u(!1),a()}catch(k){console.error("PDF Generation Error:",k),alert("Failed to generate PDF. Check console for details."),u(!1)}},100))};return e.jsxs(ie,{isOpen:s,onClose:a,maxWidth:"max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"áž‘áž¶áž‰áž™áž€áž‡áž¶ PDF (Export PDF)"]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white text-2xl",children:"Ã—"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"áž€áž¶ážšáž€áŸ†ážŽážáŸ‹áž‘áž¼áž‘áŸ… (General)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"áž‘áŸ†áž áŸ† (Size)"}),e.jsxs("select",{value:b,onChange:k=>N(k.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"a4",children:"A4"}),e.jsx("option",{value:"a3",children:"A3"}),e.jsx("option",{value:"letter",children:"Letter"}),e.jsx("option",{value:"legal",children:"Legal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"áž‘áž·ážŸážŠáŸ…"}),e.jsxs("select",{value:p,onChange:k=>d(k.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"portrait",children:"áž”áž‰áŸ’ážˆážš (Portrait)"}),e.jsx("option",{value:"landscape",children:"áž”áŸ’ážŠáŸáž€ (Landscape)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Group By"}),e.jsxs("select",{value:r,onChange:k=>v(k.target.value),className:"form-select bg-gray-900 border-gray-700",children:[e.jsx("option",{value:"Page",children:"Page"}),e.jsx("option",{value:"Team",children:"Team"}),e.jsx("option",{value:"None",children:"None"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-300 mb-3",children:"Columns"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Object.keys(w).map(k=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-700 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:w[k].visible,onChange:()=>P(k),className:"h-5 w-5 text-blue-600 rounded border-gray-500 bg-gray-900"}),e.jsx("span",{className:"text-sm text-gray-200",children:w[k].label})]},k))})]}),e.jsxs("div",{className:"flex justify-end pt-4 space-x-3 border-t border-gray-700",children:[e.jsx("button",{onClick:a,className:"btn btn-secondary",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:I,className:"btn btn-primary flex items-center shadow-lg",disabled:S,children:S?e.jsxs(e.Fragment,{children:[e.jsx(te,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"áž€áŸ†áž–áž»áž„ážŠáŸ†ážŽáž¾ážšáž€áž¶ážš..."})]}):e.jsx(e.Fragment,{children:"áž‘áž¶áž‰áž™áž€ PDF"})})]})]})]})},Ht=({selectedCount:s,isSidebarCollapsed:a,isProcessing:l,onVerify:r,onUnverify:v,onOpenModal:b,onClearSelection:N})=>{const p=a?"64px":"208px";return e.jsx("div",{className:"hidden md:flex fixed bottom-10 left-0 w-full z-[90] justify-center pointer-events-none transition-all duration-500",style:{paddingLeft:p},children:e.jsxs("div",{className:"relative bg-[#0f172a]/95 backdrop-blur-3xl border border-white/10 rounded-[3rem] shadow-[0_30px_70px_rgba(0,0,0,0.8)] p-3 flex items-center gap-6 overflow-hidden ring-1 ring-white/10 pointer-events-auto animate-fade-in-up",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3/4 h-full bg-blue-500/5 blur-[80px] pointer-events-none"}),e.jsxs("div",{className:"flex items-center gap-3.5 pl-5 relative z-10",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-black text-lg shadow-[0_0_25px_rgba(37,99,235,0.4)] animate-pulse-subtle border-2 border-white/10",children:s}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[13px] font-black text-white leading-none tracking-tight",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸ"}),e.jsx("span",{className:"text-[8px] text-blue-400 font-bold uppercase tracking-[0.25em] mt-1",children:"ACTIVE NODE"})]})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsxs("div",{className:"flex items-center bg-[#242f41] p-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsxs("button",{onClick:r,className:"px-6 py-2.5 bg-[#10b981] hover:bg-[#059669] text-white rounded-[1.4rem] text-[11px] font-black uppercase tracking-wider transition-all flex items-center gap-2 shadow-lg active:scale-95 disabled:opacity-50",disabled:l,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:4,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"VERIFY"]}),e.jsx("button",{onClick:v,className:"px-5 py-2.5 text-gray-400 hover:text-white text-[11px] font-black uppercase tracking-wider transition-all active:scale-95 disabled:opacity-50",disabled:l,children:"UNVERIFY"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-6 py-1.5 rounded-[1.8rem] border border-white/5 relative z-10",children:[e.jsx("button",{onClick:()=>b("date"),className:"px-3.5 py-3 hover:text-white text-cyan-400 text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"DATE"}),e.jsx("button",{onClick:()=>b("cost"),className:"px-3.5 py-3 hover:text-white text-[#f6ad55] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"COST"}),e.jsx("button",{onClick:()=>b("payment"),className:"px-3.5 py-3 hover:text-white text-[#4299e1] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"PAY"}),e.jsx("button",{onClick:()=>b("shipping"),className:"px-3.5 py-3 hover:text-white text-[#9f7aea] text-[11px] font-black uppercase tracking-widest transition-all hover:scale-110",children:"SHIP"})]}),e.jsx("div",{className:"h-10 w-px bg-white/10 relative z-10"}),e.jsx("div",{className:"pr-5 relative z-10",children:e.jsx("button",{onClick:()=>b("delete"),className:"px-6 py-3.5 bg-red-600/10 hover:bg-red-600 text-red-500 hover:text-white border border-red-500/20 rounded-[1.6rem] text-[12px] font-black transition-all active:scale-95 shadow-lg hover:shadow-red-900/20",children:"áž›áž»áž”áž…áŸ„áž›"})}),e.jsx("button",{onClick:N,className:"absolute -top-12 left-1/2 -translate-x-1/2 px-4 py-1.5 bg-gray-800/80 backdrop-blur-md border border-white/10 rounded-full text-[9px] font-black text-gray-400 uppercase tracking-widest hover:text-white transition-all shadow-xl",children:"Clear Selection"})]})})},Gt=({selectedCount:s,isProcessing:a,onVerify:l,onUnverify:r,onOpenModal:v,onClearSelection:b})=>e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 w-full z-[100] animate-slide-up",children:[e.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-xl border-t border-white/10 p-3 flex justify-between items-center shadow-2xl relative z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-black text-white text-sm shadow-lg shadow-blue-600/30",children:s}),e.jsx("span",{className:"text-xs font-bold text-gray-300",children:"items selected"})]}),e.jsx("button",{onClick:b,className:"text-[10px] font-black text-gray-500 uppercase tracking-widest bg-gray-800 px-3 py-1.5 rounded-lg border border-gray-700 active:scale-95",children:"Clear"})]}),e.jsx("div",{className:"bg-[#0f172a] p-3 pb-safe-bottom overflow-x-auto custom-scrollbar border-t border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-max",children:[e.jsxs("div",{className:"flex items-center bg-gray-800/50 p-1 rounded-xl border border-white/5",children:[e.jsxs("button",{onClick:l,disabled:a,className:"px-4 py-3 bg-emerald-600 text-white rounded-lg font-black text-[10px] uppercase tracking-wider flex items-center gap-1.5 active:scale-95 disabled:opacity-50",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M5 13l4 4L19 7"})}),"Verify"]}),e.jsx("button",{onClick:r,disabled:a,className:"px-4 py-3 text-gray-400 font-bold text-[10px] uppercase tracking-wider active:scale-95 disabled:opacity-50",children:"Unverify"})]}),e.jsxs("button",{onClick:()=>v("date"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ“…"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Date"})]}),e.jsxs("button",{onClick:()=>v("cost"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’°"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Cost"})]}),e.jsxs("button",{onClick:()=>v("payment"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’³"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Pay"})]}),e.jsxs("button",{onClick:()=>v("shipping"),className:"flex flex-col items-center justify-center w-16 h-14 bg-gray-800/50 rounded-xl border border-white/5 active:bg-gray-700",children:[e.jsx("span",{className:"text-lg",children:"ðŸšš"}),e.jsx("span",{className:"text-[8px] font-black uppercase text-gray-400 mt-0.5",children:"Ship"})]}),e.jsx("button",{onClick:()=>v("delete"),className:"px-4 py-3 bg-red-600/10 border border-red-500/20 text-red-500 rounded-xl font-black text-[10px] uppercase tracking-widest active:bg-red-600 active:text-white transition-colors",children:"Delete"})]})}),e.jsx("style",{children:`
                @keyframes slide-up {
                    from { transform: translateY(100%); }
                    to { transform: translateY(0); }
                }
                .animate-slide-up { animation: slide-up 0.3s ease-out forwards; }
                .pb-safe-bottom { padding-bottom: max(12px, env(safe-area-inset-bottom)); }
            `})]}),Yt=({orders:s,selectedIds:a,onComplete:l,onClearSelection:r})=>{var J,X;const{appData:v,currentUser:b,refreshData:N,isSidebarCollapsed:p}=m.useContext(re),[d,S]=m.useState(!1),[u,w]=m.useState(null),[F,P]=m.useState(""),[I,k]=m.useState(""),[O,h]=m.useState("Paid"),[y,t]=m.useState(""),[o,M]=m.useState(""),[x,c]=m.useState(""),[g,j]=m.useState(""),[n,i]=m.useState(""),f=async(U,Z)=>{if(a.size!==0&&!(Z&&!window.confirm(Z))){S(!0);try{const q=Array.from(a);for(const le of q){const ce=s.find(de=>de["Order ID"]===le);if(!ce)continue;const W={...ce,...U},ne={Timestamp:W.Timestamp,"Order ID":W["Order ID"],User:W.User,Page:W.Page,TelegramValue:W.TelegramValue,"Customer Name":W["Customer Name"],"Customer Phone":W["Customer Phone"],Location:W.Location,"Address Details":W["Address Details"],Note:W.Note||"","Shipping Fee (Customer)":W["Shipping Fee (Customer)"],Subtotal:W.Subtotal,"Grand Total":W["Grand Total"],"Internal Shipping Method":W["Internal Shipping Method"],"Internal Shipping Details":W["Internal Shipping Details"],"Internal Cost":Number(W["Internal Cost"])||0,"Payment Status":W["Payment Status"],"Payment Info":W["Payment Info"]||"","Discount ($)":W["Discount ($)"],"Total Product Cost ($)":W["Total Product Cost ($)"],"Fulfillment Store":W["Fulfillment Store"],Team:W.Team,"Scheduled Time":W["Scheduled Time"]||"",IsVerified:W.IsVerified};ne["Products (JSON)"]=JSON.stringify(W.Products),await fetch(`${ae}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:le,team:W.Team,userName:b==null?void 0:b.UserName,newData:ne})})}await N(),w(null),l()}catch(q){console.error("Bulk update failed:",q),alert("áž€áž¶ážšáž€áŸ‚ážŸáž˜áŸ’ážšáž½áž›áž”ážšáž¶áž‡áŸáž™!")}finally{S(!1)}}},L=async()=>{if(!(a.size===0||!I)){S(!0);try{const U=Array.from(a),[Z,q,le]=I.split("-").map(Number);for(const ce of U){const W=s.find(pe=>pe["Order ID"]===ce);if(!W)continue;const ne=new Date(W.Timestamp),de=new Date(Z,q-1,le,ne.getHours(),ne.getMinutes(),ne.getSeconds()),H={...W,Timestamp:de.toISOString()},ye={Timestamp:H.Timestamp,"Order ID":H["Order ID"],User:H.User,Page:H.Page,TelegramValue:H.TelegramValue,"Customer Name":H["Customer Name"],"Customer Phone":H["Customer Phone"],Location:H.Location,"Address Details":H["Address Details"],Note:H.Note||"","Shipping Fee (Customer)":H["Shipping Fee (Customer)"],Subtotal:H.Subtotal,"Grand Total":H["Grand Total"],"Internal Shipping Method":H["Internal Shipping Method"],"Internal Shipping Details":H["Internal Shipping Details"],"Internal Cost":Number(H["Internal Cost"])||0,"Payment Status":H["Payment Status"],"Payment Info":H["Payment Info"]||"","Discount ($)":H["Discount ($)"],"Total Product Cost ($)":H["Total Product Cost ($)"],"Fulfillment Store":H["Fulfillment Store"],Team:H.Team,"Scheduled Time":H["Scheduled Time"]||"",IsVerified:H.IsVerified};ye["Products (JSON)"]=JSON.stringify(H.Products),await fetch(`${ae}/api/admin/update-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:ce,team:H.Team,userName:b==null?void 0:b.UserName,newData:ye})})}await N(),w(null),k(""),l()}catch(U){console.error("Bulk date update failed:",U),alert("áž€áž¶ážšáž€áŸ‚áž”áŸ’ážšáŸ‚áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘áž”ážšáž¶áž‡áŸáž™!")}finally{S(!1)}}},$=async()=>{if(a.size!==0){if(n!==(b==null?void 0:b.Password)){alert("áž›áŸážážŸáž˜áŸ’áž„áž¶ážáŸ‹áž˜áž·áž“ážáŸ’ážšáž¹áž˜ážáŸ’ážšáž¼ážœ!");return}S(!0);try{const U=Array.from(a);for(const Z of U){const q=s.find(le=>le["Order ID"]===Z);await fetch(`${ae}/api/admin/delete-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:Z,team:q==null?void 0:q.Team,userName:b==null?void 0:b.UserName,telegramMessageId1:q==null?void 0:q["Telegram Message ID 1"],telegramMessageId2:q==null?void 0:q["Telegram Message ID 2"],telegramChatId:q==null?void 0:q.TelegramValue})})}await N(),w(null),i(""),l()}catch{alert("áž€áž¶ážšáž›áž»áž”áž”ážšáž¶áž‡áŸáž™!")}finally{S(!1)}}},C=(J=v.shippingMethods)==null?void 0:J.find(U=>U.MethodName===o),z=C==null?void 0:C.RequireDriverSelection;return a.size===0?null:e.jsxs(e.Fragment,{children:[!u&&e.jsxs(e.Fragment,{children:[e.jsx(Ht,{selectedCount:a.size,isSidebarCollapsed:p,isProcessing:d,onVerify:()=>f({IsVerified:!0},`áž”áž‰áŸ’áž‡áž¶áž€áŸ‹áž›áž¾áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ${a.size} áž“áŸáŸ‡?`),onUnverify:()=>f({IsVerified:!1}),onOpenModal:w,onClearSelection:r}),e.jsx(Gt,{selectedCount:a.size,isProcessing:d,onVerify:()=>f({IsVerified:!0},`áž”áž‰áŸ’áž‡áž¶áž€áŸ‹áž›áž¾áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ${a.size} áž“áŸáŸ‡?`),onUnverify:()=>f({IsVerified:!1}),onOpenModal:w,onClearSelection:r})]}),e.jsx(ie,{isOpen:u==="date",onClose:()=>w(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-cyan-500/20 text-cyan-400 rounded-full flex items-center justify-center mx-auto mb-6 border border-cyan-500/30",children:e.jsx("span",{className:"text-3xl",children:"ðŸ“…"})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-2 uppercase tracking-tight",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold text-center mb-6 uppercase tracking-widest",children:"áž˜áŸ‰áŸ„áž„áž“áž¹áž„ážšáž€áŸ’ážŸáž¶áž‘áž»áž€ážŠáž¼áž…ážŠáž¾áž˜ (Time Unchanged)"}),e.jsx("div",{className:"relative mb-8",children:e.jsx("input",{type:"date",value:I,onChange:U=>k(U.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 text-white font-bold text-center rounded-[2rem] focus:ring-4 focus:ring-cyan-500/10 transition-all w-full"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>w(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:L,className:"py-4 bg-cyan-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-cyan-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:d||!I,children:d?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(ie,{isOpen:u==="cost",onClose:()=>w(null),maxWidth:"max-w-sm",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("h3",{className:"text-xl font-black text-white text-center mb-8 uppercase tracking-tight",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážáŸ’áž›áŸƒážŠáž¹áž€ážŠáž¾áž˜ (Cost)"}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("input",{type:"number",step:"0.01",value:F,onChange:U=>P(U.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-6 text-blue-400 font-black text-4xl text-center rounded-[2rem] focus:ring-4 focus:ring-blue-500/10 transition-all",placeholder:"0.00",autoFocus:!0}),e.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 text-gray-600 font-black text-2xl",children:"$"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>w(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>f({"Internal Cost":Number(F)}),className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-blue-600/20 active:scale-95 flex items-center justify-center gap-2",disabled:d||!F,children:d?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(ie,{isOpen:u==="payment",onClose:()=>w(null),maxWidth:"max-w-lg",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 overflow-hidden flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600/20 rounded-xl flex items-center justify-center border border-blue-500/30",children:e.jsx("span",{className:"text-xl",children:"ðŸ’³"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážŸáŸ’ážáž¶áž“áž—áž¶áž–áž‘áž¼áž‘áž¶ážáŸ‹"})]}),e.jsxs("div",{className:"flex p-1.5 bg-black/40 rounded-2xl border border-gray-700 mb-6",children:[e.jsxs("button",{onClick:()=>{h("Paid")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${O==="Paid"?"bg-emerald-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"PAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(áž‘áž¼áž‘áž¶ážáŸ‹ážšáž½áž…ážšáž¶áž›áŸ‹)"})]}),e.jsxs("button",{onClick:()=>{h("Unpaid"),t("")},className:`flex-1 flex flex-col items-center justify-center py-4 rounded-xl transition-all duration-300 ${O==="Unpaid"?"bg-red-600 shadow-lg text-white":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"text-base font-black tracking-wider uppercase",children:"UNPAID"}),e.jsx("span",{className:"text-[9px] font-bold opacity-80",children:"(áž˜áž·áž“áž‘áž¶áž“áŸ‹áž‘áž¼áž‘áž¶ážáŸ‹ - COD)"})]})]})]}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar px-1",children:O==="Paid"?e.jsxs("div",{className:"space-y-4 animate-fade-in-down pb-4",children:[e.jsxs("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž‚ážŽáž“áž¸áž’áž“áž¶áž‚áž¶ážš"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:(X=v.bankAccounts)==null?void 0:X.map(U=>{const Z=y===U.BankName;return e.jsxs("button",{onClick:()=>t(U.BankName),className:`flex items-center gap-4 p-4 rounded-2xl border transition-all duration-200 group ${Z?"bg-blue-600/20 border-blue-500 shadow-[0_0_20px_rgba(37,99,235,0.2)]":"bg-gray-800/40 border-white/5 hover:bg-gray-800 hover:border-white/20"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${Z?"bg-black/40":"bg-black/20"}`,children:e.jsx("img",{src:he(U.LogoURL),className:"w-7 h-7 object-contain",alt:""})}),e.jsx("span",{className:`text-xs font-black w-full text-left whitespace-normal leading-tight ${Z?"text-white":"text-gray-400 group-hover:text-gray-200"}`,children:U.BankName}),Z&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 shadow-[0_0_8px_#3b82f6]"})]},U.BankName)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center opacity-50 space-y-3",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-900/20 flex items-center justify-center border border-red-500/20",children:e.jsx("span",{className:"text-3xl grayscale",children:"ðŸ“¦"})}),e.jsx("p",{className:"text-xs font-black text-gray-500 uppercase tracking-widest",children:"áž€áž¶ážšáž‘áž¼áž‘áž¶ážáŸ‹áž“áž¹áž„ážáŸ’ážšáž¼ážœáž’áŸ’ážœáž¾áž¡áž¾áž„áž–áŸáž›ážŠáž¹áž€ážŠáž›áŸ‹"})]})}),e.jsxs("div",{className:"flex-shrink-0 grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/10",children:[e.jsx("button",{onClick:()=>w(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white transition-colors bg-gray-800/50 rounded-2xl hover:bg-gray-800",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>f({"Payment Status":O,"Payment Info":O==="Paid"?y:""}),className:"py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2",disabled:d||O==="Paid"&&!y,children:d?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€áž€áž¶ážšáž•áŸ’áž›áž¶ážŸáŸ‹áž”áŸ’ážáž¼ážš"})]})]})}),e.jsx(ie,{isOpen:u==="shipping",onClose:()=>w(null),maxWidth:"max-w-xl",children:e.jsxs("div",{className:"p-6 sm:p-8 bg-[#0f172a] rounded-[2.5rem] border border-white/10 max-h-[85vh] flex flex-col",children:[e.jsx("h3",{className:"text-lg font-black text-white text-center mb-6 uppercase tracking-tight flex-shrink-0",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚áž€áŸ’ážšáž»áž˜áž áŸŠáž»áž“ážŠáž¹áž€áž‡áž‰áŸ’áž‡áž¼áž“"}),e.jsxs("div",{className:"space-y-6 overflow-y-auto custom-scrollbar pr-2 flex-grow",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸážŸáŸážœáž¶ážŠáž¹áž€"}),e.jsx(mt,{methods:v.shippingMethods||[],selectedMethodName:o,onSelect:U=>{M(U.MethodName),c("")}})]}),z&&e.jsxs("div",{className:"space-y-3 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("div",{className:"h-4 w-1 bg-blue-500 rounded-full"}),e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]",children:"áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž¢áŸ’áž“áž€ážŠáž¹áž€ (DriverSelection)*"})]}),e.jsx(ht,{drivers:v.drivers||[],selectedDriverName:x,onSelect:c}),!x&&e.jsx("p",{className:"text-center text-[9px] text-gray-500 italic",children:"ážŸáž¼áž˜áž‡áŸ’ážšáž¾ážŸážšáž¾ážŸáž¢áŸ’áž“áž€ážŠáž¹áž€áž˜áŸ’áž“áž¶áž€áŸ‹"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest ml-1",children:"áž€áŸ‚áž”áŸ’ážšáŸ‚ážáŸ’áž›áŸƒážŠáž¹áž€ážŠáž¾áž˜ (Internal Cost)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",value:g,onChange:U=>j(U.target.value),className:"form-input !bg-black/40 !border-gray-700 !py-4 pl-4 pr-10 rounded-2xl font-black text-white focus:border-blue-500",placeholder:"áž”áž‰áŸ’áž…áž¼áž›ážáŸ’áž›áŸƒážŠáž¹áž€ážáŸ’áž˜áž¸ (áž”áž¾áž˜áž¶áž“)"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-bold",children:"$"})]}),e.jsx("div",{className:"flex gap-2",children:[0,1.25,1.5,2].map(U=>e.jsxs("button",{onClick:()=>j(String(U)),className:"flex-1 py-2 bg-gray-800 border border-gray-700 rounded-xl text-[10px] font-bold text-gray-400 hover:text-white hover:bg-gray-700 transition-all",children:["$",U]},U))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6 pt-4 border-t border-white/5 flex-shrink-0",children:[e.jsx("button",{onClick:()=>w(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest hover:text-white",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:()=>{const U={"Internal Shipping Method":o};z?U["Internal Shipping Details"]=x:U["Internal Shipping Details"]=o,g&&(U["Internal Cost"]=Number(g)),f(U)},className:"py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:d||!o||z&&!x,children:d?e.jsx(te,{size:"sm"}):"ážšáž€áŸ’ážŸáž¶áž‘áž»áž€"})]})]})}),e.jsx(ie,{isOpen:u==="delete",onClose:()=>w(null),maxWidth:"max-w-md",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsx("h3",{className:"text-xl font-black text-white text-center mb-4 uppercase tracking-tight",children:"áž›áž»áž”áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸážŸážšáž»áž”"}),e.jsxs("p",{className:"text-center text-gray-500 text-sm mb-8",children:["ážáž¾áž¢áŸ’áž“áž€áž”áŸ’ážšáž¶áž€ážŠáž‘áŸážáž¶áž…áž„áŸ‹áž›áž»áž”áž€áž¶ážšáž€áž˜áŸ’áž˜áž„áŸ‹áž‘áž¶áŸ†áž„ ",e.jsx("strong",{children:a.size})," áž“áŸáŸ‡? ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž“áŸáŸ‡áž˜áž·áž“áž¢áž¶áž…ážáŸ’ážšáž¡áž”áŸ‹áž€áŸ’ážšáŸ„áž™áž”áž¶áž“áž‘áŸáŸ”"]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-600 uppercase tracking-widest ml-1",children:"áž”áž‰áŸ’áž…áž¼áž›áž–áž¶áž€áŸ’áž™ážŸáž˜áŸ’áž„áž¶ážáŸ‹ážŠáž¾áž˜áŸ’áž”áž¸áž”áž‰áŸ’áž‡áž¶áž€áŸ‹"}),e.jsx("input",{type:"password",value:n,onChange:U=>i(U.target.value),className:"form-input !bg-red-500/5 !border-red-500/20 !py-4 text-center text-white font-black tracking-widest",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>w(null),className:"py-4 text-gray-500 font-black uppercase text-xs tracking-widest",children:"áž”áŸ„áŸ‡áž”áž„áŸ‹"}),e.jsx("button",{onClick:$,className:"py-4 bg-red-600 text-white rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl shadow-red-900/40 active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:d||!n,children:d?e.jsxs(e.Fragment,{children:[e.jsx(te,{size:"sm"}),e.jsx("span",{children:"áž€áŸ†áž–áž»áž„áž›áž»áž”..."})]}):"áž”áž¶áž‘, áž›áž»áž”áž‘áž¶áŸ†áž„áž¢ážŸáŸ‹"})]})]})}),e.jsx("style",{children:`
                @keyframes pulse-subtle {
                    0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(37,99,235,0.2); }
                    50% { transform: scale(1.05); box-shadow: 0 0 35px rgba(37,99,235,0.4); }
                }
                .animate-pulse-subtle {
                    animation: pulse-subtle 2s infinite ease-in-out;
                }
            `})]})},Ge=[{key:"index",label:"#"},{key:"orderId",label:"ID"},{key:"customerName",label:"ážˆáŸ’áž˜áŸ„áŸ‡áž¢ážáž·ážáž·áž‡áž“"},{key:"productInfo",label:"áž–áŸážáŸŒáž˜áž¶áž“ Product"},{key:"location",label:"áž‘áž¸ážáž¶áŸ†áž„"},{key:"pageInfo",label:"Page"},{key:"fulfillment",label:"ážƒáŸ’áž›áž¶áŸ†áž„ (Fulfillment)"},{key:"total",label:"ážŸážšáž»áž”"},{key:"shippingService",label:"ážŸáŸážœáž¶ážŠáž¹áž€"},{key:"shippingCost",label:"(Cost) ážŸáŸážœáž¶ážŠáž¹áž€"},{key:"status",label:"ážŸáŸ’ážáž¶áž“áž—áž¶áž–"},{key:"date",label:"áž€áž¶áž›áž”ážšáž·áž…áŸ’áž†áŸáž‘ & áž˜áŸ‰áŸ„áž„"},{key:"print",label:"áž–áŸ’ážšáž¸áž“"},{key:"actions",label:"ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–"},{key:"check",label:"Check"}],Kt=({visibleColumns:s,onToggle:a,columns:l=Ge})=>{const[r,v]=m.useState(!1),b=m.useRef(null);return m.useEffect(()=>{const N=p=>{b.current&&!b.current.contains(p.target)&&v(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),e.jsxs("div",{className:"relative inline-block text-left h-full",ref:b,children:[e.jsxs("button",{onClick:()=>v(!r),className:"flex h-full items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M5 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM9 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM13 4a1 1 0 00-2 0v12a1 1 0 002 0V4zM17 4a1 1 0 00-2 0v12a1 1 0 002 0V4z"})}),"Columns",e.jsx("svg",{className:`h-3.5 w-3.5 ml-1 transition-transform duration-500 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 9l-7 7-7-7",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})]}),r&&e.jsx("div",{className:"absolute right-0 mt-3 w-64 bg-[#1a2235]/95 border border-white/10 rounded-[1.8rem] shadow-[0_30px_70px_rgba(0,0,0,0.7)] z-[100] origin-top-right overflow-hidden backdrop-blur-3xl p-3 animate-fade-in-scale",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-[0.2em] px-3 py-2 mb-1",children:"áž€áŸ†ážŽážáŸ‹áž€áž¶ážšáž”áž„áŸ’áž áž¶áž‰"}),l.map(N=>e.jsxs("label",{className:"flex items-center px-3 py-2 text-xs text-gray-300 hover:bg-white/5 rounded-xl cursor-pointer transition-colors group",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded-md border-gray-600 bg-gray-900 text-blue-500 focus:ring-blue-500/20",checked:s.has(N.key),onChange:()=>a(N.key)}),e.jsx("span",{className:"ml-3 font-bold group-hover:text-white transition-colors",children:N.label})]},N.key))]})})]})},Jt=({isOpen:s,onClose:a,children:l})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`filter-panel-overlay fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] transition-opacity duration-500 ${s?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),e.jsxs("div",{className:`filter-panel fixed right-0 top-0 h-full w-[85%] max-w-md bg-[#0f172a] z-[80] shadow-2xl border-l border-white/5 transition-transform duration-500 flex flex-col ${s?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-black/20",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter italic",children:"Filter Engine"}),e.jsx("button",{onClick:a,className:"p-2 bg-white/5 rounded-xl text-gray-400 hover:text-white transition-all",children:"Ã—"})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow custom-scrollbar space-y-8",children:l}),e.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20",children:e.jsx("button",{onClick:a,className:"btn btn-primary w-full py-4 text-sm font-black uppercase tracking-[0.2em] shadow-xl shadow-blue-900/20 rounded-2xl active:scale-95 transition-transform",children:"Apply Configuration"})})]})]}),qt=({onBack:s,initialFilters:a})=>{const{appData:l,refreshData:r,refreshTimestamp:v,currentUser:b}=m.useContext(re),[N,p]=E("editOrder",""),[d,S]=E("teamFilter",""),[u,w]=E("dateFilter","this_month"),[F,P]=E("locationFilter",""),[I,k]=E("storeFilter",""),[O,h]=E("startDate",""),[y,t]=E("endDate",""),[o,M]=E("shippingFilter",""),[x,c]=E("driverFilter",""),[g,j]=E("brandFilter",""),[n,i]=E("paymentFilter",""),[f,L]=E("userFilter",""),[$,C]=E("pageFilter",""),[z,J]=E("costFilter",""),[X,U]=E("bankFilter",""),[Z,q]=E("productFilter",""),[le,ce]=m.useState(()=>{const D=Ge||[];return new Set(D.filter(R=>R.key!=="productInfo"&&R.key!=="print"&&R.key!=="check"&&R.key!=="fulfillment").map(R=>R.key))}),[W,ne]=m.useState([]),[de,H]=m.useState([]),[ye,pe]=m.useState(!0),[Te,ke]=m.useState(0),[Me,ve]=m.useState(null),[$e,ue]=m.useState(!1),[Oe,Se]=m.useState(!1),[je,Re]=m.useState(""),[xe,ge]=m.useState(new Set),[A,Ae]=m.useState(()=>{const D=new URLSearchParams(window.location.search);return{datePreset:(a==null?void 0:a.datePreset)||D.get("dateFilter")||"this_month",startDate:(a==null?void 0:a.startDate)||D.get("startDate")||"",endDate:(a==null?void 0:a.endDate)||D.get("endDate")||"",team:(a==null?void 0:a.team)||D.get("teamFilter")||"",location:(a==null?void 0:a.location)||D.get("locationFilter")||"",fulfillmentStore:(a==null?void 0:a.fulfillmentStore)||D.get("storeFilter")||"",store:(a==null?void 0:a.store)||D.get("brandFilter")||"",shippingService:(a==null?void 0:a.shippingService)||D.get("shippingFilter")||"",driver:(a==null?void 0:a.driver)||D.get("driverFilter")||"",paymentStatus:(a==null?void 0:a.paymentStatus)||D.get("paymentFilter")||"",user:(a==null?void 0:a.user)||D.get("userFilter")||"",page:(a==null?void 0:a.page)||D.get("pageFilter")||"",internalCost:(a==null?void 0:a.internalCost)||D.get("costFilter")||"",bank:(a==null?void 0:a.bank)||D.get("bankFilter")||"",product:(a==null?void 0:a.product)||D.get("productFilter")||""}});m.useEffect(()=>{A.team!==d&&S(A.team),A.datePreset!==u&&w(A.datePreset),A.location!==F&&P(A.location),A.fulfillmentStore!==I&&k(A.fulfillmentStore),A.startDate!==O&&h(A.startDate),A.endDate!==y&&t(A.endDate),A.shippingService!==o&&M(A.shippingService),A.driver!==x&&c(A.driver),A.store!==g&&j(A.store),A.paymentStatus!==n&&i(A.paymentStatus),A.user!==f&&L(A.user),A.page!==$&&C(A.page),A.internalCost!==z&&J(A.internalCost),A.bank!==X&&U(A.bank),A.product!==Z&&q(A.product)},[A,d,u,F,I,O,y,o,x,g,n,f,$,z,X,Z]);const _e=m.useMemo(()=>{const D=new Date,R=new Date(D.getFullYear(),D.getMonth(),D.getDate());let _=null,V=new Date;switch(A.datePreset){case"today":_=R;break;case"yesterday":_=new Date(R),_.setDate(R.getDate()-1),V=new Date(R),V.setMilliseconds(-1);break;case"this_week":const Q=D.getDay();_=new Date(R),_.setDate(R.getDate()-(Q===0?6:Q-1));break;case"last_week":_=new Date(R),_.setDate(R.getDate()-D.getDay()-6),V=new Date(_),V.setDate(_.getDate()+6),V.setHours(23,59,59);break;case"this_month":_=new Date(D.getFullYear(),D.getMonth(),1);break;case"last_month":_=new Date(D.getFullYear(),D.getMonth()-1,1),V=new Date(D.getFullYear(),D.getMonth(),0,23,59,59);break;case"this_year":_=new Date(D.getFullYear(),0,1);break;case"all":return"All time data stream";case"custom":return`${A.startDate||"..."} to ${A.endDate||"..."}`}const K=Q=>Q.toISOString().split("T")[0];return _?`${K(_)} to ${K(V)}`:"All time data stream"},[A.datePreset,A.startDate,A.endDate]),Ue=D=>{ce(R=>{const _=new Set(R);return _.has(D)?_.size>1&&_.delete(D):_.add(D),_})},Ie=async D=>{let _=[];for(let V=0;V<D.length;V+=500){const Q=D.slice(V,V+500).map(Y=>{let se=[];try{Y["Products (JSON)"]&&(se=JSON.parse(Y["Products (JSON)"]))}catch{}return{...Y,Products:se,IsVerified:String(Y.IsVerified).toUpperCase()==="TRUE"}});_=[..._,...Q],ke(Math.round((V+500)/D.length*100)),await new Promise(Y=>setTimeout(Y,0))}return _},be=D=>{const R=D.Timestamp;if(!R)return 0;const _=R.match(/^(\d{4})-(\d{1,2})-(\d{1,2})\s(\d{1,2}):(\d{2})/);return _?new Date(parseInt(_[1]),parseInt(_[2])-1,parseInt(_[3]),parseInt(_[4]),parseInt(_[5])).getTime():new Date(R).getTime()},Ce=async()=>{pe(!0),ke(0),ve(null);try{const[D,R]=await Promise.all([fetch(`${ae}/api/admin/all-orders`),fetch(`${ae}/api/users`)]),_=await D.json(),V=await R.json();if(_.status==="success"){const K=(_.data||[]).filter(Y=>Y!==null&&Y["Order ID"]!=="Opening Balance"&&Y["Order ID"]!=="Opening_Balance"),Q=await Ie(K);ne(Q.sort((Y,se)=>be(se)-be(Y)))}else ve(_.message||"Failed to load orders");V.status==="success"&&H(V.data||[])}catch(D){console.error("Fetch Error:",D),ve("áž˜áž·áž“áž¢áž¶áž…áž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™áž”áž¶áž“áž‘áŸáŸ” ážŸáž¼áž˜áž–áž·áž“áž·ážáŸ’áž™ Internet ážšáž”ážŸáŸ‹áž¢áŸ’áž“áž€áŸ”")}finally{pe(!1)}};m.useEffect(()=>{Ce()},[v]);const me=m.useMemo(()=>W.map(D=>{var _;let R=(D.Team||"").trim();if(!R){const V=de.find(K=>K.UserName===D.User);if(V!=null&&V.Team)R=V.Team.split(",")[0].trim();else{const K=(_=l.pages)==null?void 0:_.find(Q=>Q.PageName===D.Page);K!=null&&K.Team&&(R=K.Team)}}return{...D,Team:R||"Unassigned"}}),[W,de,l.pages]),T=m.useMemo(()=>me.filter(D=>{var R;if(A.datePreset!=="all"){const _=be(D),V=new Date(_),K=new Date,Q=new Date(K.getFullYear(),K.getMonth(),K.getDate());let Y=null,se=null;switch(A.datePreset){case"today":Y=Q;break;case"yesterday":Y=new Date(Q),Y.setDate(Q.getDate()-1),se=new Date(Q),se.setMilliseconds(-1);break;case"this_week":const Be=K.getDay();Y=new Date(Q),Y.setDate(Q.getDate()-(Be===0?6:Be-1));break;case"last_week":Y=new Date(Q),Y.setDate(Q.getDate()-K.getDay()-6),se=new Date(Y),se.setDate(Y.getDate()+6),se.setHours(23,59,59);break;case"this_month":Y=new Date(K.getFullYear(),K.getMonth(),1);break;case"last_month":Y=new Date(K.getFullYear(),K.getMonth()-1,1),se=new Date(K.getFullYear(),K.getMonth(),0,23,59,59);break;case"this_year":Y=new Date(K.getFullYear(),0,1);break;case"custom":A.startDate&&(Y=new Date(A.startDate+"T00:00:00")),A.endDate&&(se=new Date(A.endDate+"T23:59:59"));break}if(Y&&V<Y||se&&V>se)return!1}if(A.fulfillmentStore&&(D["Fulfillment Store"]||"Unassigned")!==A.fulfillmentStore)return!1;if(A.store){const _=(R=l.pages)==null?void 0:R.find(V=>V.PageName===D.Page);if(!_||_.DefaultStore!==A.store)return!1}if(A.team&&D.Team!==A.team||A.user&&(D.User||"").trim().toLowerCase()!==A.user.trim().toLowerCase()||A.paymentStatus&&D["Payment Status"]!==A.paymentStatus||A.shippingService&&D["Internal Shipping Method"]!==A.shippingService||A.driver&&D["Internal Shipping Details"]!==A.driver||A.bank&&D["Payment Info"]!==A.bank||A.product&&!D.Products.some(_=>_.name===A.product)||A.page&&D.Page!==A.page||A.location&&D.Location!==A.location||A.internalCost&&String(D["Internal Cost"])!==A.internalCost)return!1;if(je.trim()){const _=je.toLowerCase();return D["Order ID"].toLowerCase().includes(_)||(D["Customer Name"]||"").toLowerCase().includes(_)||(D["Customer Phone"]||"").includes(_)}return!0}),[me,A,je,l.pages]),G=D=>{ge(R=>{const _=new Set(R);return _.has(D)?_.delete(D):_.add(D),_})},B=D=>{const R=D.length>0&&D.every(_=>xe.has(_));ge(R?_=>{const V=new Set(_);return D.forEach(K=>V.delete(K)),V}:_=>new Set([..._,...D]))};if(ye)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-5",children:[e.jsx(te,{size:"lg"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-500 uppercase tracking-[0.4em] animate-pulse",children:"Syncing Operational Logs..."}),Te>0&&e.jsx("div",{className:"w-48 h-1 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${Te}%`}})})]})]});if(Me)return e.jsxs("div",{className:"flex flex-col h-96 items-center justify-center gap-6 p-6 text-center bg-gray-900/50 rounded-[3rem] border border-red-500/20 m-6 animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-500 rounded-2xl flex items-center justify-center border border-red-500/30 shadow-xl",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",strokeWidth:"2.5"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight",children:"áž€áŸ†áž áž»ážŸáž‘áž¶áž‰áž™áž€áž‘áž·áž“áŸ’áž“áž“áŸáž™"}),e.jsx("p",{className:"text-gray-500 font-bold max-w-md",children:Me})]}),e.jsx("button",{onClick:Ce,className:"btn btn-primary px-10 py-4 shadow-lg shadow-blue-600/20",children:"áž–áŸ’áž™áž¶áž™áž¶áž˜áž˜áŸ’ážŠáž„áž‘áŸ€áž"})]});if(N){const D=me.find(R=>R["Order ID"]===N);return D?e.jsx(ut,{order:D,onSaveSuccess:()=>{p(""),Ce(),r()},onCancel:()=>p("")}):e.jsx("div",{className:"p-20 text-center text-gray-500 font-black uppercase italic tracking-widest",children:"ážšáž€áž˜áž·áž“ážƒáž¾áž‰ Order ID áž“áŸáŸ‡áž‘áŸ"})}return e.jsxs("div",{className:"w-full max-w-full mx-auto px-3 sm:px-6 lg:px-8 animate-fade-in relative pb-40 pt-6 overflow-x-hidden",children:[e.jsx("div",{className:"md:hidden",children:e.jsx(Jt,{isOpen:$e,onClose:()=>ue(!1),children:e.jsx(He,{filters:A,setFilters:Ae,orders:me,usersList:de,appData:l,calculatedRange:_e})})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(ie,{isOpen:$e,onClose:()=>ue(!1),maxWidth:"max-w-4xl",children:e.jsxs("div",{className:"p-8 bg-[#0f172a] rounded-[3rem] border border-white/10 shadow-3xl overflow-hidden relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-1.5 h-8 bg-blue-600 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tighter italic leading-none",children:"Filter Subsystem"})]}),e.jsx("button",{onClick:()=>ue(!1),className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-gray-500 hover:text-white transition-all active:scale-90 border border-white/5",children:"Ã—"})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto custom-scrollbar pr-2 relative z-10",children:e.jsx(He,{filters:A,setFilters:Ae,orders:me,usersList:de,appData:l,calculatedRange:_e})}),e.jsx("div",{className:"mt-12 flex justify-center relative z-10",children:e.jsx("button",{onClick:()=>ue(!1),className:"btn btn-primary w-full py-5 text-[13px] font-black uppercase tracking-[0.25em] shadow-[0_20px_50px_rgba(37,99,235,0.3)] rounded-2xl active:scale-[0.98] transition-all",children:"Apply Filter Configuration"})}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end mb-10 gap-6 px-1",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl lg:text-5xl font-black text-white italic tracking-tighter leading-relaxed mb-3 py-1",children:"áž‚áŸ’ážšáž”áŸ‹áž‚áŸ’ážšáž„áž”áŸ’ážšážáž·áž”ážáŸ’ážáž·áž€áž¶ážšážŽáŸ"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600/10 rounded-full border border-blue-500/20",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("span",{className:"text-[11px] font-black text-blue-400 uppercase tracking-widest",children:[T.length," Entries Logged"]})]})})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:s,className:"group flex items-center gap-3 px-8 py-4 bg-gray-800/40 backdrop-blur-xl border border-white/5 hover:border-blue-500/30 text-gray-500 hover:text-blue-400 font-black uppercase tracking-widest text-[12px] rounded-2xl transition-all shadow-xl active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Core"]})})]}),e.jsx("div",{className:"bg-gray-800/20 backdrop-blur-3xl border border-white/5 rounded-[2.5rem] p-5 sm:p-6 mb-8 shadow-2xl relative z-20 group transition-all hover:bg-gray-800/30",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"relative w-full lg:max-w-2xl group",children:[e.jsx("input",{type:"text",placeholder:"ážŸáŸ’ážœáŸ‚áž„ážšáž€ ID, ážˆáŸ’áž˜áŸ„áŸ‡, áž¬áž›áŸážáž‘áž¼ážšážŸáŸáž–áŸ’áž‘...",value:je,onChange:D=>Re(D.target.value),className:"form-input !pl-16 !py-5 bg-black/40 border-gray-800 rounded-[1.8rem] text-[15px] font-bold text-white placeholder:text-gray-700 focus:border-blue-500/50 focus:bg-black/60 transition-all shadow-inner"}),e.jsxs("div",{className:"absolute left-6 top-1/2 -translate-y-1/2 flex items-center gap-4 text-gray-700 group-focus-within:text-blue-500 transition-colors",children:[e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("div",{className:"h-6 w-px bg-gray-800"})]})]}),e.jsxs("div",{className:"flex items-stretch gap-3 w-full lg:w-auto h-16 sm:h-[68px]",children:[e.jsxs("button",{onClick:()=>ue(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-gray-900 border border-gray-800 text-gray-400 hover:text-white hover:border-blue-500/30 rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:e.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]}),e.jsxs("button",{onClick:()=>Se(!0),className:"flex-1 lg:flex-none flex items-center justify-center gap-3 px-8 py-5 bg-red-600/10 border border-red-500/20 text-red-500 hover:bg-red-600 hover:text-white rounded-2xl text-[12px] font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-red-950/20",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:e.jsx("path",{d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Export"]}),e.jsx("div",{className:"hidden lg:block h-full",children:e.jsx(Kt,{columns:Ge,visibleColumns:le,onToggle:Ue})})]})]})}),e.jsx("div",{className:"relative z-10",children:e.jsx(pt,{orders:T,onEdit:D=>p(D["Order ID"]),showActions:!0,visibleColumns:le,selectedIds:xe,onToggleSelect:G,onToggleSelectAll:B})}),e.jsx(Yt,{orders:me,selectedIds:xe,onComplete:()=>{ge(new Set),Ce()},onClearSelection:()=>ge(new Set)}),Oe&&e.jsx(Vt,{isOpen:Oe,onClose:()=>Se(!1),orders:T})]})},Xt=({stats:s,onStatClick:a})=>{const l=m.useMemo(()=>s.reduce((r,v)=>({revenue:r.revenue+v.revenue,orders:r.orders+v.orders}),{revenue:0,orders:0}),[s]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center px-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-orange-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"ážƒáŸ’áž›áž¶áŸ†áž„áž”áž‰áŸ’áž…áŸáž‰áž‘áŸ†áž“áž·áž‰ (Stock)"]}),e.jsx("div",{className:"bg-gray-800/40 backdrop-blur-sm rounded-2xl border border-gray-700/50 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-[10px] text-gray-500 font-black uppercase tracking-widest bg-gray-900/50 border-b border-gray-700 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"ážˆáŸ’áž˜áŸ„áŸ‡ážƒáŸ’áž›áž¶áŸ†áž„ (Store)"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"áž…áŸ†áž“áž½áž“ Orders"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"áž…áŸ†ážŽáž¼áž›"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-700/30",children:[s.map((r,v)=>e.jsxs("tr",{className:"hover:bg-orange-600/5 transition-colors group cursor-pointer",onClick:()=>a(r.name),children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-gray-100 flex items-center gap-3",children:[e.jsxs("span",{className:"w-6 h-6 rounded-lg bg-gray-700 text-gray-400 flex items-center justify-center text-[10px] border border-gray-600",children:["#",v+1]}),e.jsx("span",{className:"group-hover:text-orange-300 transition-colors",children:r.name})]}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-400 font-black group-hover:underline",children:r.orders}),e.jsxs("td",{className:"px-6 py-4 text-right font-black text-green-400 group-hover:text-green-300 transition-colors",children:["$",r.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]},r.name)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500 italic",children:"áž˜áž·áž“áž‘áž¶áž“áŸ‹áž˜áž¶áž“áž‘áž·áž“áŸ’áž“áž“áŸáž™"})})]}),s.length>0&&e.jsx("tfoot",{className:"bg-gray-900/80 font-black border-t-2 border-gray-700",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 uppercase tracking-widest text-gray-500 text-[10px]",children:"ážŸážšáž»áž”ážšáž½áž˜"}),e.jsx("td",{className:"px-6 py-4 text-center text-blue-300 text-base",children:l.orders}),e.jsxs("td",{className:"px-6 py-4 text-right text-green-400 text-base",children:["$",l.revenue.toLocaleString(void 0,{minimumFractionDigits:2})]})]})})]})})})]})},rs=()=>{const{appData:s,currentUser:a,refreshTimestamp:l,isSidebarCollapsed:r}=m.useContext(re),[v,b]=E("tab","admin"),[N,p]=E("subview","dashboard"),[d,S]=E("reportType","overview"),[u,w]=m.useState(!1),[F,P]=m.useState(!1),[I,k]=m.useState(!1),[O,h]=m.useState(!1),[y,t]=m.useState("desktop"),[o,M]=m.useState([]),[x,c]=m.useState({preset:"today",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[g,j]=E("teamFilter",""),[n,i]=E("locationFilter",""),[f,L]=E("storeFilter",""),[$,C]=E("dateFilter","today"),[z,J]=E("startDate",""),[X,U]=E("endDate",""),[Z,q]=E("shippingFilter",""),[le,ce]=E("driverFilter",""),[W,ne]=E("brandFilter",""),[de,H]=E("paymentFilter",""),[ye,pe]=E("userFilter",""),[Te,ke]=E("pageFilter",""),[Me,ve]=E("costFilter",""),[$e,ue]=E("bankFilter",""),[Oe,Se]=E("productFilter","");m.useEffect(()=>{const T=()=>{const G=window.innerWidth;G<768?t("mobile"):G<1280?t("tablet"):t("desktop")};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]);const je=async()=>{o.length===0&&w(!0);try{const T=await fetch(`${ae}/api/admin/all-orders`);if(T.ok){const G=await T.json();if(G.status==="success"){const D=(Array.isArray(G.data)?G.data.filter(R=>R!==null&&R["Order ID"]!=="Opening_Balance"&&R["Order ID"]!=="Opening Balance"):[]).map(R=>{let _=[];try{R["Products (JSON)"]&&(_=JSON.parse(R["Products (JSON)"]))}catch{}return{...R,Products:_,IsVerified:String(R.IsVerified).toUpperCase()==="TRUE",FulfillmentStatus:R.FulfillmentStatus}});M(D)}}}catch(T){console.error(T)}finally{w(!1)}};m.useEffect(()=>{je()},[l]);const Re=()=>{const T=new Date,G=new Date(T.getFullYear(),T.getMonth(),T.getDate());return o.filter(B=>{if(!B.Timestamp)return!1;const D=new Date(B.Timestamp);if(x.preset==="today")return D.toDateString()===T.toDateString();if(x.preset==="this_week"){const R=T.getDay(),_=new Date(G);_.setDate(G.getDate()-(R===0?6:R-1));const V=new Date(_);return V.setDate(_.getDate()+6),V.setHours(23,59,59,999),D>=_&&D<=V}else{if(x.preset==="this_month")return D.getMonth()===T.getMonth()&&D.getFullYear()===T.getFullYear();if(x.preset==="custom"){const R=x.start?new Date(x.start+"T00:00:00"):null,_=x.end?new Date(x.end+"T23:59:59"):null;return!(R&&D<R||_&&D>_)}}return D.toDateString()===T.toDateString()})},xe=m.useMemo(()=>Re(),[o,x]),ge=m.useMemo(()=>{const T={};return xe.forEach(G=>{let B=G.Team||"Unassigned";T[B]||(T[B]={name:B,revenue:0,orders:0}),T[B].revenue+=Number(G["Grand Total"])||0,T[B].orders+=1}),Object.values(T).sort((G,B)=>B.revenue-G.revenue)},[xe]),A=m.useMemo(()=>{const T={};return xe.forEach(G=>{let B=G["Fulfillment Store"]||"Unassigned";T[B]||(T[B]={name:B,revenue:0,orders:0}),T[B].revenue+=Number(G["Grand Total"])||0,T[B].orders+=1}),Object.values(T).sort((G,B)=>B.revenue-G.revenue)},[xe]),Ae=m.useMemo(()=>{const T={};return xe.forEach(G=>{const B=(G.Location||"").split(/[,|\-|/]/)[0].trim();!B||B.toUpperCase()==="N/A"||(T[B]||(T[B]={name:B,revenue:0,orders:0}),T[B].revenue+=Number(G["Grand Total"])||0,T[B].orders+=1)}),Object.values(T).sort((G,B)=>B.revenue-G.revenue)},[xe]),_e=T=>{T==="reports"?P(!F):(["dashboard","performance"].includes(T)?(b("admin"),p(T)):b(T),P(!1))},Ue=T=>{b("reports"),S(T)},Ie=T=>{j(""),i(""),L(""),ne(""),q(""),ce(""),H(""),pe(""),ke(""),ve(""),ue(""),Se(""),T.team&&j(T.team),T.location&&i(T.location),T.fulfillmentStore&&L(T.fulfillmentStore),T.store&&ne(T.store),T.shipping&&q(T.shipping),T.driver&&ce(T.driver),T.paymentStatus&&H(T.paymentStatus),T.user&&pe(T.user),T.page&&ke(T.page),T.internalCost&&ve(T.internalCost),T.bank&&ue(T.bank),T.product&&Se(T.product),T.datePreset&&(C(T.datePreset),T.datePreset==="custom"&&T.startDate&&T.endDate?(J(T.startDate),U(T.endDate)):(J(""),U(""))),b("orders")},be=(T,G)=>{const B={};T==="team"&&(B.team=G),T==="location"&&(B.location=G),T==="store"&&(B.fulfillmentStore=G),B.datePreset=x.preset,x.preset==="custom"&&(B.startDate=x.start,B.endDate=x.end),Ie(B)},me={activeDashboard:v,currentAdminView:N,isReportSubMenuOpen:F,setIsReportSubMenuOpen:P,isProfileSubMenuOpen:I,setIsProfileSubMenuOpen:k,onNavChange:_e,onReportSubNav:Ue,setEditProfileModalOpen:h,children:(()=>{if(u&&o.length===0)return e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx(te,{size:"lg"})});switch(v){case"admin":return N==="dashboard"?e.jsx(Ct,{currentUser:a,parsedOrders:o,dateFilter:x,setDateFilter:c,teamRevenueStats:ge,provinceStats:Ae,storeStats:A,onTeamClick:T=>be("team",T),onProvinceClick:T=>be("location",T),onStoreClick:T=>be("store",T)}):e.jsx(Ot,{orders:o,users:s.users||[],targets:s.targets||[]});case"orders":return e.jsx(qt,{onBack:()=>b("admin"),initialFilters:{team:g,location:n,fulfillmentStore:f,store:W,datePreset:$,startDate:z,endDate:X,shippingService:Z,driver:le,paymentStatus:de,user:ye,page:Te,internalCost:Me,bank:$e,product:Oe}});case"reports":return e.jsx(Ft,{activeReport:d,onBack:()=>b("admin"),onNavigate:Ie});case"settings":return e.jsx(Wt,{onBack:()=>b("admin")});case"fulfillment":return e.jsx(Xt,{orders:o});default:return null}})()};return e.jsxs(e.Fragment,{children:[y==="mobile"?e.jsx(ft,{...me}):y==="tablet"?e.jsx(yt,{...me}):e.jsx(bt,{...me,isSidebarCollapsed:r}),O&&e.jsx(rt,{onClose:()=>h(!1)})]})};export{rs as default};
